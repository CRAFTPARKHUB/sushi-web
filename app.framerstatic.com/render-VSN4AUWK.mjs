import{a as va}from"https://app.framerstatic.com/chunk-BVRG4FKI.mjs";import"https://app.framerstatic.com/chunk-EOVRIR22.mjs";import{a as Re}from"https://app.framerstatic.com/chunk-E645MZLF.mjs";import{a as Ia}from"https://app.framerstatic.com/chunk-ZDS6BDCL.mjs";import{a as Fa,b as ba,c as Sa}from"https://app.framerstatic.com/chunk-OY56MMTN.mjs";import"https://app.framerstatic.com/chunk-ZQWPBI2W.mjs";import"https://app.framerstatic.com/chunk-NYCTM64J.mjs";import"https://app.framerstatic.com/chunk-NPGQCTFR.mjs";import{Bc as xt,Dc as da,Ic as pa,Mb as tn,Nb as $i,Nc as ma,Oc as ua,Qc as ga,Rb as ea,Rc as ya,Sb as ta,Sc as ha,Va as Xi,Vc as wa,Wc as Ca,Xa as Zi,Xc as oo,_c as B,a as Jt,ad as Ua,b as _i,bc as oa,bd as xa,c as Ri,cc as na,d as Mi,db as ji,dc as ra,dd as nn,e as Di,ec as ia,fc as aa,gb as Yi,ic as sa,j as Qt,k as Ti,l as $t,n as eo,o as to,p as Gi,r as zi,sc as la,t as qi,tc as ca,u as Wi,v as Li,va as $o,wc as on,xc as fa,ya as en}from"https://app.framerstatic.com/chunk-GVUQ2BZQ.mjs";import"https://app.framerstatic.com/chunk-DDH5A6SU.mjs";import{b as _e}from"https://app.framerstatic.com/chunk-FBR66C4L.mjs";import{h as Ai}from"https://app.framerstatic.com/chunk-SOF4EPEX.mjs";import{r as bi}from"https://app.framerstatic.com/chunk-R2FWM7WC.mjs";import"https://app.framerstatic.com/chunk-IHOAENGB.mjs";import{E as wt,F as Ct,H as G,I as oi,J as ni,K as ri,L as ii,M as ai,N as si,O as li,P as ci,Q as jt,S as fi,T as Yt,aa as pi,ia as mi,lb as xi,mb as Ii,nb as Fi,ta as ui,ua as wi,wa as Ht,xa as Ci}from"https://app.framerstatic.com/chunk-IZDFJLUX.mjs";import{a as hi,j as Si,m as vi}from"https://app.framerstatic.com/chunk-OY6MDLSR.mjs";import"https://app.framerstatic.com/chunk-6TTJU3MI.mjs";import{Bf as di,Pd as ti,ga as Zr,gb as Hr,ja as Zt,ka as C,la as jr,nb as Qr,xb as $r}from"https://app.framerstatic.com/chunk-LFHNV3Y3.mjs";import"https://app.framerstatic.com/chunk-PPD7JV62.mjs";import{e as ei}from"https://app.framerstatic.com/chunk-MXONXJZS.mjs";import"https://app.framerstatic.com/chunk-R2C6SYZL.mjs";import"https://app.framerstatic.com/chunk-JRBFLTNY.mjs";import"https://app.framerstatic.com/chunk-N57XNHE3.mjs";import"https://app.framerstatic.com/chunk-US5TF3B5.mjs";import"https://app.framerstatic.com/chunk-4AYVGW7R.mjs";import"https://app.framerstatic.com/chunk-P6LO7Y3T.mjs";import"https://app.framerstatic.com/chunk-JB3A7NVR.mjs";import"https://app.framerstatic.com/chunk-HTH46QE2.mjs";import"https://app.framerstatic.com/chunk-BQK5PZHM.mjs";import{a as Bi}from"https://app.framerstatic.com/chunk-V67MTYNI.mjs";import"https://app.framerstatic.com/chunk-4VZV62QQ.mjs";import"https://app.framerstatic.com/chunk-ETID5B72.mjs";import"https://app.framerstatic.com/chunk-WAFDZ45U.mjs";import"https://app.framerstatic.com/chunk-IRXQYDZ2.mjs";import"https://app.framerstatic.com/chunk-CQPWAHYM.mjs";import"https://app.framerstatic.com/chunk-YE25YANI.mjs";import{a as Yr,b as ht}from"https://app.framerstatic.com/chunk-IDXTJXXX.mjs";import"https://app.framerstatic.com/chunk-FF5K3P3Y.mjs";import"https://app.framerstatic.com/chunk-OIUMJCWK.mjs";import{b as Ki}from"https://app.framerstatic.com/chunk-B2GJZGNG.mjs";import"https://app.framerstatic.com/chunk-FQUBPV2J.mjs";import"https://app.framerstatic.com/chunk-D7MEQ7Y3.mjs";import{d as Xr}from"https://app.framerstatic.com/chunk-MSOVP7VS.mjs";import"https://app.framerstatic.com/chunk-PCV272DA.mjs";import{a as Ji,d as Qi}from"https://app.framerstatic.com/chunk-A4DB6RTD.mjs";import"https://app.framerstatic.com/chunk-OC6NILJY.mjs";import"https://app.framerstatic.com/chunk-T54BTL7R.mjs";import"https://app.framerstatic.com/chunk-KRBJUBXO.mjs";import{a as it}from"https://app.framerstatic.com/chunk-7GSEC7H4.mjs";import"https://app.framerstatic.com/chunk-246E47TK.mjs";import"https://app.framerstatic.com/chunk-ITPH43YU.mjs";import{a as Vi}from"https://app.framerstatic.com/chunk-LRDLYUYQ.mjs";import{a as Oi}from"https://app.framerstatic.com/chunk-KRNWUQIL.mjs";import{b as yi,r as Ui}from"https://app.framerstatic.com/chunk-W42HW5VE.mjs";import{e as Ut,f as gi}from"https://app.framerstatic.com/chunk-WAQRBJZZ.mjs";import{a as Jr,j as ee}from"https://app.framerstatic.com/chunk-DTJW3CSW.mjs";import"https://app.framerstatic.com/chunk-PABHF7FN.mjs";import{Hg as Fr,Ia as pr,Ig as br,Ld as Ho,Md as Jo,Ub as mr,Ug as Sr,Wg as vr,ac as ur,be as Cr,ce as Ur,de as xr,ee as Ir,id as gr,jd as R,ka as Yo,vd as hr,wd as wr}from"https://app.framerstatic.com/chunk-6YTQAM34.mjs";import"https://app.framerstatic.com/chunk-AZP6OTDM.mjs";import"https://app.framerstatic.com/chunk-UJZ2TDVM.mjs";import{e as yr,f as K}from"https://app.framerstatic.com/chunk-R57RKM33.mjs";import"https://app.framerstatic.com/chunk-V4TANWPK.mjs";import"https://app.framerstatic.com/chunk-2L7FC5IH.mjs";import{b as Hi}from"https://app.framerstatic.com/chunk-ZLPIJXTY.mjs";import"https://app.framerstatic.com/chunk-TVYYAEV6.mjs";import{Bc as Br,Ee as Qo,G as Nr,Gc as Ar,Gf as Wr,H as Or,Ie as Mr,Le as Wt,Se as Lt,We as Dr,Xe as Tr,Ye as Gr,ab as qt,ag as Lr,b as Pr,bg as Vr,je as _r,me as Rr,pf as zr,se as P,sf as Vt,tf as Kt,uf as Xt,vg as Kr,wf as qr,ye as T}from"https://app.framerstatic.com/chunk-AAFAMNTF.mjs";import"https://app.framerstatic.com/chunk-25W4MKKO.mjs";import"https://app.framerstatic.com/chunk-2OHDEXOT.mjs";import"https://app.framerstatic.com/chunk-HHZD2RYV.mjs";import"https://app.framerstatic.com/chunk-RLD2AJHB.mjs";import"https://app.framerstatic.com/chunk-57S4664Q.mjs";import{a as Ei}from"https://app.framerstatic.com/chunk-VJBLPHHY.mjs";import{a as L}from"https://app.framerstatic.com/chunk-QFU6OGL3.mjs";import{a as ki,b as Pi,c as Ni}from"https://app.framerstatic.com/chunk-CTKJD4ES.mjs";import"https://app.framerstatic.com/chunk-7VTUJ2SW.mjs";import{Id as fr,Ve as dr,qc as S,tb as cr}from"https://app.framerstatic.com/chunk-HMWS5X5Y.mjs";import{Bi as Jn,Dd as Yn,Eo as rr,Hb as Kn,Id as A,Jd as fe,L as Oe,Md as Tt,Nd as Ve,Ol as tr,Q as We,Qc as Zn,Sc as jn,Uc as ke,Vq as yt,X as Le,Xq as Ke,am as de,ar as Gt,bp as ir,cm as or,dm as nr,ej as Qn,ek as er,gt as lr,ic as Xn,jc as O,ku as zt,l as q,lb as Ln,li as Ko,nl as Zo,pb as J,ps as ar,ql as jo,qs as sr,rb as Vn,ua as Be,uj as $n,x as Tn,xi as Xo}from"https://app.framerstatic.com/chunk-ZK325ET3.mjs";import"https://app.framerstatic.com/chunk-VXJAAVJQ.mjs";import"https://app.framerstatic.com/chunk-5DSVU7DA.mjs";import"https://app.framerstatic.com/chunk-KD4H3DLZ.mjs";import"https://app.framerstatic.com/chunk-4DUBS6C5.mjs";import"https://app.framerstatic.com/chunk-XX4R3RQ6.mjs";import"https://app.framerstatic.com/chunk-MFZYGAHA.mjs";import"https://app.framerstatic.com/chunk-XFC6OVIX.mjs";import"https://app.framerstatic.com/chunk-4I3XDWXC.mjs";import"https://app.framerstatic.com/chunk-POQKH4YA.mjs";import{a as k,b as nt}from"https://app.framerstatic.com/chunk-4AQCMAAQ.mjs";import"https://app.framerstatic.com/chunk-CYNLX7FI.mjs";import{e as kr,g as Er,i as ae}from"https://app.framerstatic.com/chunk-XWEO5KIO.mjs";import"https://app.framerstatic.com/chunk-AUNF3KWQ.mjs";import{H as Hn,k as Gn,r as zn,s as qn}from"https://app.framerstatic.com/chunk-MM3XA4KU.mjs";import{b as ie,d as Wn,e as Ae,i as Ce}from"https://app.framerstatic.com/chunk-ZQUNXESX.mjs";import{Pd as Ml,Vc as W,a as $,b as g,sc as rt}from"https://app.framerstatic.com/chunk-M7LXWNTO.mjs";import"https://app.framerstatic.com/chunk-PFHOMMMY.mjs";import"https://app.framerstatic.com/chunk-72P4HPJP.mjs";import"https://app.framerstatic.com/chunk-WIUFUKXG.mjs";import{$ as Dn,aa as ot,i as Rt,k as H,o as Mt}from"https://app.framerstatic.com/chunk-GQILM44Y.mjs";import{a as h,b as Vo}from"https://app.framerstatic.com/chunk-WNSBRACC.mjs";import{a as Dt}from"https://app.framerstatic.com/chunk-LQILWJHN.mjs";import{e as m,j as p,k as qe,l as At,m as _t}from"https://app.framerstatic.com/chunk-AHQIRSXG.mjs";var Ea=m(g()),Dl={BooleanControlPropRow:Fa,EnumControlPropRow:la,StringControlPropRow:xt};function ka({children:n}){return(0,Ea.jsx)(ji.Provider,{value:Dl,children:n})}var rn="data-chrome";function Pa(n){return n instanceof HTMLElement?n.closest(`[${rn}]`)!==null:!1}function Na(){return window}function an(){return Na().secureFrameAncestors}function at(){k(an(),"Must have secure frame ancestors.")}var go=m($()),Ls=m(Ml());var Oa="chromeHidden_c1gxt05z",Ba="nonHudChromeWrapper_n1sd5akc";var ro=m($());var Aa="modal_m1cvfiap",_a="form_f1nz04q2",Ra="scroll_syo0l7n",Ma="width100_w9541mz",Da="editor_e73gufq";var Xe=m(g()),zl=["left","right","auto-vertical"];function Ga({controlKey:n,nodeId:o}){let e=R(),t=()=>{e.stores.modalStore.dismiss()},r=_e(()=>{let c=e.stores.treeStore.tree.get(o);return!Ve(c)&&!fe(c)?null:c},[o],["Tree"]),i=_e(()=>{let l=e.tree.getScopeNodeFor(r);return l?$r(l):null},[r],["Tree"]),s=_e(()=>{if(Ve(r)){let l=r?.parentid,c=e.stores.treeStore.tree,u=c.getNodeWithTrait(l,Tt);if(!u)return null;let U=u.getPropertyControls(c)[n];return U?.type==="richtext"?U:null}if(fe(r)){let l=q.reactComponentForIdentifier(r.codeComponentIdentifier);if(!l)return null;let c=l.properties[n];return c?.type==="richtext"?c:null}return null},[n,r],["Tree","ActiveBundle"]),f=(0,ro.useMemo)(()=>{if(!r)return"";let l=Ta(r,n);return ie(l?.value)?l.value:""},[r,n]),a=!!i&&!!r&&s?.type==="richtext",d=l=>{if(!r)return;let c=e.stores.treeStore.tree.current(r);if(!c)return;let u,w=Ta(r,n);w?u={...w,value:l}:u={type:"richtext",value:l},Ve(c),c.setControlProp(n,u),h(jr(e),"Only on-page engine can commit tree"),e.stores.projectStore.commitTreeAndSend()};return(0,ro.useEffect)(()=>{a||e.stores.modalStore.dismiss()},[a]),a?(0,Xe.jsxs)(Vt,{visible:!0,hasBackdrop:!0,onDismiss:t,className:Aa,formClassName:_a,children:[(0,Xe.jsx)(Kt,{separator:!0,title:s.title??"Unknown",className:Ma,children:(0,Xe.jsx)(Xt,{onDismiss:t})}),(0,Xe.jsx)(Gr,{className:Ra,children:(0,Xe.jsx)(oo,{enabled:!0,supportsEmbeds:Xo(r),supportsMedia:Xo(r),className:Da,defaultValue:f,onChange:d,scopeType:i,onUnsavedChange:it,popoverAttachmentEdge:zl,fallbackToModalAppearance:!0,saveOnMetaArrowNavigation:!0})})]}):null}function Ta(n,o){if(Ve(n)){let e=n.getControlProp(o);return e?.type==="richtext"&&ie(e.value)?e:null}if(fe(n)){let e=q.reactComponentForIdentifier(n.codeComponentIdentifier);if(!e)return null;let r=n.getControlProps(e.properties)[o];if(r?.type==="richtext"&&ie(r.value))return r}return null}var io=m(g()),Wl={AcquireAddonModal:null,AcquireAdvancedAnalyticsTrialModal:null,AddToLibrary:null,BatchTranslate:null,CMSImport:null,CodeFileCreation:null,CompleteSignup:null,ComponentIsolationModal:null,Confirmation:null,ConfirmBatchTranslateAll:null,ConfirmDefaultLanguage:null,ConfirmDeleteCollectionItems:null,ConfirmDestructiveFeedbackAction:null,ConfirmDraftCollectionItem:null,ConfirmDraftLocale:null,ConfirmDraftPage:null,ConfirmPublishAbTest:null,ConfirmPublishDraftCollectionItem:null,ConfirmPublishDraftLocale:null,ConfirmPublishDraftPage:null,ConfirmRemoveTriggerEvent:null,ConfirmUpdatingAbVariants:null,ConvertToCMSPage:null,CreateAbTest:null,CreateComponent:null,CreateLayoutTemplate:null,CreateManagedCollection:null,CreateTeam:null,CSVImportConflict:null,CustomBreakpoint:null,DeleteCodeFile:null,DeleteCustomFont:null,DeleteEntityFolder:null,DeleteFile:null,DeprecatedDrafts:null,DuplicateProjectWithVersion:null,DuplicateWebPage:null,FigmaImportTutorial:null,ImageCrop:ia,ImageFocalPoint:aa,ImportFigma:null,ImportRedirects:null,LoadingFullDocument:null,LocaleReady:null,LocaleSettings:null,LocalizationGlossary:null,None:null,NudgePreferences:null,OverrideFile:null,PasteFromFigma:null,PlanCancellation:null,PluginCustomHTML:null,PluginFromURL:null,PluginWithModePicker:null,RichTextEditor:Ga,PublishModule:null,QuickActions:null,RemoveTeamLibraryModule:null,ReplaceTextStylePreset:null,ReplaceWebPage:null,SelectProjectToUpgrade:null,Shortcuts:null,StopAbTest:null,SubscriptionNotInOrder:null,TransferProject:null,UnlinkComponent:null,UnsavedChanges:null,UnsupportedFileSize:null,UnsupportedFileType:null,UpgradeDocument:null,UpsellEnterprise:null,UpsellFeature:null,Variables:null,VectorImport:null,VectorSetCreation:null,Welcome:null};function za(){let n=C(),{type:o,...e}=n.stores.modalStore.useState(i=>i.active);if(o==="None")return;let t=Wl[o];h(t,"Modal is missing");let r=Ai(o);return(0,io.jsx)(Mr,{allowFocusTrap:!0,children:(0,io.jsx)(zr.Provider,{value:r,children:(0,io.jsx)(t,{...e})})})}var Me="EDITOR_BAR_DEVICE_PREFERENCE",sn="EDITOR_BAR_MENU_SEEN";function ao({accessStore:n,activeRouteStore:o},e,t){let r=n.access;h(r.status==="success","Can't open Framer if project access is not successful");let i=t||localStorage.getItem(Me)==="app",s=e??o.projectLinkNodeId,f=`${Dt().app}/projects/${r.data.projectSlug}?node=${s}`;i?window.open(`https://www.framer.com/open-in-app?url=${encodeURIComponent(f)}`,"_blank"):window.open(f,"FramerStudio")}var lo=m($());var cn=m(g());function qa({collectionItemNode:n,collectionNode:o,controlProp:e,variableId:t,warningMessage:r,onChange:i}){let s=R();if(!n)return null;let a=o.getPropertyControls(s.tree)[t];return k(a?.type==="boolean"),(0,cn.jsx)(B,{title:a.title??"",warningMessage:r,children:(0,cn.jsx)(da,{control:a,controlProp:e,fieldId:t,itemId:n.id,onChange:d=>{ee(d)&&i(t,d)}})})}var Wa="onPageCMSFieldsModal_o1kosemn",La="onPageCMSFieldsModalHeader_o1tcokht",Va="onPageCMSFieldsModalBody_o11jr4ka",Ll=1,Ka=ae.panelPadding+Ll,Xa="onPageCMSFieldsModalButtonContainer_oaqx903",fn="button_b1gqim6f";var Za="wrapper_wje69dc",ja="input_i1rqgchl",Ya="icon_ixghur2",Ha="collectionInputHeight_c1d0unc6";var dn=m(g());function Ja({collectionNode:n,controlProp:o,variableId:e,warningMessage:t,onChange:r}){let i=R(),f=n.getPropertyControls(i.tree)[e];k(f?.type==="collectionreference");let a=ar(f,o);k(!O(a),"Variables are not supported");let d=f.dataIdentifier;function l(c){r(e,{type:"collectionreference",value:c})}return(0,dn.jsx)(B,{title:f.title??"",warningMessage:t,children:(0,dn.jsx)(sa,{large:!0,value:a,onChange:l,className:ja,dataIdentifier:d,wrapperClassName:J(Za,Ha),iconClassName:Ya,overrideTheme:"onPageEditing"})})}var pn=m(g());function Qa({collectionItemNode:n,collectionNode:o,controlProp:e,variableId:t,warningMessage:r,onChange:i}){let s=R();if(!n)return null;let a=o.getPropertyControls(s.tree)[t];return k(a?.type==="date"),(0,pn.jsx)(B,{title:a.title??"",warningMessage:r,children:(0,pn.jsx)(ma,{control:a,controlProp:e,fieldId:t,itemId:n.id,onChange:d=>{ee(d)&&i(t,d)},required:!1})})}var mn=m(g());function $a({collectionItemNode:n,collectionNode:o,controlProp:e,variableId:t,warningMessage:r,onChange:i}){let s=R();if(!n)return null;let a=o.getPropertyControls(s.tree)[t];return k(a?.type==="enum"),(0,mn.jsx)(B,{title:a.title??"",warningMessage:r,children:(0,mn.jsx)(ua,{control:a,controlProp:e,fieldId:t,itemId:n.id,onChange:d=>{ee(d)&&i(t,d)}})})}var un=m(g());function es({collectionItemNode:n,collectionNode:o,controlProp:e,variableId:t,warningMessage:r,onChange:i}){let s=R();if(!n)return null;let a=o.getPropertyControls(s.tree)[t];if(k(a?.type==="file"),k(!ke(e?.value),"Dynamic values are not supported within required field validation"),e&&e?.type!=="file")return null;let l=(e?.value??"").split(".").pop(),c=!l||a.allowedFileTypes.length===0||a.allowedFileTypes.includes(l);return(0,un.jsx)(B,{title:a.title??"",warningMessage:r,showWarningTint:!c,children:(0,un.jsx)(ga,{control:a,controlProp:e,fieldId:t,itemId:n.id,onChange:u=>{ee(u)&&i(t,u)},reset:()=>{i(t,{type:"file",value:void 0})}})})}var gn=m(g());function ts({collectionItemNode:n,collectionNode:o,controlProp:e,variableId:t,onChange:r}){let i=R(),s=Bi(w=>{let U=w(e);U&&r(t,U)});if(!n)return null;let a=o.getPropertyControls(i.tree)[t];k(a?.type==="array"),k(!e||ir(e));let d=Gi(e,a,!0),l=zi(e,a,!0),u=to(d??l,a);return(0,gn.jsx)(B,{title:a.title??"",warningMessage:u,children:(0,gn.jsx)(ya,{collectionId:o.id,control:a,fieldId:t,controlProp:e,itemId:n.id,onChange:s,required:!1})})}var yn=m(g());function os({collectionItemNode:n,collectionNode:o,controlProp:e,variableId:t,warningMessage:r,onChange:i}){let s=R();if(!n)return null;let a=o.getPropertyControls(s.tree)[t];return k(a?.type==="responsiveimage"),(0,yn.jsx)(B,{title:a.title??"",warningMessage:r,children:(0,yn.jsx)(ha,{control:a,controlProp:e,fieldId:t,itemId:n.id,onChange:d=>{let l=d(e);ee(l)&&i(t,l)},reset:()=>{let d={type:"image",value:void 0};i(t,d)}})})}var hn=m(g());function ns({collectionItemNode:n,collectionNode:o,controlProp:e,variableId:t,warningMessage:r,onChange:i}){let s=R();if(!n)return null;let a=o.getPropertyControls(s.tree)[t];return k(a?.type==="link"),(0,hn.jsx)(B,{title:a.title??"",warningMessage:r,children:(0,hn.jsx)(wa,{control:a,controlProp:e,fieldId:t,itemId:n.id,onChange:d=>{ee(d)&&i(t,d)},reset:()=>{let d={type:"link",value:void 0};i(t,d)}})})}var rs="inputWrapper_i4uywus";var wn=m(g());function is({collectionItemNode:n,collectionNode:o,controlProp:e,variableId:t,warningMessage:r,onChange:i}){let s=R();if(!n)return null;let a=o.getPropertyControls(s.tree)[t];h(a?.type==="multicollectionreference");let d=a.dataIdentifier,l=sr(a,e)??[];return h(!O(l),"Variables are not supported"),(0,wn.jsx)(B,{title:a.title??"",warningMessage:r,children:(0,wn.jsx)(fa,{large:!0,value:l,onChange:c=>{i(t,{type:"multicollectionreference",value:c})},wrapperClassName:rs,dataIdentifier:d,overrideTheme:"onPageEditing"})})}var Cn=m(g());function as({collectionItemNode:n,collectionNode:o,controlProp:e,variableId:t,warningMessage:r,onChange:i}){let s=R();if(!n)return null;let a=o.getPropertyControls(s.tree)[t];return k(a?.type==="number"),(0,Cn.jsx)(B,{title:a.title??"",warningMessage:r,children:(0,Cn.jsx)(Ca,{control:a,controlProp:e,fieldId:t,itemId:n.id,onChange:d=>{ee(d)&&i(t,d)}})})}var Un=m(g()),Zl=["left","right","auto-vertical"];function ss({control:n,collectionItemNode:o,controlProp:e,setControlProp:t,warningMessage:r}){let i=e&&Tn(e.value)?e.value:void 0,s=f=>{t({type:n.type,value:f})};return(0,Un.jsx)(B,{title:n.title??"",warningMessage:r,children:(0,Un.jsx)(oo,{enabled:!0,supportsEmbeds:!0,supportsMedia:!0,compactTagSelector:!0,defaultValue:i??"",onChange:s,scopeType:"ContentManagement",onUnsavedChange:it,popoverAttachmentEdge:Zl,fallbackToModalAppearance:!0,saveOnMetaArrowNavigation:!0},o.id)})}var so=m(g());function ls({control:n,collectionItemNode:o,controlProp:e,setControlProp:t,warningMessage:r}){let i=e&&ie(e.value)?e.value:void 0,s=n.placeholder,f=n.defaultValue??"",a=i??f,d=l=>{t({type:n.type,value:l})};return(0,so.jsx)(B,{title:n.title??"",warningMessage:r,children:n.displayTextArea?(0,so.jsx)(Dr,{value:a,onChange:d,constantChange:!0,placeholder:s,minRows:10,maxRows:30,className:xa},o.id):(0,so.jsx)(Tr,{type:n.obscured?"password":"text",value:a,onChange:d,placeholder:s,constantChange:!0,className:pa})})}var N=m(g());function cs({onDiscard:n,onSave:o,fieldIdsToShow:e,type:t}){let[r,i]=(0,lo.useState)(()=>new Map),{canvasStore:s,treeStore:f}=C().stores,{collectionNode:a,collectionItemNode:d}=s.useState(),l=jl({collectionNode:a,collectionItemNode:d,tempControlProps:r,fieldIdsToShow:e});function c(y){let x=a?.getPropertyControls(f.tree)?.[y];if(!x)return;let F=l.get(y);if(F?.type!=="required")return to(F,x)}let u=()=>{for(let[y,E]of r)f.tree.current(d)?.setControlProp(y,E);o()},w=(y,E)=>{i(x=>Dn.set(x,y,E))},U=()=>{Jt()||o()};return(0,N.jsxs)(Vt,{hasBackdrop:!0,className:Wa,visible:e.length>0,onDismiss:t==="allFields"?u:n,onConfirm:U,children:[(0,N.jsx)(Kt,{separator:!0,title:t==="requiredFields"?"Required Fields":"All Fields",className:La,children:(0,N.jsx)(Xt,{onDismiss:n})}),(0,N.jsxs)(Kr,{className:Va,children:[(0,N.jsx)(Wr,{size:0}),e.map(y=>{if(!a)return null;let E=a.getVariable(y);if(!E)return null;let x=r.get(y)??d?.getControlProp(y),F=E.type;switch(F){case"slug":return!Ke(E)||!d?null:(0,N.jsx)(Ua,{collectionNode:a,collectionItemNode:d,controlProp:x,setControlProp:v=>w(y,v),variable:E,warningMessage:c(y)},y);case"string":{if(!d)return null;let v=a.getPropertyControls(f.tree);if(!yt(E))return null;let b=v[y];return b?.type!=="string"?null:(0,N.jsx)(ls,{control:b,collectionItemNode:d,controlProp:x,setControlProp:Se=>w(y,Se),warningMessage:c(y)},y)}case"richtext":{if(!d)return null;let b=a.getPropertyControls(f.tree)[y];return b?.type!=="richtext"?null:(0,N.jsx)(ss,{control:b,collectionItemNode:d,controlProp:x,setControlProp:Se=>w(y,Se),warningMessage:c(y)},y)}case"link":return(0,N.jsx)(ns,{collectionItemNode:d,collectionNode:a,controlProp:x,variableId:y,warningMessage:c(y),onChange:w},y);case"image":return(0,N.jsx)(os,{collectionItemNode:d,collectionNode:a,controlProp:x,variableId:y,warningMessage:c(y),onChange:w},y);case"array":return(0,N.jsx)(ts,{collectionItemNode:d,collectionNode:a,controlProp:x,variableId:y,onChange:w},y);case"multicollectionreference":return(0,N.jsx)(is,{collectionItemNode:d,collectionNode:a,controlProp:x,variableId:y,warningMessage:c(y),onChange:w},y);case"collectionreference":return(0,N.jsx)(Ja,{collectionNode:a,controlProp:x,variableId:y,warningMessage:c(y),onChange:w},y);case"file":return(0,N.jsx)(es,{collectionItemNode:d,collectionNode:a,controlProp:x,variableId:y,warningMessage:c(y),onChange:w},y);case"date":return(0,N.jsx)(Qa,{collectionItemNode:d,collectionNode:a,controlProp:x,variableId:y,warningMessage:c(y),onChange:w},y);case"number":return(0,N.jsx)(as,{collectionItemNode:d,collectionNode:a,controlProp:x,variableId:y,warningMessage:c(y),onChange:w},y);case"boolean":return(0,N.jsx)(qa,{collectionItemNode:d,collectionNode:a,controlProp:x,variableId:y,warningMessage:c(y),onChange:w},y);case"enum":return(0,N.jsx)($a,{collectionItemNode:d,collectionNode:a,controlProp:x,variableId:y,warningMessage:c(y),onChange:w},y);default:nt(F)}})]}),(0,N.jsx)(qr,{displayDivider:!1,paddingTop:Ka,className:Xa,gap:ae.inputSpacing,children:(0,N.jsxs)(Pr,{children:[(0,N.jsx)(T,{bold:!0,onClick:n,className:fn,children:(0,N.jsx)(Qo,{children:t==="requiredFields"?"Cancel":"Discard"})}),(0,N.jsx)(T,{bold:!0,enabled:l.size===0||t==="allFields",variant:"primary",type:"submit",onClick:u,className:fn,children:(0,N.jsx)(Qo,{children:"Save"})})]})})]})}function jl({collectionNode:n,collectionItemNode:o,tempControlProps:e,fieldIdsToShow:t}){let r=C(),{tree:i}=r.stores.treeStore.useState(),s=Ti(n,o);return(0,lo.useMemo)(()=>{let f=new Map;if(!n||!o)return f;for(let a of t){let d=n.getVariable(a);if(!d)continue;let c=n.getPropertyControls(i)[a];if(!c)continue;let u=e.get(a)??o.getControlProp(a),w=s.get(a),U;(yt(d)||Ke(d))&&(U=$t(d,n.variables,o));let y=eo(d.type,c,u,U,void 0,Gt(d),w);y&&f.set(a,y)}return f},[n,o,t,s,i,e])}var fs="toolbar_t49i6vy",st="button_bjwo6qr",It="buttonSecondary_b1qwl3y9",ds="mainContentContainer_m1wta5up",ps="mainContent_m69kutt",xn="secondaryText_sdjdrec",ms="logoIcon_l9efojb";var I=m(g());function gs(){let n=C(),{canvasStore:o,activeRouteStore:e,projectStore:t}=n.stores,{isCreatingCollectionItem:r,modalState:i}=o.useState(),{hasPermanentlyFailed:s}=t.useState(),f=_e(()=>o.collectionNode,[],[o,e]),a=i.type==="finishEditing"&&i.isNewItem?"Page saved":"Site saved",d=()=>{i.type==="requiredFields"?n.stores.canvasStore.saveTemporaryCollectionItem():(n.stores.projectStore.commitTreeAndSend(),n.stores.canvasStore.resetModalState())},l=()=>{n.stores.canvasStore.resetModalState()};return(0,I.jsxs)(I.Fragment,{children:[(0,I.jsxs)("div",{className:fs,children:[(0,I.jsxs)(T,{className:L(st,It),onClick:()=>ao(n.stores,i.type==="finishEditing"&&i.isNewItem?i.nodeId:void 0,!0),"aria-label":"Open in Framer",children:[(0,I.jsx)(qt,{"aria-hidden":"true",className:ms}),(0,I.jsx)(co,{desktopText:"Open in Framer"})]}),(0,I.jsxs)("div",{className:ds,children:[(0,I.jsx)(us,{desktopText:"Click to edit",mobileText:"Tap to edit",secondaryText:"Changes are auto-saved",isVisible:i.type!=="finishEditing"}),(0,I.jsx)(us,{desktopText:a,mobileText:a,secondaryText:`A notification was sent to your collaborators. ${i.type==="finishEditing"&&i.isNewItem?"The page":"Changes"} will be visible when the project is published.`,isVisible:i.type==="finishEditing"})]}),(0,I.jsxs)(P,{direction:"row",gap:10,children:[f&&!r&&!f.managedByPlugin&&i.type!=="finishEditing"&&(0,I.jsxs)(T,{className:L(st,It),enabled:!s,onClick:()=>o.createTemporaryCollectionItem(),"aria-label":"Add Page",children:[(0,I.jsx)(Ar,{}),(0,I.jsx)(co,{desktopText:"Add Page",mobileText:"Page"})]}),r&&!s&&(0,I.jsxs)(T,{className:L(st,It),onClick:()=>{n.stores.canvasStore.handleShowAllFields()},children:[(0,I.jsx)(Jl,{}),"Show All Fields"]}),i.type==="finishEditing"?(0,I.jsxs)(T,{className:L(st,It),onClick:()=>o.handleDismissFinishEditing(),children:[(0,I.jsx)(Hl,{}),"Go Back to Site"]}):(0,I.jsxs)(T,{variant:"primary",className:st,onClick:()=>o.handleFinishEditing(),children:[(0,I.jsx)(Or,{"aria-hidden":"true"}),(0,I.jsx)(co,{desktopText:"Finish Editing",mobileText:"Done"})]})]})]}),(i.type==="requiredFields"||i.type==="allFields")&&(0,I.jsx)(cs,{onDiscard:l,onSave:d,type:i.type,fieldIdsToShow:i.fieldIdsToShow})]})}function us({desktopText:n,mobileText:o,secondaryText:e,isVisible:t}){return(0,I.jsx)(rt,{children:t&&(0,I.jsxs)(W.div,{className:ps,initial:{marginTop:10,opacity:0},animate:{marginTop:0,opacity:1},exit:{marginTop:-10,opacity:0},children:[(0,I.jsx)(co,{desktopText:n,mobileText:o}),(0,I.jsx)("span",{className:xn,children:"\xB7"}),(0,I.jsx)("span",{className:xn,children:e})]})})}function co({desktopText:n,mobileText:o}){let e=Vi(`(max-width: ${kr.tabletSmall}px)`);return!o&&e?null:(0,I.jsx)("span",{children:e?o:n})}function Hl(){return(0,I.jsxs)("svg",{xmlns:"http://www.w3.org/2000/svg",width:"9",height:"9",fill:"none",children:[(0,I.jsx)("path",{d:"M 1.5 7.5 L 8 1",fill:"transparent",strokeWidth:"1.5",stroke:"currentColor",strokeLinecap:"round",strokeLinejoin:"round"}),(0,I.jsx)("path",{d:"M 3 1 L 8 1 L 8 6",fill:"transparent",strokeWidth:"1.5",stroke:"currentColor",strokeLinecap:"round",strokeLinejoin:"round"})]})}function Jl(){return(0,I.jsxs)("svg",{xmlns:"http://www.w3.org/2000/svg",width:"11",height:"11",fill:"none",children:[(0,I.jsx)("path",{d:"M1 5.5s1.5-3 4.5-3 4.5 3 4.5 3-1.5 3-4.5 3-4.5-3-4.5-3Z",fill:"transparent",strokeWidth:"1.5",stroke:"#fff",strokeLinecap:"round",strokeLinejoin:"round"}),(0,I.jsx)("path",{d:"M5.5 4a1.5 1.5 0 1 1 0 3 1.5 1.5 0 0 1 0-3Z",fill:"#fff"})]})}var j=class{constructor(o){this.engine=o}};var Ue=class n extends j{constructor(e,t,r){super(e);this.nodeId=t;this.renderId=r}getCodeComponentNode(){return this.engine.tree.getNodeWithTrait(this.nodeId,fe)}getEditableControls(){let e=this.getCodeComponentNode();if(e)return n.getEditableControls(this.engine,e,this.renderId)}update(){let e=this.engine,t=this.getCodeComponentNode();(!t||!n.supportsNode(e,t,this.renderId))&&e.exitTool()}static getEditableControls(e,t,r){let i=t.cache.getRenderInstance(r);if(!i)return Rt();let s=q.reactComponentForIdentifier(t.codeComponentIdentifier);if(!s)return Rt();let f=t.getControlProps(s.properties);if(!f)return Rt();let a=[];for(let d in f){let l=f[d];if(!l)continue;let c=s.properties[d];if(c){if(l.type==="string"){if(O(l.value)){let u=G(e.tree,e.stores.treeStore.sandboxCollectionData,l.value,l.type,i.collectionItemId);if(!u)continue;a.push({type:"collection",controlKey:d,variableInfo:u})}else if(!ke(l.value)){h(c.type==="string");let u=Ct(c);h(u,"Reduced control prop should not be null"),wt(u,l,c),a.push({type:"component",controlKey:d,controlDescription:c,controlProp:l,reducedControlProp:u})}}if(l.type==="richtext"){if(O(l.value)){let u=G(e.tree,e.stores.treeStore.sandboxCollectionData,l.value,l.type,i.collectionItemId);if(!u)continue;a.push({type:"collection",controlKey:d,variableInfo:u})}else if(!ke(l.value)){h(c.type==="richtext");let u=Ct(c);h(u,"Reduced control prop should not be null"),wt(u,l,c),a.push({type:"component",controlKey:d,controlDescription:c,controlProp:l,reducedControlProp:u})}}if(l.type==="image"){if(O(l.value)){let u=G(e.tree,e.stores.treeStore.sandboxCollectionData,l.value,l.type,i.collectionItemId);if(!u)continue;a.push({type:"collection",controlKey:d,variableInfo:u})}else if(!ke(l.value)){h(c.type==="image"||c.type==="responsiveimage");let u=Ct(c);h(u,"Reduced control prop should not be null"),wt(u,l,c),a.push({type:"component",controlKey:d,controlDescription:c,controlProp:l,reducedControlProp:u})}}if(l.type==="date"){if(O(l.value)){let u=G(e.tree,e.stores.treeStore.sandboxCollectionData,l.value,"date",i.collectionItemId);if(!u)continue;a.push({type:"collection",controlKey:d,variableInfo:u})}else if(!ke(l.value)){h(c.type==="date");let u=Ct(c);h(u,"Reduced control prop should not be null"),wt(u,l,c),a.push({type:"component",controlKey:d,controlDescription:c,controlProp:l,reducedControlProp:u})}}if(l.type==="link"&&O(l.value)){let u=G(e.tree,e.stores.treeStore.sandboxCollectionData,l.value,"link",i.collectionItemId);if(!u)continue;a.push({type:"collection",controlKey:d,variableInfo:u})}}}return a}static supportsNode(e,t,r){return fe(t)?n.getEditableControls(e,t,r).length>0:!1}};var xe=class n extends j{constructor(e,t,r,i){super(e);this.nodeId=t;this.renderId=r;this.eventSource=i}getRichTextNode(){return this.engine.tree.getNodeWithTrait(this.nodeId,A)}getVariableInfo(){let e=this.getRichTextNode();if(!e)return;let t=e.cache.getRenderInstance(this.renderId);if(!t)return;let r=n.getVariableReference(e);if(r)return G(this.engine.tree,this.engine.stores.treeStore.sandboxCollectionData,r,"date",t.collectionItemId)}getControlProp(){return this.getVariableInfo()?.controlProp}changeValue(e){let t=this.getVariableInfo();if(!t)return;let{collectionItemNode:r,variableDefinition:i,controlProp:s}=t;s.value!==e&&(r.setControlProp(i.id,{...s,value:e}),this.engine.stores.projectStore.commitTreeAndSend())}update(){let e=this.engine,t=this.getRichTextNode();(!t||!n.supportsNode(e,t,this.renderId))&&e.exitTool()}static getVariableReference(e){let t=e.textContent;if(!jn(t))return;let r=t.startValue;if(O(r))return r}static supportsNode(e,t,r){if(!A(t))return!1;let i=n.getVariableReference(t);if(!i)return!1;let s=t.cache.getRenderInstance(r);return s?!!G(e.tree,e.stores.treeStore.sandboxCollectionData,i,"date",s.collectionItemId):!1}};var Ie=class n extends j{constructor(e,t,r){super(e);this.nodeId=t;this.renderId=r}update(){let e=this.engine,t=e.tree.get(this.nodeId);(!t||!n.supportsNode(e,t,this.renderId))&&e.exitTool()}static supportsNode(e,t,r){if(!zt(t))return!1;if(O(t.fillImage)){let i=t.cache.getRenderInstance(r);return i?!!G(e.tree,e.stores.treeStore.sandboxCollectionData,t.fillImage,"image",i.collectionItemId):!1}return!Zn(t.fillImage)}};var Ql=/^(?<hashes>#{1,6})\s$/u,pe=class n extends j{constructor(e,t,r,i="none"){super(e);this.nodeId=t;this.renderId=r;this.eventSource=i;p(this,"handleOnFocus",()=>this.proseMirrorEditor?.controls.handleOnFocus());p(this,"handleOnBlur",()=>this.proseMirrorEditor?.controls.handleOnBlur());p(this,"proseMirrorEditor",null);p(this,"hasTextFitViewBox",!1);this.engine.beginUndoGroup(),this.start()}getRichTextNode(){return this.engine.tree.getNodeWithTrait(this.nodeId,A)}update(){let e=this.getRichTextNode();if(!e||!n.supportsNode(e)){this.engine.exitTool();return}!e.textFitViewBoxSize||this.hasTextFitViewBox||this.engine.processWhenReady(()=>{Ir(this.engine.tree,e)&&(this.hasTextFitViewBox=!0)})}async stop(){let e=this.getRichTextNode();e&&(e.cache.isEditable=!1),this.proseMirrorEditor?.destroy(),this.proseMirrorEditor=null,this.engine.endUndoGroup(),this.engine.stores.toolStore.proseMirrorView=null,this.engine.stores.toolStore.nodeInTextEditor=null}start(){let e=this.getRichTextNode();if(!e)return;this.engine.process(()=>{this.hasTextFitViewBox=Cr(this.engine.tree,e)});let t=Yt(this.engine.tree,e);if(t.length===0){this.init();return}Oe.loadFonts(t).catch(H).finally(()=>this.init())}init(){this.startAsync().catch(e=>{H(e),this.engine.exitTool()})}async startAsync(){let e=this.getRichTextNode();if(!e)return this.engine.exitTool();this.proseMirrorEditor=await this.createProseMirrorEditor(e),e.cache.isEditable=!0,this.engine.stores.toolStore.proseMirrorView=this.proseMirrorEditor.view}async createProseMirrorEditor(e){let{baseKeymap:t,chainCommands:r,createParagraphNear:i,Decoration:s,DecorationSet:f,dropCursor:a,EditorView:d,ellipsis:l,emDash:c,gapCursor:u,history:w,InputRule:U,inputRules:y,keymap:E,liftEmptyBlock:x,liftListItem:F,newlineInCode:v,redo:b,sinkListItem:Se,splitBlock:Wo,splitListItem:Bl,toggleMark:Lo,undo:Al,undoInputRule:An}=await jt(),Q=this.engine,_l=r(Bl(de.nodes.listItem),v,i,x,ri,ni,(Z,M)=>Wo(Z,M&&(V=>{let Ne=Z.selection,et=this.getRichTextNode();h(et,"RichTextNode not found");let we=Ne.$from.node(1);if(!jo(we)||!(Ne.$to.parentOffset===Ne.$to.parent.content.size))return M(V);let re={...we.attrs},ze=Zo(we)&&re.tag!=="p",gt=V.mapping.map(Z.selection.to),tt=Z.selection.$from.marks();if(ze){let ve=et.getNodeTextStylePreset(Q.tree,"p")??Ho(Q.tree,"p")??Yo.createDefault("p");Q.processWhenReady(()=>{Jo(Q,ve),et.setNodeTextStylePreset(ve)}),re.textStylePreset=ve.id,re.tag="p",re.inlineStyles={},re.blockStyles={}}else{let ve=tt.find(tr);re.inlineStyles={...re.inlineStyles,...ve?.attrs.inlineStyles}}V.setNodeMarkup(gt-1,void 0,re),V.setStoredMarks(tt),ze&&V.removeStoredMark(de.marks.inlineStyles),M(V)}))),Rl=Q.wrapHandler(()=>(Q.exitTool(),!0));h(!O(e.htmlContent),"Can't edit rich text node when htmlContent variable is assigned"),h(!O(e.textContent),"Can't edit rich text node when textContent variable is assigned");let _n=()=>{let Z=this.getRichTextNode();h(Z,"RichTextNode not found");let M=Z.getNodeInlineCodeStylePreset(Q.tree)??hr(Q.tree)??new ur;return wr(Q,M),Z.setNodeInlineCodeStylePreset(M),M.id},Rn=nr(e.html,{plugins:[w(),E({"Mod-z":r(An,Al),"Mod-Shift-z":b,"Shift-Enter":ii,"Mod-b":Lo(de.marks.bold),"Mod-i":Lo(de.marks.italic),"Shift-Tab":F(de.nodes.listItem),Tab:r(Se(de.nodes.listItem),()=>!0),Backspace:r(An,ai),Escape:Rl,Enter:_l,"Mod-Shift-c":Lo(de.marks.inlineCode,{get inlineCodeStylePreset(){return _n()}})}),E(t),a({color:Er.cmsRichTextDropCursor,width:ae.richTextDropCursor}),u(),fi(),mi({engine:this.engine,nodeId:this.nodeId,getRichTextNode:()=>this.getRichTextNode()}),y({rules:[c,l,new U(Ql,(Z,M,V,Ne)=>{let et=Z.doc.resolve(V),we=et.node(1),Bt=et.before(1);if(!jo(we))return null;let re=Z.tr,ze="h"+(M.groups?.hashes?.length||1),gt=this.getRichTextNode();h(gt,"RichTextNode not found");let tt=gt.getNodeTextStylePreset(Q.tree,ze)??Ho(Q.tree,ze)??Yo.createDefault(ze),ve=tt.id;return Q.processWhenReady(()=>{Jo(Q,tt),gt.setNodeTextStylePreset(tt)}),Zo(we)||re.removeMark(Bt,Bt+we.nodeSize,de.marks.inlineStyles),re.delete(V,Ne),re.setNodeMarkup(Bt,de.nodes.textBlock,{...we.attrs,blockStyles:ve?{}:we.attrs.blockStyles,inlineStyles:ve?{}:we.attrs.inlineStyles,textStylePreset:ve,tag:ze}),re}),si,li]}),...oi({markType:de.marks.inlineCode,attrs:{get inlineCodeStylePreset(){return _n()}}})]}),Mn,Pe=new d(null,{state:Rn,dispatchTransaction:Q.wrapHandler(Z=>{let M=this.getRichTextNode();h(M,"Node should not be null");let V=Pe.state.apply(Z);if(Pe.updateState(V),V=Ur(V,Pe,M),Mn!==V.doc){let Ne=or(V.doc);M.html!==Ne&&(this.updateNodeWithBreakpointAwareness(M,Ne),xr(M,Pe)),Mn=V.doc}})});return{controls:{handleOnFocus(){Pe.setProps({decorations(){}})},handleOnBlur(){Pe.setProps({decorations(Z){let M=Z.selection;if(M.from!==M.to)return document.getSelection()?.removeAllRanges(),f.create(Z.doc,[s.inline(M.from,M.to,{class:"selection",nodeName:"mark"})])}})}},destroy:()=>Pe.destroy(),state:Rn,view:Pe}}updateNodeWithBreakpointAwareness(e,t){let{tree:r}=this.engine,{breakpointNode:i}=this.engine.stores.canvasStore;if(!Kn(i)||$n(i)){e.set({html:t});return}let s=dr(r,e,"html"),f=e.originalid||e.id;if(s){Sr(r,i,f,{html:t});return}(r.getNodeWithTrait(f,A)??e).set({html:t})}static supportsNode(e){return A(e)&&!e.htmlContent&&!e.textContent}};var me=class n extends j{constructor(e,t,r,i){super(e);this.nodeId=t;this.renderId=r;this.eventSource=i;p(this,"controls");this.engine.beginUndoGroup(),jt().then(s=>{e.stores.toolStore.proseMirror??=s})}getRichTextNode(){return this.engine.tree.getNodeWithTrait(this.nodeId,A)}getVariableReference(){let e=this.getRichTextNode();if(!e)return;let t=e.htmlContent;if(O(t))return t}getVariableInfo(){let e=this.getRichTextNode();if(!e)return;let t=e.cache.getRenderInstance(this.renderId);if(!t)return;let r=this.getVariableReference();if(r)return G(this.engine.tree,this.engine.stores.treeStore.sandboxCollectionData,r,"richtext",t.collectionItemId)}getControlProp(){return this.getVariableInfo()?.controlProp}changeValue(e){let t=this.getVariableInfo();if(!t)return;let{collectionItemNode:r,variableDefinition:i,controlProp:s}=t;s.value!==e&&(r.setControlProp(i.id,{...s,value:e}),this.engine.stores.projectStore.commitTreeAndSend())}update(){let e=this.engine,t=this.getRichTextNode();if(!t||!n.supportsNode(e,t,this.renderId))e.exitTool();else{let r=this.getVariableInfo();this.engine.stores.toolStore.validateCollectionControl(r)}}stop(){this.engine.endUndoGroup(),this.engine.stores.toolStore.nodeInTextEditor=void 0}static supportsNode(e,t,r){if(!A(t)||!O(t.htmlContent))return!1;let i=t.cache.getRenderInstance(r);return i?!!G(e.tree,e.stores.treeStore.sandboxCollectionData,t.htmlContent,"richtext",i.collectionItemId):!1}};var ue=class n extends j{constructor(e,t,r,i){super(e);this.nodeId=t;this.renderId=r;this.eventSource=i;this.engine.beginUndoGroup();let s=this.getRichTextNode();h(s,"Missing rich text node");let f=Yt(this.engine.tree,s);Oe.loadFonts(f).catch(H)}getRichTextNode(){return this.engine.tree.getNodeWithTrait(this.nodeId,A)}getVariableReference(){let e=this.getRichTextNode();if(!e)return;let t=e.textContent;if(O(t))return t}getVariableInfo(){let e=this.getRichTextNode();if(!e)return;let t=e.cache.getRenderInstance(this.renderId);if(!t)return;let r=this.getVariableReference();if(r)return G(this.engine.tree,this.engine.stores.treeStore.sandboxCollectionData,r,"string",t.collectionItemId)}getControlProp(){return this.getVariableInfo()?.controlProp}changeValue(e){let t=this.getVariableInfo();if(!t)return;let{collectionItemNode:r,variableDefinition:i,controlProp:s}=t;s.value!==e&&(r.setControlProp(i.id,{...s,value:e}),this.engine.stores.projectStore.commitTreeAndSend())}update(){let e=this.engine,t=this.getRichTextNode();if(!t||!n.supportsNode(e,t,this.renderId))e.exitTool();else{let r=this.getVariableInfo();this.engine.stores.toolStore.validateCollectionControl(r)}}stop(){this.engine.endUndoGroup(),this.engine.stores.toolStore.nodeInTextEditor=null}static supportsNode(e,t,r){if(!A(t)||!O(t.textContent))return!1;let i=t.cache.getRenderInstance(r);return i?!!G(e.tree,e.stores.treeStore.sandboxCollectionData,t.textContent,"string",i.collectionItemId):!1}};var Fe=class n extends j{update(){let o=this.engine,{canvasStore:e,treeStore:t,mouseStore:r,toolStore:i}=o.stores,s=e.breakpointNode;if(!s)return;if(r.isHoveringChrome){i.highlightedRenderId=void 0;return}let f=t.tree,a=r.canvasMousePosition,d=f.getNodeRendersAtPoint(s,a,!0),l=br(d,f),u=l.filter(y=>n.isSelectableNode(o,y.node,y.renderId)).at(-1);if(u){o.stores.toolStore.highlightedRenderId=u.renderId;return}let U=l.filter(y=>n.isUnexpectedlyUnselectableNode(o,y.node,y.renderId)).at(-1);if(U){i.highlightedRenderId=U.renderId;return}i.highlightedRenderId=void 0}static isSelectableNode(o,e,t){return Ue.supportsNode(o,e,t)||xe.supportsNode(o,e,t)||Ie.supportsNode(o,e,t)||pe.supportsNode(e)||me.supportsNode(o,e,t)||ue.supportsNode(o,e,t)}static isUnexpectedlyUnselectableNode(o,e,t){return n.isSelectableNode(o,e,t)?!1:cr(e)||fe(e)}};var Cs=m($());var ys="container_ci35ri5",hs="shockwaveMask_suurpvn",ws="shockwaveNodeHighlight_s1xlu29h";var fo=m(g()),Us=(0,Cs.memo)(function(){let o=C(),{editableNodesHighlight:e}=o.stores.editableNodeHighlightStore.useState();return e?(0,fo.jsx)(W.div,{className:L(ys,hs),initial:{"--radius":`${e.minRadius}px`},animate:{"--radius":`${e.maxRadius}px`},transition:{duration:e.animationDuration/1e3,ease:"easeOut"},style:{top:e.minY,height:e.maxY-e.minY,"--x":`${e.originX}px`,"--y":`${e.originY}px`,"--gradient-size":`${e.gradientSize}px`},children:(0,fo.jsx)("div",{style:{position:"absolute",top:-e.minY},children:e.highlights.map(t=>(0,fo.jsx)("div",{className:ws,style:{width:t.width,height:t.height,transform:t.transform,transformOrigin:"top left"}},t.renderId))})},e.animationId):null});var xs="hudContainer_h1czcor4";var Ze=m($());var Is="popover_p6dts5z",Fs="popoverWithModalInFront_pcmqzkm";var po="nodeHighlight_nbqylm8",bs="visuallyHidden_v1pcr3uc",Ss="pointerCursor_p1mivvux",vs="textCursor_t42x8tu",ks="notAllowedCursor_n1atul0u",Es="background_b1i0g06w";var Ns=m($()),Os=m(g()),te=(0,Ns.forwardRef)(function({tree:o,node:e,renderId:t,style:r,...i},s){let f=o.getRect(e,void 0,void 0,void 0,t),a=o.transformMatrixToNode(e,void 0,void 0,t);return(0,Os.jsx)("div",{...i,ref:s,style:{position:"absolute",width:f.width,height:f.height,transformOrigin:"top left",transform:a.toString(),...r}})});var Y=m(g()),Ft=[];Object.freeze(Ft);var oc=["bottom","top","right","left"],nc={x:ae.inputSpacing,y:ae.inputSpacing};function Bs({tool:n}){let[o,e]=(0,Ze.useState)(null),t=C(),r=t.stores.modalStore.useState(c=>c.active.type!=="None"),[i,s]=(0,Ze.useState)(!1);!i&&r&&s(!0);let{tree:f}=t.stores.treeStore.useState(),a=f.getNodeWithTrait(n.nodeId,Jn),d=(0,Ze.useMemo)(()=>{let c=f;return n.getEditableControls()},[n,f]);function l(){t.exitTool()}if((0,Ze.useLayoutEffect)(()=>()=>{t.stores.modalStore.active.type!=="None"&&t.stores.modalStore.dismissAll()},[]),!(!a||!d||d.length===0))return(0,Y.jsx)(te,{tree:f,node:a,ref:e,renderId:n.renderId,className:po,children:(0,Y.jsx)(Lt,{anchor:o,alignSelf:"center",attachTo:oc,offset:nc,onClose:l,showArrow:!0,arrow:{anchor:o,alignSelf:"center"},fallbackToModalAppearance:!0,backdropTintEnabled:!1,themeOverrideMode:"darkOnDarkModal",className:L(Is,r&&Fs),focusTrapEnabled:!r,animateAppear:!i,zIndex:21,children:(0,Y.jsx)($i,{displayDivider:!0,title:rc(a),onClose:l,children:(0,Y.jsx)(P,{gap:0,paddingTop:ae.inputSpacing,paddingBottom:ae.inputSpacing,paddingLeft:ae.panelPadding,paddingRight:ae.panelPadding,children:d.map(c=>{if(c.type==="component")switch(c.controlDescription.type){case"string":return h(c.reducedControlProp.type==="string"),(0,Y.jsx)(xt,{nodeIds:Ft,controlKey:c.controlKey,control:c.controlDescription,controlProp:c.reducedControlProp,onChange:(F,v)=>{h(c.controlProp.type==="string");let b=v(c.controlProp);Be(b,c.controlProp)||(a.setControlProp(F,b),t.stores.projectStore.commitTreeAndSend())}},c.controlKey);case"richtext":return h(c.reducedControlProp.type==="richtext"),(0,Y.jsx)($o,{title:c.controlDescription.title??"Unknown",children:(0,Y.jsx)(T,{title:"Edit Content",className:en,onClick:()=>{t.stores.modalStore.set({type:"RichTextEditor",controlKey:c.controlKey,nodeId:n.nodeId,source:"on_page_hud"})}})},c.controlKey);case"image":case"responsiveimage":return h(c.reducedControlProp.type==="image"||c.reducedControlProp.type==="responsiveimage"),(0,Y.jsx)(on,{nodeIds:Ft,controlKey:c.controlKey,control:c.controlDescription,controlProp:c.reducedControlProp,onChange:(F,v)=>{h(w.type==="image");let b=v(w);Be(b,w)||(a.setControlProp(F,b),t.stores.projectStore.commitTreeAndSend())},onUpload:async(F,v)=>{let b=await F;if(!b)return;h(c.controlProp.type==="image");let Se=ca(c.controlProp,b);a.setControlProp(v,Se),t.stores.projectStore.commitTreeAndSend()}},c.controlKey);case"date":return h(c.reducedControlProp.type==="date"),(0,Y.jsx)(tn,{controlKey:c.controlKey,control:c.controlDescription,controlProp:c.reducedControlProp,onChange:(F,v)=>{h(F.type==="date"),!Be(F,w)&&(a.setControlProp(v,F),t.stores.projectStore.commitTreeAndSend())}},c.controlKey);default:Vo(c.controlDescription)}let{variableInfo:u}=c,{controlProp:w,controlDescription:U,collectionItemNode:y,variableDefinition:E,reducedControlProp:x}=u;switch(w.type){case"string":return h(U.type==="string"),h(x.type==="string"),(0,Y.jsx)(xt,{nodeIds:Ft,controlKey:E.id,control:U,controlProp:x,onChange:(F,v)=>{h(w.type==="string");let b=v(w);Be(b,w)||(y.setControlProp(F,b),t.stores.projectStore.commitTreeAndSend())}},c.controlKey);case"richtext":return h(U.type==="richtext"),h(x.type==="richtext"),(0,Y.jsx)($o,{title:U.title||Xn(E.id),children:(0,Y.jsx)(T,{title:"Edit Content",className:en,onClick:()=>{t.stores.modalStore.set({type:"RichTextEditor",controlKey:E.id,nodeId:y.id,source:"on_page_hud"})}})},c.controlKey);case"image":return h(U.type==="responsiveimage"),h(x.type==="responsiveimage"),(0,Y.jsx)(on,{nodeIds:Ft,controlKey:E.id,control:U,controlProp:x,onChange:(F,v)=>{h(w.type==="image");let b=v(w);Be(b,w)||(y.setControlProp(F,b),t.stores.projectStore.commitTreeAndSend())},onUpload:async(F,v)=>{let b=await F;b&&(y.setControlProp(v,{type:"image",value:b}),t.stores.projectStore.commitTreeAndSend())}},c.controlKey);case"date":return h(U.type==="date"),h(x.type==="date"),(0,Y.jsx)(tn,{controlKey:E.id,control:U,controlProp:x,onChange:(F,v)=>{h(F.type==="date"),h(w.type==="date"),!Be(F,w)&&(y.setControlProp(v,F),t.stores.projectStore.commitTreeAndSend())}},c.controlKey);case"link":return h(U.type==="link"),h(x.type==="link"),(0,Y.jsx)(Sa,{controlKey:E.id,control:U,controlProp:x,onChange:(F,v)=>{h(w.type==="link");let b=v(w);Be(b,w)||(y.setControlProp(F,b),t.stores.projectStore.commitTreeAndSend())}},c.controlKey);default:Vo(w)}})})})})})}function rc(n){let o=q.reactComponentForIdentifier(n.codeComponentIdentifier);return o?o.name:"Component"}var bt=m($());var In=m(g());function As({tool:n}){let{nodeId:o,renderId:e}=n,t=C(),r=t.tree,i=(0,bt.useRef)(null),s=t.stores.canvasStore.webPageNode,f=r.getNodeWithTrait(o,A);if(ic(i,()=>{t.exitTool()}),(0,bt.useEffect)(()=>(document.body.style.overflow="hidden",()=>{document.body.style.overflow="auto"})),!!f&&s)return(0,In.jsx)(te,{ref:i,tree:r,node:f,renderId:e,children:(0,In.jsx)(ea,{tool:n,scopeNode:s,node:f,renderId:e,backdropEnabled:!0})})}function ic(n,o){(0,bt.useEffect)(()=>{function e(t){n.current&&!n.current.contains(t.target)&&o()}return document.addEventListener("mousedown",e),()=>{document.removeEventListener("mousedown",e)}},[n,o])}var Fn=m($());var je=m(g());function _s(){let n=C(),{tree:o}=n.stores.treeStore.useState(),{highlightedRenderId:e}=n.stores.toolStore.useState(),t=n.stores.mouseStore.useState(l=>l.lastUpdateType==="scroll"),r=Ut(e),i=o.get(r),s=ac(i,e),f=(0,Fn.useCallback)(()=>{n.stores.editableNodeHighlightStore.highlight(n,{type:"clickOnVoid"})},[]),a=!!i&&!!e&&Fe.isUnexpectedlyUnselectableNode(n,i,e),d=!!i&&!!e&&(pe.supportsNode(i)||me.supportsNode(n,i,e)||ue.supportsNode(n,i,e));return(0,je.jsxs)(je.Fragment,{children:[(0,je.jsx)("div",{className:L(Es,a&&ks),onClick:f}),i&&e&&!a&&(0,je.jsx)(te,{tree:o,node:i,renderId:e,className:L(po,t&&bs,d?vs:Ss),onClick:s})]})}function ac(n,o){let e=C();return(0,Fn.useCallback)(()=>{if(!(!n||!o)){if(Ue.supportsNode(e,n,o))return e.startComponentInstanceEditTool(n.id,o);if(xe.supportsNode(e,n,o))return e.startDateVariableEditTool(n.id,o,"mouse");if(Ie.supportsNode(e,n,o))return e.startImageEditTool(n.id,o);if(pe.supportsNode(n))return e.startRichTextEditTool(n.id,o,"mouse");if(me.supportsNode(e,n,o))return e.startRichTextVariableEditTool(n.id,o,"mouse");if(ue.supportsNode(e,n,o))return e.startStringVariableEditTool(n.id,o,"mouse")}},[n,o])}var oe=m($());var Rs="popout_pqnmppj";var ce=m(g()),lc=["right","left"],cc={x:15,y:0};function Ms({tool:n}){let{nodeId:o,renderId:e}=n,[t,r]=(0,oe.useState)(null),i=C(),{tree:s}=i.stores.treeStore.useState(),f=s.getNodeWithTrait(o,zt);function a(){i.exitTool()}if(f)return(0,ce.jsx)(te,{tree:s,node:f,renderId:e,ref:r,children:(0,ce.jsxs)(Lt,{anchor:t,alignSelf:"center",attachTo:lc,offset:cc,onClose:a,showArrow:!0,arrow:{anchor:t,alignSelf:"center"},fallbackToModalAppearance:!0,backdropTintEnabled:!1,themeOverrideMode:"darkOnDarkModal",children:[(0,ce.jsx)(Lr,{disableDivider:!0,onClose:a,children:(0,ce.jsx)(Vr,{title:"Image"})}),(0,ce.jsx)("div",{className:Rs,children:ke(f.fillImage)?(0,ce.jsx)(fc,{node:f,dynamicValue:f.fillImage,renderId:e}):(0,ce.jsx)(pc,{node:f})})]})})}function fc({node:n,dynamicValue:o,renderId:e}){return h(O(o),"Expected variable reference"),(0,ce.jsx)(dc,{node:n,variableReference:o,renderId:e})}function dc({node:n,variableReference:o,renderId:e}){let t=C(),r=t.stores.treeStore.useState(l=>{let c=n.cache.getRenderInstance(e);return G(l.tree,l.sandboxCollectionData,o,"image",c?.collectionItemId)});h(r,"Variable info must exist");let{collectionItemNode:i,reducedControlProp:s,controlProp:f}=r;h(s.type==="responsiveimage","Expected reduced responsive image");let a=(0,oe.useCallback)(l=>{i.set(Ko({[o.id]:l(f)})),t.stores.projectStore.commitTreeAndSend()},[i,o,f]),d=(0,oe.useCallback)(()=>{i.set(Ko({[o.id]:{type:"image",value:void 0}})),t.stores.projectStore.commitTreeAndSend()},[i,o]);return(0,ce.jsx)(Yi,{controlProp:s,onChange:a,onRemove:d,maxExtraImages:0})}function pc({node:n}){let o=C(),e=(0,oe.useMemo)(()=>{let l={..._i(),...Mi()};return Ri(n,l),Di(n,l),l},[n]),t=(0,oe.useCallback)(async l=>{let[c]=await l;c&&(bi(n,c),o.stores.projectStore.commitTreeAndSend())},[n]),r=(0,oe.useCallback)(l=>{ie(n.fillImage)&&(n.set({fillImage:qn(n.fillImage,l)}),o.stores.projectStore.commitTreeAndSend())},[n]),i=(0,oe.useCallback)(l=>{fr(n)&&(n.set({altAttribute:l}),o.stores.projectStore.commitTreeAndSend())},[n]),s=(0,oe.useCallback)(l=>{n.set({fillImageResize:l}),o.stores.projectStore.commitTreeAndSend()},[n]),f=(0,oe.useCallback)(l=>{n.set({fillImageTileSize:l}),o.stores.projectStore.commitTreeAndSend()},[n]),a=(0,oe.useCallback)((l,c)=>{n.set({fillImagePositionX:l,fillImagePositionY:c}),o.stores.projectStore.commitTreeAndSend()},[n]),d=(0,oe.useCallback)(()=>{n.set({fillImage:void 0}),o.stores.projectStore.commitTreeAndSend()},[n]);return(0,ce.jsx)(Xi,{...e,imageReferences:e.fillImages,altText:e.altAttribute,onChangeImages:t,onChangeAssetSize:r,onChangeAltText:i,onChangeImageResize:s,onChangeFillImageSize:f,onChangeImagePosition:a,onRemoveImage:d})}var Ds=m($());function lt(n){let o=C(),{domLayoutUpdate:e,tree:t}=o.stores.treeStore.useState();return(0,Ds.useMemo)(()=>{let r=t.getNode(n);if(!r)return;let{breakpointNode:i}=o.stores.canvasStore;if(!i)return;let s=e;return mc(t,i,r)},[e,n,t])}function mc(n,o,e){let t=n.convertFrameToCanvas(e),r=n.getNodesInRect(o,t,!0),i=[],s=o.cache.layoutTemplateRects;if(s)for(let[U,y]of s)!y.canvasRect||!Le.intersects(y.canvasRect,t)||i.push(new mr({zIndex:y.domRect.zIndex,id:U,parentid:o.id}));let f=r.concat(i),a=Fr(f,n,{[o.id]:i}),d=a.findIndex(U=>U.id===e.id);if(d===-1)return;let l=a.slice(d+1);if(l.length===0)return;let u=n.transformMatrixToNode(e).inverse(),w=`M ${-De},${-De} L ${-De},${t.height+De} L ${t.width+De},${t.height+De} L ${t.width+De},${-De} Z`;for(let U of l){let y=s?.get(U.id),E;y?.canvasCorners?E=y.canvasCorners:E=n.convertCornerPointsToCanvas(U);let x=E[0];x&&E.push(x);for(let{x:F,y:v}of E){let b=new DOMPoint(F,v).matrixTransform(u);w+=` L ${b.x},${b.y}`}w+=" Z"}return`path("${w}")`}var De=100;var bn=m(g());function Ts({tool:n}){let{nodeId:o,renderId:e}=n,t=C(),{treeStore:r,canvasStore:i,toolStore:s}=t.stores,{tree:f}=r.useState(),a=lt(o),d=f.getNodeWithTrait(o,A),l=i.webPageNode;return!d||!l||!s.proseMirrorView?null:(0,bn.jsx)(te,{tree:f,node:d,renderId:e,children:(0,bn.jsx)(ta,{tool:n,scopeNode:l,node:d,renderId:e,editorView:s.proseMirrorView,zoom:1,handleOutsideClick:c=>{c.target===c.currentTarget&&t.exitTool()},style:{clipPath:a}})})}var Gs="validationBadge_v1r7rm12";var uo=m(g());function uc(n){return n.message}function mo({validationWarning:n}){if(!n)return null;let o=uc(n);return(0,uo.jsxs)("div",{className:Gs,children:[(0,uo.jsx)(_r,{width:10,height:10}),o]})}var St=m(g());function zs({tool:n}){let{nodeId:o,renderId:e}=n,t=C(),{treeStore:r,canvasStore:i,toolStore:s}=t.stores,{validationWarning:f}=t.stores.toolStore.useState(),{tree:a}=r.useState(),d=lt(o),l=i.webPageNode,{proseMirror:c}=s.useState(),u=a.getNodeWithTrait(o,A);if(!u||!l||!c)return;function w(U){U.target===U.currentTarget&&t.exitTool()}return(0,St.jsxs)(te,{tree:a,node:u,renderId:e,children:[(0,St.jsx)(mo,{validationWarning:f}),(0,St.jsx)(oa,{tool:n,scopeNode:l,node:u,renderId:e,proseMirror:c,zoom:1,onClickOutside:w,hasValidationWarning:!!f,style:{clipPath:d}})]})}var vt=m(g());function qs({tool:n}){let{nodeId:o,renderId:e}=n,t=C(),{tree:r}=t.stores.treeStore.useState(),{validationWarning:i}=t.stores.toolStore.useState(),s=lt(o),f=r.getNodeWithTrait(o,A),a=t.stores.canvasStore.webPageNode;return!a||!f?null:(0,vt.jsxs)(te,{tree:r,node:f,renderId:e,children:[(0,vt.jsx)(mo,{validationWarning:i}),(0,vt.jsx)(na,{tool:n,scopeNode:a,node:f,renderId:e,zoom:1,onClickOutside:d=>{d.target===d.currentTarget&&t.exitTool()},hasValidationWarning:!!i,style:{clipPath:s}})]})}var se=m(g());function Ws(){let{treeStore:n,sandboxStore:o}=C().stores,{canvasHeight:e}=o.useState(),t=n.useState(r=>r.tree.getPresetsListNode());return(0,se.jsxs)("div",{className:xs,style:{height:e??"initial"},children:[(0,se.jsx)(Us,{}),(0,se.jsx)(gc,{}),(0,se.jsx)(Oi,{presetsListNode:t})]})}function gc(){let{toolStore:n,canvasStore:o,projectStore:e}=C().stores,{tool:t}=n.useState(),{modalState:r}=o.useState(),{hasPermanentlyFailed:i}=e.useState();if(!i&&r.type==="hidden"){if(t instanceof Fe)return(0,se.jsx)(_s,{});if(t instanceof Ie)return(0,se.jsx)(Ms,{tool:t});if(t instanceof pe)return(0,se.jsx)(Ts,{tool:t});if(t instanceof me)return(0,se.jsx)(zs,{tool:t});if(t instanceof ue)return(0,se.jsx)(qs,{tool:t});if(t instanceof xe)return(0,se.jsx)(As,{tool:t});if(t instanceof Ue)return(0,se.jsx)(Bs,{tool:t})}}var be=m(g());function Vs(){at();let n=C(),{isHidden:o}=n.stores.canvasStore.useState();return(0,go.useEffect)(()=>{let e=({data:t})=>{if(Ae(t)&&t.apiVersion===1){let{type:r,position:i}=t;r==="showCanvas"&&Ae(i)&&Wn(i.top)&&(window.scrollTo({behavior:"instant",top:i.top}),setTimeout(()=>{n.stores.canvasStore.isHidden=!1,n.startHighlightTool(),n.stores.editableNodeHighlightStore.highlight(n,{type:"start"})},0))}};return window.addEventListener("message",e),()=>{window.removeEventListener("message",e)}},[]),(0,go.useEffect)(()=>{let{sandboxStore:e}=n.stores;o?e.hide():e.show()},[o]),yc(o),(0,Ls.createPortal)((0,be.jsx)(Wt,{mode:"onPageEditing",children:(0,be.jsxs)("div",{className:L(o&&Oa),children:[(0,be.jsx)(Ws,{}),(0,be.jsxs)("div",{className:Ba,[rn]:"true",children:[(0,be.jsx)(gs,{}),(0,be.jsx)(za,{}),(0,be.jsx)(Yr,{padding:80}),(0,be.jsx)(ra,{ref:n.stores.projectStore.filePickerRef})]})]})}),document.body)}function yc(n){let o=C();(0,go.useEffect)(()=>{if(n)return;let e=new Zi;e.set("CommandOrControl+Z",o.undo.bind(o),"undo"),e.set("CommandOrControl+Shift+Z",o.redo.bind(o),"redo");function t(r){if(Jt())return;let i=e.get(r);i&&(i.action(r),r.preventDefault(),r.stopPropagation())}return window.addEventListener("keydown",t),()=>{window.removeEventListener("keydown",t)}},[n])}function X(n){return window.editorBarFeatures[n]===!0}async function yo({awaitOnBeginSizeMeasuring:n=!0,onAbleToDraw:o,padding:e=0,ref:t}){let r=({width:a,height:d,padding:l=0})=>{let c=`calc(50% - ${d/2+l}px)`,u="0%",w=`calc(50% - ${d/2+l}px)`,U=`calc(100% - ${a+l*2}px)`;return`inset(${c} ${u} ${w} ${U})`},i=t;if(!i)return;window.parent.postMessage({apiVersion:1,type:"beginSizeMeasuring"},"*"),n&&await Ks(document.body),o&&(o(),await Ks(i));let s=i.getBoundingClientRect(),f=r({width:Math.ceil(s.width),height:Math.ceil(s.height),padding:e});window.parent.postMessage({apiVersion:1,type:"updateStyle",clipPath:f},"*")}async function Ks(n){let o=n.offsetWidth,e=n.offsetHeight,t=5e3,r=100;return new Promise(i=>{let s=window.setTimeout(()=>{a.disconnect(),i()},t),f=Ln(()=>{clearTimeout(s),a.disconnect(),i()},r),a=new ResizeObserver(()=>{(n.offsetWidth!==o||n.offsetHeight!==e)&&f()});a.observe(n)})}var ho=class extends S{constructor(e){super();this.getAccess=e;p(this,"_navigationState","Initializing");p(this,"_isMenuOpen",!localStorage.getItem(sn));p(this,"isMouseHoveringMenu",!1);p(this,"layoutRef");this.isMenuOpen&&this.scheduleMenuAutoClose()}get navigationState(){return this._navigationState}get isMenuOpen(){return this._isMenuOpen}registerLayoutRef(e){this.layoutRef=e,yo({ref:e,padding:30})}async navigate(e){e!==this._navigationState&&(!X("editorBarOnPageEditing")&&this.layoutRef?await yo({awaitOnBeginSizeMeasuring:!1,ref:this.layoutRef,onAbleToDraw:()=>{this._navigationState=e},padding:30}):this._navigationState=e)}async setMenuOpen(e){if(k(this.layoutRef,"Must registerLayoutRef before calling OnPageNavigationStore.navigate"),e&&this.navigationState==="SelectAppPreference"&&Xs()){let t=this.getAccess();t&&(this._navigationState=Sn(t))}await yo({awaitOnBeginSizeMeasuring:!1,ref:this.layoutRef,onAbleToDraw:()=>{this._isMenuOpen=e},padding:e?30:0})}async toggleMenuOpen(){await this.setMenuOpen(!this.isMenuOpen)}scheduleMenuAutoClose(){setTimeout(()=>{localStorage.setItem(sn,"true"),this.isMouseHoveringMenu||this.setMenuOpen(!1)},2e3)}};function Sn(n){switch(n.status){case"no-auth":return"Guest";case"success":return X("editorBarOnPageEditing")?"Canvas":Xs()?"Menu":"SelectAppPreference";case"unknown":return"CookiePrompt";case"error":return"Error";case"no-access":return"NoAccess";case"no-permission":return"NoPermission";default:nt(n)}}function Xs(){let n=localStorage.getItem(Me);return n==="browser"||n==="app"}var Zs=m($());function js(){(0,Zs.useEffect)(()=>{let n=o=>{if(!Ae(o.data))return;let{apiVersion:e,type:t}=o.data;e===1&&t==="enterOnPageEditing"&&K("editor_bar_interaction",{page:"editor-bar-project-page",id:"editor-bar-enter-on-page-editing"})};return window.addEventListener("message",n),()=>window.removeEventListener("message",n)},[])}var Qe=m($());var Ys="wrapper_w1wtsf9k";var Hs="button_blajnuz",Js="open_o1r4uh58",Qs="logo_lbr5chv";var dt=m(g());function Te({width:n=10,height:o=10,className:e}){return(0,dt.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",width:n,height:o,fill:"none",className:e,"aria-hidden":"true",children:(0,dt.jsxs)("g",{transform:"translate(2 2)",children:[(0,dt.jsx)("path",{d:"M 0 0 L 6 6",fill:"transparent",stroke:"currentColor",strokeWidth:"1.5",strokeLinecap:"round"}),(0,dt.jsx)("path",{d:"M 0 6 L 6 0",fill:"transparent",stroke:"currentColor",strokeWidth:"1.5",strokeLinecap:"round"})]})})}var wo=m(g());function $s({open:n,hidden:o,onClick:e}){return(0,wo.jsx)(P,{className:J(Hs,n&&Js),direction:"row",alignItems:"center",justifyContent:"center",style:{display:o?"none":void 0},onClick:e,role:"button","aria-label":`${n?"Close":"Open"} Framer Menu`,children:n?(0,wo.jsx)(Te,{}):(0,wo.jsx)(qt,{className:Qs,height:16,"aria-hidden":"true"})})}var Co="container_c1amlb55",el="textContainer_t1noknjc",tl="title_t14vtnbc",ol="subtitle_swpufyq",kt="button_b9jl8lf",Uo="editorBarButtonPrimary_eptse9g",nl="item_i187n6fv",rl="menuRowText_mirdjeq",il="divider_djjgtbz",pt="iconSquare_ixgjdid",Et="buttonsContainer_b1qnbldr";var _=m(g());function Pt({children:n,onClick:o}){return(0,_.jsx)("button",{type:"button",className:nl,onClick:o,children:(0,_.jsx)("span",{className:rl,children:n})})}function Ye({children:n,onClick:o,disabled:e,layoutId:t,duration:r,className:i}){return(0,_.jsx)(W.div,{layout:"position",layoutId:t,style:{width:"100%"},transition:{duration:r,type:"spring",bounce:.2,delay:0},children:(0,_.jsx)(T,{type:"button",className:J(kt,i),onClick:o,enabled:!e,children:n})})}function Ee({logo:n,title:o,subtitle:e,buttons:t,showLearnMoreAndHideEditorBarButtons:r,customClassNames:i}){let{navigationStore:s}=C().stores,f=()=>{window.open("https://www.framer.com/help/articles/page-edit","_blank"),s.setMenuOpen(!1)},a=()=>{K("editor_bar_interaction",{page:"editor-bar-menu",id:"editor-bar-hide"}),window.parent.postMessage({apiVersion:1,type:"editorBarHidden"},"*")};return(0,_.jsxs)(P,{className:J(Co,i?.container),justifyContent:"center",alignItems:"center",children:[(0,_.jsxs)(P,{className:J(el,i?.textContainer),gap:15,alignItems:"center",justifyContent:"center",children:[n,(0,_.jsxs)(P,{gap:5,alignItems:"center",justifyContent:"center",children:[(0,_.jsx)(W.span,{layout:!0,className:J(tl,i?.title),children:o}),(0,_.jsx)(W.p,{layout:!0,className:J(ol,i?.subtitle),children:e})]})]}),t?(0,_.jsx)(P,{className:J(Et,i?.buttonsContainer),gap:10,children:t}):null,r?(0,_.jsxs)(_.Fragment,{children:[(0,_.jsx)("hr",{className:J(il,i?.divider)}),(0,_.jsxs)(P,{className:J(Et,i?.buttonsContainer),gap:2,children:[(0,_.jsxs)(Pt,{onClick:f,children:[(0,_.jsx)(P,{className:J(pt,i?.iconSquare),children:(0,_.jsx)(Rr,{})}),"Learn More"]}),(0,_.jsxs)(Pt,{onClick:a,children:[(0,_.jsx)(P,{className:J(pt,i?.iconSquare),children:(0,_.jsx)(Te,{})}),"Hide Button"]})]})]}):null]})}var ge="https://app.framerstatic.com/framer-logo-blue-23OMXQLR.png";var al="backdrop_bzafg2a",sl="container_cnhgigm",ll="textContainer_t1ookr3o",cl="title_tyol4w7",fl="subtitle_s7fryoi",dl="button_by9jupw",pl="buttonsContainer_b18g1n4a",ml="closeModal_c1gc3a0q";var ne=m(g());function xc({children:n,onClick:o,disabled:e,layoutId:t,duration:r}){return(0,ne.jsx)(W.div,{layout:"position",layoutId:t,style:{width:"100%"},transition:{duration:r,type:"spring",bounce:.2,delay:0},children:(0,ne.jsx)(T,{type:"button",className:dl,onClick:o,enabled:!e,children:n})})}function mt({logo:n,title:o,subtitle:e,buttons:t,showLearnMoreButton:r}){let i=()=>{window.open("https://www.framer.com/help/articles/on-page-editing","_blank")},s=()=>{window.parent.postMessage({apiVersion:1,type:"sandboxReadyState",data:{status:"ready"}},"*"),window.parent.postMessage({apiVersion:1,type:"exitFullscreen",position:{top:window.scrollY}},"*")};return(0,ne.jsx)(P,{className:al,onClick:s,children:(0,ne.jsxs)(P,{className:sl,justifyContent:"center",alignItems:"center",onClick:f=>f.stopPropagation(),children:[(0,ne.jsx)(P,{onClick:s,className:ml,children:(0,ne.jsx)(Te,{})}),(0,ne.jsxs)(P,{className:ll,gap:15,alignItems:"center",justifyContent:"center",children:[n,(0,ne.jsxs)(P,{gap:5,alignItems:"center",justifyContent:"center",children:[(0,ne.jsx)(W.span,{layout:!0,className:cl,children:o}),(0,ne.jsx)(W.p,{layout:!0,className:fl,children:e})]})]}),t||r?(0,ne.jsxs)(P,{className:pl,gap:10,children:[r?(0,ne.jsx)(xc,{onClick:i,children:"Learn More"}):null,t||null]}):null]})})}var He=m(g());function ul(){let{stores:{accessStore:n}}=C(),o=X("editorBarOnPageEditing");async function e(){K("editor_bar_interaction",{page:"editor-bar-cookie-prompt",id:"editor-bar-allow-cookies"});try{await document.requestStorageAccess()}finally{await n.refresh()}}return o?(0,He.jsx)(mt,{logo:(0,He.jsx)("img",{decoding:"async",width:36,src:ge,alt:"Framer Logo"}),title:"Edit Page",subtitle:"Continuing may require granting permissions in a browser dialog.",buttons:(0,He.jsx)(T,{className:L(kt,Uo),onClick:e,variant:"primary",children:"Continue"}),showLearnMoreButton:!0}):(0,He.jsx)(Ee,{logo:(0,He.jsx)("img",{decoding:"async",width:36,src:ge,alt:"Framer Logo"}),title:"Page Edit",subtitle:"You need to grant additional permissions to edit the site",buttons:(0,He.jsx)(T,{className:kt,onClick:e,children:"Grant Permissions"}),showLearnMoreAndHideEditorBarButtons:!0})}var vn="loginButtonLoading_l4nhz4u";var ye=m(g());function gl(){let{stores:{loginStore:n}}=C(),{isLoginInProgress:o}=n.useState(),e=X("editorBarOnPageEditing");async function t(){K("editor_bar_interaction",{page:"editor-bar-guest-page",id:"editor-bar-login"}),await n.login()}return e?(0,ye.jsx)(mt,{logo:(0,ye.jsx)("img",{decoding:"async",width:36,height:36,src:ge,alt:"Framer Logo"}),title:"Edit Page",subtitle:"Edit the page directly in the browser, without opening the app.",buttons:(0,ye.jsx)(Ye,{onClick:t,disabled:o,className:Uo,children:o?(0,ye.jsx)("div",{className:vn,children:(0,ye.jsx)(nn,{})}):"Continue"}),showLearnMoreButton:!0}):(0,ye.jsx)(Ee,{logo:(0,ye.jsx)("img",{decoding:"async",width:36,height:36,src:ge,alt:"Framer Logo"}),title:"Page Edit",subtitle:"Edit pages in one click",buttons:(0,ye.jsx)(Ye,{onClick:t,disabled:o,children:o?(0,ye.jsx)("div",{className:vn,children:(0,ye.jsx)(nn,{})}):"Continue"}),showLearnMoreAndHideEditorBarButtons:!0})}var Nt=m(g()),yl="Page Edit",hl="To edit, ask the site owner for access to the project",wl="To edit, ask the site owner for content editing permissions";function kn({reason:n}){return X("editorBarOnPageEditing")?(0,Nt.jsx)(mt,{logo:(0,Nt.jsx)("img",{decoding:"async",width:36,src:ge,alt:"Framer Logo"}),title:yl,subtitle:n==="no-permission"?wl:hl,showLearnMoreButton:!0}):(0,Nt.jsx)(Ee,{logo:(0,Nt.jsx)("img",{decoding:"async",width:36,src:ge,alt:"Framer Logo"}),title:yl,subtitle:n==="no-permission"?wl:hl,showLearnMoreAndHideEditorBarButtons:!0})}var En=m(g());function Cl(n){return(0,En.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",width:"9",height:"14",fill:"none","aria-hidden":"true",...n,children:(0,En.jsx)("path",{d:"M4.33 5.33H0v4.34L4.33 14V9.67h4.34ZM0 1h8.67v4.33H4.33Z",fill:"currentColor"})})}var Ul="container_cs4bcfd",xl="containerWithOnPageEditing_ctwsnmx",Il="containerWithoutOnPageEditing_cauv9zl";var he=m(g());function Fl(){let n=localStorage.getItem(Me)==="app",{stores:{accessStore:o,navigationStore:e,activeRouteStore:t}}=C(),{canEditContent:r}=o.useState();function i(){K("editor_bar_interaction",{page:"editor-bar-project-page",id:"editor-bar-open-project"}),ao({activeRouteStore:t,accessStore:o}),e.setMenuOpen(!1)}let s=()=>{K("editor_bar_interaction",{page:"editor-bar-project-page",id:"editor-bar-hide"}),window.parent.postMessage({apiVersion:1,type:"editorBarHidden"},"*")};return(0,he.jsx)(P,{className:L(Co,Ul,X("editorBarOnPageEditing")?xl:Il),justifyContent:"center",alignItems:"center",children:(0,he.jsxs)(P,{className:Et,gap:2,children:[(0,he.jsxs)(Pt,{onClick:i,children:[(0,he.jsx)(P,{className:pt,children:n?(0,he.jsx)(Cl,{}):(0,he.jsx)(Br,{"aria-title":"Open in New Tab"})}),r?"Edit Page":"View Page"]}),(0,he.jsxs)(Pt,{onClick:s,children:[(0,he.jsx)(P,{className:pt,children:(0,he.jsx)(Te,{})}),"Hide"]})]})})}var Ot=m($());var bl="checkMarkContainer_c1den3f4",Pn="container_c19h5h6d",Sl="subtitle_s1n2m10t";var z=m(g()),Sc=()=>(0,z.jsx)(W.div,{layout:!0,className:bl,children:(0,z.jsx)(Nr,{})});function vl(){let{stores:{navigationStore:n}}=C(),[o,e]=(0,Ot.useState)(null),t=.4,r=(0,Ot.useCallback)(s=>{K("editor_bar_interaction",{page:"editor-bar-select-app-preference",id:s==="browser"?"editor-bar-select-app-preference-browser":"editor-bar-select-app-preference-app"}),localStorage.setItem(Me,s),e(s)},[]),i=(0,Ot.useCallback)(()=>{n.setMenuOpen(!1)},[]);return(0,z.jsx)(rt,{mode:"wait",children:(0,z.jsx)(W.div,{layoutId:"preference-container",transition:{duration:t,type:"spring",bounce:.2,delay:0},children:o?(0,z.jsx)(Ee,{logo:(0,z.jsx)(Sc,{}),title:"Preference Saved",subtitle:`From now on, the Edit Page button will open the ${o}`,buttons:(0,z.jsx)(Ye,{layoutId:"preference-buttons",duration:t,onClick:i,children:"Dismiss"}),customClassNames:{container:Pn}}):(0,z.jsx)(Ee,{logo:(0,z.jsx)(W.img,{layout:!0,decoding:"async",width:36,src:ge,alt:"Framer Logo"}),title:"Page Edit",subtitle:(0,z.jsxs)(z.Fragment,{children:["Do you prefer to edit your sites in the"," ",(0,z.jsx)("a",{href:"https://www.framer.com/downloads/",target:"_blank",children:"Framer App"})," ","or in the web browser?"]}),buttons:(0,z.jsxs)(z.Fragment,{children:[(0,z.jsx)(Ye,{layoutId:"preference-buttons",duration:t,onClick:()=>r("app"),children:"Framer App"}),(0,z.jsx)(Ye,{onClick:()=>r("browser"),children:"Web Browser"})]}),customClassNames:{container:Pn,subtitle:Sl}})},o?"saved":"select")})}var Je=m(g());function Nn(){let{stores:{accessStore:n,navigationStore:o}}=C(),{access:e}=n.useState(),{navigationState:t}=o.useState();switch(t){case"Guest":return(0,Je.jsx)(gl,{});case"CookiePrompt":return(0,Je.jsx)(ul,{});case"Menu":return k(e.status==="success"),(0,Je.jsx)(Fl,{});case"SelectAppPreference":return(0,Je.jsx)(vl,{});case"NoAccess":return(0,Je.jsx)(kn,{reason:"no-access"});case"NoPermission":return(0,Je.jsx)(kn,{reason:"no-permission"});case"Canvas":case"Error":case"Initializing":return null;default:nt(t)}}var le=m(g());function kc({children:n,open:o}){return(0,le.jsx)(rt,{children:o&&(0,le.jsx)(W.div,{initial:{marginRight:-4,opacity:0},animate:{marginRight:0,opacity:1},exit:{marginRight:-4,opacity:0},children:n})})}function kl(){let n=C(),{navigationStore:o,accessStore:e,sandboxStore:t,activeRouteStore:r}=n.stores,{shouldRenderOnPageCanvas:i}=e.useState(),{isMenuOpen:s,navigationState:f}=o.useState(),a=(0,Qe.useRef)(null),d=X("editorBarOnPageEditing"),l=_e(()=>r.webPageNodeId,[],[r]);(0,Qe.useEffect)(()=>{!d||!l||t.waitForInitialLoad(l).then(()=>{window.parent.postMessage({apiVersion:1,type:"sandboxReadyState",data:{status:"ready"}},"*")}).catch(H)},[t,d,l]),(0,Qe.useEffect)(()=>{f!=="Initializing"&&f!=="Error"&&window.parent.postMessage({apiVersion:1,type:"accessResult",data:{status:"success"}},"*")},[f]),(0,Qe.useEffect)(()=>{n.performanceTracker.reportEditorBarReady()}),js(),(0,Qe.useEffect)(()=>{d||a.current&&o.registerLayoutRef(a.current)},[d]);let c=()=>{o.isMouseHoveringMenu=!0},u=()=>{o.isMouseHoveringMenu=!1},w=async()=>{await o.toggleMenuOpen()};return d?(0,le.jsxs)(le.Fragment,{children:[(0,le.jsx)(Nn,{}),i&&(0,le.jsx)(Vs,{})]}):(0,le.jsxs)(P,{direction:"row",alignItems:"center",gap:10,ref:a,className:Ys,onMouseEnter:c,onMouseLeave:u,role:"presentation",children:[(0,le.jsx)(kc,{open:s,children:(0,le.jsx)(Nn,{})}),(0,le.jsx)($s,{hidden:f==="Initializing"||f==="Error",open:s,onClick:w})]})}var Io=class extends S{constructor(e,t,r,i){super();this.navigationStore=e;this.projectStore=t;this.hostnameStore=r;this.siteId=i;p(this,"_access")}get access(){return h(this._access,"Access not initialized"),this._access}get projectId(){return El(this.access)}get canEditContent(){let e=this.access;return e.status!=="success"?!1:e.data.permissions?.canEditContent==="on"}get shouldRenderOnPageCanvas(){return X("editorBarOnPageEditing")&&an()&&this.canEditContent}async set(e){this._access=e;let t=Sn(e);if(await this.navigationStore.navigate(t),this.shouldRenderOnPageCanvas){let r=El(e);e.userId&&r&&(this.projectStore.loadProject(e.userId,r),this.hostnameStore.loadHostnames(r).catch(H))}yr.setUserId(e.userId??"null")}async refresh(){let e=await Ia(this.siteId);await this.set(e)}},Ec=/^(?<name>.+--)?(?<id>[a-z0-9]{20})(?<hash>-[a-z0-9]+)?$/iu;function El(n){if(n.status==="success")return Ec.exec(n.data.projectSlug)?.groups?.id}var Fo=class extends S{constructor(e){super();this.editableNodeHighlightStore=e;p(this,"localeId",rr);p(this,"_collectionItemNodeId");p(this,"_webPageNodeId");let t=({data:r})=>{if(Ae(r)&&r.apiVersion===1){let{type:i,nodeIds:s}=r;if(i==="updateNodeIds"&&Ae(s)&&ie(s.webPageNodeId)){let{webPageNodeId:f,collectionItemNodeId:a}=s;this._webPageNodeId=f,this._collectionItemNodeId=ie(a)?a:void 0,this.editableNodeHighlightStore.onChangeRoute()}}};window.addEventListener("message",t),window.parent.postMessage({apiVersion:1,type:"initializeComponent",component:"OnPageActiveRouteStore"},"*")}get collectionItemNodeId(){return this._collectionItemNodeId}get webPageNodeId(){return this._webPageNodeId}get projectLinkNodeId(){return this._collectionItemNodeId??this._webPageNodeId}};var bo=class extends S{constructor(){super(...arguments);p(this,"_assets",[]);p(this,"_assetService");p(this,"assetMap",new Gn)}get assets(){return this._assets}get assetService(){return this._assetService}setAssetService(e){this._assetService=e,zn(e,t=>{t.assets&&(this._assets=t.assets,this.assetMap.set(t.assets),Oe.importCustomFonts(t.assets,Hn.isOn("customFontImprovements")))})}};var On={slug:!0,string:!0,richtext:!0,link:!0,image:!0,array:!0,multicollectionreference:!0,collectionreference:!0,file:!0,date:!0,number:!0,boolean:!0,enum:!0};async function Pl(n){return Xr.post("/edit/notifications/page-edited",n)}var So=class extends S{constructor(e,t,r,i,s,f,a){super();this.accessStore=e;this.activeRouteStore=t;this.editableNodeHighlightStore=r;this.treeStore=i;this.projectStore=s;this.undoRedoManager=f;this.exitTool=a;p(this,"isHidden",!0);p(this,"_screenWidth",window.innerWidth);p(this,"_temporaryCollectionItemNodeId");p(this,"_modalState",{type:"hidden"});window.addEventListener("resize",()=>{this._screenWidth=window.innerWidth})}get screenWidth(){return this._screenWidth}get temporaryCollectionItemNodeId(){return this._temporaryCollectionItemNodeId}set temporaryCollectionItemNodeId(e){this._temporaryCollectionItemNodeId=e,this.editableNodeHighlightStore.onChangeRoute()}get modalState(){return this._modalState}get webPageNode(){let e=this.activeRouteStore.webPageNodeId,t=this.treeStore.tree.getNodeWithTrait(e,Yn);if(t?.loaded)return t.loaded;t?.load().catch(H)}get collectionItemNode(){return this.treeStore.tree.getNodeWithTrait(this.temporaryCollectionItemNodeId??this.activeRouteStore.collectionItemNodeId,Ve)??void 0}get collectionNode(){let e=this.collectionItemNode;if(e)return this.treeStore.tree.getNodeWithTrait(e.parentid,Tt)??void 0}get isCreatingCollectionItem(){return!!this.collectionItemNode?.privateToUserId}createTemporaryCollectionItem(){let e=this.collectionNode;if(!e)return;let t=this.accessStore.access?.userId;h(t,"User must be logged in");let r=e.getPrivateItemForUser(t);if(r)this.temporaryCollectionItemNodeId=r.id;else{let i=pr.create({isDraft:!0,privateToUserId:t});this.treeStore.tree.insertNode(i,e.id,0),this.temporaryCollectionItemNodeId=i.id;let s=new Date().toJSON();for(let f of e.variables)f.type==="date"&&i.setControlProp(f.id,{type:"date",value:s});this.projectStore.commitTreeAndSend()}}get breakpointNode(){let e=this.webPageNode?.getBreakpointValues(),t=Qn(e,this.screenWidth);return this.treeStore.tree.get(t)}get stylePresetBreakpointClassNames(){let e=this.treeStore.tree.getPresetsListNode(),t=Ji(e);return Qi(t,this.screenWidth)}async sendNotification(e){let t=this.accessStore.projectId;h(t,"Project ID must exist");let r=this.webPageNode;h(r,"Web page node must exist");let i=this.collectionItemNode,s;if(i){let f=this.collectionNode;h(f,"Collection item exists, so its parent collection must exist"),h(f.name,"Collection node must have a name"),s={notificationType:e,projectId:t,webPageNodeId:r.id,collectionItemNodeId:i.id,collectionItemTitle:Pc(f,i),collectionTitle:f.name,pageType:"cms-detail"}}else s={notificationType:e,projectId:t,webPageNodeId:r.id,pageTitle:r.webMetadata?.title||ti(this.treeStore.tree,r),pageType:"static"};await Pl(s)}discardTemporaryCollectionItem(){h(this.collectionItemNode,"Collection item node must exist"),h(this.collectionItemNode.id===this.temporaryCollectionItemNodeId,"Collection item must be temporary"),this.treeStore.tree.remove(this.collectionItemNode.id),this.projectStore.commitTreeAndSend(),this.clearTemporaryItem(),this.exitFullscreen()}saveTemporaryCollectionItem(){h(this.collectionItemNode,"Collection item node must exist"),h(this.collectionItemNode.id===this.temporaryCollectionItemNodeId,"Collection item must be temporary"),this.treeStore.tree.current(this.collectionItemNode)?.set({privateToUserId:void 0}),this.projectStore.commitTreeAndSend(),this.finishEditingWithChanges(this.collectionItemNode.id,!0)}handleFinishEditing(){if(this.exitTool(),!this.isCreatingCollectionItem){if(!this.treeStore.hasChanged()){this.handleDismissFinishEditing();return}let a=this.activeRouteStore.projectLinkNodeId;if(!a)return;this.finishEditingWithChanges(a,!1);return}let{collectionItemNode:e}=this,{collectionNode:t}=this;if(h(t&&e,"Collection node and collection item node must exist"),!e.hasData()){this.discardTemporaryCollectionItem();return}let r=Qt(t,e);Li(t,e,r)&&this.projectStore.commitTreeAndSend();let f=Wi(this.treeStore.tree,t,e,r).flatMap(a=>{let d=a.type;return On[d]!==void 0?a.id:[]});f.length>0?this._modalState={type:"requiredFields",fieldIdsToShow:f}:this.saveTemporaryCollectionItem()}finishEditingWithChanges(e,t){this._modalState={type:"finishEditing",nodeId:e,isNewItem:t},K("editor_bar_interaction",{page:"editor-bar-project-page",id:"editor-bar-finish-editing-with-changes"});let r=t?"page-created":"page-edited";this.sendNotification(r).catch(H)}handleShowAllFields(){let e=this.collectionNode;h(e,"Collection node must exist");let r=qi(this.collectionNode).flatMap(i=>{let s=i.type;return On[s]!==void 0?i.id:[]});this.exitTool(),this._modalState={type:"allFields",fieldIdsToShow:r}}handleDismissFinishEditing(){this.clearTemporaryItem(),this.undoRedoManager.clearUndoStack(),this.exitFullscreen()}exitFullscreen(){window.parent.postMessage({apiVersion:1,type:"exitFullscreen",position:{top:window.scrollY}},"*"),this.isHidden=!0}resetModalState(){this._modalState={type:"hidden"}}clearTemporaryItem(){this.resetModalState(),this.temporaryCollectionItemNodeId=void 0}};function Pc(n,o){let e=n.variables.find(Ke);if(e?.associatedStringVariable){let t=o.getControlProp(e.associatedStringVariable);if(t&&t.type==="string"&&ie(t.value)&&t.value.trim())return t.value.trim()}return"a new page"}var vo=class extends S{updateComponentLoader(o,e){q.setModuleRevision(e,0);for(let t of o)q.updateEntity(t.identifier,t)}};var Nc=0,ut,ko=class extends S{constructor(){super();p(this,"editableNodesHighlight");At(this,ut);window.addEventListener("resize",()=>{this.editableNodesHighlight&&(this.editableNodesHighlight=void 0)})}onChangeRoute(){this.editableNodesHighlight&&(this.editableNodesHighlight=void 0)}cleanupAnimationOnFinish(e){qe(this,ut)&&clearTimeout(qe(this,ut)),_t(this,ut,window.setTimeout(()=>{this.editableNodesHighlight=void 0},e+100))}highlight(e,{type:t}){let r=e.stores.canvasStore.breakpointNode;if(!r)return;let i=[],s={x:0,y:window.scrollY,width:window.innerWidth,height:window.innerHeight},f=1/0,a=-1/0,d=!1;for(let l of r.walk())for(let[c]of l.cache.iterateRenderInstances()){if(!Fe.isSelectableNode(e,l,c))continue;d=!0;let u=e.tree.convertFrameToCanvas(l,void 0,c);if(!Oc(s,u))continue;f=Math.min(f,u.y),a=Math.max(a,u.y+u.height);let w=e.tree.getRect(l,void 0,void 0,void 0,c),U=e.tree.transformMatrixToNode(l,void 0,void 0,c);i.push({renderId:c,width:w.width,height:w.height,transform:U.toString(),centerX:u.x+u.width/2,centerY:u.y+u.height/2})}if(i.length===0)ht({key:"editable-nodes-highlight-empty",type:"add",text:d?"Editable content is out of view, scroll to reveal it":"Content is not editable on this page",variant:"info"}),this.editableNodesHighlight=void 0;else{let l=t==="clickOnVoid",c=l?e.stores.mouseStore.windowMousePosition.x:s.width,u=l?e.stores.mouseStore.windowMousePosition.y:s.height/2,w=l?e.stores.mouseStore.canvasMousePosition.y:e.stores.mouseStore.scrollPosition.y,U=400,y=Math.max(c,window.innerWidth-c),E=Math.max(u,window.innerHeight-u),x=Math.sqrt(y**2+E**2)+U,F=Math.max(500,t==="clickOnVoid"?x:x*2),v=5,b=Math.max(0,Math.floor(f-v)),Se=Math.ceil(a+v),Wo=Bc(i,x,c,w);this.editableNodesHighlight={animationId:`editable-nodes-highlight-${Nc++}`,minY:b,maxY:Se,originX:c,originY:u-b+s.y,highlights:i,minRadius:Wo,maxRadius:x,gradientSize:U,animationDuration:F},this.cleanupAnimationOnFinish(F)}}};ut=new WeakMap;function Oc(n,o){return!(o.x>=Le.maxX(n)||Le.maxX(o)<=n.x||o.y>=Le.maxY(n)||Le.maxY(o)<=n.y)}function Bc(n,o,e,t){let r=1/0;for(let i of n){let s=Math.sqrt(i.width**2+i.height**2),f=Math.abs(i.centerX-e),a=Math.abs(i.centerY-t),d=Math.sqrt(f**2+a**2),l=Math.max(0,d-s/2);r=Math.min(r,l)}return Number.isFinite(r)&&r<o?r:0}var Eo=class extends Fi{constructor(){super(...arguments);p(this,"hostnames")}get customHostnameString(){return this.hostnames?.find(e=>e.type==="custom")?.hostname}get defaultHostnameString(){return this.hostnames?.find(e=>e.type==="default")?.hostname}async loadHostnames(e){let{hostnames:t}=await Ii(e);this.hostnames=t}};var Po=class extends S{constructor(e){super();this.sandboxStore=e}async ensureModuleEvaluatedInSandbox(e){await(await this.sandboxStore.getModulesRuntime()).loadModule(e.value)}hasModuleForIdentifier(e){return!!q.componentForIdentifier(e.value)}};var No=class extends S{constructor(e){super();this.accessStore=e;p(this,"isLoginInProgress",!1)}login(){let e=window.open(`${Dt().login}?closeAfterSuccess=true`,"_blank");return e?this.startLoginWindowClosedPolling(e):Promise.resolve()}startLoginWindowClosedPolling(e){return this.isLoginInProgress=!0,new Promise(r=>{let i=setInterval(async()=>{e.closed&&(clearInterval(i),await this.accessStore.refresh(),this.isLoginInProgress=!1,r())},500)})}};var Oo=class extends S{constructor(){super();p(this,"_lastUpdateType",null);p(this,"_scrollPosition",We(0,0));p(this,"_windowMousePosition",We(0,0));p(this,"_canvasMousePosition",We(0,0));p(this,"_isHoveringChrome",!1);let e=this.onMouseMove.bind(this);document.addEventListener("mousemove",e);let t=this.onScroll.bind(this);document.addEventListener("scroll",t)}get lastUpdateType(){return this._lastUpdateType}get scrollPosition(){return this._scrollPosition}get windowMousePosition(){return this._windowMousePosition}get canvasMousePosition(){return this._canvasMousePosition}get isHoveringChrome(){return this._isHoveringChrome}onScroll(){this._scrollPosition=We(window.scrollX,window.scrollY),this._lastUpdateType="scroll",this.updateCanvasMousePosition()}onMouseMove(e){this._isHoveringChrome=Pa(e.target),this._windowMousePosition=We(e.clientX,e.clientY),this._lastUpdateType="mouseMove",this.updateCanvasMousePosition()}updateCanvasMousePosition(){this._canvasMousePosition=We.add(this.windowMousePosition,this.scrollPosition)}};var Nl=m($());var Bo=class extends S{constructor(e,t){super();this.assetStore=e;this.treeStore=t;p(this,"_hasPermanentlyFailed",!1);p(this,"project");p(this,"projectPromise",new ot);p(this,"filePickerRef",(0,Nl.createRef)())}get hasPermanentlyFailed(){return this._hasPermanentlyFailed}getProject(){return this.projectPromise}get resourceLimits(){}get featureFlags(){}get projectLicenseType(){return"freeSite"}loadProject(e,t){at(),!this.project&&(this.project=new va(this.treeStore.timeline,e,t),this.project.connect(),this.project.document.on("disconnect",this.onDisconnect,this),this.project.connection.on("disconnect",this.onDisconnect,this),this.project.document.on("update",r=>{this.treeStore.newTreeAfterRemoteUpdate(r)}),this.assetStore.setAssetService(this.project.assetService),this.projectPromise.resolve(this.project))}onDisconnect(e){vi(e)||(this._hasPermanentlyFailed=!0,e==="ClientNeedsUpdate"?ht({type:"add",variant:"warning",text:"A new version of Framer is available. Please reload the page to continue working.",key:"client-outdated",duration:1/0,icon:"warning",showCloseButton:"never"}):ht({type:"add",variant:"error",text:"Connection error: "+e,key:"connection-error",duration:1/0,icon:"error",showCloseButton:"never"}))}commitTreeAndSend(e=!0){h(this.project,"Project must be initialized"),h(!this.hasPermanentlyFailed,"Project is permanently failed");let t=this.treeStore.timeline.commitLocalTree();this.treeStore.newTreeAfterLocalUpdate(t,e),this.project.maybeSend()}};var Ol="iframe_icxp2h1";var Ao=class extends S{constructor(e,t,r,i){super();this.componentsStore=e;this.treeStore=t;this.performanceTracker=r;this.updateGenerator=i;p(this,"config",Hr.onPageCanvas);p(this,"iframe");p(this,"remoteSandbox");p(this,"remoteControlsVisibility",new ot);p(this,"remoteModulesRuntime",new ot);p(this,"_canvasHeight");p(this,"webPageNodeIdToInitialLoadPromise",new Map);window.addEventListener("scroll",()=>{this.remoteSandbox?.scrollTo({behavior:"instant",top:window.scrollY})})}getControlsVisibility(){return this.remoteControlsVisibility}getModulesRuntime(){return this.remoteModulesRuntime}get canvasHeight(){return this._canvasHeight}loadSandbox(){at(),h(!this.iframe,"Sandbox already loaded");let e=document.createElement("iframe");e.src=this.config.url,e.allow=Hi("canvas"),e.sandbox.add("allow-scripts","allow-same-origin"),e.tabIndex=-1,e.id="canvas_sandbox",e.className=Ol;let t=this.initializeSandbox.bind(this,e);e.addEventListener("load",t),this.iframe=e,this.hide(),document.body.append(e)}getInitialLoadPromise(e){let t=this.webPageNodeIdToInitialLoadPromise.get(e)??new ot;return this.webPageNodeIdToInitialLoadPromise.set(e,t),t}async waitForInitialLoad(e){this.performanceTracker.reportCanvasLoaderViewed(),await this.getInitialLoadPromise(e)}async initializeSandbox(e){let t=e.contentWindow;h(t,"Sandbox didn't load correctly");let r=new Jr(Re);r.setLocal(Re.channels.componentsStore,this.componentsStore),r.setLocal(Re.channels.sandboxStore,this),r.setLocal(Re.channels.treeStore,this.treeStore);let i=r.getRemote(Re.channels.sandbox),s=r.getRemote(Re.channels.controlsVisibility),f=r.getRemote(Re.channels.modulesRuntime);await r.connect({target:t,url:this.config.origin}),this.remoteSandbox=i,this.remoteControlsVisibility.resolve(s),this.remoteModulesRuntime.resolve(f)}onHeightChange(e){this._canvasHeight=e}onInitialLoadComplete(e){this.performanceTracker.reportCanvasReady(),this.getInitialLoadPromise(e).resolve()}update(){let e=this.remoteSandbox;if(!e)return;let t=this.updateGenerator.getUpdate();Mt(t)||e.update(t)}hide(){h(this.iframe,"Sandbox not loaded"),this.iframe.setAttribute("aria-hidden","true")}show(){h(this.iframe,"Sandbox not loaded"),this.iframe.removeAttribute("aria-hidden")}};var _o=class extends S{constructor(e){super();this.canvasStore=e}get active(){return k(this.canvasStore.webPageNode,"webPageNode must be defined"),this.canvasStore.webPageNode}};var $e,Ro=class extends S{constructor(e){super();this.treeStore=e;p(this,"highlightedRenderId");p(this,"nodeInTextEditor");p(this,"proseMirror");p(this,"proseMirrorView",null);At(this,$e);p(this,"validationWarning")}get tool(){return qe(this,$e)}set tool(e){qe(this,$e)!==e&&(qe(this,$e)?.stop?.(),_t(this,$e,e))}validateCollectionControl(e){let t="required";if(!e)return;let{collectionItemNode:r,variableDefinition:i,collectionNode:s,controlDescription:f,controlProp:a}=e,d;(yt(i)||Ke(i))&&(d=$t(i,s.variables,r));let l=Qt(s,r),c=i.type,u=eo(c,f,a,d,void 0,Gt(i),l.get(i.id));this.validationWarning=u?.type===t?void 0:u}};$e=new WeakMap;var Mo=class extends S{constructor(e,t){super();this.activeRouteStore=e;this.undoRedoManager=t;p(this,"layoutCache",new ui);p(this,"sandboxCollectionData",new gi("editor"));p(this,"sandboxVisibility",new yi("editor"));p(this,"_tree",vr.createEmpty());p(this,"_domLayoutUpdate",0);p(this,"timeline",new hi(this.tree));p(this,"treeIndexes",new Bn(this))}get tree(){return this._tree}get domLayoutUpdate(){return this._domLayoutUpdate}get remoteTreeVersion(){return this.timeline.remoteTreeVersion}getChangesForUndo(){let e=this.timeline.getLatestChangesForUndo();return e?e.filter(t=>!t.ignoreInUndo):[]}hasChanged(){return this.undoRedoManager.getUndoBufferSize()>0}getPartialIndexes(){return this.treeIndexes}getLoadedIndexes(){let e=this.tree.getService("loader");if(e){let t=e.numberOfScopesToLoad();throw new Error(`Some scopes are still loading: ${t} scopes left to load`)}return this.treeIndexes}onLayoutMeasure(e){let t=this.layoutCache.processLayoutMeasurements(e);t.size===0||Ci(this.tree,this.layoutCache,t).size===0||this._domLayoutUpdate++}onSandboxRendered(e){let t=new Set;if(e.collectionUpdates){let r=this.sandboxCollectionData.import(e.collectionUpdates);for(let i of r){let s=Ut(i);t.add(s)}}if(e.visibilityUpdates){let r=this.sandboxVisibility.import(e.visibilityUpdates);for(let i of r){let s=Ut(i);t.add(s)}}if(t.size>0){let r=wi(this.tree,t);Ht(this.tree,this.layoutCache,this.sandboxCollectionData,this.sandboxVisibility,q.activeBundleHash,this.activeRouteStore.localeId,void 0,r)}e.layoutMeasurements&&this.onLayoutMeasure(e.layoutMeasurements)}newTreeAfterRemoteUpdate(e){e.inEditor=!0,this._tree!==e&&(this._tree=e)}newTreeAfterLocalUpdate(e,t){if(e.inEditor=!0,this._tree===e)return;this._tree=e;let r=this.getChangesForUndo();t&&r.length>0&&this.undoRedoManager.addUndoEntry({changes:r})}},Bn=class{constructor(o){this.treeStore=o;p(this,"codeComponentNodeCache");p(this,"richTextNodeCache")}get codeComponents(){let o=this.treeStore.tree;if(this.codeComponentNodeCache?.tree===o)return this.codeComponentNodeCache.codeComponentNodes;let e=[];for(let t of o.root.walk())fe(t)&&e.push(t);return this.codeComponentNodeCache={tree:o,codeComponentNodes:e},e}get richTextNodes(){let o=this.treeStore.tree;if(this.richTextNodeCache?.tree===o)return this.richTextNodeCache.richTextNodes;let e=[];for(let t of o.root.walk())A(t)&&e.push(t);return this.richTextNodeCache={tree:o,richTextNodes:e},e}};var Do=class extends Si{};var To=class{constructor(o,e){p(this,"accessStore");p(this,"activeRouteStore");p(this,"assetStore");p(this,"canvasStore");p(this,"componentsStore");p(this,"contextMenuStore");p(this,"hostnameStore");p(this,"loadedExternalModulesStore");p(this,"loginStore");p(this,"modalStore");p(this,"modulesStore");p(this,"mouseStore");p(this,"navigationStore");p(this,"projectStore");p(this,"sandboxStore");p(this,"toolStore");p(this,"treeStore");p(this,"scopeStore");p(this,"editableNodeHighlightStore");p(this,"undoRedoManager",new Do);p(this,"changes",new Zt);this.assetStore=bo.new(o),this.editableNodeHighlightStore=ko.new(o),this.activeRouteStore=Fo.new(o,this.editableNodeHighlightStore),this.componentsStore=vo.new(o),this.contextMenuStore=xi.new(o),this.hostnameStore=Eo.new(o),this.navigationStore=ho.new(o,()=>this.accessStore.access),this.treeStore=Mo.new(o,this.activeRouteStore,this.undoRedoManager),this.projectStore=Bo.new(o,this.assetStore,this.treeStore),this.accessStore=Io.new(o,this.navigationStore,this.projectStore,this.hostnameStore,e),this.loginStore=No.new(o,this.accessStore),this.mouseStore=Oo.new(o),this.toolStore=Ro.new(o,this.treeStore),this.canvasStore=So.new(o,this.accessStore,this.activeRouteStore,this.editableNodeHighlightStore,this.treeStore,this.projectStore,this.undoRedoManager,()=>o.exitTool()),this.scopeStore=_o.new(o,this.canvasStore),this.sandboxStore=Ao.new(o,this.componentsStore,this.treeStore,o.performanceTracker,o.sandboxUpdateGenerator),this.loadedExternalModulesStore=Po.new(o,this.sandboxStore),this.modulesStore=di.new(o,this.treeStore,this.loadedExternalModulesStore,{codeEditorPreviewVisible:!1,mainView:0},this.projectStore.getProject().then(t=>t.modulesAPI),()=>{throw new Error("Can't make document readonly")},async t=>{await(await this.sandboxStore.getModulesRuntime()).insertTemporaryImportMap(t)},async()=>{throw new Error("Can't load all local modules")}),this.modalStore=Zr.new(o)}};var Go=class{constructor(){p(this,"editorBarReadyAt");p(this,"canvasReadyAt");p(this,"canvasLoaderViewedAt")}get editorBarReadyMs(){let o=_c();if(!(Ce(o)||Ce(this.editorBarReadyAt)))return this.editorBarReadyAt-o}get canvasReadyMs(){if(!(Ce(this.canvasReadyAt)||Ce(this.editorBarReadyAt)))return this.canvasReadyAt-this.editorBarReadyAt}get perceivedCanvasLoadMs(){if(!Ce(this.canvasReadyAt))return Ce(this.canvasLoaderViewedAt)?0:Math.min(this.canvasReadyAt-this.canvasLoaderViewedAt,0)}reportEditorBarReady(){this.editorBarReadyAt=Date.now()}reportCanvasLoaderViewed(){this.canvasLoaderViewedAt=Date.now()}reportCanvasReady(){this.canvasReadyAt=Date.now(),this.sendCanvasLoadedEvent()}sendCanvasLoadedEvent(){let{canvasReadyMs:o,editorBarReadyMs:e,perceivedCanvasLoadMs:t}=this;Ce(o)||Ce(e)||Ce(t)||K("editor_bar_canvas_loaded",{editorBarReadyMs:e,canvasReadyMs:o,perceivedCanvasLoadMs:t})}};function _c(){let n=new URLSearchParams(window.location.search).get("loadStart");if(!n)return;let o=Number(n);if(!Number.isNaN(o))return o}var zo=class{constructor(o){this.engine=o;p(this,"partialTreeSender");p(this,"previousWebPageNodeId");p(this,"previousCollectionItemNodeId");p(this,"previousBreakpointNodeId");p(this,"previousStylePresetBreakpointClassNames");p(this,"previousLocalModules");p(this,"previousDependenciesModule");p(this,"previousAssets");p(this,"previousNodeInTextEditor")}getUpdate(){let{canvasStore:o,modulesStore:e,assetStore:t,treeStore:r,toolStore:i}=this.engine.stores,s={},f=o.webPageNode?.id;f!==this.previousWebPageNodeId&&(this.previousWebPageNodeId=f,s.webPageNodeId=f);let a=o.collectionItemNode?.id;a!==this.previousCollectionItemNodeId&&(this.previousCollectionItemNodeId=a,s.collectionItemNodeId=a);let d=o.breakpointNode?.id;d!==this.previousBreakpointNodeId&&(this.previousBreakpointNodeId=d,s.breakpointNodeId=d);let l=o.stylePresetBreakpointClassNames;l!==this.previousStylePresetBreakpointClassNames&&(this.previousStylePresetBreakpointClassNames=l,s.stylePresetBreakpointClassNames=l);let c=e.localModules;c!==this.previousLocalModules&&(this.previousLocalModules=c,s.localModules=new Map(c));let u=e.dependenciesModule;u!==this.previousDependenciesModule&&(this.previousDependenciesModule=u,s.dependenciesModule=u);let w=t.assets;w!==this.previousAssets&&(this.previousAssets=w,s.assets=w),this.partialTreeSender??=new Qr(r.timeline,"canvas");let U=this.partialTreeSender.update(f);Mt(U)||(s.partialTreeUpdate=U);let y=i.nodeInTextEditor??null;return y!==this.previousNodeInTextEditor&&(this.previousNodeInTextEditor=y,s.nodeInTextEditor=y),s}};var qo=class{constructor(o){this.siteId=o;p(this,"name","OnPageEngine");p(this,"sandboxUpdateGenerator",new zo(this));p(this,"performanceTracker",new Go);p(this,"stores");p(this,"changes",new Zt);p(this,"animationTimeout");p(this,"inRendering",!1);p(this,"inPostProcessing",!1);p(this,"runWhenIdle",o=>{throw new Error("Not implemented")});p(this,"isUserEdit",!0);this.stores=new To(this,o),this.stores.projectStore.getProject().then(e=>{h(this.stores.assetStore.assetService,"assetsService must be initialized"),pi(this,this.stores.assetStore.assetService,this.stores.projectStore.filePickerRef),ei(e.api,this.stores.assetStore.assetService),this.stores.modulesStore.initialize().catch(H),e.connection.on("connect",t=>{t&&this.stores.modulesStore.refresh().catch(H)})})}getStateToken(){return this.stores.undoRedoManager.getUndoBufferSize()}get tree(){return this.stores.treeStore.tree}startHighlightTool(){this.stores.toolStore.tool=new Fe(this)}startComponentInstanceEditTool(o,e){this.stores.toolStore.tool=new Ue(this,o,e)}startDateVariableEditTool(o,e,t){this.stores.toolStore.tool=new xe(this,o,e,t)}startImageEditTool(o,e){this.stores.toolStore.tool=new Ie(this,o,e)}startRichTextEditTool(o,e,t){this.stores.toolStore.tool=new pe(this,o,e,t)}startRichTextVariableEditTool(o,e,t){this.stores.toolStore.tool=new me(this,o,e,t)}startStringVariableEditTool(o,e,t){this.stores.toolStore.tool=new ue(this,o,e,t)}exitTool(){this.startHighlightTool()}signalChanges(o){if(this.changes.addChanges(o),this.animationTimeout)return;let e=this.render.bind(this);this.animationTimeout=window.setTimeout(e,0)}render(){if(!this.inRendering&&!this.inPostProcessing){this.inPostProcessing=!0;try{this.changes.has(this.stores.treeStore,this.stores.activeRouteStore)&&Ht(this.stores.treeStore.tree,this.stores.treeStore.layoutCache,this.stores.treeStore.sandboxCollectionData,this.stores.treeStore.sandboxVisibility,q.activeBundleHash,this.stores.activeRouteStore.localeId,void 0,this.stores.activeRouteStore.webPageNodeId),this.stores.toolStore.tool?.update?.(),lr(this.tree)?.postProcess(this.tree),this.stores.undoRedoManager.processScheduledEndUndoGroup({})}finally{this.inPostProcessing=!1}this.inRendering=!0;try{this.stores.sandboxStore.update(),this.changes.signalAllObservers()}finally{this.inRendering=!1}this.animationTimeout=void 0}}undo(){let{undoRedoManager:o,toolStore:e,projectStore:t}=this.stores;e.tool?.undo?e.tool.undo():o.peekUndo()&&(o.undo(this.tree),t.commitTreeAndSend(!1))}redo(){let{undoRedoManager:o,toolStore:e,projectStore:t}=this.stores;e.tool?.redo?e.tool.redo():o.peekRedo()&&(o.redo(this.tree),t.commitTreeAndSend(!1))}beginUndoGroup(){this.stores.undoRedoManager.beginUndoGroup()}endUndoGroup(){this.stores.undoRedoManager.scheduleEndUndoGroup()}wrapHandler(o){let e=this;return function(...t){let r=o.apply(this,t);return e.stores.projectStore.commitTreeAndSend(e.isUserEdit),e.isUserEdit=!0,r}}process(o){this.wrapHandler(o)()}processWhenReady(o){this.wrapHandler(o)()}async processWhenReadyAsync(o){return this.wrapHandler(o)()}runBeforeNextFrame(o){requestAnimationFrame(()=>{o()})}runWithFullyLoadedTree(o,e){h(e.runInBackground,"Only background tasks are supported in the OnPageEngine for now.");let t=this.tree.getService("loader"),r=()=>{o(),this.stores.projectStore.commitTreeAndSend()};if(!t)return r(),it;let i=t.prioritizeLoadingAllData({operationName:e.name,operationInBackground:!0,doNotTrack:e.doNotTrack}),s=t.afterAllDataLoaded(r);return()=>{i(),s()}}signalNonUserEvent(){this.isUserEdit=!1}};var Ge=m(g());Vn({enableFontStore:!0,fetchGoogleFontsList:Ni,fetchFontshareFontsList:Pi,fetchBuiltInFontsList:ki});async function sU(n,o){let e=new qo(o),{stores:{accessStore:t,sandboxStore:r,assetStore:i}}=e;await t.set(n),X("editorBarOnPageEditing")&&(r.loadSandbox(),Ui(i.assetMap),Oe.importFramerFonts(er),ci(),Object.assign(window,{engine:e,componentLoader:q})),Ei((0,Ge.jsx)(gr.Provider,{value:e,children:(0,Ge.jsx)(Ki,{forceDarkMode:!0,children:(0,Ge.jsx)(Wt,{mode:"onPageEditing",children:(0,Ge.jsxs)(ka,{children:[(0,Ge.jsx)(kl,{}),(0,Ge.jsx)(ba,{})]})})})}),document.getElementById("root"))}export{sU as renderEditorBar};
//# sourceMappingURL=https://app.framerstatic.com/render-VSN4AUWK.mjs.map
