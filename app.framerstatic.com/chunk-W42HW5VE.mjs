import{g as A,h as Ie,j as Ve}from"https://app.framerstatic.com/chunk-DTJW3CSW.mjs";import{$c as Re,Ac as Se,jb as he,pc as be}from"https://app.framerstatic.com/chunk-6YTQAM34.mjs";import{Bm as ye,Bt as ge,Fs as J,Lk as ue,Me as de,Nl as Q,Ok as j,Ol as fe,Rl as U,Sl as G,Uc as m,Yo as _,_c as se,_o as ve,am as P,bd as le,cm as me,dm as K,et as Ce,gd as ce,jc as D,qb as V,qc as z,ql as W,rl as q,u as R,uc as H,xs as $,yl as pe}from"https://app.framerstatic.com/chunk-ZK325ET3.mjs";import{q as ne}from"https://app.framerstatic.com/chunk-MM3XA4KU.mjs";import{a as B,b as O,d as I,e as M,f as ie,i as p,l as L,o as oe,r as ae}from"https://app.framerstatic.com/chunk-ZQUNXESX.mjs";import{t as re}from"https://app.framerstatic.com/chunk-GQILM44Y.mjs";import{a as f,b as S}from"https://app.framerstatic.com/chunk-WNSBRACC.mjs";import{a as te}from"https://app.framerstatic.com/chunk-LQILWJHN.mjs";import{j as N}from"https://app.framerstatic.com/chunk-AHQIRSXG.mjs";var Ae=re("initializeAssetResolver"),T,X;function Xe(e){if(T)throw new Error("initializeAssetResolver() should only be called once");return Ae.debug("initializeAssetResolver",{assetMap:e}),T=ne(te().userContent,e),X=e,T}function Ee(){if(T===void 0)throw new Error("getAssetResolver() should not be called before initializeAssetResolver()");return T}function Ye(){if(X===void 0)throw new Error("getCurrentAssetMapHash() should not be called before initializeAssetResolver()");let e=Ee(),t=X.hash;return{assetResolver:e,assetMapHash:t}}function Fe(){R.frame.addScope("is-hidden",1500),R.component.addScope("is-hidden",1500)}function De(){R.frame.removeScope("is-hidden"),R.component.removeScope("is-hidden")}function Y(e,t,n){if(p(e.hidden))return!1;if(B(e.hidden))return e.hidden;try{Fe();let s=e.hidden(t,n);return De(),s}catch{return De(),!1}}var Te=class{constructor(t){this.engine=t}async requestHiddenStateForComponentControls(t){let n=t.args,s=this.engine.tree,r={};return Object.entries(n).forEach(([i,{controlNames:a}])=>{let o=s.getNode(i);if(!o)return;f(ye(o),"Node is not a CanvasNode with control props (node.__class: ",o.__class,")");let c=o.getControlPropSourceIdentifier();f(c,"Cannot find component identifier for node");let l=V.reactComponentForIdentifier(c);if(!l||!l.properties)return;let u=a??Object.keys(l.properties),C=o.getResolvedControlPropValues(V);r[i]=xe(u,l,C)}),{hiddenControlsByNodeId:r}}async requestHiddenStateForActionControls(t){let{actionIdentifier:n,controlNames:s,actionProps:r}=t;f(n,"Fail to request hidden state for action controls: missing actionIdentifier");let i=V.componentForIdentifier(n);return{hiddenState:s.reduce((o,c)=>{let l=i?i.properties[c]:void 0;return l?(o[c]=Y(l,r,r),o):(o[c]=!1,o)},{})}}async requestHiddenStateForModuleControls(t){let n=V.reactComponentForIdentifier(t.moduleIdentifier);return n?.properties?{hiddenState:xe(t.controlNames??Object.keys(n.properties),n,t.moduleProps)}:{hiddenState:{}}}};function Z(e,t,n,s,r,i){let a=e+t;if(n){if(n.hidden&&(i[a]=Y(n,s,r)),n.type==="object"){let o=s[t];if(!M(o))return;for(let c in n.controls){let l=n.controls[c];Z(a+".",c,l,o,r,i)}}if(n.type==="array"&&n.control.type==="object"){let o=s[t];if(!ie(o))return;let c=o.length;for(let l=0;l<c;l++){let u=o[l];if(M(u))for(let C in u){let d=n.control.controls[C];Z(a+`[${l}].`,C,d,u,r,i)}}}}}function xe(e,t,n){let s={};for(let r of e){let i=t.properties[r];Z("",r,i,n,n,s)}return s}var ke=class{constructor(t){this.environment=t;N(this,"visibleRenderIds",new Set);N(this,"addedRenderIds",new Set);N(this,"removedRenderIds",new Set)}setVisible(t,n){f(this.environment==="sandbox","Setting data is only allowed in the sandbox.");let s=this.getVisible(t);n!==s&&(n?(this.visibleRenderIds.add(t),this.addedRenderIds.add(t),this.removedRenderIds.delete(t)):(this.visibleRenderIds.delete(t),this.removedRenderIds.add(t),this.addedRenderIds.delete(t)))}import(t){f(this.environment==="editor","Importing data is only allowed in the editor.");let n=new Set;for(let s of t.addedRenderIds)this.visibleRenderIds.add(s),n.add(s);for(let s of t.removedRenderIds)this.visibleRenderIds.delete(s),n.add(s);return n}getVisible(t){return this.visibleRenderIds.has(t)}export(){f(this.environment==="sandbox","No need to collect and send updates from within the editor.");let t=Array.from(this.addedRenderIds),n=Array.from(this.removedRenderIds);return this.addedRenderIds.clear(),this.removedRenderIds.clear(),{addedRenderIds:t,removedRenderIds:n}}};function Ne(e,t,n){if(!e||!le(e)){t.cache.parentDirected=void 0;return}t.cache.parentDirected=e.layout,ce(e)&&(t.cache.parentDirectedRowHeightFitContent=e.gridRowHeightType==="fit",t.cache.parentDirectedColumnCount=I(e.gridColumnCount)?e.gridColumnCount:void 0),m(e.stackDirection)&&n?t.cache.parentDirection=e.resolveValue("stackDirection")??se:t.cache.parentDirection=e.stackDirection??null,de(e)&&(t.cache.parentWidthType=e.widthType,t.cache.parentHeightType=e.heightType)}function Ct(e,t){Ne(e,t,!1)}function gt(e,t){Ne(e,t,!0)}function Rt(e,t){let n=K(e,{supportsStyles:!0}),s={},r=[],i=[],a=[],o=[];n.doc.descendants(d=>{if(W(d)){let y={blockStyles:d.attrs.blockStyles,inlineStyles:d.attrs.inlineStyles,textStylePreset:d.attrs.textStylePreset},v=s[d.attrs.tag]??[];v.push(y),s[d.attrs.tag]=v}if(q(d)){let y=!1,v=!1,h,b;for(let g of d.marks)y||=U(g),v||=G(g),pe(g)&&(b??=g.attrs),Q(g)&&r.push(g.attrs.linkStylePreset),fe(g)&&(h=g.attrs.inlineStyles);o.push(b),y&&i.push(h),v&&a.push(h)}});let c=K(t,{supportsStyles:!0}),l=c.tr,u=new Map;c.doc.descendants((d,y,v)=>{if(W(d)){let h=s[d.attrs.tag]??[],b=h.length>1?h.shift():h[0];b&&(u.set(d,b.inlineStyles),l.setNodeMarkup(y,d.type,{...d.attrs,...b}))}if(q(d)){let h=!1,b=!1,g=v?u.get(v):void 0;for(let k of d.marks)if(h||=U(k),b||=G(k),Q(k)){let Pe=r.length>1?r.shift():r[0];l.addMark(y,y+d.nodeSize,P.marks.link.create({...k.attrs,linkStylePreset:Pe}))}h&&(g=i.length>1?i.shift():i[0]),b&&(g=a.length>1?a.shift():a[0]),g&&l.addMark(y,y+d.nodeSize,P.marks.inlineStyles.create({inlineStyles:g}));let ee=o.length>1?o.shift():o[0];ee&&l.addMark(y,y+d.nodeSize,P.marks.backgroundMask.create(ee))}});let C=c.apply(l);return me(C.doc,!0)}function we(e){if(_(e))return e.type===void 0?e:{...e,type:void 0,value:Re(e.value)}}function Me(e,t){if(_(e))return e.type==="rich-text"?e:{...e,type:"rich-text",value:Se(t,e.value)}}function kt(e,t,n){switch(e){case"text":return we(t);case"rich-text":return Me(t,n);default:S(e)}}function ze(e){return e.originalid??e.id}function F(e,t,n){return f(t==="boolean","Unsupported enum output type:",t),B(e)||D(e)?n(e):{type:"LiteralValue",value:J(t,void 0)}}function He(e,t,n,s){function r(i){return D(i)?s(i):{type:"LiteralValue",value:i}}switch(f(z(e.name),`Transform is not a valid expression: ${e.name}`),e.name){case"contains":switch(n?.type){case"multicollectionreference":return{type:"BinaryOperation",operator:"in",left:r(e.value),right:t};default:return{type:"FunctionCall",functionName:"CONTAINS",arguments:[t,r(e.value)]}}case"startsWith":return{type:"FunctionCall",functionName:"STARTS_WITH",arguments:[t,r(e.value)]};case"endsWith":return{type:"FunctionCall",functionName:"ENDS_WITH",arguments:[t,r(e.value)]};case"equals":return{type:"BinaryOperation",operator:"==",left:t,right:r(e.value)};case"isSet":{let i={type:"BinaryOperation",operator:"!=",left:t,right:{type:"LiteralValue",value:null}};return n?.type==="multicollectionreference"||n?.type==="array"?{type:"BinaryOperation",operator:"and",left:i,right:{type:"BinaryOperation",operator:">",left:{type:"FunctionCall",functionName:"LENGTH",arguments:[t]},right:{type:"LiteralValue",value:0}}}:{type:"BinaryOperation",operator:"and",left:i,right:{type:"BinaryOperation",operator:"!=",left:t,right:{type:"LiteralValue",value:""}}}}case"greaterThan":return{type:"BinaryOperation",operator:">",left:t,right:r(e.value)};case"lessThan":return{type:"BinaryOperation",operator:"<",left:t,right:r(e.value)};case"negate":return{type:"UnaryOperation",operator:"not",value:t};case"toBoolean":return{type:"TypeCast",dataType:"BOOLEAN",value:t};case"isBefore":return{type:"BinaryOperation",operator:"<=",left:{type:"TypeCast",dataType:"DATE",value:t},right:{type:"TypeCast",dataType:"DATE",value:r(e.value)}};case"isAfter":return{type:"BinaryOperation",operator:">=",left:{type:"TypeCast",dataType:"DATE",value:t},right:{type:"TypeCast",dataType:"DATE",value:r(e.value)}};case"isBetweenDates":return{type:"BinaryOperation",operator:"and",left:{type:"BinaryOperation",operator:">=",left:{type:"TypeCast",dataType:"DATE",value:t},right:{type:"TypeCast",dataType:"DATE",value:r(e.start)}},right:{type:"BinaryOperation",operator:"<=",left:{type:"TypeCast",dataType:"DATE",value:t},right:{type:"TypeCast",dataType:"DATE",value:r(e.end)}}};case"isIncludedIn":return{type:"BinaryOperation",operator:"in",left:t,right:r(e.value)};case"convertFromEnum":{if(n?.type!=="enum")return{type:"LiteralValue",value:J(e.outputType,void 0)};let i=new Set,a=[];for(let o of e.cases)i.has(o.from)||n.options.includes(o.from)&&(i.add(o.from),a.push({type:"Condition",when:{type:"LiteralValue",value:o.from},then:F(o.to,e.outputType,r)}));return{type:"Case",value:t,conditions:a,else:F(e.default,e.outputType,r)}}case"convertFromString":{let i=new Set,a=[];for(let o of e.cases)i.has(o.from)||(i.add(o.from),a.push({type:"Condition",when:{type:"LiteralValue",value:o.from},then:F(o.to,e.outputType,r)}));return{type:"Case",value:t,conditions:a,else:F(e.default,e.outputType,r)}}default:S(e.name)}}function je(e,t,n,s,r,i){if(!e.collectionFilters)return;let a=e.collectionFilters.filters,o=e.collectionFiltersOperator??he,c;for(let{itemKey:l,transforms:u}of a){if(!l)continue;let C=t.get(l);if(!C||(n.add(l),C.type!=="boolean"&&u.length===0))continue;let d=u.some(v=>{if(!H(v.name)||!z(v.name))return!1;switch(v.name){case"convertFromEnum":case"convertFromString":case"endsWith":case"equals":case"greaterThan":case"isAfter":case"isBefore":case"isBetweenDates":case"isSet":case"lessThan":case"negate":case"startsWith":case"toBoolean":return!0;case"contains":case"isIncludedIn":return!D(v.value);default:S(v.name)}}),y=w(l,C,n,s,i,d);for(let v of u)H(v.name)&&(y=He(v,y,C,r));c=c?{type:"BinaryOperation",operator:o==="all"?"and":"or",left:c,right:y}:y}return c}function We(e,t,n,s,r,i){if(e.collectionOrder&&e.collectionOrder.length>0){let a=[];for(let{itemKey:o,direction:c}of e.collectionOrder){if(!o)continue;let l=t.get(o);if(!l)continue;let u=w(o,l,n,s,i);c==="desc"&&(u.direction="desc"),a.push(u)}return a}if(e.collectionFilters&&e.collectionFilters.filters.length===1){let a=e.collectionFilters.filters.at(0);if(f(a,"filter should exist"),a.itemKey){let o=t.get(a.itemKey),c=w(a.itemKey,o,n,s,i),l=qe(e,a.transforms,c,o,r);if(l)return[l]}}return e.collectionReverse?[{type:"Identifier",name:"index",collection:s,direction:"desc"}]:[]}function qe(e,t,n,s,r){if(t.length!==1||s?.type!=="collectionreference")return;let i=t[0];if(f(i,"Transform must exist"),i.name==="isIncludedIn"&&D(i.value))return{type:"FunctionCall",functionName:"INDEX_OF",arguments:[r(i.value),n],direction:e.collectionReverse?"desc":"asc"}}function Qe(e,t,n,s,r){let i={type:"Collection",data:r(e),alias:s},a=new Map;for(let o of n){let c=o.split(".");for(let l=1;l<c.length;l++){let u=c.slice(0,l).join("."),C=t.get(u);if(C?.type!=="collectionreference")continue;let d=C.dataIdentifier;a.set(u,d)}}for(let[o,c]of a){let[l,u]=Be(o,s);i={type:"LeftJoin",left:i,right:{type:"Collection",data:r(c),alias:o},constraint:{type:"BinaryOperation",operator:"==",left:{type:"Identifier",name:u,collection:l},right:{type:"Identifier",name:"id",collection:o}}}}return i}function Ue(e,t,n,s,r){let i=[];for(let a of t){if(Ce(a))continue;let o=e.get(a),c=w(a,o,n,s,r);(c.type!=="Identifier"||a!==c.name)&&(c.alias=a),i.push(c)}return i}function Ut(e,t,n,s,r){let i={},a=new Set,o=ze(e);e.collectionFilters&&(i.where=je(e,t,a,o,s,r));let c=We(e,t,a,o,s,r);c.length>0&&(i.orderBy=c),I(e.collectionStartOffset)&&(i.offset={type:"LiteralValue",value:e.collectionStartOffset}),I(e.collectionLimit)&&(i.limit={type:"LiteralValue",value:e.collectionLimit});let l=Ue(t,n,a,o,r);return{from:Qe(e.dataIdentifier,t,a,o,r),select:l,...i}}function w(e,t,n,s,r,i=!0){i&&t?.type==="collectionreference"&&!ge(e)&&(e+=".id"),n.add(e);let[a,o]=Be(e,s);return i&&t?.type==="multicollectionreference"?{type:"FunctionCall",functionName:"FLAT_ARRAY",arguments:[{type:"Select",from:{type:"Collection",data:r(t.dataIdentifier),alias:e},select:[{type:"Identifier",name:"id",collection:e}],where:{type:"BinaryOperation",operator:"in",left:{type:"Identifier",name:"id",collection:e},right:{type:"Identifier",name:o,collection:a}},orderBy:[{type:"FunctionCall",functionName:"INDEX_OF",arguments:[{type:"Identifier",name:o,collection:a},{type:"Identifier",name:"id",collection:e}]}]}]}:{type:"Identifier",name:o,collection:a}}function Be(e,t){let n=e.split(".");if(n.length===1)return[t,e];let s=n.slice(0,-1).join("."),r=n.slice(-1).join(".");return[s,r]}function Xt(e){let t=new Map;for(let n of e)n.type!=="divider"&&t.set(n.id,n);return t}function Ge(e,t,n,s,r,i){if(t.type!=="string"||O(n?.value))return;let a=s.get(e);if(a?.type!=="string"||a.fallbackValue!=="associatedVariable")return;let o=a.associatedStringVariable;if(oe(o))return;let c=i.getControlProp(o),l=r[o];if(p(l))return;let u=$(l,c);if(u?.type==="string")return u}function Yt(e,t,n,s,r){let i=r.getControlProp(e),o=Ge(e,t,i,n,s,r)??$(t,i);if(Ve(o))return o}function Oe({control:e,controlProp:t,resolvers:n,locale:s}){switch(t.type){case"array":{f(e.type==="array","Invalid control");let{value:r}=t;if(m(r))return;let i=r.map(a=>Oe({control:e.control,controlProp:a,resolvers:n,locale:s})??null);return{type:"array",value:i}}case"boolean":{let{value:r}=t;return m(r)?void 0:{type:"boolean",value:r}}case"collectionreference":{let{value:r}=t;return m(r)||p(r)?void 0:{type:"string",value:r}}case"color":{let{value:r}=t;if(m(r)||L(r))return;let i=n.resolveColor(r);return p(i)?void 0:{type:"color",value:i}}case"date":{f(e.type==="date","Invalid control");let{value:r}=t;if(m(r)||p(r))return;let i=new Date(r);return ae(i)?(e.displayTime||i.setUTCHours(0,0,0,0),{type:"date",value:i.toISOString()}):void 0}case"enum":{let{value:r}=t;return m(r)||p(r)?void 0:(f(O(r),"Enum is not a string"),{type:"enum",value:r})}case"file":{let{value:r}=t;if(m(r)||p(r))return;let i=n.resolveFile(r);return p(i)?void 0:{type:"file",value:i}}case"image":{let r=x(e,t.valueLocalized,s),i=r?.value??t.value;if(m(i)||p(i))return;let a=r?.imageFocalPoint??t,o=n.resolveImage(i,a);if(p(o))return;let l=x(e,t.altLocalized,s)?.value??t.alt;return{type:"responsiveimage",value:{...o,alt:l}}}case"link":{let r=j(t.value);if(ue(r)){let a=x(e,t.valueLocalized,s);a?.value&&(r=j(a.value))}if(m(r)||p(r))return;let i=n.resolveLink(r);return p(i)?void 0:{type:"link",value:i}}case"multicollectionreference":{let{value:r}=t;return m(r)||p(r)?void 0:{type:"array",value:r.map(i=>({type:"string",value:i}))}}case"number":{let{value:r}=t;return m(r)?void 0:{type:"number",value:r}}case"object":{f(e.type==="object","Invalid control");let{value:r}=t;if(m(r)||L(r))return;let i=be(e.controls,(a,o)=>{let c=r[a];return c?Oe({control:o,controlProp:c,resolvers:n,locale:s})??null:null});return ve(t)&&(i[A]={type:"string",value:t.id}),{type:"object",value:i}}case"richtext":{let i=x(e,t.valueLocalized,s)?.value??t.value;if(m(i)||Ie(i))return;let a=n.resolveRichTextPointer(i);return p(a)?void 0:{type:"richtext",value:a}}case"string":{let i=x(e,t.valueLocalized,s)?.value??t.value;return m(i)?void 0:{type:"string",value:i}}case"vectorsetitem":{let{value:r}=t;if(m(r)||p(r))return;let i=n.resolveVectorSetItemPointer(r);return p(i)?void 0:{type:"vectorsetitem",value:i}}default:}}function x(e,t,n){if(!(!t||!n||_e(e)))for(;n;){let r=t[n.id];if(r&&!L(r.value))return r;n=n.fallback}}function _e(e){return"preventLocalization"in e?e.preventLocalization??!1:!1}function Le(e,t=n=>n){switch(e.type){case"array":{let n=Le(e.control,t);return n.definitions[A]={type:t("string"),isNullable:!1},{type:t("array"),isNullable:!0,definition:n}}case"boolean":case"color":case"date":case"enum":case"file":case"link":case"number":case"richtext":case"string":return{type:t(e.type),isNullable:!0};case"collectionreference":return{type:t("string"),isNullable:!0};case"image":case"responsiveimage":return{type:t("responsiveimage"),isNullable:!0};case"multicollectionreference":return{type:t("array"),isNullable:!0,definition:{type:t("string"),isNullable:!0}};case"object":{let n=Object.entries(e.controls),s={};for(let[r,i]of n){let a=Le(i,t);a&&(s[r]=a)}return{type:t("object"),isNullable:!0,definitions:s}}case"vectorsetitem":return{type:t("vectorsetitem"),isNullable:!0};default:}}export{Te as a,ke as b,Xt as c,Yt as d,Oe as e,Le as f,Ct as g,gt as h,Rt as i,we as j,Me as k,kt as l,ze as m,Qe as n,Ue as o,Ut as p,Be as q,Xe as r,Ee as s,Ye as t};
//# sourceMappingURL=https://app.framerstatic.com/chunk-W42HW5VE.mjs.map
