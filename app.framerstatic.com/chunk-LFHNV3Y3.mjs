import{a as Rm,b as Im}from"https://app.framerstatic.com/chunk-PPD7JV62.mjs";import{d as fn,n as ym}from"https://app.framerstatic.com/chunk-MXONXJZS.mjs";import{e as ya}from"https://app.framerstatic.com/chunk-4AYVGW7R.mjs";import{a as Pm}from"https://app.framerstatic.com/chunk-WAFDZ45U.mjs";import{a as vm}from"https://app.framerstatic.com/chunk-IRXQYDZ2.mjs";import{a as Sm}from"https://app.framerstatic.com/chunk-YE25YANI.mjs";import{b as vA,c as mm}from"https://app.framerstatic.com/chunk-IDXTJXXX.mjs";import{a as Yj}from"https://app.framerstatic.com/chunk-D7MEQ7Y3.mjs";import{d as Ia}from"https://app.framerstatic.com/chunk-MSOVP7VS.mjs";import{e as km,g as ul,q as um}from"https://app.framerstatic.com/chunk-PCV272DA.mjs";import{a as Qs,b as Hd,c as Us,e as Em,f as fm,g as ih,h as zj,i as gm,k as hm,n as Fm}from"https://app.framerstatic.com/chunk-T54BTL7R.mjs";import{a as Wj}from"https://app.framerstatic.com/chunk-KRBJUBXO.mjs";import{a as Bm,d as Fa,g as gr,l as va}from"https://app.framerstatic.com/chunk-DTJW3CSW.mjs";import{$ as to,$a as Fu,A as ik,B as ak,Cb as rl,Cf as $r,E as Gt,Ee as ot,F as sk,Fa as Gk,Fc as $a,Fe as Uj,G as oa,H as oh,I as Ek,Ic as Du,J as fk,Kc as Nu,Kg as cm,Lc as xu,Ld as ga,M as na,Ma as fa,Md as Zu,N as O6,Nc as Ou,O as w6,Oa as el,Pa as fu,Pe as rm,Qa as $u,Ra as Bu,Rf as ha,Sc as wu,Ta as gu,Tc as Pt,U as $k,Ub as fe,Uc as mr,Ue as om,Ug as mn,V as et,Ve as Er,Vg as dm,We as nm,Wg as Ra,Xe as im,Ya as hu,Yg as pm,Za as Ru,_a as Iu,_e as am,a as nr,ab as Su,ac as vu,ad as Lu,af as al,ag as cl,bd as qu,bg as sm,cb as yu,cd as Ku,cg as un,dc as Tu,dd as Vu,dg as dl,e as C6,ec as Pu,ed as Ju,ef as fr,eg as lm,fc as Mu,fe as Am,gb as tl,gc as ol,gd as nl,ha as gk,ib as bu,ig as pl,ja as hk,jd as Qu,jf as sl,ka as Ik,ld as lo,m as An,md as Nj,ne as jm,p as T6,pa as on,q as P6,qd as Uu,r as ir,ra as nn,rd as Ba,s as M6,sa as ia,t as _6,u as en,v as D6,vd as Wu,w as N6,wd as zu,we as em,x as tn,xc as _u,xe as tm,y as Ao,yd as Xu,yf as ll,zd as Yu}from"https://app.framerstatic.com/chunk-6YTQAM34.mjs";import{e as or,g as Zo,h as b6,q as Gu,u as Cu,v as rt}from"https://app.framerstatic.com/chunk-AZP6OTDM.mjs";import{a as il,d as Hu}from"https://app.framerstatic.com/chunk-UJZ2TDVM.mjs";import{a as nh,f as fA}from"https://app.framerstatic.com/chunk-R57RKM33.mjs";import{Ee as kl}from"https://app.framerstatic.com/chunk-AAFAMNTF.mjs";import{a as fi,b as Qd,c as bm,d as ba,e as Ca,g as Cm,h as YA,i as Ta,l as $l,n as Xj}from"https://app.framerstatic.com/chunk-HHZD2RYV.mjs";import{a as En,b as Ga,c as Sa,d as Gm}from"https://app.framerstatic.com/chunk-RLD2AJHB.mjs";import{a as fl,b as Br}from"https://app.framerstatic.com/chunk-57S4664Q.mjs";import{m as Tm}from"https://app.framerstatic.com/chunk-7VTUJ2SW.mjs";import{$c as Qk,$e as au,$f as pu,Ab as ie,Ac as xk,Ag as pn,Bb as Fk,Bc as cn,Bd as ao,Bg as tt,C as yt,Cb as K6,Cc as U6,Dc as Ok,E as hj,Eb as vt,Ec as ro,Ed as Yk,Ef as Ij,F as rn,Fc as oo,Fd as Zk,Ff as Y6,Fg as kr,Gc as no,Hc as wk,Ib as Sk,Ic as Lk,Ie as ru,Jb as aa,Jc as qk,Je as ka,K as x6,Ka as Ct,Kb as V6,Kd as Au,Ke as ua,La as L6,Lb as yk,Le as ou,Lg as se,Me as ma,Nc as Kk,Oc as Vk,Pd as ju,Qb as bk,R as pk,Rc as me,Sa as sr,Sb as sa,Sc as W6,T as kk,Tc as yA,U as uk,Uc as ca,Uf as cu,V as mk,Vb as la,Ve as Ee,Wb as Ck,Wc as io,Wd as eu,Xb as vk,Xc as Jk,Xf as du,Yc as lr,Zc as Hk,_c as cr,a as ea,ah as uu,b as ok,bg as Z6,c as nk,db as Bk,df as su,dg as ku,e as jn,ec as Tk,fa as Dj,g as v6,gc as J6,ge as dn,hf as z6,hg as Al,hh as mu,ic as H6,id as Uk,ii as jl,jh as kn,k as CA,kg as so,l as jo,lf as lu,lh as Eu,o as ta,oc as Pk,od as Wk,p as ra,qb as q6,qc as ae,qi as ur,r as be,rd as da,rf as pr,sd as zk,se as pa,sf as Tt,ta as At,tb as Tj,tc as Q6,te as tu,uc as _k,v as eo,vb as Rk,vc as an,wc as sn,wd as Xk,xc as ln,xd as ve,xf as X6,y as St,yc as Dk,yg as _A,zc as Nk,zg as Ea}from"https://app.framerstatic.com/chunk-HMWS5X5Y.mjs";import{$c as F7,$j as ap,$m as fp,$n as yp,$t as Ce,Ad as tA,Ae as D7,Aj as Wo,An as f6,Ao as It,Ap as Np,Bd as ij,Be as N7,Bg as Ni,Bi as Qo,Bj as oe,Bn as Rp,Cb as Gi,Cd as re,Ch as Xt,Cj as sj,Cn as Ip,Co as Yi,Cs as Qp,Ct as rk,Db as qj,Dd as V,Dh as Bt,Dn as Fp,Ds as Up,Eb as wr,Ed as Hj,Eh as J7,Ej as RA,En as Gp,Eo as vp,Es as Wp,Fb as xo,Fd as dj,Fn as ht,Fq as Op,Fs as zp,Gb as l7,Gd as qr,Gi as Uo,Gn as gj,Gr as Yo,Gs as Xp,Hb as jj,Hd as Lo,He as x7,Hg as xi,Hi as Z7,Hn as Ui,Ho as Tp,Hs as Yp,Id as JA,Ii as Yt,In as Wi,Ip as xp,Is as Zp,Jb as ej,Jd as X,Jg as $t,Ji as Ap,Jj as op,Jn as Rt,Jp as Zi,Kb as gA,Kd as qo,Ke as zA,Kk as Vj,Ko as Pp,Lb as c7,Ld as Kr,Lg as Oi,Li as p6,Lm as ne,Lr as Ze,Mb as d7,Md as tj,Me as EA,Mj as Ur,Mq as Ft,N as nj,Nb as Oo,Nd as ue,Ne as s6,Nm as Xo,Ns as Ak,O as A6,Od as IA,Om as Ji,P as j6,Pd as Ko,Pt as OA,Q as aA,Qc as I7,Qd as kt,Qk as Qe,Qt as q,R as e7,Rm as jr,Rn as Sp,Sc as n6,Sj as np,Sp as B6,Sq as wp,Ss as jk,St as vj,Tb as p7,Tj as u6,To as Mp,U as Ri,Ub as Si,Uc as WA,Um as dA,Un as Xr,Uo as er,Ut as Rj,Vh as mj,Vq as Lp,Vt as B,W as t7,Wb as k7,Wd as G7,Wh as Ho,Wi as jp,Wj as ip,Wl as dp,Wp as g6,Wt as ar,X as L,Xb as yi,Xc as i6,Xd as S7,Xh as Ej,Xq as F6,Y as e6,Yc as Kj,Yi as k6,Yj as m6,Yl as E6,Yn as Yr,Ze as O7,Zm as zr,_b as u7,_d as Pi,_o as _p,_q as Aa,ad as Ci,ai as H7,aj as ep,au as bt,bb as i7,bc as wo,bd as Ie,bi as Q7,bj as Ki,c as Ws,cb as t6,ce as y7,ck as sp,cp as $6,d as Le,db as r6,dc as Wt,de as b7,di as U7,dj as He,dq as Xe,e as zs,eb as a7,ec as m7,ed as de,ee as C7,eg as zt,eh as K7,fb as o6,fd as pe,fe as Vr,fh as Jo,fi as wi,fu as lk,ga as bj,gc as Re,gd as vi,gi as W7,gm as Wr,gr as Ye,gs as Jp,gt as Zr,h as Ud,he as ut,hi as Li,hj as tp,hn as Se,hr as G6,ht as ja,ic as bi,ie as Jr,ii as d6,it as rr,jc as cA,je as v7,jl as Ue,jm as Zt,jp as Dp,k as Wd,kc as Jj,ke as mt,ki as VA,kq as ye,kr as qp,ku as ck,l as K,la as Ii,le as T7,li as Hr,lu as dk,m as PA,me as Mi,mh as V7,ml as cp,mr as S6,nc as $7,ne as P7,nk as lp,np as ze,nq as h6,om as Ar,on as $p,or as Kp,os as Hp,ot as ek,pe as _i,pm as pp,po as bp,qe as Et,qg as Bj,qm as kp,qo as zi,qt as tk,r as No,rc as B7,rd as Fe,re as ft,rg as Vo,ri as z7,rm as We,rn as Bp,ro as Xi,s as Xs,sb as s7,sc as g7,sd as Lr,sj as rp,sm as up,sp as tr,su as jt,td as mA,te as Di,ti as X7,tj as MA,tm as mp,tn as gp,tq as R6,tr as Vp,tu as dr,ua as Fi,uc as h7,ud as LA,ue as Ve,ug as w7,uj as aj,un as hp,vd as Ke,vi as Y7,vj as Vi,vn as Hi,vo as Qj,vr as y6,vu as nu,wd as ke,we as Ge,wi as HA,wj as Qr,wu as iu,xd as a6,xe as M7,xi as qi,xm as Ep,xo as Cp,ye as _7,yg as L7,ym as zo,yn as Qi,zc as R7,zd as Ti,ze as Je,zg as q7,zq as I6}from"https://app.framerstatic.com/chunk-ZK325ET3.mjs";import{s as E7,u as f7}from"https://app.framerstatic.com/chunk-MFZYGAHA.mjs";import{a as Mk}from"https://app.framerstatic.com/chunk-4I3XDWXC.mjs";import{a as Ut,b as Bi}from"https://app.framerstatic.com/chunk-4AQCMAAQ.mjs";import{a as $m,c as ml,d as El}from"https://app.framerstatic.com/chunk-CYNLX7FI.mjs";import{b as oj}from"https://app.framerstatic.com/chunk-AUNF3KWQ.mjs";import{H as XA,b as gi,d as zd,e as Ys,f as Xd,j as hi,l as Zs,n as Yd,o as Zd,p as A7,r as j7,u as l6,w as c6}from"https://app.framerstatic.com/chunk-MM3XA4KU.mjs";import{a as pt,b as _,d as Y,e as Lj,f as Aj,i as oA,j as te,k as o7,l as Cj,o as qe,q as n7}from"https://app.framerstatic.com/chunk-ZQUNXESX.mjs";import{Xd as gt,a as $i,b as Or,zc as r7}from"https://app.framerstatic.com/chunk-M7LXWNTO.mjs";import{f as $j}from"https://app.framerstatic.com/chunk-PFHOMMMY.mjs";import{a as dt,b as Kd,c as Vd,d as Jd,e as xr,g as Ei}from"https://app.framerstatic.com/chunk-72P4HPJP.mjs";import{c as Hs,f as we}from"https://app.framerstatic.com/chunk-WIUFUKXG.mjs";import{A as ce,B as KA,C as cj,E as ee,F as ki,G as Oe,H as ui,I as Ht,J as AA,K as wd,L as Nr,O as mi,P as Js,Q as Ld,R as ge,S as _o,T as Do,Y as he,a as _d,aa as qd,ba as Qt,e as Vs,i as Dd,k as SA,n as Nd,o as $e,q as xd,t as kA,x as Jt,y as je,z as Od}from"https://app.framerstatic.com/chunk-GQILM44Y.mjs";import{a as E,b as lA}from"https://app.framerstatic.com/chunk-WNSBRACC.mjs";import{a as Be}from"https://app.framerstatic.com/chunk-LQILWJHN.mjs";import{e as yj,j as R,k as eA,l as xA,m as hA,n as Mo,o as Ks}from"https://app.framerstatic.com/chunk-AHQIRSXG.mjs";var _m=yj(nh());var Dm=yj($i());var Wy=Dm.default.createContext("not-defined");var Mm={store_internal:2,store_browse:2,store_use_installed:2},Bl={},Pa=new _m.FramerTracking({sourceName:"framer-x",trackingURL:Be().events+"/track",verbose:window.localStorage&&window.localStorage.getItem("debug-metrics")==="active",addContext:j=>{for(let A in Bl)j[A]===void 0&&(j[A]=Bl[A])}}),ah;(t=>(t.init=function(r){let{appVersion:o,projectId:n}=r;Object.assign(Bl,{appVersion:o,projectId:n}),Pa.setUserId(r.userId)},t.push=function(r){let{name:o,type:n,...a}=r;r.type==="store_internal"?(delete a.action,Pa.track({type:"track",event:o,version:2,...a})):Pa.track({type:"track",event:n,version:Mm[n],name:o,...a})},t.pushEvent=function(r){let{event:o,...n}=r;Pa.track({...n,type:"track",event:o,version:Mm[o]})}))(ah||={});var sh=new Set(wo({fillImageLocalized:!0,formInputPlaceholderLocalized:!0,htmlLocalized:!0,altAttributeLocalized:!0,titleLocalized:!0,descriptionLocalized:!0,linkLocalized:!0}));function gl(j){return sh.has(j)}function Ma(j){return j.map(A=>Lj(A)?_a(A):Aj(A)?Ma(A):A)}function lh(j){return j.endsWith("Localized")}function _a(j){let A={};for(let e in j){if(lh(e))continue;let t=j[e];Lj(t)?A[e]=_a(t):Aj(t)?A[e]=Ma(t):A[e]=t}return A}function eb(j){let A={};for(let e in j){if(gl(e))continue;if(!d6(e)){A[e]=j[e];continue}let t=j[e];Lj(t)?A[e]=_a(t):Aj(t)?A[e]=Ma(t):A[e]=t}return A}function Nm(j){let A={};for(let e in j){if(gl(e))continue;if(!d6(e)){A[e]=j[e];continue}let t=j[e];Lj(t)?A[e]=_a(t):Aj(t)?A[e]=Ma(t):A[e]=t}return A}var{onewayMethodTemplate:mb,voidMethodTemplate:xm,valueMethodTemplate:hl,streamMethodTemplate:Eb}=Ei,Rl;(A=>A.service={id:"__ElectronWebRendering__",fingerprint:"55e7a2685b81eb6008c3d91a35ec44f1",methods:{collectMetrics:{},openSaveDialog:{},willOpenWindow:{},writeToClipboard:{},writeToDisk:{}},newOutgoingWrapper:e=>({collectMetrics:hl.bind(-1,"collectMetrics",!1,e),openSaveDialog:hl.bind(-1,"openSaveDialog",!0,e),willOpenWindow:hl.bind(-1,"willOpenWindow",!0,e),writeToClipboard:xm.bind(-1,"writeToClipboard",!0,e),writeToDisk:xm.bind(-1,"writeToDisk",!0,e)})})(Rl||={});var Il;(t=>{t.service=Rl.service;function A(r){let o=dt.shared();return{expect:()=>o.expectWithoutDiscovery(t.service,r),discover:n=>o.discover(t.service,r,n),register:n=>o.register({channel:r,service:t.service,implementation:n})}}t.on=A;async function e(r){dt.shared().unregister(r)}t.unregister=e})(Il||={});var{onewayMethodTemplate:Mb,voidMethodTemplate:Om,valueMethodTemplate:Da,streamMethodTemplate:_b}=Ei,Fl;(A=>A.service={id:"__ElectronWebRenderingV2__",fingerprint:"6c902a5850607b51714e2b27dafbde81",methods:{collectMetrics:{},openSaveDialog:{},willOpenWindow:{},writeToClipboard:{},writeToDisk:{},getImageData:{}},newOutgoingWrapper:e=>({collectMetrics:Da.bind(-1,"collectMetrics",!1,e),openSaveDialog:Da.bind(-1,"openSaveDialog",!0,e),willOpenWindow:Da.bind(-1,"willOpenWindow",!0,e),writeToClipboard:Om.bind(-1,"writeToClipboard",!0,e),writeToDisk:Om.bind(-1,"writeToDisk",!0,e),getImageData:Da.bind(-1,"getImageData",!0,e)})})(Fl||={});var Gl;(t=>{t.service=Fl.service;function A(r){let o=dt.shared();return{expect:()=>o.expectWithoutDiscovery(t.service,r),discover:n=>o.discover(t.service,r,n),register:n=>o.register({channel:r,service:t.service,implementation:n})}}t.on=A;async function e(r){dt.shared().unregister(r)}t.unregister=e})(Gl||={});function Kb(j,A){if(!j||j.changes.length===0)return!1;for(let e of j.changes){let t=A.get(e.id);if(!S7(t)&&!G7(t)&&!(!t&&e.added==="RedirectRouteNode"))return!1}return!0}function wm(j,A){if(!j||j.changes.length===0)return!1;for(let e of j.changes){let t=A.get(e.id);return!t||!Ye(t)?!1:"variables"in e.from}return!0}function Lm(j,A){if(!j||j.changes.length===0)return!1;for(let e of j.changes){let t=A.get(e.id);if(!Lr(t))return!1;let r="locales";return!!(r in e.from||e.from._deleted?.includes(r))}return!0}var dh=kA("EngineChanges");var qm=class{constructor(){R(this,"changes",new Set);R(this,"addChanges",(...A)=>{for(let e of A)this.changes.add(e)});R(this,"changeObserverFlags",[]);R(this,"changeObservers",[]);R(this,"inSignalAllObservers",!1);R(this,"observersToRemove",[])}get flags(){return this.changes}has(...A){for(let e of A)if(this.changes.has(e))return!0;return!1}observe(...A){let e=A.pop(),t=A;return $j.isDebugBuild&&t.some(r=>r===void 0)&&dh.warn("changes.observe was called with undefined as one of the flags. It might be caused by observing a store that hasn't been instantiated yet."),this.changeObserverFlags.push(t),this.changeObservers.push(e),e}observeWithComponent(A,e,t){this.changeObserverFlags.push(A);let r=()=>{$j.benchmarkSkipRendering||e.setState(t())};return this.changeObservers.push(r),r}removeObserver(A){if(this.inSignalAllObservers){this.observersToRemove.push(A);return}let e=this.changeObservers.indexOf(A);e!==-1&&(this.changeObserverFlags.splice(e,1),this.changeObservers.splice(e,1))}signalAllObservers(){if(!this.changes)return;let A=this.changes,e=this.changeObserverFlags,t=this.changeObservers;this.inSignalAllObservers=!0;for(let r=0;r<e.length;r++){let o=e[r];for(let n of o)if(A.has(n)){t[r]();break}}if(this.inSignalAllObservers=!1,this.observersToRemove.length>0){for(let r of this.observersToRemove)this.removeObserver(r);this.observersToRemove.length=0}this.changes.clear()}signalObserversFor(...A){let e=new Set(A),t=this.changeObserverFlags,r=this.changeObservers;for(let o=0;o<t.length;o++){let n=t[o];for(let a of n)if(e.has(a)){r[o]();break}}e.forEach(o=>this.changes.delete(o))}};function Sl(j){return j.userIsViewer?ul:$j.isAutomation||$j.isTest?km:j.acl.find(e=>e.user.id===j.userId)?.permissions??ul}var $n=class{constructor(A){this.aclPermissions=A}get canDesign(){return this.aclPermissions.canDesign==="on"}get canEditContent(){return this.aclPermissions.canEditContent==="on"}get canPublish(){return this.aclPermissions.canPublish==="on"}get canEditSiteSettings(){return this.canDesign&&this.canEditContent&&this.canPublish}get canPublishToStaging(){return this.canDesign||this.canEditContent||this.canPublish}get canInviteCollaborators(){return this.canDesign||this.canEditContent||this.canPublish}get canEditVariables(){return this.canDesign}get canAddCollections(){return this.canDesign}get canEditAnalytics(){return this.canDesign||this.canEditContent}get canEditLocales(){return this.canDesign}get canEditLocalizedValues(){return this.canEditContent}get canSendDiffs(){return this.canDesign||this.canEditContent}},jC=tp({canDesign:"Design",canEditContent:"Content",canPublish:"Deploy",canEditSiteSettings:"Design and Content and Deploy",canPublishToStaging:"Design or Content or Deploy",canInviteCollaborators:"Design or Content or Deploy",canEditVariables:"Design",canAddCollections:"Design",canEditAnalytics:"Design or Content",canEditLocales:"Design",canEditLocalizedValues:"Content",canSendDiffs:"Design or Content"});function eC(j){let A=Sl(j);return new $n(A)}var yl=j=>[j.stores.chromeStore,j.stores.projectStore,j.stores.sessionStore],Na=([j,A,e])=>({userIsViewer:j.userIsViewer,acl:A.acl,userId:e.user.id});function tC(j,A,{signal:e}){let t=yl(j),r=Na(t),o=j.changes.observe(...t,()=>{let n=Na(t);Re(r,n)||(r=n,A(n))});e.addEventListener("abort",()=>{j.changes.removeObserver(o)},{once:!0})}function iC(){let j=Qu();return E(bl(j),"Expected OnPageEngine"),j}function bl(j){return j.name==="OnPageEngine"}var Km=j=>[j.stores.loadingStore,...yl(j)],Cl=([j,...A])=>({isReady:j.isReady,...Na(A)});function ph(j,A){if(!j.isReady||j.userIsViewer)return!0;let e=Sl(j);return!new $n(e)[A]}function Bn(j,A){return lo(j)?ph(Cl(Km(j)),A):!bl(j)}function pC(j,A,{signal:e}){let t=Km(j),r=Cl(t),o=j.changes.observe(...t,()=>{let n=Cl(t);Re(r,n)||(r=n,A(n))});e.addEventListener("abort",()=>{j.changes.removeObserver(o)},{once:!0})}var kh={track:!0};function Vm(j){let A={...j,event:"canvas_page_add"};oj(A,kh)}var uh={track:!0};function Jm(j){let A={...j,event:"canvas_page_select"};oj(A,uh)}var mh={track:!0};function Hm(j){let A={...j,event:"component_canvas_create"};oj(A,mh)}var Eh={track:!0};function Qm(j){let A={...j,event:"component_canvas_enter"};oj(A,Eh)}var fh={track:!0};function Um(j){let A={...j,event:"component_canvas_variant_create"};oj(A,fh)}var $h={track:!0};function vl(j){let A={...j,event:"component_design_instance"};oj(A,$h)}var Bh={track:!0};function Tl(j){let A={...j,event:"export_bitmap"};oj(A,Bh)}var gh={track:!0};function Wm(j){let A={...j,event:"external_component_insert"};oj(A,gh)}var hh={track:!0};function zm(j){let A={...j,event:"property_layout_update"};oj(A,hh)}var Rh={track:!0};function Xm(j){let A={...j,event:"variable_reference_create"};oj(A,Rh)}var Ym=class extends ae{constructor(e,t){super();this.addChanges=e;this.effectsStore=t;R(this,"update",0);R(this,"tooltip");R(this,"shapeToolActive",!1);R(this,"feedbackModeActive",!1);R(this,"handle",null);R(this,"straightLineAnchorIndex",0);R(this,"proseMirrorView",null);R(this,"proseMirrorState",null);R(this,"textLink",null);R(this,"editedTextLink");R(this,"stackInsertionIndicator",null);R(this,"replaceableFloatingPositionNode",null);R(this,"activeTool",0);R(this,"nodeInTextEditor",mj);R(this,"nodeInPathEditorOffset",null);R(this,"dragAndDropPlaceholders",null);R(this,"codeComponentInProgressInsertionIndicatorNodeIDs",new Set)}get tool(){return this.activeTool}postProcess(e){this.update=e}get isDefaultToolActive(){return this.tool===0||this.tool===1}updateDragAndDropPlaceholder(e){if(e){let t=e.cache.placeholders,r=t?{id:e.id,placeholders:t}:null;if(Fi(r,this.dragAndDropPlaceholders))return;this.dragAndDropPlaceholders=r}else this.dragAndDropPlaceholders=null}setTool(e){rn.canEditTree(e)&&e!==6&&this.effectsStore.exitPreview(),this.shapeToolActive=Fh(e),Gh(e)||(this.feedbackModeActive=!1),this.tool===6&&e!==6&&this.addChanges("ExitMove"),this.tool!==e&&this.addChanges("Tool"),this.activeTool=e}};function Ih(j){switch(j){case 21:case 10:case 22:case 24:case 23:case 12:case 11:case 20:case 13:case 19:case 14:case 45:case 29:case 39:case 44:case 27:case 38:case 28:case 25:return!1;case 40:case 41:case 15:case 17:case 16:case 18:case 1:case 36:case 32:case 42:case 0:case 43:case 9:case 37:case 6:case 30:case 3:case 33:case 35:case 7:case 26:case 8:case 34:case 46:case 2:case 47:case 31:case 4:case 5:return!0;default:lA(j)}}function Fh(j){switch(j){case 40:case 41:case 21:case 10:case 22:case 24:case 23:case 12:case 11:case 20:case 13:case 19:case 14:case 45:case 1:case 36:case 32:case 42:case 0:case 43:case 39:case 44:case 37:case 6:case 30:case 3:case 35:case 7:case 26:case 27:case 28:case 29:case 8:case 34:case 46:case 2:case 38:case 25:case 47:case 31:case 4:case 5:return!1;case 15:case 17:case 16:case 18:case 9:case 33:return!0;default:lA(j)}}function Gh(j){switch(j){case 40:case 41:case 3:case 4:case 5:return!0;case 0:case 1:case 2:case 6:case 7:case 46:case 8:case 9:case 10:case 11:case 12:case 45:case 13:case 14:case 15:case 16:case 17:case 18:case 19:case 20:case 21:case 22:case 24:case 23:case 25:case 26:case 27:case 28:case 29:case 30:case 32:case 33:case 34:case 35:case 36:case 37:case 38:case 39:case 42:case 47:case 31:case 43:case 44:return!1;default:lA(j)}}function KC(j){switch(j){case 4:case 5:return!0;case 0:case 1:case 2:case 3:case 6:case 7:case 46:case 8:case 9:case 10:case 11:case 12:case 45:case 13:case 14:case 15:case 16:case 17:case 18:case 19:case 20:case 21:case 22:case 24:case 23:case 25:case 26:case 27:case 28:case 29:case 30:case 32:case 33:case 34:case 35:case 36:case 37:case 38:case 39:case 40:case 41:case 42:case 47:case 31:case 43:case 44:return!1;default:lA(j)}}function jE(j){switch(j){case 0:case 1:case 2:case 3:case 4:case 5:case 6:case 40:case 41:case 47:case 44:return!0;case 7:case 46:case 8:case 9:case 10:case 11:case 12:case 45:case 13:case 14:case 15:case 16:case 17:case 18:case 19:case 20:case 21:case 22:case 24:case 23:case 25:case 26:case 27:case 28:case 29:case 30:case 32:case 33:case 34:case 35:case 36:case 37:case 38:case 39:case 42:case 31:case 43:return!1;default:lA(j)}}function VC(j){switch(j){case 3:case 4:case 44:return!0;case 5:case 6:case 0:case 1:case 2:case 40:case 41:case 47:case 7:case 46:case 8:case 9:case 10:case 11:case 12:case 45:case 13:case 14:case 15:case 16:case 17:case 18:case 19:case 20:case 21:case 22:case 24:case 23:case 25:case 26:case 27:case 28:case 29:case 30:case 32:case 33:case 34:case 35:case 36:case 37:case 38:case 39:case 42:case 31:case 43:return!1;default:lA(j)}}function eE(j){switch(j){case 0:case 1:case 2:case 3:case 4:case 5:case 6:case 47:return!0;case 40:case 41:case 7:case 46:case 8:case 9:case 10:case 11:case 12:case 45:case 13:case 14:case 15:case 16:case 17:case 18:case 19:case 20:case 21:case 22:case 24:case 23:case 25:case 26:case 27:case 28:case 29:case 30:case 32:case 33:case 34:case 35:case 36:case 37:case 38:case 39:case 42:case 31:case 43:case 44:return!1;default:lA(j)}}function JC(j,A){return j.stores.historyStore.isLoadingDocument?A===44:Bn(j,"canDesign")?jE(A):j.stores.chromeStore.isPreviewingFeaturedTemplate?eE(A):!0}function HC(j,A){return A==="VectorSet"?Ih(j):!(A==="WebPage"&&j===39)}function QC(j,A){if(Bn(j,"canDesign")&&!jE(A))throw Error("Viewer mode: Tool "+A+" is a forbidden action.");if(j.stores.chromeStore.isPreviewingFeaturedTemplate&&!eE(A))throw Error("Previwing template mode: Tool "+A+" is a forbidden action.")}var UC=j=>j===20||j===21||j===22||j===24||j===23||j===19;function WC(j){return j===8||j===7||j===46||j===30||j===32}var Sh={0:!0,1:!0,2:!0,3:!0,4:!0,6:!0,5:!0};function ZC(j){return Y(j)&&Sh[j]===!0}var Pl=new Map;function jv(j,A){Pl.set(j,A)}function ev(j){Pl.delete(j)}function tE(j){Pl.get(j)?.()}var yh="__page_input";function bh(j){return`${yh}_${j}`}function xa(j){let A=bh(j);tE(A)}function Oa(j){return tA(j)||V(j)}async function rE({messages:j,model:A,schema:e,signal:t}){let r=await Ia.post("/ai/v2/chat/",{model:A,messages:j,response_format:{type:"json_schema",json_schema:{strict:!0,name:"schema",schema:e}}},t);try{return JSON.parse(r?.choices?.[0]?.message?.content??"")}catch(o){throw new Error(`Could not process JSON response: ${o}`,{cause:r})}}function gn(j,A){if(oA(j))return j;let e=[];for(let t of j)e.push(A.get(t)??t);return e.length>0?e:void 0}function Pe(j,A){if(!sj(A))return null;let e=j.getNode(A.originalid);return E(e,"The original variant node should exist"),e}function Ch(j,A,e){let t=dA.inheritedReplicaNode(j,A.replicaInfo.inheritsFrom),r=jr(A.replicaInfo.overrides,t?.replicaInfo.overrides);for(let o of e.walk()){let n=r[o.id];if(!n)continue;let{_deleted:a,itemsOrder:i,...s}=n;a?.forEach(l=>s[l]=void 0),j.current(o)?.set(s)}}function oE(j,A){let e=j.getNode(A.originalid),t=dA.getReplicaForTemplateNode(j,A);if(!e||!t||!MA(t))return[];if(!t.replicaInfo.inheritsFrom)return[e];let r=j.getNode(t.replicaInfo.inheritsFrom);if(!r)return[e];let o=ne(r.id,e.id),n=j.getNode(o);return n?[e,n]:[e]}function gv(j,A,e,t){let r=dA.getReplicaForTemplateNode(j.tree,A);E(r,"replica should exist when moving node out of replica"),E(MA(r),"replica must be a variant"),Ch(j.tree,r,e),A.isVisible()&&!e.isVisible()&&j.tree.current(e)?.set({visible:!0}),t.delete(A.id),t.add(e.id)}function hn(j,A,e,t,r){if(!e||!t)return A.id;E(gA(e),"Fail to update variant nodes: parent must be a replica");let o=dA.getReplicaForTemplateNode(j.tree,e);if(E(o,"Fail to update variant nodes: replica should exist"),E(MA(o),"Fail to update variant nodes: replica must be an variant"),Yi(j.tree,e)){j.tree.current(A)?.set({visible:!1});let a={visible:!0};er(A)&&r&&(a.itemsOrder=gn(A.itemsOrder,r)),mn(j.tree,o,A.id,a)}return ne(o.id,A.id)}function Ml(j,A,e,t,r,o){let n=hn(j,A,e,t,o);return r.delete(A.id),r.add(n),n}function hv(j,A,e){let t=oE(j.tree,A),r=oE(j.tree,e),o=t.find((n,a)=>!n.isVisible()||n.cache.visible===!0?!1:r[a]?.cache.visible??!1);o&&(j.tree.get(o.id)?.set({visible:!1}),A.set({visible:!0},j.tree,!0))}function nE(j,A,e){It(j.tree,A).forEach(({replicaRoot:t})=>{if(Object.keys(t.replicaInfo.overrides).every(i=>!e.has(i)))return;let n={...t.replicaInfo},a={...n.overrides};n.overrides=a,e.forEach((i,s)=>{if(s in a){let l={...a[s]},d=l.itemsOrder;"itemsOrder"in l&&Array.isArray(d)&&(l.itemsOrder=gn(d,e)),a[i]=Nm(l)}}),j.tree.get(t.id)?.set({replicaInfo:n})})}function iE(j,A,e){return pt(e)?e:EA(A)?A.constraintsLocked:!1}function Kv(j,A,e,t){let r=j.tree,o={x:Math.round(e.x-t.width/2),y:Math.round(e.y-t.height/2)},n=r.getNode(A);if(!A||!n)return{left:o.x,top:o.y};let a=bp(j.tree,A),i=a?j.tree.getViewportRect(a):null,s=r.getRect(n),l=r.convertPointToNode(n,o),d={x:l.x,y:l.y,width:t.width,height:t.height},p=d.width/d.height,k=J6(d,{sizing:s,positioning:s,viewport:i,layout:Fe(n)},null,{aspectRatio:p,shouldGuessPinToBottom:ot(r,null,n),shouldGuessPinToRight:Uj(r,null,n)});return k.aspectRatio=p,k}var _l=(j,A,e,t)=>{let r=A.getGroundNodes().map(o=>j.getRect(o));return t!==void 0&&r.push(...t),r.find(o=>L.intersects(e,o))===void 0},vh=(j,A,e,t,r)=>{let o=A.getGroundNodes().map(i=>j.getRect(i));t!==void 0&&o.push(...t);let a=o.sort((i,s)=>L.maxX(i)>L.maxX(s)?-1:1)[0];return a!==void 0?xl(a,e,r):null},Th=(j,A,e,t,r)=>{let o=A.getGroundNodes().map(s=>j.getRect(s));t!==void 0&&o.push(...t);let i=o.filter(s=>s.width===e.width&&s.height===e.height||s.height===e.width&&s.width===e.height).sort((s,l)=>L.maxX(s)>L.maxX(l)?-1:1)[0];return i!==void 0?xl(i,e,r):null},Ph=(j,A,e)=>A.map(t=>j.getNode(t)).filter(t=>Ni.equals(t.rect(null),e));function Nl({tree:j,activeScope:A,node:e,size:t,filledRects:r,offsetDistance:o}){let n={...j.getRect(e),...t},a=A.getGroundNodes().map(l=>l.rect());r&&a.push(...r);let i=n,s=0;for(;i;){if(oA(o.x)||(n.x=Dl("x",i,o.x)),oA(o.y)||(n.y=Dl("y",i,o.y)),i=a.find(l=>L.intersects(l,n)),s>a.length)return n;s++}return n}var sE=(j,A,e,t,r={x:100,y:void 0},o)=>Nl({tree:j,activeScope:A,node:e,size:t,filledRects:o,offsetDistance:r}),Rn=(j,A,e,t,r=100,o)=>Nl({tree:j,activeScope:A,node:e,size:t,filledRects:o,offsetDistance:{x:r}}),Vv=(j,A,e,t,r=100,o)=>Nl({tree:j,activeScope:A,node:e,size:t,filledRects:o,offsetDistance:{y:r}});function Dl(j,A,e){return(j==="x"?L.maxX:L.maxY)(A)+e}function xl(j,A,e=100){return{...j,x:Dl("x",j,e),...A}}var Mh=(j,A,e,t,r,o,n)=>{if(o){let s=j.getNode(o);if(s)return Rn(j,A,s,e,n,r)}if(t){let s=Ph(j,t,e);if(s.length){let d=s.map(k=>xl(k.rect(),e,n)).find(k=>_l(j,A,k,r));if(d)return d;let p=s[0];return E(p,"Equal frame must be defined"),Rn(j,A,p,e,n,r)}}let a=Th(j,A,e,r,n);if(a!==null&&_l(j,A,a,r))return a;let i=vh(j,A,e,r,n);return i!==null&&_l(j,A,i,r)?i:{...e,x:0,y:0}},Jv=(j,A,e,t,r)=>{let o=j.getRect(e),n=j.getParent(e.id),a;IA(e)&&(a=Math.min(o.width,100));let i=Mh(j,A,o,t,r,e.id,a);return r.push(i),J6(i,null,ht(e)?Rt(e):null,{shouldGuessPinToBottom:!0,shouldGuessPinToRight:Uj(j,e,n)})},Hv=(j,A,e,t)=>{if(e.length>0){let r=e[e.length-1],o=j.getGroundFrameAncestor(r,!0);if(o)return o.id}for(let r of j.sortVisually(j.getNodesAtPoint(A,t)).reverse())if(r instanceof fe&&j.getParent(r.id)===mj){if(gA(r))continue;return r.id}return mj},Qv=(j,A,e)=>{let r=j.tree.newId(),o={top:A.y,left:A.x,width:A.width,height:A.height,overflow:ye(),isScreen:!0};return o.framePreset=e,j.createFrame(mj,{id:r,...o}),r},Uv=(j,A)=>{let e=j.tree,t=e.newId(),r={top:A.y,left:A.x,width:A.width,height:A.height,overflow:ye(),isScreen:!0};return j.createFrame(mj,{id:t,...r}),j.stores.scopeStore.active.getGroundNodes(n=>{let a=e.getRect(n);return n.id!==t&&L.containsRect(A,a)}).forEach(n=>{let a=e.getParent(n.id),i=e.getRect(n),s=L.offset(i,aA.reverse(A));j.moveNode(n.id,t),j.tree.current(n)?.set(n.updateForRect({rect:s,parentSizeInfo:{sizing:A,positioning:A,viewport:null,layout:Fe(a)},constraintsLocked:iE(j,n),shouldGuessPinToBottom:!0,shouldGuessPinToRight:Uj(j.tree,n,a)}))}),t},aE=["#9ef","#4cf","#3af","#38f","#26f"],Wv=(()=>{let j=-1,A=aE.length;return()=>(j++,aE[j%A])})();var _h={type:{type:No.type,value:Xs.type},variantId:{type:No.variantId,value:void 0},pauseOffscreen:{type:No.pauseOffscreen,value:Xs.pauseOffscreen}},rT={type:"type",variantId:"variantId",pauseOffscreen:"pauseOffscreen"},Dh={cycle:!0,set:!0};function oT(j){return _(j)&&j in Dh}function Me(j){return Hi(j)&&j.actionIdentifier==="framer/useSetVariant"}function lE(j){return j.controls.type?.value!=="set"?null:j.controls.variantId?.value??null}function nT(j){return Array.isArray(j)&&j.some(Me)}function iT(j){return Array.isArray(j)&&j.some(A=>Me(A)&&A.controls.type?.value==="set"&&!A.controls.variantId?.value)}function aT(j,A){return hp(j,Me,A)}function sT(j,A,e){let t=gp(A,Me,e),r=[];return t.forEach(o=>{switch(o.controls.type?.value){case"set":{let a=o.controls.variantId?.value;a&&r.push(a);break}case"cycle":{let a=j.getScopeNodeFor(A);if(!tA(a))return;let i=a.getTopLevelVariants();if(i.length<=1)return;let s=j.getGroundNodeFor(A),l=i.findIndex(g=>g.id===s.id);if(l===-1)return;let d=l+1,p=d>=i.length?0:d,k=i[p];k&&r.push(k.id);break}}}),r}function lT(j){let A={};return Object.entries(j).forEach(([e,t])=>{A[e]=t?.value}),A}function Nh(j,A){return!(j?.inputValue!==A?.inputValue||j?.delay!==A?.delay||j?.key!==A?.key)}function cT(j,A,e){let t=Array.isArray(j)?[...j]:[],r=t.findIndex(Me),o=t[r];if(Me(o)&&Nh(o.meta,e)){let n={...o.controls,...cE(A)},a={...o,controls:n,meta:{...o.meta,...e}};t[r]=a}else{let n=xh(A,void 0,e);t.push(n)}return t}function cE(j){let A={};return Object.entries(j).forEach(([e,t])=>{A[e]={type:No[e],value:t}}),A}function xh(j,A,e){let t=cE({...j}),r={identifier:A||gt(),actionIdentifier:"framer/useSetVariant",controls:{..._h,...t}};return e&&Object.assign(r,{meta:e}),r}function dT(j,A){let e={...j.controls,...A};return{...j,controls:e}}function dE(j,A){let e=A.get(j);return Pi(e)?e:null}function Ol(j,A,e="transparent"){if(oA(j))return e;if(!He(j))return j;let t=Ki(j);return(t?dE(t,A):null)?.light??e}function hr(j,A,e,t=!1){if(ak(A)){j.has(A)||j.ensureEntityTypeRootNode(A);return}let r=t?ia(e):nn(e);if(j.has(r))return;let o=new on({id:r});j.insertNode(o,A)}function Oh(j,A){let e=j.tree.get(A);if(Cj(e))return;let t=j.tree.get(e.parentid);if(!Cj(t))return t.children?.findIndex(r=>r.id===A)}function IT(j,A,e){let t=j.tree.getEntityReferenceNode(A);if(Cj(t))return;let r=nn(e),o=new on({id:r}),n=Oh(j,t.id),a=te(n)?n+1:void 0;j.tree.insertNode(o,t.parentid,a)}function FT(j,A){let e=j.tree.get(A);Cj(e)||(j.tree.removeNode(e),wh(j,A))}function wh(j,A,e){let{isCodeFile:t=!1}=e??{},r=t?ia(A):nn(A);j.tree.remove(r)}function wa(j,A){return j===ir?ia(A):nn(A)}function Lh(j){return A=>Ge(A)&&A.name===j}function pE(j,A){return j.children.find(Lh(A))??null}var qh=/\s*\/\s*/g,Kh=/\/+/g,Vh=/^\/+|\/+$/g;function kE(j){let A=j.trim();return A?A.replace(qh,"/").replace(Kh,"/").replace(Vh,""):""}function NT(j,A){return j.children.find(e=>Ge(e)&&e.getName()===A)??null}function wl(j){let A=kE(j);return A===""?[]:A.split("/")}function xT(j,A){let t=Qh(j.tree,A).map(n=>j.tree.get(n));E(t.length>0,"unreferenced nodes parent node must exist");let r=t.flatMap(n=>n?.children??[]);if(!r||r.length===0)return;let o=Jh[A];j.tree.beginAllowPartialScopeAccess();for(let n of r){if(!o(n))continue;let a=wa(A,n.id);if(j.tree.get(a))continue;let i=new on({id:a});j.tree.insertNode(i,A)}j.tree.endAllowPartialScopeAccess()}var Jh={[T6]:j=>P7(j),[M6]:j=>Et(j),[D6]:j=>mt(j),[N6]:j=>Jr(j),[P6]:j=>_i(j)||Mi(j)||Vr(j),[ir]:j=>vt(j)&&j.save.type==="codeFile",[en]:j=>tA(j)||vt(j),[_6]:j=>Pi(j),[tn]:j=>ij(j),[Ao]:j=>re(j)},Hh={[T6]:Pt,[M6]:Pt,[D6]:Pt,[N6]:Pt,[P6]:Pt,[ir]:ie,[_6]:fa};function Qh(j,A){return A===tn||A===Ao?[j.root.id]:A===en?[j.root.id,ie]:[Hh[A]]}var Uh="__entity_input";function OT(j,A){return`${Uh}_${j}_${A?"popout":"panel"}`}function wT(j){let A=j.lastIndexOf("/");return A>=0?j.slice(A+1):j}function Ll(j){return ik(j)||Ge(j)}function LT(j,A,e){let t=e;for(let[r,o]of A.entries()){let n=r===A.length-1,a=j.getNode(t);if(!a||!Ll(a))return!1;let i=!1;for(let s of a.children){if(M7(s)&&o===s.getName())return!0;if(Ge(s)&&o===s.getName()){if(n)return!0;i=!0,t=s.id;break}}if(!i)return!1}return!1}function La(j,A,e){let t=Aj(A)?A:Wh(A);if(t.length===0)return e;let r=j.get(e);E(r&&Ll(r),"A reference must be in a folder.");for(let o of t){let n=pE(r,o);if(n){r=n;continue}r=j.insertNode(new $u({name:o}),r.id)}return r.id}function zT(j,A){let e=j.tree.get(A);if(!Ge(e))return"";let t=[e.name];for(let r of e.ancestors()){if(!Ge(r))break;t.unshift(r.name)}return`/${t.join("/")}`}function XT(j,A,e){let t=j.tree.get(A);E(t,"Node must exist");let r=wa(e,A),o=j.tree.get(r),n=[t.name];if(o)for(let a of o.ancestors()){if(!Ge(a))break;n.unshift(a.name)}return`/${n.join("/")}`}function Wh(j){return wl(j).slice(0,-1)}function YT(j,A,e,t){let r=wl(e);if(r.length===0)return;let o=r.pop(),n=La(j.tree,e,t),a=t===ir;return hr(j.tree,n,A.id,a),A.set({name:o}),n}function co(j){return Vo(j)}function uE(j,A){if(!Qo(A))return!1;let e=v6(A.codeComponentIdentifier);if(!e)return!1;let t=j.getNode(e);return!!(t&&V(t))}function nP(j,A){let e=v6(A.codeComponentIdentifier);E(e,"WebPageInstance should have a local canvas component id");let t=j.getNode(e);return E(t,"SmartComponentInstance should have a local WebPageNode"),E(V(t),"WebPageInstance its WebPageNode should be a web page"),t}var Fn=(j,A)=>j.length===0?[]:typeof j[0]=="string"?A.withoutDescendants(A.getNodes(j)):j;function qa(j,A){let e=A.reactComponentForIdentifier(j.codeComponentIdentifier);return e?Au(e.properties,j.getControlProps(e.properties)):{}}var zh={type:"None",source:"undefined"},mE=class extends ae{constructor(){super(...arguments);R(this,"stack",[]);R(this,"dismiss",()=>{this.stack=he.pop(this.stack)});R(this,"isVisible",()=>this.active.type!=="None");R(this,"shouldBlockUndoRedo",(e,t)=>{switch(this.active.type){case"None":return!1;case"Variables":return!wm(e,t);case"LocaleSettings":return!Lm(e,t);default:return!0}})}get active(){return this.stack[this.stack.length-1]??zh}trackModalOpen({type:e,source:t}){fA("modal_open",{modalType:e,source:t})}push(e){this.stack=he.push(this.stack,e),this.trackModalOpen(e)}set(e){this.stack=[e],this.trackModalOpen(e)}dismissAll(){this.stack.length!==0&&(this.stack=[])}dismissModal(e){this.stack=he.filter(this.stack,t=>t.type!==e)}displayComponentIsolationModal({source:e}){let t="componentIsolationModal",r="1";$j.isAutomation||$j.isE2E||$j.isTest||localStorage.getItem(t)!==r&&(localStorage.setItem(t,r),setTimeout(()=>{this.processWhenReady(()=>{this.set({type:"ComponentIsolationModal",source:e})})},0))}};var EE=class extends ae{constructor(){super(...arguments);R(this,"active",0)}};function fE(j){if(_(j))return[j];if("id"in j)return[j.id];let A=[];for(let e of j)_(e)?A.push(e):A.push(e.id);return A}function Gn(j,A){if(j===A)return!0;if(j.length!==A.length)return!1;let e=new Set(j);for(let t of A)if(!e.has(t))return!1;return!0}var $E=class extends ae{constructor(e,t,r){super();this.guides=e;this.chromeStore=t;this.overlayStore=r;R(this,"_previousIds",[]);R(this,"_ids",[]);R(this,"_nodes",[]);R(this,"_isSticky",!1);R(this,"_commonGroundNode");R(this,"gradientStopId")}get ids(){return this._ids}get nodes(){return this._nodes}get isSticky(){return this._isSticky}get commonGroundNode(){return this._commonGroundNode}get commonGroundNodeId(){return this._commonGroundNode?.id??null}get previousIds(){return this._previousIds}set(e,t={}){let r=fE(e);if(Gn(this._ids,r))return;this._previousIds=this._ids,this._ids=r,this._isSticky=t.sticky??r.length>1,r.length>0&&this.guides.clearSelected();let{switchToLayers:n=!1,tree:a}=t;this.chromeStore.onCanvasSelectionChange(r,n),this.overlayStore.onCanvasSelectionChange(r,{tree:a})}toggle(e,{switchToLayers:t=!1}={}){let r=fE(e),o=new Set(this.ids);for(let n of r)o.has(n)?o.delete(n):o.add(n);this._ids=Array.from(o),this.chromeStore.onCanvasSelectionChange(this.ids,t),this.overlayStore.onCanvasSelectionChange(o,{toggle:!0})}clear(){this.set([])}updateNodes(e){let t=e.getNodes(this.ids),r=!Wt(this.nodes,t);r&&(this._nodes=t),(r||this.commonGroundNode&&!e.isGroundNode(this.commonGroundNode))&&this.updateCommonGroundNode(e)}updateCommonGroundNode(e){let t;for(let r of this.nodes){let o=e.getGroundNodeFor(r);if(!t)t=o;else if(t!==o){t=void 0;break}}this._commonGroundNode=t}postProcess(e,t,r,o=this.gradientStopId,n=this._ids){this.gradientStopId=o;let a=[];for(let i of n){let s=e.getNode(i);if(s){e.isAncestorOfNode(s,t.id)&&a.push(i);continue}let l=r.getNode(i);if(!ue(l))continue;let d=e.getNode(l.parentid);if(tj(d)){a.splice(0,a.length,d.id);break}}this.set(a,{tree:e}),this.updateNodes(e)}};function ql(j){let A=K.componentForIdentifier(j.codeComponentIdentifier);if(!A?.properties)return null;let e=Object.entries(A.properties).find(([,n])=>n&&n.title==="Variant"&&n.type==="enum");if(!e)return null;let[t,r]=e;if(r.options.length<=1)return null;let o=r.defaultValue??r.options[0];return _(o)?{key:t,control:r,defaultVariant:o}:null}function Kl(j,{control:A}){let e=j.toLowerCase().trim(),r=(A.optionTitles??A.options).findIndex(n=>_(n)&&n.toLowerCase()===e);if(r===-1)return null;let o=A.options[r];return _(o)?o:null}function BE(j,A,e){let t={};for(let r of e.walk()){if(!X(r))continue;let o=ql(r);if(!o)continue;let n=Kl(A,o);if(!n)continue;let a=r;if(ej(r)&&(a=j.tree.getNode(r.originalid)),!a||(a.getRawControlProp(o.key)??o.defaultVariant)===n)continue;let s={type:"enum",value:n};t[a.id]={[VA(o.key)]:s}}return Object.keys(t).length>0?t:null}var gE=["blur","backgroundBlur","brightness","contrast","grayscale","hueRotate","invert","saturate","sepia"];var Va={left:"position",right:"position",top:"position",bottom:"position",centerAnchorX:"position",centerAnchorY:"position",constraintsLocked:"position",x:"position",y:"position",width:"size",widthType:"size",height:"size",heightType:"size",aspectRatio:"size",itemsOrder:"itemsOrder",layout:"layout",gap:"layout",gridAlignment:"layout",gridColumnCount:"layout",gridColumnWidthType:"layout",gridColumnWidth:"layout",gridColumnMinWidth:"layout",gridRowHeightType:"layout",gridRowHeight:"layout",gridRowCount:"layout",stackDirection:"layout",stackDistribution:"layout",stackAlignment:"layout",stackWrapEnabled:"layout",gridItemFillCellWidth:"size",gridItemFillCellHeight:"size",gridItemHorizontalAlignment:"position",gridItemVerticalAlignment:"position",gridItemColumnSpan:"size",gridItemRowSpan:"size",minHeight:"sizeConstraints",minWidth:"sizeConstraints",maxHeight:"sizeConstraints",maxWidth:"sizeConstraints",paragraphSpacing:"paragraphSpacing",position:"positionType",positionStickyTop:"positionType",positionStickyRight:"positionType",positionStickyBottom:"positionType",positionStickyLeft:"positionType",intrinsicWidth:"intrinsicSize",intrinsicHeight:"intrinsicSize",fillColor:"fill",fillEnabled:"fill",fillImage:"fill",fillImageOriginalName:"fill",fillImagePixelHeight:"fill",fillImagePixelWidth:"fill",fillImageResize:"fill",fillImagePositionX:"fill",fillImagePositionY:"fill",fillImageTileSize:"fill",fillType:"fill",fillRadialGradient:"fill",fillLinearGradient:"fill",fillConicGradient:"fill",tapHighlightColor:"tapHighlight",textSelection:"textSelection",masks:"mask",radius:"radius",radiusBottomLeft:"radius",radiusBottomRight:"radius",radiusIsRelative:"radius",radiusPerCorner:"radius",radiusTopLeft:"radius",radiusTopRight:"radius",borderTop:"border",borderBottom:"border",borderLeft:"border",borderRight:"border",borderEnabled:"border",borderWidth:"border",borderStyle:"border",borderColor:"border",borderPerSide:"border",rotation:"rotation",rotate3d:"rotation",rotateX:"rotation",rotateY:"rotation",blendingMode:"blending",opacity:"opacity",backgroundBlur:"backgroundBlur",overflow:"overflow",overflowY:"overflowY",overflowX:"overflowX",overscrollBehavior:"overscroll",visible:"visibility",brightness:"brightness",contrast:"contrast",grayscale:"grayscale",hueRotate:"hueRotate",invert:"invert",saturate:"saturate",sepia:"sepia",blur:"blur",boxShadows:"shadows",shadows:"shadows",guidesX:"canvasSettings",guidesY:"canvasSettings",exportOptions:"canvasSettings",overlayGrid:"canvasSettings",gesture:"canvasSettings",sizeToFit:"canvasSettings",framePreset:"canvasSettings",isVariant:"canvasSettings",onTap:"action",onTapStart:"action",onClick:"action",onMouseUp:"action",onMouseDown:"action",onMouseEnter:"action",onMouseLeave:"action",onAppear:"action",onKeyDown:"action",padding:"padding",paddingPerSide:"padding",paddingTop:"padding",paddingRight:"padding",paddingBottom:"padding",paddingLeft:"padding",name:"name",strokeEnabled:"stroke",strokeAlignment:"stroke",strokeWidth:"stroke",strokeColor:"stroke",lineJoin:"stroke",lineCap:"stroke",strokeMiterLimit:"stroke",strokeDashArray:"stroke",strokeDashOffset:"stroke",html:"richText",htmlLocalized:"richText",htmlContent:"richText",textFitScale:"richText",textFitViewBoxSize:"richText",textFitViewBoxSizeLocalized:"richText",stylePresetHeading1:"stylePresets",stylePresetHeading2:"stylePresets",stylePresetHeading3:"stylePresets",stylePresetHeading4:"stylePresets",stylePresetHeading5:"stylePresets",stylePresetHeading6:"stylePresets",stylePresetParagraph:"stylePresets",stylePresetLink:"stylePresets",stylePresetAnchorLink:"stylePresets",stylePresetBlockquote:"stylePresets",stylePresetTable:"stylePresets",stylePresetInlineCode:"stylePresets",stylePresetImage:"stylePresets",anchorLinkOffsetY:"anchorLinkOffsetY",styledText:"styledText",getStyledText:"styledText",font:"font",rootFontSize:"rootFontSize",textColor:"textColor",textBackgroundColor:"textBackgroundColor",fontSize:"fontSize",letterSpacing:"letterSpacing",textTransform:"textTransform",textDecoration:"textDecoration",textDecorationColor:"textDecoration",textDecorationThickness:"textDecoration",textDecorationStyle:"textDecoration",textDecorationSkipInk:"textDecoration",textDecorationOffset:"textDecoration",lineHeight:"lineHeight",textAlignment:"textAlignment",textStrokeWidth:"textStroke",textStrokeColor:"textStroke",textWrapBalance:"textWrapBalance",openTypeFontFeatures:"openTypeFontFeatures",link:"link",linkOpenInNewTab:"link",linkSmoothScroll:"link",linkClickTrackingId:"link",linkLocalized:"link",linkRelValues:"link",linkPreserveParams:"link",getLink:"link",linkFont:"linkStyle",linkTextColor:"linkStyle",linkFontSize:"linkStyle",linkTextTransform:"linkStyle",linkTextDecoration:"linkStyle",linkTextDecorationColor:"linkStyle",linkTextDecorationThickness:"linkStyle",linkTextDecorationStyle:"linkStyle",linkTextDecorationSkipInk:"linkStyle",linkTextDecorationOffset:"linkStyle",linkHoverFont:"linkStyle",linkHoverTextColor:"linkStyle",linkHoverFontSize:"linkStyle",linkHoverTextTransform:"linkStyle",linkHoverTextDecoration:"linkStyle",linkHoverTextDecorationColor:"linkStyle",linkHoverTextDecorationThickness:"linkStyle",linkHoverTextDecorationStyle:"linkStyle",linkHoverTextDecorationSkipInk:"linkStyle",linkHoverTextDecorationOffset:"linkStyle",linkCurrentFont:"linkStyle",linkCurrentTextColor:"linkStyle",linkCurrentFontSize:"linkStyle",linkCurrentTextTransform:"linkStyle",linkCurrentTextDecoration:"linkStyle",linkCurrentTextDecorationColor:"linkStyle",linkCurrentTextDecorationThickness:"linkStyle",linkCurrentTextDecorationStyle:"linkStyle",linkCurrentTextDecorationSkipInk:"linkStyle",linkCurrentTextDecorationOffset:"linkStyle",textContent:"textContent",textVerticalAlignment:"textVerticalAlignment",variantTransition:"transition",pathSegments:"vectorPath",pathClosed:"vectorPath",spikeCount:"vectorPath",spikeDepth:"vectorPath",polygonSides:"vectorPath",elementId:"scrollTarget",scrollMarginTop:"scrollTarget",scrollTargetEnabled:"scrollTarget",altAttribute:"accessibility",altAttributeLocalized:"accessibility",cursor:"cursor",customCursorSmartComponentId:"customCursor",customCursorFollow:"customCursor",customCursorOffsetX:"customCursor",customCursorOffsetY:"customCursor",customCursorVariant:"customCursor",customCursorType:"customCursor",customCursorTransitionEnabled:"customCursor",customCursorTransition:"customCursor",customCursorPlacement:"customCursor",customCursorAlignment:"customCursor",pointerEvents:"pointerEvents",userSelect:"userSelect",zIndex:"zIndex",draggable:"draggable",imageRendering:"imageRendering",viewportHeight:"canvasSettings",isBreakpoint:"canvasSettings",backdropFill:"overlay",backdropFillEnabled:"overlay",backdropDismissible:"overlay",blockDocumentScrolling:"overlay",backdropExitTransition:"overlayTransition",backdropEnterTransition:"overlayTransition",backdropTransitionLocked:"overlayTransition",hideScrollbars:"scrollbars",customizations:"customizations",customizationsDescription:"customizations",customizationsSectionId:"customizations",isApplyingCustomizations:"customizations",translateZ:"translateZ",scale:"scale",skewX:"skew",skewY:"skew",backfaceVisibility:"backfaceVisibility",perspective:"perspective",transformStylePreserve3d:"transformStylePreserve3d",transformOriginX:"transformOrigin",transformOriginY:"transformOrigin",transition:"transition",formInputFontSize:"formInputFont",formInputFontFamily:"formInputFont",formInputFontSelector:"formInputFont",formInputFontWeight:"formInputFont",formInputFontStyle:"formInputFont",formInputPlaceholderColor:"formPlaceholderColor",formInputFontColor:"formInputColor",formInputFontLetterSpacing:"formInputFont",formInputFontLetterSpacingUnit:"formInputFont",formInputFontLineHeight:"formInputFont",formInputFontLineHeightUnit:"formInputFont",formInputFontTextAlignment:"formInputFont",formInputOpenTypeFontFeatures:"formInputFont",formTextInputType:"formTextInputType",formTextAreaResizable:"formInputTextAreaResize",formTextInputMinNumber:"formTextInputTypeMin",formTextInputMaxNumber:"formTextInputTypeMax",formInputMaxLength:"formInputMaxLength",formInputStep:"formInputStep",formBooleanInputType:"formBooleanInputType",formBooleanInputValue:"formBooleanInputValue",formBooleanInputCheckedBorderColor:"formBooleanInputCheckedEffect",formBooleanInputCheckedBorderWidth:"formBooleanInputCheckedEffect",formBooleanInputCheckedBorderStyle:"formBooleanInputCheckedEffect",formBooleanInputCheckedBoxShadow:"formBooleanInputCheckedEffect",formBooleanInputCheckedFillColor:"formBooleanInputCheckedEffect",formBooleanInputCheckedTransition:"formBooleanInputCheckedEffect",formInputFocusedBackgroundColor:"formInputFocusedFill",formInputFocusedBorderColor:"formInputFocusedBorder",formInputFocusedBorderStyle:"formInputFocusedBorder",formInputFocusedBorderWidth:"formInputFocusedBorder",formInputFocusedBoxShadow:"formInputFocusedBoxShadow",formInputFocusedTransition:"formInputFocusedTransition",formInputInvalidTextColor:"formInputInvalidTextColor",formInputIconImage:"formInputIcon",formInputIconColor:"formInputIcon",viewTransitionNone:"viewTransitionNone"};function xP(j){let A=[],e;for(e in Va){let t=Va[e];j.includes(t)&&A.push(e)}return A}function hE(j,A){let e=K.componentForIdentifier(A.codeComponentIdentifier);if(!e?.properties)return{};let t={};return Object.entries(e.properties).forEach(([r,o])=>{if(!o||oe(A)&&o.type==="slot")return;let n=VA(r),a=j[n];Li(a)&&a.type&&Jp(o.type,a.type)&&(o.type==="enum"&&!Np(o,a.value)||(t[n]=a))}),t}function U(j,A){return A?new Set(Aj(A)?A:[A]).has(j):!0}function Ja(j,A,e,t,r,o){let n=j.getScopeNodeFor(e);function a(s){return!cA(s)||n&&Ye(n)&&n.hasVariable(s.id)?s:r?.[s.id]??s}let i={};if(zi(j,e)||We(A)&&(A.widthType===4&&(i.widthType=1),A.heightType===4&&(i.heightType=1)),U("visibility",o)&&so(A)&&so(e)&&(i.visible=a(A.visible)),U("border",o)&&At(A)&&At(e)&&(i.borderEnabled=A.borderEnabled,i.borderWidth=A.borderWidth,i.borderColor=A.borderColor,i.borderStyle=A.borderStyle,i.borderPerSide=A.borderPerSide,i.borderLeft=A.borderLeft,i.borderTop=A.borderTop,i.borderRight=A.borderRight,i.borderBottom=A.borderBottom),U("border",o)&&At(A)&&se(e))if(WA(A.borderEnabled)){let s=A.resolveValue("borderEnabled");tr(s)?(i.strokeEnabled=!0,i.strokeWidth=s.borderWidth,i.strokeColor=s.borderColor):i.strokeEnabled=!1}else i.strokeEnabled=A.borderEnabled,i.strokeWidth=A.borderWidth,i.strokeColor=A.borderColor;if(U("stroke",o)&&se(A)&&se(e)&&(i.strokeEnabled=A.strokeEnabled,i.strokeColor=A.strokeColor,i.strokeWidth=A.strokeWidth,i.strokeAlignment=A.strokeAlignment,i.lineJoin=A.lineJoin,i.lineCap=A.lineCap,i.strokeMiterLimit=A.strokeMiterLimit,i.strokeDashArray=A.strokeDashArray,i.strokeDashOffset=A.strokeDashOffset),U("stroke",o)&&se(A)&&At(e)&&(i.borderEnabled=A.strokeEnabled,i.borderWidth=A.resolveValue("strokeWidth"),i.borderColor=A.resolveValue("strokeColor")),U("formInputTextAreaResize",o)&&Op(A)&&(i.formTextAreaResizable=A.formTextAreaResizable),U("formInputFocusedFill",o)&&Ze(A)&&Ze(e)&&(i.formInputFocusedBackgroundColor=A.formInputFocusedBackgroundColor),U("formInputFocusedBorder",o)&&Ze(A)&&Ze(e)&&(i.formInputFocusedBorderColor=A.formInputFocusedBorderColor,i.formInputFocusedBorderWidth=A.formInputFocusedBorderWidth,i.formInputFocusedBorderStyle=A.formInputFocusedBorderStyle),U("formInputFocusedBoxShadow",o)&&Ze(A)&&Ze(e)&&(i.formInputFocusedBoxShadow=A.formInputFocusedBoxShadow?[...A.formInputFocusedBoxShadow]:void 0),U("formInputFocusedTransition",o)&&Ze(A)&&Ze(e)&&(i.formInputFocusedTransition=A.formInputFocusedTransition),U("formInputColor",o)&&$r(A)&&$r(e)&&(i.formInputFontColor=A.formInputFontColor),U("formPlaceholderColor",o)&&ll(A)&&ll(e)&&(i.formInputPlaceholderColor=A.formInputPlaceholderColor),U("formInputPadding",o)&&et(A)&&et(e)&&(i.padding=A.padding,i.paddingPerSide=A.paddingPerSide,i.paddingTop=A.paddingTop,i.paddingRight=A.paddingRight,i.paddingBottom=A.paddingBottom,i.paddingLeft=A.paddingLeft),U("shadows",o)&&Yt(A)&&Yt(e)){let s=a(A.boxShadows);Z7(e)?i.boxShadows=s:WA(s)||(i.boxShadows=s?.filter(l=>l.type!=="realistic"))}if(U("shadows",o)&&p6(A)&&p6(e)&&(i.shadows=A.shadows),U("rotation",o)&&St(A)&&St(e)&&(i.rotation=A.rotation,Ij(e)&&Ij(A)&&(i.rotate3d=A.rotate3d,i.rotateX=A.rotateX,i.rotateY=A.rotateY)),U("overflow",o)&&Xe(A)&&Xe(e)&&(i.overflow=a(A.overflow)),U("overscroll",o)&&h6(A)&&h6(e)&&(i.overscrollBehavior=a(A.overscrollBehavior)),U("cursor",o)&&Yo(A)&&Yo(e)&&(i.cursor=a(A.cursor)),U("customCursor",o)&&Yo(A)&&Yo(e)&&(i.customCursorType=A.customCursorType,i.customCursorSmartComponentId=A.customCursorSmartComponentId,i.customCursorVariant=A.customCursorVariant,i.customCursorFollow=A.customCursorFollow,i.customCursorOffsetX=A.customCursorOffsetX,i.customCursorOffsetY=A.customCursorOffsetY,i.customCursorTransitionEnabled=A.customCursorTransitionEnabled,i.customCursorTransition=A.customCursorTransition,i.customCursorPlacement=A.customCursorPlacement,i.customCursorAlignment=A.customCursorAlignment),dn(A)&&dn(e))for(let s of gE){let l=Va[s];U(l,o)&&(i[s]=a(A[s]))}if(U("blending",o)&&B6(A)&&B6(e)&&(i.blendingMode=a(A.blendingMode)),U("transition",o)&&Z6(A)&&Z6(e)){let s=MA(A)?A.variantTransition:A.transition;MA(e)?i.variantTransition=s:i.transition=s}if(U("fill",o)&&Ce(A)&&Ce(e)){i.fillColor=a(A.fillColor),i.fillType=A.fillType,i.fillLinearGradient=A.fillLinearGradient,i.fillRadialGradient=A.fillRadialGradient,i.fillConicGradient=A.fillConicGradient,i.fillType==="conic-gradient"&&!lk(e)&&(i.fillType=e.fillType??"color");let s=a(A.fillImage);WA(s)?WA(s)&&e.supportsDynamicValues()&&(i.fillImage=s):i.fillImage=s,i.fillImageResize=A.fillImageResize,i.fillImagePixelWidth=A.fillImagePixelWidth,i.fillImagePixelHeight=A.fillImagePixelHeight,i.fillImagePositionX=A.fillImagePositionX,i.fillImagePositionY=A.fillImagePositionY,i.fillImageTileSize=A.fillImageTileSize}if(U("fill",o)&&bt(A)&&bt(e)&&(i.fillEnabled=A.fillEnabled),U("opacity",o)&&X6(A)&&X6(e)&&(i.opacity=a(A.opacity)),U("radius",o)&&Ct(A)&&Ct(e)&&(i.radius=a(A.radius),L6(A)&&L6(e)&&(i.radiusIsRelative=A.radiusIsRelative),sr(A)&&sr(e)&&(i.radiusPerCorner=A.radiusPerCorner,i.radiusBottomLeft=A.radiusBottomLeft,i.radiusBottomRight=A.radiusBottomRight,i.radiusTopLeft=A.radiusTopLeft,i.radiusTopRight=A.radiusTopRight)),U("pointerEvents",o)&&R6(A)&&R6(e)&&!dj(n)&&(i.pointerEvents=a(A.pointerEvents)),U("draggable",o)&&z6(A)&&z6(e)&&(i.draggable=a(A.draggable)),U("userSelect",o)&&I6(A)&&I6(e)&&(i.userSelect=a(A.userSelect)),U("imageRendering",o)&&g6(A)&&g6(e)&&(i.imageRendering=a(A.imageRendering)),U("overflowX",o)&&Xe(A)&&Xe(e)&&(i.overflowX=a(A.overflowX)),U("overflowY",o)&&Xe(A)&&Xe(e)&&(i.overflowY=a(A.overflowY)),U("zIndex",o)&&y6(A)&&y6(e)&&(i.zIndex=a(A.zIndex)),U("scrollbars",o)&&rl(A)&&rl(e)&&(i.hideScrollbars=a(A.hideScrollbars)),U("textVerticalAlignment",o)&&nl(A)&&nl(e)&&(i.textVerticalAlignment=A.textVerticalAlignment),U("textWrapBalance",o)&&q6(A)&&q6(e)&&(i.textWrapBalance=A.textWrapBalance),U("styledText",o)&&Tj(A)&&Ep(e)){i.font=A.getFonts(!1)[0],i.textColor=A.getTextColors(!1)[0];let s=A.getFontSizes(!1)[0];i.fontSize=Jo(s)?s[0]:s;let l=A.getLetterSpacings(!1)[0];i.letterSpacing=oA(l)?l:V7(l),i.textTransform=A.getTextTransforms(!1)[0],i.textDecoration=A.getTextDecorations(!1)[0],i.lineHeight=A.getLineHeights(!1)[0],i.textAlignment=A.getTextAlignments(!1)[0],i.styledText=e.styledText.setFont(void 0,!1).setTextColor(void 0,!1).setFontSize(void 0,!1).setLetterSpacing(void 0,!1).setTextTransform(void 0,!1).setTextDecoration(void 0,!1).setLineHeight(void 0).setTextAlignment(void 0)}if(U("link",o)&&Tj(A)&&Tj(e)&&(i.linkFont=A.linkFont,i.linkTextColor=A.linkTextColor,i.linkFontSize=A.linkFontSize,i.linkTextTransform=A.linkTextTransform,i.linkTextDecoration=A.linkTextDecoration,i.linkHoverFont=A.linkHoverFont,i.linkHoverTextColor=A.linkHoverTextColor,i.linkHoverFontSize=A.linkHoverFontSize,i.linkHoverTextTransform=A.linkHoverTextTransform,i.linkHoverTextDecoration=A.linkHoverTextDecoration,i.linkCurrentFont=A.linkCurrentFont,i.linkCurrentTextColor=A.linkCurrentTextColor,i.linkCurrentFontSize=A.linkCurrentFontSize,i.linkCurrentTextTransform=A.linkCurrentTextTransform,i.linkCurrentTextDecoration=A.linkCurrentTextDecoration),U("mask",o)&&x6(A)&&x6(e)&&(i.masks=A.masks),JA(A)&&JA(e)){if(U("fontSize",o)&&(i.textFitScale=A.textFitScale,i.textFitViewBoxSize=A.textFitViewBoxSize),U("paragraphSpacing",o)&&(i.paragraphSpacing=A.paragraphSpacing),U("styledText",o)){let s=A.getTextStrokeWidths(!1)[0],l=A.getTextStrokeColors(!1)[0];oA(s)||(i.textStrokeWidth=s),l&&(i.textStrokeColor=l)}if(U("richText",o))for(let s of Ju){let l=A[s];j.has(l)&&(i[s]=l)}}if(U("codeComponentProps",o)&&Qo(A)&&Qo(e)){let s=hE(A,e);Object.assign(i,s)}if(U("codeOverride",o)&&Wr(A)&&Wr(e)&&(i.codeOverrideEnabled=A.codeOverrideEnabled,i.codeOverrideIdentifier=A.codeOverrideIdentifier),U("formInputFont",o)&&$r(A)&&$r(e)&&(i.formInputFontFamily=A.formInputFontFamily,i.formInputFontWeight=A.formInputFontWeight,i.formInputFontStyle=A.formInputFontStyle,i.formInputFontSize=A.formInputFontSize,i.formInputFontSelector=A.formInputFontSelector,i.formInputFontLetterSpacing=A.formInputFontLetterSpacing,i.formInputFontLetterSpacingUnit=A.formInputFontLetterSpacingUnit,i.formInputFontLineHeight=A.formInputFontLineHeight,i.formInputFontLineHeightUnit=A.formInputFontLineHeightUnit,i.formInputFontTextAlignment=A.formInputFontTextAlignment,i.formInputOpenTypeFontFeatures=A.formInputOpenTypeFontFeatures),U("layout",o)&&LA(A)&&mA(e)&&(sj(e)||(i.layout=A.layout),i.stackDirection=A.stackDirection,i.stackDistribution=A.stackDistribution,i.stackAlignment=A.stackAlignment,i.gap=A.gap,i.padding=A.padding,i.paddingPerSide=A.paddingPerSide,i.paddingTop=A.paddingTop,i.paddingRight=A.paddingRight,i.paddingBottom=A.paddingBottom,i.paddingLeft=A.paddingLeft),U("position",o)&&Object.assign(i,eo(A,t)),U("perspective",o)&&Ij(A)&&Ij(e)&&(i.perspective=a(A.perspective)),U("overlay",o)&&gj(A)&&gj(e)&&t){let s=Rt(A);Object.assign(i,s)}if(U("effects",o)&&kn(A)&&kn(e)&&Object.assign(i,Eu(e,A)),U("transformOrigin",o)&&Ij(A)&&Ij(e)&&Object.assign(i,{transformOriginX:A.transformOriginX,transformOriginY:A.transformOriginY}),U("backfaceVisibility",o)&&Ij(A)&&Ij(e)&&Object.assign(i,{backfaceVisibility:A.backfaceVisibility}),U("transformStylePreserve3d",o)&&Ij(A)&&Ij(e)&&Object.assign(i,{transformStylePreserve3d:A.transformStylePreserve3d}),U("translateZ",o)&&Ij(A)&&Ij(e)&&Object.assign(i,{translateZ:A.translateZ}),U("scale",o)&&Ij(A)&&Ij(e)&&Object.assign(i,{scale:A.scale}),U("skew",o)&&Ij(A)&&Ij(e)&&Object.assign(i,{skewX:A.skewX,skewY:A.skewY}),U("formBooleanInputType",o)&&fr(A)&&fr(e)&&Object.assign(i,{formBooleanInputType:A.formBooleanInputType}),U("formBooleanInputValue",o)&&fr(A)&&fr(e)&&Object.assign(i,{formBooleanInputValue:A.formBooleanInputValue}),U("formBooleanInputCheckedEffect",o)&&fr(A)&&fr(e)){let s={formBooleanInputCheckedBorderColor:A.formBooleanInputCheckedBorderColor,formBooleanInputCheckedBorderWidth:A.formBooleanInputCheckedBorderWidth,formBooleanInputCheckedBorderStyle:A.formBooleanInputCheckedBorderStyle,formBooleanInputCheckedFillColor:A.formBooleanInputCheckedFillColor,formBooleanInputCheckedBoxShadow:A.formBooleanInputCheckedBoxShadow,formBooleanInputCheckedTransition:A.formBooleanInputCheckedTransition};Object.assign(i,s)}return U("formInputIcon",o)&&sl(A)&&sl(e)&&Object.assign(i,{formInputIconImage:A.formInputIconImage,formInputIconColor:A.formInputIconColor}),U("viewTransitionNone",o)&&Al(A)&&Al(e)&&(i.viewTransitionNone=A.viewTransitionNone),i}function RE(j,A,e,t,r){if(Ve(t))return;let o=HA(A)?2:0,n=nj(e.x,o),a=nj(e.y,o);if(Bt(r.x)?(r.x=n,r.y=a):(!je(r.x)&&r.x!==n&&(r.x=Jt),!je(r.y)&&r.y!==a&&(r.y=Jt)),!EA(A)||!t)return;let i=j.getParentSizeInfo(A);if(!i?.positioning)return;let s=i.positioning,l=nj(s.width-L.maxX(e),o),d=nj(s.height-L.maxY(e),o);Bt(r.right)?(r.right=l,r.bottom=d):(!je(r.right)&&r.right!==l&&(r.right=Jt),!je(r.bottom)&&r.bottom!==d&&(r.bottom=Jt))}var Pj={padding:0,gridRowCount:2,gridColumnCount:2,gridRowHeight:200,gridColumnWidth:200};Object.freeze(Pj);function N_(j){switch(j){case 20:return 0;case 21:return 1;case 23:return 4;case 24:return 3;case 22:return 2;case 19:return 5}}var Xh=(j,A,e=!0)=>{let t=j.stores.persistedUserDefaults.layoutGap;return{layout:"stack",stackDirection:A,stackDistribution:"start",stackAlignment:"center",gap:t,stackWrapEnabled:!1,paddingPerSide:!1,padding:e?t:Pj.padding,paddingTop:Pj.padding,paddingBottom:Pj.padding,paddingLeft:Pj.padding,paddingRight:Pj.padding}},Yh={gridItemFillCellWidth:!0,gridItemFillCellHeight:!0,gridItemHorizontalAlignment:"center",gridItemVerticalAlignment:"center",gridItemColumnSpan:1,gridItemRowSpan:1},Zh=j=>({layout:"grid",gridColumnCount:Pj.gridColumnCount,gridAlignment:"center",gridColumnWidthType:"minmax",gridColumnWidth:Pj.gridColumnWidth,gridColumnMinWidth:50,gridRowHeightType:"auto",gridRowCount:Pj.gridRowCount,gridRowHeight:Pj.gridRowHeight,gap:j.stores.persistedUserDefaults.layoutGap,paddingPerSide:!1,padding:Pj.padding,paddingTop:Pj.padding,paddingBottom:Pj.padding,paddingLeft:Pj.padding,paddingRight:Pj.padding}),FE=new Set(["#BDF","#CEF","#9DF"]);function AR(j){let A=Array.from(FE).filter(e=>e!==j);return A.length=2,A}var GE=(j,A={},e={})=>{let{index:t=0,lastColor:r,parentColor:o,source:n}=e,a=AR(o),i=a.length,s=a[0];if(t>0)s=a[Math.ceil(t/i)%i];else if(_(r))if(FE.has(r)){let d=(a.indexOf(r)+1)%i;s=a[d]}else s=r;n&&fA("layout_frame",{source:n});let l={fillEnabled:!0,fillColor:s};return LA(j)&&!j.stackWrapEnabled&&(j.widthType!==2&&(l.width=1,l.widthType=3),j.heightType!==2&&(l.height=1,l.heightType=3)),Object.assign(l,A),new fe(l)},x_=(j,A)=>{switch(j){case 0:case 1:{A.layout="stack",A.stackDirection=j===0?"vertical":"horizontal";break}case 2:case 3:case 4:A.overflow=ye();break}},jR=(j,A,e,t,r,o)=>{let n=new fe({...Xh(j,e,r),fillEnabled:!1,...A});E(LA(n));let a=o?{widthType:0,width:o.width,heightType:0,height:o.height}:void 0;for(let i=0;i<t;i++){let s=GE(n,a,{index:i});n.addChild(s)}return n},IE=(j,A,e,t)=>{let r=new fe({...Zh(j),fillEnabled:!1,...A});E(Ke(r));for(let o=0;o<e;o++){let n={};switch(t){case 3:o===0&&(n.gridItemRowSpan=2);break;case 4:o+1===e&&(n.gridItemColumnSpan=2);break;default:break}let a=GE(r,{...Yh,...n},{index:o});r.addChild(a)}return r},O_=(j,A,e,t=!1)=>{if(A===2)return IE(j,e,t?0:4);if(A===3||A===4)return IE(j,e,t?0:3,A);let r=t?0:2;return jR(j,e,e.stackDirection??"horizontal",r,!1)},SE=Sp.width,eR=(j,A,e,t,r,o)=>{let n={x:Xt,y:Xt,right:Xt,bottom:Xt};RE(j,A,e,t,n),gi(n.x)&&gi(n.right)&&r-n.x-n.right<200&&(o.left=0,o.right=0)},tR=(j,A)=>{j.stackDirection==="horizontal"&&!j.stackWrapEnabled&&(A.stackDirection="vertical"),j.stackWrapEnabled&&j.stackDistribution==="start"&&(A.stackDistribution="center")},rR=j=>{let A={};return j.children?.forEach(e=>{if(!Yr(e))return;let t=e.originalid??e.id;A[t]={maxWidth:"100%"}}),A},oR=(j,A)=>{gi(j.gridColumnCount)&&(A.gridColumnCount=1)},nR=(j,A,e,t,r,o)=>{eR(j,A,e,t,r,o),!(r>SE)&&(LA(A)&&tR(A,o),Ke(A)&&oR(A,o))},Vl=(j,A,e,t,r,o)=>{let n=A.originalid??A.id,a={};if(nR(j,A,e,t,r,a),o[n]=a,pe(A)&&A.stackWrapEnabled&&r<=SE){let s=rR(A);for(let l in s)o[l]={...o[l],...s[l]}}};function w_(j,A,e){let t=j.tree.getNode(A);if(!t||!ke(t))return;let r=j.tree.getNode(e);if(!r||!aj(r)||!RA(r))return;let o=j.tree.getScopeNodeFor(r);if(!o||!V(o))return;let n=j.tree.getRect(t),a=o.getBreakpointValues();for(let i in a){if(i===e)continue;let s=j.tree.getNode(i);if(!s||!jj(s)||!zA(s))continue;let l={};Vl(j.tree,t,n,r,s.width,l),dm(j.tree,s,l)}}function yE(j,A){let e={width:{2:!0,0:!0,3:!0,1:!0,4:!0},height:{2:!0,0:!0,3:!0,1:!0,4:!0}},t=j.getParent(A.id);if(!t||!EA(A)||rm(A)&&A.autoSize===!0||gj(A)?(e.width[1]=!1,e.height[1]=!1,e.width[3]=!1,e.height[3]=!1,e.width[4]=!1,e.height[4]=!1):Ke(t)?be(A,t)?(e.width[3]=!0,e.height[3]=t.gridRowHeightType!=="fit"):(e.width[3]=!1,e.height[3]=!1):LA(t)?(be(A,t)||(e.width[3]=!1),be(A,t)||(e.height[3]=!1)):(e.width[3]=!1,e.height[3]=!1),Rk(A)&&Lj(A.textFitViewBoxSize)&&(e.height[2]=!0,e.width[2]=!1,e.height[0]=!1,e.height[1]=!1,e.height[3]=!1,e.height[4]=!1),X(A)){let o=A.getSupportedLayout(K);Le(o.width)||(e.width[2]=!1),Le(o.height)||(e.height[2]=!1),zs(o.width)||(e.width[0]=!1,e.width[1]=!1,e.width[3]=!1,e.width[4]=!1),zs(o.height)||(e.height[0]=!1,e.height[1]=!1,e.height[3]=!1,e.height[4]=!1)}else if(mA(A)){if(RA(A)){e.width[2]=!1,u6(A)&&(e.height[0]=!1,e.height[1]=!1,e.height[3]=!1,e.height[4]=!1);let o=j.get(A.parentid);ij(o)&&(e.height[2]=!1)}A.children.length===0&&(e.width[2]=!1,e.height[2]=!1)}else mA(A)||Lo(A)||JA(A)||(e.width[2]=!1,Bk(A)||(e.height[2]=!1));return Ie(A)&&oA(A.layout)&&ej(A)&&!sj(A)&&(e.width[2]=!1,e.height[2]=!1),zi(j,A)||(e.width[4]=!1,e.height[4]=!1),(RA(t)&&We(t)&&t.heightType===2||u6(t))&&(e.height[3]=!1,e.height[1]=!1),Ve(t)&&(e.width[3]=!1,e.width[1]=!1,e.height[3]=!1,e.height[1]=!1),e}var bE=j=>{let A=[];return j.forEach((e,t)=>{for(let r=t+1;r<j.length;r++){let o=j[r];A.push([e,o])}}),A};function CE(j,A,e){let t=A.map(d=>j.convertFrameToCanvas(d));if(t.length===2){let[d,p]=t,k=sR(d,p),g=lR(d,p);if(k&&!g)return"vertical";if(g&&!k)return"horizontal"}let r=t.map(d=>L.center(d));if(r.length<=1){if(t.length===1){let[d]=t,p=e.width/Math.max(1,d.width),k=e.height/Math.max(1,d.height);return p<k?"vertical":"horizontal"}return e.width<e.height?"vertical":"horizontal"}let o=bE(r),n=[],a=[];o.forEach(([d,p])=>{n.push(Math.abs(d.x-p.x)),a.push(Math.abs(d.y-p.y))});let i=n.reduce((d,p)=>d+p,0),s=a.reduce((d,p)=>d+p,0);return i>s?"horizontal":"vertical"}function vE(j,A,e){return[...A].sort((t,r)=>{let o=j.tree.getRect(t),n=j.tree.getRect(r);return e==="horizontal"?o.x-n.x:o.y-n.y})}function iR(j){if(WA(j))return!0;switch(j){case"start":case"center":case"end":return!0;default:return!1}}function Jl(j,A,e){let t=CE(j.tree,A,e),r=j.stores.persistedUserDefaults.layoutGap;return{layout:"stack",stackDirection:t,gap:r,stackDistribution:F7,stackAlignment:Ci,stackWrapEnabled:!1,padding:0,paddingPerSide:!1,paddingTop:0,paddingRight:0,paddingBottom:0,paddingLeft:0}}function aR(j,A){A.forEach((e,t)=>{j.tree.moveNodeIndex(e,t)})}function TE(j,A,e,t,r){e==="horizontal"&&A.heightType===2||e==="vertical"&&A.widthType===2||PE(j,t,e,r,{})}function PE(j,A,e,t,r){if(e==="horizontal"||WA(r.padding))return;let o={...t};if(r.paddingPerSide)r.paddingLeft&&(o.width-=r.paddingLeft),r.paddingRight&&(o.width-=r.paddingRight),r.paddingTop&&(o.height-=r.paddingTop),r.paddingBottom&&(o.height-=r.paddingBottom);else if(r.padding){let a=r.padding*2;o.width-=a,o.height-=a}o.width=Math.max(0,o.width),o.height=Math.max(0,o.height);let n=o.width;n>0&&A.forEach(a=>{if(!EA(a)||IA(a)||ra(a)||ta(a)||a.widthType===2||a.widthType===4)return;if(j.tree.getRect(a).width/n>.96){let l=j.tree.getParent(a.id),d=j.tree.getParentSizeInfo(a);d.sizing&&a.heightType===4&&(d.sizing={...o,height:d.sizing.height});let p=j.tree.getRect(a),k=a.updateForRect({rect:p,parentSizeInfo:d,constraintsLocked:!0,shouldGuessPinToBottom:ot(j.tree,a),shouldGuessPinToRight:Uj(j.tree,a,l)});k.width=1,a.width!==1&&(k.widthType=3),a.set(k)}})}function ME(j,A,e,t,r){if(!j.tree.getNode(A))return;vE(j,t,r).forEach(a=>{if(Y7(a)&&Tt(a)||Uo(a))return;let i=j.tree.getParent(a.id),s=j.tree.getRect(a),l=L.offset(s,aA.reverse(e));j.moveNode(a.id,A);let d={...e},p=j.tree.getParentSizeInfo(a);up(a)&&p.sizing&&(d.width=p.sizing.width),mp(a)&&p.sizing&&(d.height=p.sizing.height),j.tree.current(a)?.set({...a.updateForRect({rect:l,parentSizeInfo:{sizing:d,positioning:e,viewport:p?.viewport??null,layout:Fe(i)},constraintsLocked:!1,shouldGuessPinToBottom:!0,shouldGuessPinToRight:Uj(j.tree,a,i)}),top:null,left:null,bottom:null,right:null,position:void 0}),It(j.tree,a).forEach(({replicaRoot:g,relatedNode:$})=>{dA.resetOverridesByProperty(j.tree,g,$,["position"])})})}function sR(j,A){let e=L.maxX(j),t=L.maxX(A);return e>A.x&&t>j.x}function lR(j,A){let e=L.maxY(j),t=L.maxY(A);return e>A.y&&t>j.y}function Hl(j,A,e){if(!CA(e))return;let t=A==="width"?"widthType":"heightType";e.children.forEach(r=>{if(EA(r)&&(r[t]===3||r[t]===1)){let o=j.getRect(r),n={[t]:0,[A]:o[A]};Xr(r)&&(n.aspectRatio=null),j.current(r)?.set(n)}})}function kD(j,A){if(!CA(A)||!EA(A))return;let e=new Set;A.children.forEach(t=>{if(!EA(t)||!Yr(t))return;let r=j.getRect(t),o={};A.widthType===2&&(t.widthType===3||t.widthType===1)&&(o.minWidth=r.width,e.add(t)),A.heightType===2&&(t.heightType===3||t.heightType===1)&&(o.minHeight=r.height),Object.keys(o).length>0&&(e.add(t),j.current(t)?.set(o))}),e.size>0&&cR()}function cR(){vA({type:"add",variant:"info",key:"setting-stack-direction-causes-children-change",text:"Layers in this stack received min-sizing to prevent a collapse",icon:"thumbnail",duration:5e3,showCloseButton:"always"})}function Ha(j,A,e={}){if(!Ie(A)||!CA(A)||pe(A))return;let t={layout:"stack",...e},r=j.tree.getRect(A),o=j.tree.getScopeNodeFor(A),n=Cu(A)||MA(A)&&V(o)||A.__unsafeIsGroundNode(j.tree)&&Hj(o),a=n?"vertical":CE(j.tree,A.children,r),i=vE(j,A.children,a);gA(A)||aR(j,i);let s=vi(A),l=A.gap??j.stores.persistedUserDefaults.layoutGap,d=n?"start":"center";t.stackDirection=s?A.stackDirection??a:a,t.stackDistribution=s?A.stackDistribution??d:d,t.gap=s||iR(d)?l:0,t.stackAlignment=s?A.stackAlignment??Ci:Ci,t.stackWrapEnabled=s?A.stackWrapEnabled??!1:!1;let p=s&&et(A)?{padding:A.padding,paddingPerSide:A.paddingPerSide,paddingLeft:A.paddingLeft,paddingRight:A.paddingRight,paddingTop:A.paddingTop,paddingBottom:A.paddingBottom}:{...$k};if(a==="horizontal"&&e.heightType===2||a==="vertical"&&e.widthType===2||PE(j,A.children,a,r,p),p.paddingPerSide){let{paddingTop:g,paddingRight:$,paddingBottom:F,paddingLeft:I}=p;g===$&&g===F&&g===I&&(p.paddingPerSide=!1,p.padding=g)}A.set({...t,...p})}var NE=900;function PD(j){return j.intrinsicWidth>=NE}function Qa(j,A,e){if(Tj(A))return!1;let t=e??j.getParent(A.id);return!!(t&&RA(t))}function MD(j){return j<=.5}function dR(j,A,e){if(!mA(A)||!aj(A)||!RA(A)||de(A)||!Qa(j,e,A))return!1;let t=zA(e)&&We(e)&&e.widthType===1&&e.width===1;if(zA(e)&&e.width<NE&&!t)return!1;let r=A.children.filter(l=>l.id!==e.id);if(r.length===0)return!0;let n=j.getRect(A).width||1,a=r.map(l=>j.getRect(l));return a.some(l=>l.width/n<.5)?!1:a.every((l,d)=>a.every((p,k)=>d===k?!0:!L.intersects(l,p)))}function xE(j,A,e,t){if(!Ie(A)||!dR(j.tree,A,e))return;let r={};t.height>500&&(r.heightType=2),Ha(j,A,r),A.set({gap:0})}function _E(j,A){for(let e of Object.values(j.variables))if(e?.type==="collectionreference"&&e.dataIdentifier===A)return e}function DE(j,A){return Object.values(j.variables).find(e=>e?.type==="multicollectionreference"&&e.dataIdentifier===A)}function pR(j,A){let e=nu(A);if(a6(e))return{targetDataIdentifier:e.dataIdentifier,targetProviderId:e.id};let t=j.stores.scopeStore.active;if(Kj(t))return{targetDataIdentifier:t.dataIdentifier,targetProviderId:t.id}}function OE(j,A,e){if(!a6(e))return;let t=pR(j,A);if(!t)return;let{targetDataIdentifier:r,targetProviderId:o}=t,n=dr(j.tree,e.dataIdentifier),a=dr(j.tree,r);if(!n||!a)return;let i=_E(n,r),s=DE(n,r),l=_E(a,e.dataIdentifier),d=DE(a,e.dataIdentifier),p;d?p={id:Ej(),itemKey:"id",transforms:[{id:Ej(),type:"valueTransform",name:"isIncludedIn",value:Jj(d.id,o)}]}:l?p={id:Ej(),itemKey:"id",transforms:[{id:Ej(),type:"valueTransform",name:"equals",value:Jj(l.id,o)}]}:s?p={id:Ej(),itemKey:s.id,transforms:[{id:Ej(),type:"valueTransform",name:"contains",value:Jj("id",o)}]}:i&&(p={id:Ej(),itemKey:i.id,transforms:[{id:Ej(),type:"valueTransform",name:"equals",value:Jj("id",o)}]}),p&&e.set({collectionFilters:{filters:[p]}})}function wE(j,A,e,t){if(!mA(A)||!aj(A)||!RA(A)||!pe(A)||A.stackDirection!=="vertical"||!Qa(j.tree,e,A)||A.heightType===2||!yE(j.tree,A).height[2])return;let o=A.children.filter(s=>s.id!==e.id);if(o.length===0)return;let n=j.tree.getRect(A),a=o.map(s=>j.tree.getRect(s));L.merge(...a).height+t.height<=n.height||(A.set({height:n.height,heightType:2}),o.forEach((s,l)=>{let d=a[l];E(d,"Child rect must be defined"),zA(s)&&We(s)&&s.heightType===3&&s.set({height:d.height,heightType:0})}))}var LE=yj(ih());var Wa=yj(Or()),Wl=yj($i());function Ua(j){let A=j.name||rt(j);return/^\s*$/u.test(A)?j instanceof am?"Text":"Layer":A}function qE({node:j,renderTarget:A=Ri.export,addNames:e=!1,isDarkMode:t,combinedVariableValueMap:r}){if(Kr(j))return j.svg;let o=[],n=!0,a=null;IA(j)?(a=j,j.children.map($=>{HA($)&&o.push($)})):(n=!1,o.push(j));let i=j.tree();E(i,"cannot render nodes to svg without a tree"),o=o.map($=>Em($,i,t)),fm(i,r,t);let s={needsXlinks:!1},l=o.map($=>(Ul($,s),Ql($,n,e,r))),d=null,p=a?.fillEnabled&&a.exportIncludesBackground&&!dk(a);if(p&&a){let $=new lm(a.raw({__class:"RectangleShapeNode"}));Ul($,s),d=Ql($,!1,!1,r)}let k=(0,Wa.jsx)(r7,{isStatic:!0,children:(0,Wa.jsxs)("svg",{xmlns:"http://www.w3.org/2000/svg",xmlnsXlink:s.needsXlinks?"http://www.w3.org/1999/xlink":void 0,width:A6(j.width,3),height:A6(j.height,3),fill:"none",overflow:IA(j)?void 0:"visible",children:[p&&d,l]})});return e7({target:A},()=>LE.renderToStaticMarkup(k))}function KE(j){return j.replace(/[\f\n\r\t\v\xa0\u1680\u2000-\u200a\u2028\u2029\u202f\u205f\u3000\ufeff]+/gu," ").replace(/(?:\/|^)(?:\.+\/)+/gmu,"/")}function Ql(j,A,e,t){if(kt(j)){let o=j.getProps(t);return(0,Wl.createElement)(q7,{...o,key:j.id,isRootVectorNode:!1,includeTransform:A},j.children.map(n=>Ql(n,!0,e,t)))}let r=j.getProps(t);return(0,Wl.createElement)(L7,{...r,key:j.id,isRootVectorNode:!1,includeTransform:A})}function Ul(j,A){if(A.needsXlinks||((kt(j)||Ko(j))&&j.children&&j.children.map(p=>Ul(p,A)),kt(j)))return;let{strokeEnabled:e,strokeAlignment:t,strokeWidth:r,fillEnabled:o,fillType:n,fillImage:a,boxShadows:i}=j,s=t==="inside"&&e&&e&&!!r,l=o&&n==="image"&&a!==null,d=i&&!WA(i)&&i.length>0&&i.some(p=>p!==void 0);(s||d||l)&&(A.needsXlinks=!0)}var VE=xd({canvas:()=>{let j=kR();return El(j),ml(j)},onPageCanvas:()=>{let j=uR();return El(j),ml(j)}});function kR(){let j=$j.isDebugBuild?"canvas-sandbox.debug.html":"canvas-sandbox.html",A=Q6(`./${j}`),e=JSON.stringify(Be());return A+`#services=${encodeURIComponent(e)}`}function uR(){let j=$j.isDebugBuild?"canvas-sandbox-on-page.debug.html":"canvas-sandbox-on-page.html",A=Q6(`./${j}`),e=JSON.stringify(Be());return A+`#services=${encodeURIComponent(e)}`}var pj=class pj{constructor(A,e,t,r){this.log=A;this.windowService=e;this.windowRef=t;this.contentWindow=r}static async serviceIfAvailable(){pj.deprecatedServicePromise=pj.deprecatedServicePromise??Il.on(xr).discover({timeout:1e3}),pj.servicePromise=pj.servicePromise??Gl.on(xr).discover({timeout:1e3});try{return await Promise.any([pj.servicePromise,pj.deprecatedServicePromise])}catch{return}}static async isAvailable(){return!!await pj.serviceIfAvailable()}static async new(A){pj.currentWindow&&(pj.currentWindow.contentWindow.close(),pj.currentWindow=void 0);let e=await pj.serviceIfAvailable();E(e,"CustomWindow is not available");let t=kA("electron-window"),r=await e.willOpenWindow(A);t.debug("opening window...");let o=window.open(A.url,"_blank")??void 0;return E(o,"Couldn't open a new DOM window"),t.debug("opened window",o),pj.currentWindow=new pj(t,e,r,o),pj.currentWindow}async openSaveDialog({count:A,pathname:e}){return this.windowService.openSaveDialog({count:A,pathname:e})}async collectMetrics(){return this.windowService.collectMetrics()}async writeToClipboard(A){return this.windowService.writeToClipboard({...A,ref:this.windowRef})}async writeToDisk(A){return this.log.debug("capture....",this.windowRef),this.windowService.writeToDisk({...A,ref:this.windowRef})}async getImageData(A){return"getImageData"in this.windowService?(await this.windowService.getImageData({...A,ref:this.windowRef})).imageData:Promise.reject(new Error("getImageData is not available"))}};R(pj,"deprecatedServicePromise"),R(pj,"servicePromise"),R(pj,"currentWindow");var Sn=pj;var za=class{constructor(){R(this,"controller");R(this,"renderer");R(this,"modules");R(this,"modulesRuntime");R(this,"assets");R(this,"controlsVisibility");R(this,"flags");XA.isOn("newRpc")&&(this.controller=new Bm(zj),this.renderer=this.controller.getRemote(zj.channels.renderer),this.modules=this.controller.getRemote(zj.channels.modules),this.modulesRuntime=this.controller.getRemote(zj.channels.modulesRuntime),this.controlsVisibility=this.controller.getRemote(zj.channels.controlsVisibility),this.assets=this.controller.getRemote(zj.channels.assets),this.flags=this.controller.getRemote(zj.channels.flags))}setLocal({componentsStore:A,loadedExternalModulesStore:e},t){this.controller&&(this.controller.setLocal(zj.channels.rendererListener,t),this.controller.setLocal(zj.channels.componentsStore,A),this.controller.setLocal(zj.channels.loadedExternalModulesStore,e))}};var yn=class{constructor(A){this.callbacks=A;R(this,"experimentListeners",new Map);R(this,"employeesOnlySettingsListeners",new Map);R(this,"projectFeaturesListeners",new Map)}startUpdatesStream(){Object.keys(c6).forEach(A=>{let e=t=>{this.callbacks.updateExperiments({[A]:t})};XA.addListener(A,e),this.experimentListeners.set(A,e)}),Object.keys(l6).forEach(A=>{let e=t=>{this.callbacks.updateEmployeesOnlySettings({[A]:t})};Wj.addListener(A,e),this.employeesOnlySettingsListeners.set(A,e)})}getInitialExperiments(){let A={};return Object.keys(c6).forEach(e=>{A[e]=XA.get(e)}),A}getInitialEmployeesOnlySettings(){let A={};return Object.keys(l6).forEach(e=>{A[e]=Wj.get(e)}),A}initProjectFeatures(){Br.updated.then(()=>{let A={};Object.keys(fl).forEach(e=>{A[e]=Br.get(e)}),this.callbacks.updateProjectFeatures(A),this.projectFeaturesListeners.size===0&&Object.keys(fl).forEach(e=>{let t=r=>{this.callbacks.updateProjectFeatures({[e]:r})};Br.addListener(e,t),this.projectFeaturesListeners.set(e,t)})}).catch(SA)}stopUpdatesStream(){for(let[A,e]of this.experimentListeners)XA.removeListener(A,e);for(let[A,e]of this.employeesOnlySettingsListeners)Wj.removeListener(A,e);for(let[A,e]of this.projectFeaturesListeners)Br.removeListener(A,e);this.experimentListeners.clear(),this.employeesOnlySettingsListeners.clear(),this.projectFeaturesListeners.clear()}},Xa=class{constructor(A){this.remoteFlags=A;let e=new yn(this.remoteFlags);e.startUpdatesStream(),this.remoteFlags.updateExperiments(e.getInitialExperiments()),this.remoteFlags.updateEmployeesOnlySettings(e.getInitialEmployeesOnlySettings())}};var po=class{constructor(){R(this,"experimentsUpdatesEmitter",new we);R(this,"employeesOnlySettingsUpdatesEmitter",new we);R(this,"projectFeaturesUpdatesEmitter",new we);R(this,"flagsUpdater",new yn(this));this.flagsUpdater.startUpdatesStream(),this.experimentsUpdatesEmitter.onNewStream=A=>{if(A?.replay==="latest")return{latest:this.flagsUpdater.getInitialExperiments()}},this.employeesOnlySettingsUpdatesEmitter.onNewStream=A=>{if(A?.replay==="latest")return{latest:this.flagsUpdater.getInitialEmployeesOnlySettings()}},this.projectFeaturesUpdatesEmitter.onNewStream=A=>{this.flagsUpdater.initProjectFeatures()}}updateExperiments(A){this.experimentsUpdatesEmitter.emit(A)}updateEmployeesOnlySettings(A){this.employeesOnlySettingsUpdatesEmitter.emit(A)}updateProjectFeatures(A){this.projectFeaturesUpdatesEmitter.emit(A)}stopUpdatesStream(){this.flagsUpdater.stopUpdatesStream()}experimentsUpdatesStream(A){return this.experimentsUpdatesEmitter.newStream(A)}employeesOnlySettingsUpdatesStream(A){return this.employeesOnlySettingsUpdatesEmitter.newStream(A)}projectFeaturesUpdatesStream(A){return this.projectFeaturesUpdatesEmitter.newStream(A)}};var Ya=kA("setup-rpc-connection"),zl=3e4;function HE(j,A){if(!j)return Promise.resolve();let e=performance.now(),t=gt(),r=j.connect(A);return r.then(()=>{Ya.debug("Connected to controller",j.channelInterface.name),fA("connected_to_sandbox",{correlationId:t,durationMs:Math.round(performance.now()-e),userAgent:navigator.userAgent,visibility:document.visibilityState})}).catch(()=>{Ya.debug("Failed to connect to controller",j.channelInterface.name),fA("connection_to_sandbox_error",{correlationId:t,userAgent:navigator.userAgent,visibility:document.visibilityState,error:"failed to connect"})}),new Xl(zl,()=>{if(j.isConnected)Ya.debug("Controller connected within timeout");else{fA("connection_to_sandbox_error",{correlationId:t,userAgent:navigator.userAgent,visibility:document.visibilityState,error:`not connected within ${zl}ms`});let o=new Error(`RPC connection timeout after ${zl}ms`);Ya.reportCriticalError(o)}}),r}var JE=10,Xl=class{constructor(A,e){this.millis=A;this.callback=e;R(this,"round",0);R(this,"timer",0);R(this,"arm",()=>{this.round>=JE?this.callback():(this.round+=1,this.timer=window.setTimeout(this.arm,this.millis/JE))});this.arm()}cancel(){this.timer&&(clearTimeout(this.timer),this.timer=0)}};async function QE(j,A,e,t,r){if(!e)throw Error("ServiceSandbox: no trusted sandbox origin");if(j){await HE(j,{target:A,url:e}),await j.getRemote(zj.channels.renderer).initialize(An,t);return}let o=!1,n=new Jd(A,e),a=await Us.on(n).discover({timeout:3e4}),i=new po;j||fi.on(n).register(i);let s=An;await a.initialize({renderTarget:t,upgradeToMessagePortChannel:o,treeVersion:s}),r.debug("ServiceSandbox: ready to initialize contentWindow. Establishing channel\u2026");let l=new MessageChannel,d=Us.service.fingerprint;return A.postMessage(d,e,[l.port2]),o&&(i.stopUpdatesStream(),r.debug("ServiceSandbox: unregistering initializer"),await dt.shared().unregister(n)),r.debug("ServiceSandbox: service channel ready"),o?new Vd(l.port1):n}var UE=new WeakMap,Yl=new Set;function WE(j){return UE.get(j())?Promise.resolve():new Promise((A,e)=>{let t=setTimeout(()=>{e(new Error("waitForReadyToInitialize timed out"))},1e4);Yl.add({source:j,resolveReady(){clearTimeout(t),A()}})})}window.addEventListener("message",j=>{if(j.data!==gm)return;let A=j.source;if(A){UE.set(A,!0);for(let e of Yl)e.source()===A&&(Yl.delete(e),e.resolveReady())}},!1);var bn=class extends za{constructor(e,t,r){super();R(this,"log",kA("window-sandbox"));R(this,"channelPromise");R(this,"windowPromise",Qt());this.channelPromise=(async()=>{let o=await Sn.new({...r,url:e.url});return this.log.debug("WindowSandbox: created custom window"),this.windowPromise.resolve(o),this.controller||(await WE(()=>o.contentWindow),this.log.debug("WindowSandbox: loaded")),QE(this.controller,o.contentWindow,e.origin,t,this.log)})()}static async isAvailable(){return Sn.isAvailable()}waitForServiceChannel(){return this.channelPromise}async openSaveDialog({count:e,pathname:t}){return(await this.windowPromise).openSaveDialog({count:e,pathname:t})}async collectMetrics(){return(await this.windowPromise).collectMetrics()}async writeToClipboard(e){return(await this.windowPromise).writeToClipboard(e)}async writeToDisk(e){return(await this.windowPromise).writeToDisk(e)}async getImageData(e){return(await this.windowPromise).getImageData(e)}};var Cn=class{constructor(){R(this,"metricsMap",new Map)}static trackError(A){Tl({exportCount:0,success:!1,scope:"selection",errorReason:A})}createErrorReason({sizeKb:A,hasSavedToDisk:e}){if(!e)return"Export success, but no file was written";if(A===0)return"Export success, but the file is 0kb"}createId({nodeId:A,pixelRatio:e}){return A+"-"+e}mergeElectronMetrics(A){for(let e of A){let t=this.createId({nodeId:e.nodeId,pixelRatio:e.pixelRatio}),r=this.metricsMap.get(t);r&&this.metricsMap.set(t,{...r,sizeKb:e.kb,success:e.hasSavedToDisk})}}add(A,e){let t=this.createId({nodeId:A.nodeId,pixelRatio:A?.pixelRatio??1}),r=this.metricsMap.get(t)??{};this.metricsMap.set(t,{...r,...e})}track(){for(let[A,e]of this.metricsMap){let t=this.createErrorReason({sizeKb:e.sizeKb??0,hasSavedToDisk:e.hasSavedToDisk??!1});Tl({durationMs:e.durationMs,format:e.format,exportCount:e.exportCount,success:e.success,scope:e.scope,sizeKb:e.sizeKb,errorReason:e.errorReason??t})}this.metricsMap.clear()}};function zE(j){for(let A of j.walk())if(ck(A))return!1;return HA(j)||IA(j)||Kr(j)}function XE(j){return qE({...j})}var mR=3,ko=kA("PartialTreeSender"),Za=class{constructor(A,e){this.timeline=A;R(this,"name");R(this,"currentScopeId","");R(this,"timelineCursor");R(this,"scopeBufferMap",new Map);this.name=e+"-"+String(Math.round(Math.random()*1e3))}resetScopeBuffer(A){this.scopeBufferMap.clear(),this.currentScopeId=A??"",A&&(this.timelineCursor=void 0,this.scopeBufferMap.set(A,performance.now()))}updateScopeBuffer(A){if(this.currentScopeId===A)return[void 0,void 0];if(A===nr)return[void 0,void 0];if(this.currentScopeId=A,this.scopeBufferMap.has(this.currentScopeId))return this.scopeBufferMap.set(this.currentScopeId,performance.now()),[void 0,void 0];let e;if(this.scopeBufferMap.size>=mR){let t=Af(),r=1/0,o;for(let[n,a]of this.scopeBufferMap)t.has(n)||r>a&&(r=a,o=n);o&&(this.scopeBufferMap.delete(o),e=o)}return this.scopeBufferMap.set(this.currentScopeId,performance.now()),[e,A]}reset(A){let e=this.timeline.tree;return this.resetScopeBuffer(A),ZE(e,A)}update(A){if(!A)return{};let e=this.timeline.tree,t=this.timeline.fetchForwardChanges(this.timelineCursor);if(!t)return this.timeline.invalidatedByLoadCompletedDocument(this.timelineCursor)?(ko.debug(this.name,"cursor invalidated, sending empty update for load completed document"),this.timelineCursor=this.timeline.getChangeTrackingCursor(),{}):(ko.debug(this.name,"cursor invalidated, sending tree with scope:",A),this.resetScopeBuffer(A),this.timelineCursor=this.timeline.getChangeTrackingCursor(),{name:this.name,tree:ZE(e,A),timestamp:Date.now()});let[r,o]=this.updateScopeBuffer(A);r&&(ko.debug(this.name,"deleting scope by diff:",r),YE(r,t)),t.length===0&&(t=void 0);let n;if(o&&(ko.debug(this.name,"adding scope by subtree:",o),n=this.getScopeSubTree(e,o)),t){let a=this.getAffectedScopeIDsAfterCrossScopeMove(e,t);for(let i of a){if(i!==this.currentScopeId){this.scopeBufferMap.has(i)&&(ko.debug(this.name,"deleting scope due to cross-scope move:",i),YE(i,t),this.scopeBufferMap.delete(i));continue}n||(ko.debug(this.name,"resending tree with scope due to cross-scope move:",i),n=this.getScopeSubTree(e,i))}}return{changes:t,scopes:n?[n]:void 0,timestamp:Date.now()}}getScopeSubTree(A,e){let t=A.get(e);return or(t)&&E(t.isLoaded(),"Scope must be loaded"),ER(t)}getAffectedScopeIDsAfterCrossScopeMove(A,e){let t=new Set;for(let r of e){if(!r.previousScope||!r.to.parentid)continue;let o=A.get(r.id),n=A.getScopeNodeFor(o);n&&t.add(n.id)}return t}};function YE(j,A){A.push({id:j,removed:"CanvasNode",to:{}})}function ER(j){if(j)return w6.valueFromNode(j)}function Af(){return new Set([Pt,fa,tm,ie,hu,nr])}function ZE(j,A){let e=Af();A&&e.add(A);let t=j.getNodes(e).map(a=>w6.valueFromNode(a)),r=j.root,o,n={};for(o in r)z7[o]||(n[o]=r[o]);return{version:An,root:{...n,__class:"RootNode",id:j.root.id,children:t}}}function jf(j,A){let e=Zr(j);if(!e)return A;let t=new Map(A.map(o=>[o.id,o])),r=[];for(let o of e.walk()){if(!ft(o)||!o.webPageId)continue;let n=t.get(o.webPageId);n&&r.push(n)}return r}function ef(j,A,e=!1,t=!1){let r=A?.[j];if(r)return r;if(j===fp&&e)return t?"Key":"Key & Gamepad";if(t&&j==="onMouseEnter")return"Enter";let n=(j.startsWith("on")&&j.length>2?j.substring(2):j).replace("Tap","Click");return bi(n)}function fR(){let j=null,A=null;return e=>{let t=K.componentForIdentifier(e.codeComponentIdentifier);if(t===j)return A;if(!t||!t.properties)return null;let r={},o=Object.keys(t.properties);for(let n=0,a=o.length;n<a;n++){let i=o[n],s=t.properties[i];s?.type==="eventhandler"&&s.title&&(r[i]=s.title)}return j=t,A=r,r}}var fx=fR();function $R(j){if(j.type!=="controlReference"&&j.type!=="nodePropertyControlReference")return;let{expectedType:A}=j;E(A==="enum"||A==="segmentedenum"||A==="file")}function Gx({galleryImageId:j,isSmartComponent:A}){return A?Array(4).fill(null).map(()=>({id:Ej(),type:"object",value:{[j]:{type:"image",value:void 0}}})):[]}function tf(j,A){return E(j.type!=="responsiveimage",`Image variables are compiled to be responsive images. To
        prevent confusion we don't allow creation of type responsive images.
        Because that would mean that two different types represent the same thing.`),$R(j),j.type!=="trackingid"&&j.type!=="vectorsetitem"&&fA("variable_create",{scopeType:A,variableType:j.type}),j.type==="image"&&(_(j.initialValue)?Zs(j.initialValue)||(j.initialValue=void 0):te(j.initialValue)&&_(j.initialValue.value)&&(Zs(j.initialValue.value)||(j.initialValue=void 0))),j.type==="array"&&A==="canvas_component"&&(E(j.minCount===void 0,"minCount should not be lifted to component"),E(j.maxCount===void 0,"maxCount should not be lifted to component")),{id:Ej(),...j}}function BR(j,A){let e=new Set(j.variables.map(t=>t.name));return Nj(bi(A),e)}function gR(j){switch(j.type){case"controlReference":case"nodePropertyControlReference":switch(j.expectedType){case"enum":return"Type";case"file":return"File";default:throw Error(`getFallbackNameForCreateVariableOptions(), unsupported file reference type: ${j.expectedType}`)}default:return Kp(j.type)}}function hR(j,A){if(j==="richtext")return A.length;let e=Xt;return A.forEach((t,r)=>{if(!je(e)){if(t.type!=="richtext"){Y(e)&&(e=Jt);return}J7(e)||(e=r)}}),Y(e)?e:A.length}function RR(j){return tj(j)?"collection":ij(j)?"layout_template":(tA(j)||E(!0,"Should not be able to create variables on invalid scope",j.__class),"canvas_component")}function Zl(j,A){let{scopeId:e,isAssigned:t=!0,useUniqueName:r=!0,...o}=A,n=j.get(e);if(!n||!Ye(n))return null;let a=A.name.trim(),i=a||gR(A),s=r?BR(n,i):i,l=tf({...o,name:s},RR(n));if(l.type==="eventhandler"&&!tA(n))return null;let d=hR(l.type,n.variables),p=he.insert(n.variables,d,l);return n.set({variables:p}),t&&Xm({variableType:l.type,variableId:l.id}),Jj(l.id,n.id)}function Lx(j){let{engine:A,showModal:e=!0,...t}=j,r=Zl(A.tree,t);if(!r)return null;let o=A.tree.get(j.scopeId);return!o||!Ye(o)?null:(lo(A)&&e&&(A.stores.variablesStore.selectedVariableId=r.id,A.stores.modalStore.set({type:"Variables",source:"properties"})),Jj(r.id,o.id))}var IR=kA("createAndAssignActionVariableToNode");function rf(j,A,e,t,r){if(!(Se(A)||X(A)))return null;let o=j.getScopeNodeFor(A);if(!o||!tA(o))return null;let n=j.getGroundNodeFor(A);if(!n||!aj(n))return null;let a=K.componentForIdentifier("framer/useTriggerEvent");if(!a)return null;let i=Zl(j,{scopeId:o.id,type:"eventhandler",name:t??ef(e,null),initialValue:void 0});if(!i)return null;ua(j,A,e,a,{id:{type:"string",value:i.id}});let s=o.getTopLevelReplicaVariants();for(let l of s){let{overrides:d}=l.replicaInfo;d[A.id]&&ou(j,l,A.id,e,a,{id:{type:"string",value:i.id}})}return r&&r.updateComponent(o.id).catch(l=>IR.error(l)),i.id}function FR(j){let A=ka(j);if(Object.keys(A).length!==0)for(let t in A){let r=A[t];if(r&&r.length===0)return t}}function GR(j,A,e){switch(A){case"framer/useShowOverlay":return j.create(wu,e);case"framer/useShowRelativeOverlay":return j.create(fe,e,{width:200,height:150,radius:10,boxShadows:[U7({x:0,y:10,blur:20,color:"rgba(0,0,0,0.05)",spread:0})],floatingPositionEnabled:!0,floatingPlacement:Ui,floatingAlignment:Wi,floatingOffsetX:Ip,floatingOffsetY:Fp,floatingCollisionDetection:!0,floatingCollisionPadding:Rp});default:lA(A)}}function SR(j,A,e,t){e&&E(A==="framer/useShowOverlay"&&qo(e)||A==="framer/useShowRelativeOverlay"&&(mA(e)||X(e)),"Invalid overlay type: ",e.__class,"for overlay action: ",A);let r=e??GR(j,A,t.id);return gj(r)&&r.set({zIndex:Vp,styleAppearEffectEnabled:!0,styleAppearEffectTrigger:"onMount",overflow:ye(),position:"absolute",...cu.fadeIn()}),r}function yR(j,A,e,t,r){E(jn(e),"Parent is not a local smart component instance, events can't be created");let o=ok(j,e);j.loadScopes([o],([n])=>{if(!n)return;let a=n.getPrimaryVariant();E(a,"SmartComponentNode should have a primary variant");let i=rf(j,a,t,t==="onMouseEnter"?"Hover":void 0,A);E(i,"Should be able to create event key for local smart component node"),r(i)})}function of(j,A,e,t,r){let o=K.componentForIdentifier(A);E(o,"Cannot find overlay action definition"),ua(j,r,t,o,{overlay:{type:"string",value:e.id}},!0)}function bR(j){switch(j){case"framer/useShowOverlay":return"fixed";case"framer/useShowRelativeOverlay":return"relative";default:lA(j)}}function As({treeStore:j,codeGenerationStore:A},e,t,r){let o=j.tree.get(t);if(!o)return;let n=gA(o)?j.tree.get(o.originalid):o;if(!n||!Se(n)&&!X(n))return;let a=e==="framer/useShowRelativeOverlay"?"onMouseEnter":"onTap",i=X(n)?FR(n):a,s=jn(n);if(!i&&!s)return;let l=SR(j.tree,e,r,n);return i?of(j.tree,e,l,i??a,n):yR(j.tree,A,n,a,d=>of(j.tree,e,l,d,n)),fA("overlay_create",{source:r?"duplicate":"events_panel",overlayType:bR(e)}),l}var nf=kA("ScopeStore");function vn(j){return dj(j,!0)||V(j,!0)||Hj(j,!0)}function af(j){if(dj(j))return"CanvasPage";if(V(j))return"WebPage";if(tA(j))return"SmartComponent";if(qr(j))return"ContentManagement";if(ij(j))return"LayoutTemplate";if(re(j))return"VectorSet";if(D7(j))return"Analytics";if(N7(j))return"LocalizationGlossary";if(Hj(j))return"DesignPage";throw Error(`Failed to return scope type, invalid scope: ${j.__class}`)}var Rr,Ir,Fr,Gr,uo,Zj,nt,Mt,mo,Eo,fo,sf=class extends ae{constructor(e,t,r,o,n,a,i,s,l,d,p,k){super();this.treeStore=e;this.canvasStore=t;this.selection=r;this.chromeStore=o;this.contentManagementStore=n;this.modalStore=a;this.overlayStore=i;this.codeGenerationStore=s;this.insertSidebarStore=l;this.modulesStore=d;this.aiGenerationStore=p;this.setHighlight=k;xA(this,Rr,0);R(this,"isCheckingActivePage",!0);xA(this,Ir,"");xA(this,Fr,"");xA(this,Gr,"");xA(this,uo,"");xA(this,Zj,[]);xA(this,nt,!1);xA(this,Mt,!1);xA(this,mo,new Map);xA(this,Eo,new Map);R(this,"loadingActiveId");R(this,"_activeId");R(this,"scopeSwitchStart",0);R(this,"scopeSwitchPending",!1);R(this,"scopeIdToSelectedCollectionItem",new Map);R(this,"rootScopeType","CanvasPage");xA(this,fo,[]);R(this,"canGoBack",()=>eA(this,nt));R(this,"goBack",()=>{let e=Array.from(this.isolatedCanvasNodes());e.pop();let t=e.pop();t&&this.select(t.id,{keepHistory:!1})});let g=this.getFirstPageNodeAccordingToUI();this._activeId=g.id,Zo(g),dj(g)?hA(this,Ir,g.id):V(g)?hA(this,Fr,g.id):Hj(g)&&hA(this,Gr,g.id);let $=this.getScopeNodes();hA(this,Rr,$.indexOf(g)),E(g.loaded,"Scope must be fully loaded"),l.onScopeChange({scope:g.loaded,hasCanvasPageNodes:this.hasCanvasPageNodes(),hasWebPageNodes:this.hasWebPageNodes()}),this.modulesStore.setActiveScope(this._activeId)}get activeId(){return this._activeId}get active(){let e=this.getScopeNode(this._activeId);return E(e.isLoaded(),"Scope must be fully loaded"),e}get rootNode(){return this.treeStore.tree.root}get checkingActivePage(){return this.isCheckingActivePage}documentDidLoad(){this.isCheckingActivePage=!1}get scopeType(){return af(this.active)}getScopeNode(e){let t=this.treeStore.tree.get(e);return E(t instanceof b6,"Node, ",e,"is not a ScopeNode"),t}getScopeNodes(){return this.rootNode.children.filter(or)}getCanvasPageNodes(){return this.rootNode.children.filter(dj)}getDesignPageNodes(){return this.rootNode.children.filter(Hj)}getSmartComponentNodes(){return this.rootNode.children.filter(tA)}getLayoutTemplateNodes(){return this.rootNode.children.filter(ij)}getWebPageNodes(){return this.rootNode.children.filter(V)}getWebPageNodesWithoutCollection(){return this.rootNode.children.filter(e=>V(e,!0)&&!e.dataIdentifier)}getWebPageNodesWithCollection(e=!1){let t=this.rootNode.children.filter(r=>!!(V(r)&&r.dataIdentifier));return e?jf(this.treeStore.tree,t):t}hasPages(){let e=!1,t=!1,r=!1,o=!1;for(let n of this.rootNode.children)if(dj(n)&&(r=!0),Hj(n)&&(o=!0),V(n)&&(n.dataIdentifier?t=!0:e=!0),e&&t&&r&&o)break;return{hasSitesPages:e,hasCMSPages:t,hasCanvasPages:r,hasDesignPages:o}}hasCanvasPageNodes(){return this.rootNode.children.some(dj)}hasWebPageNodes(){return this.rootNode.children.some(V)}getCanvasPageAndWebPageNodes(){return this.rootNode.children.filter(vn)}getFirstPageNodeAccordingToUI(e=this.treeStore.tree){let{children:t,homePageNodeId:r}=e.root;return Rm(t,r)}getFirstWebPageNode(){try{let e=this.getFirstPageNodeAccordingToUI();if(V(e))return e}catch{}}changeActive(e,t,r){if(this._activeId){let i=e.get(this._activeId),s=V(i)&&i.abTestingParentId?i.abTestingParentId:this._activeId;eA(this,mo).set(s,{zoom:this.canvasStore.zoom,offset:this.canvasStore.offset}),eA(this,Eo).set(this._activeId,this.selection.ids),tA(i)&&fA("component_canvas_exit",{componentId:this._activeId})}if(hA(this,uo,this._activeId),hA(this,Rr,r),this._activeId=t.id,Zo(t),this.codeGenerationStore.changeScope(),this.modulesStore.changeScope(t),Hj(t))this.rootScopeType="DesignPage",hA(this,Gr,t.id),hA(this,Zj,[]),hA(this,nt,!1),hA(this,Mt,!1);else if(dj(t))this.rootScopeType="CanvasPage",hA(this,Ir,t.id),hA(this,Zj,[]),hA(this,nt,!1),hA(this,Mt,!1);else if(V(t))this.rootScopeType="WebPage",hA(this,Fr,t.id),hA(this,Zj,[]),hA(this,nt,!1),hA(this,Mt,Kj(t));else if(tA(t)||ij(t)||re(t)){let i=eA(this,Zj).indexOf(t.id);i===-1?eA(this,Zj).push(t.id):eA(this,Zj).splice(i+1),hA(this,nt,eA(this,Zj).length>0),hA(this,Mt,!1),Qm({componentId:t.id}),tA(t)&&this.chromeStore.mainView===0&&this.modalStore.displayComponentIsolationModal({source:"automatic"})}let o=eA(this,mo).get(V(t)&&t.abTestingParentId?t.abTestingParentId:t.id);o?this.canvasStore.updateCanvas(o.offset,o.zoom):this.canvasStore.zoomAfterScopeSwitch(e,t);let n=eA(this,Eo).get(t.id);n?this.selection.set(n):this.selection.clear(),this.overlayStore.hideAll(),this.insertSidebarStore.onScopeChange({scope:t,hasWebPageNodes:this.hasWebPageNodes(),hasCanvasPageNodes:this.hasCanvasPageNodes()}),this.setHighlight(null);let a=af(t);this.chromeStore.onChangeScopeType(a),this.contentManagementStore.onChangeScopeType(a),this.aiGenerationStore.setCurrentSessionId(a==="DesignPage"?t.id:void 0)}select(e,{keepHistory:t,activateContentPanel:r,collectionItemId:o}){this.loadingActiveId=e,this.scopeSwitchStart=performance.now();let n=()=>{if(this.scopeSwitchPending=!1,this.loadingActiveId!==e||this._activeId===e)return;let s=this.getScopeNodes().findIndex(k=>k.id===e);E(s!==-1,"Tree must contain scope node");let d=this.treeStore.tree.latestTree().getNode(e);E(or(d),"Tree must contain scope node");let p;if(d.isLoaded())p=d.loaded;else if(!this.treeStore.tree.getService("loader"))nf.reportError(new ReferenceError("Loader service is not available in the tree but scope is not loaded"),{message:"Scope must be fully loaded"},{shallowScopes:"true"}),p=d;else throw new TypeError("Scope must be fully loaded");t||hA(this,Zj,[]),_(o)&&V(d)&&this.setSelectedCollectionItemForWebPage(d.id,o),r&&(this.chromeStore.contentPanelTab=r),this.changeActive(this.treeStore.tree,p,s)},a=this.treeStore.tree.getService("loader");if(a&&!a.hasLoadedScope(e)){this.scopeSwitchPending=!0,a.prioritizeLoadingScope(e,()=>this.processWhenReady(n));return}n()}selectByNode(e){let t=this.treeStore.tree.get(e);if(t===null)return;let r=this.treeStore.tree.getScopeNodeFor(t);r!==null&&this.select(r.id,{keepHistory:!1})}selectPreviousActiveScope(){let e=this.treeStore.tree.get(eA(this,uo));this.select(e?.id??this.getFirstPageNodeAccordingToUI().id,{keepHistory:!1})}findNextActiveScope(e=this.treeStore.tree){let t=e.root,r=t.children.filter(or);E(t.children.some(vn),"validateActiveScope: Tree must contain at least one Canvas Page or Web Page");let o=r.findIndex(n=>n.id===this._activeId);return o===-1&&(o=this.findNextAvailablePageIndex(r,eA(this,Rr))),[r[o],o]}validateActiveScope(e=this.treeStore.tree,t=!1){let[r,o]=this.findNextActiveScope(e);E(r,"ScopeNode must be defined"),t||E(r.isLoaded(),"Scope must be fully parsed"),hA(this,Rr,o);let n=r;return r.id!==this._activeId&&(this.scopeSwitchStart=performance.now(),this.scopeSwitchPending=!1,this.changeActive(e,n,o)),n}findNextAvailablePageIndex(e,t){let r=[],o=[];for(let s=0;s<e.length;s++){let l=e[s];V(l)?o.push(s):dj(l)&&r.push(s)}let n=this.rootScopeType==="WebPage",a=n?o:r,i=n?r:o;return CR(a.length>0?a:i,t)}renameScope(e,t){this.getScopeNode(e).set({name:t})}getActiveScopeNodeForReset(e=this.treeStore.tree,t=null){if(t){let o=e.getScopeNodeFor(e.get(t));if(Im(o)&&o?.isValid())return o}let r=this.getFirstPageNodeAccordingToUI(e);if(V(r)&&r.isValid()&&r.loaded||dj(r)&&r.loaded)return r.loaded;nf.warn("getActiveScopeNodeForReset: falling back to scanning for a useful scope to make active");for(let o of e.root.children)if(dj(o)&&o.isValid()&&o.loaded||V(o)&&o.isValid()&&o.loaded)return o.loaded;for(let o of e.root.children)if(tA(o)&&o.isValid()&&o.loaded)return o.loaded;throw Error("Document does not have any scopes that can be set to active.")}resetActiveScope(e=this.treeStore.tree,t=void 0){let r=this.getActiveScopeNodeForReset(e,t);if(r.id===this._activeId)return;this._activeId="",hA(this,Ir,""),hA(this,Gr,""),hA(this,Fr,""),hA(this,uo,""),eA(this,mo).clear(),eA(this,Eo).clear(),E(r.isLoaded(),"Scope must be fully parsed");let o=e.root.children.indexOf(r);this.scopeSwitchStart=performance.now(),this.scopeSwitchPending=!1,this.changeActive(e,r,o)}movePage(e,t){let r=this.getScopeNode(e),o=[];Hj(r)?o=this.getDesignPageNodes():dj(r)?o=this.getCanvasPageNodes():E(!r,"Scope is not movable",r);let n=o[t];E(n,`Trying to move a page node to an invalid index: ${t}, total: ${o.length} page nodes.`);let a=this.rootNode.children.findIndex(i=>i.id===n.id);E(r.parentid,"Scope node has no parentid"),E(a!==-1,"Cant find scope in root node"),this.treeStore.tree.moveNode(r,r.parentid,a)}getParentId(e,t){let r=this.rootNode.id;if(e instanceof b6||wr(e))return r;let o=this.active,n=o.id;return qr(o)&&E(qi(e),"ContentManagementNode only accepts content nodes"),t===r?n:t??n}insertNode(e,t,r,o){t=this.getParentId(e,t),Qj(e)&&As({codeGenerationStore:this.codeGenerationStore,treeStore:this.treeStore},gj(e)?"framer/useShowRelativeOverlay":"framer/useShowOverlay",t,e),this.treeStore.tree.insertNode(e,t,r,o)}insertNodes(e){for(let t of e)this.insertNode(t,t.parentid)}moveNode(e,t,r,o){t=this.getParentId(e,t),this.treeStore.tree.moveNode(e,t,r,o)}removeNode(e){this.treeStore.tree.removeNode(e),e.id===this._activeId&&this.validateActiveScope(this.treeStore.tree,!0)}setSelectedCollectionItemForWebPage(e,t){if(this.scopeIdToSelectedCollectionItem.get(e)===t)return;let o=new Map(this.scopeIdToSelectedCollectionItem);o.set(e,t),this.scopeIdToSelectedCollectionItem=o}getSelectedCollectionItemForScope(e){if(V(e))return this.scopeIdToSelectedCollectionItem.get(e.id)}getMostRecentPage(){switch(this.rootScopeType){case"CanvasPage":{let e=this.treeStore.tree.get(eA(this,Ir));if(dj(e))return e;break}case"DesignPage":{let e=this.treeStore.tree.get(eA(this,Gr));if(Hj(e))return e;break}case"WebPage":{let e=this.treeStore.tree.get(eA(this,Fr));if(e&&or(e)&&V(e))return e;break}}return this.getFirstPageNodeAccordingToUI()}getComponentHistory(){if(eA(this,Zj).length===0)return[];let e=this.active;if(!(tA(e)||ij(e)||re(e)))return[];let t=[],r;for(let o of eA(this,Zj)){let n=this.treeStore.tree.getNode(o);(tA(n)||ij(n)||re(n))&&n.isLoaded()&&(t.push(n),r=n)}return r===e?t:[e]}get onIsolatedCanvas(){return eA(this,nt)}get onCollectionPage(){return eA(this,Mt)}isolatedCanvasNodes(){let e=this.active,t;return vn(e)?t=[e]:t=[this.getMostRecentPage(),...this.getComponentHistory()],Wt(eA(this,fo),t)?eA(this,fo):(hA(this,fo,t),t)}getTopMostWebPageNode(){for(let e of this.isolatedCanvasNodes())if(V(e))return e}};Rr=new WeakMap,Ir=new WeakMap,Fr=new WeakMap,Gr=new WeakMap,uo=new WeakMap,Zj=new WeakMap,nt=new WeakMap,Mt=new WeakMap,mo=new WeakMap,Eo=new WeakMap,fo=new WeakMap;function CR(j,A){for(let e of j)if(!(e<A))return e;return Math.max(...j)}var HO=xr,cf=$j.isAutomation?xr:Kd;var js=class{constructor(A,e){R(this,"sandbox");R(this,"log");R(this,"engine");R(this,"wantsEngineUpdates");R(this,"renderState");R(this,"partialTreeSender");R(this,"timelineCursor");R(this,"onSandboxServicesReady");R(this,"onSandboxStateChange",A=>{typeof A!="boolean"&&this.log.reportError(A)});R(this,"onSandboxRender");R(this,"fail",A=>{this.readyForRenderingPromise.reject(A),this.onSandboxStateChange?.(A)});R(this,"renderServiceIfDiscovered");R(this,"readyForRenderingPromise",Qt());R(this,"flagsService",new po);R(this,"lastSandboxTreeUpdate",0);R(this,"onRenderedUpdate",A=>{this.lastSandboxTreeUpdate&&(this.lastSandboxTreeUpdate<A.update?(this.fail(new Error(`dropped tree update: ${this.lastSandboxTreeUpdate} < ${A.update}`)),this.lastSandboxTreeUpdate=0):this.lastSandboxTreeUpdate===A.update&&(this.lastSandboxTreeUpdate=0)),this.onSandboxRender&&(this.onSandboxRender(A),this.updateGroundNodeOverflowSizes());let{scopeId:e,scopeSwitchStartTime:t,renderEndTime:r,updateEndTime:o}=A;if(t&&o&&r){let n=Math.round(o-t),a=Math.round(r-t),{scopeStore:i}=this.engine.stores,{scopeSwitchStart:s,scopeSwitchPending:l,activeId:d}=i,p=a,k=!1;d===e&&(p=performance.now()-s,k=l);let g=this.engine.tree.get(e);g&&vn(g)&&Jm({pageId:e,renderDurationMs:a,updateDurationMs:n,totalDurationMs:p,neededLoading:k})}});R(this,"onChannelReady",async A=>{if(A){let r=await Hd.on(A).discover({timeout:3e4});this.log.debug("Discovered render service"),this.renderServiceIfDiscovered=r,r.renderedUpdateStream({oneway:!0}).read(this.onRenderedUpdate).catch(this.fail),fi.on(A).register(this.flagsService)}let{modulesStore:e}=this.engine.stores;this.sandbox.modules?e.getModulesUpdatesService().moduleUpdatesStream({replay:"latest"}).read(r=>this.sandbox.modules?.updateModules(r.patches,r.dependentModules,r.prioritizedModules,r.initialized,r.revision)).catch(this.fail):(E(A,"neither old or new rpc defined for modules"),Qd.on(A).register(e.getModulesUpdatesService()));let t=new we;t.emit({}),A&&Qs.on(A).register({assetUpdatesStream:t.newStream}),j7(Qs.on(cf).discover(),async r=>{this.sandbox.assets?r.assets&&this.sandbox.assets.oneway.updateAssets(r.assets):t.emit(r)}),this.onSandboxServicesReady&&(this.renderServiceIfDiscovered?await this.onSandboxServicesReady(A,this.renderServiceIfDiscovered):this.sandbox.renderer&&await this.onSandboxServicesReady(A,this.sandbox.renderer)),this.wantsEngineUpdates&&(this.engine.addSandbox(this),this.engine.changes.observe("PendingBundle",()=>this.update(!0)),this.engine.loadWasCalled&&this.update(!0)),this.log.debug("Initialized render sandbox"),this.onSandboxStateChange?.(!0),this.renderServiceIfDiscovered?this.readyForRenderingPromise.resolve(this.renderServiceIfDiscovered):this.sandbox.renderer&&this.readyForRenderingPromise.resolve(this.sandbox.renderer)});R(this,"previousTransform");R(this,"previousActiveLocaleId");R(this,"previousIsReadyToRender");R(this,"previousPerformanceMode");R(this,"previousLoadedAllUserData");R(this,"previousRenderScope");R(this,"previousRenderNodes");R(this,"previousSelection");R(this,"previousNodeInTextEditor");R(this,"previousNodeInEffectPreview");R(this,"previousActiveEffect");R(this,"previousActiveEffectIds");R(this,"previousNodesInMoveToolRootFontSize");R(this,"previousActiveOverlays");R(this,"previousPlaceholder");R(this,"previousRootFontSize");R(this,"previousIsDarkMode");R(this,"previousScopeIdToSelectedCollectionItem");R(this,"previousShouldSetMinHeight");R(this,"previousActiveLinkStyle");R(this,"update",(A=!0)=>{let e=this.renderState(),t=e.transform,r=!Re(t,this.previousTransform);if(this.previousTransform=t,!A)return this.sendSandboxUpdate(void 0,r?t:void 0);let o=!1,n={},a=this.engine,{treeStore:i,loadingStore:s,chromeStore:l,persistedUserDefaults:d}=a.stores,p=i.timeline,k="renderScope"in e?e.renderScope:void 0;k!==this.previousRenderScope&&(this.previousRenderScope=k,o=!0,n.renderScope=k),this.previousRenderScope||(this.previousRenderScope=p.tree.root.children[0]?.id??"");let g=!Wj.isOn("disablePartialTreeInSandbox");if(!this.partialTreeSender&&g?(this.partialTreeSender=new Za(p,"sandbox"),this.timelineCursor=void 0):this.partialTreeSender&&!g&&(this.partialTreeSender=void 0),this.partialTreeSender){p.legacyMode=!1;let v=this.partialTreeSender.update(this.previousRenderScope);n.partialTreeUpdate=v,v.tree?(o=!0,r=!0,n.loadedSomeUserData=s.isDocumentLoaded):(v.changes||v.scopes)&&(o=!0)}else{let v=p.fetchForwardChanges(this.timelineCursor);p.legacyMode=!0,v?(this.log.trace("change tracking cursor changes:",v.length),v.length>0&&(n.changes=v,o=!0)):(this.timelineCursor=p.getChangeTrackingCursor(),this.log.debug("change tracking cursor invalidated, sending full tree:",p.tree.size()),p.tree.beginAllowPartialScopeAccess(),n.tree=p.tree.toJS(),p.tree.endAllowPartialScopeAccess(),o=!0,r=!0,n.loadedSomeUserData=s.isDocumentLoaded)}XA.isOn("debugEditWhileNeverLoadingRest")?!this.previousLoadedAllUserData&&s.hasMinimalEditableData&&(this.previousLoadedAllUserData=!0,n.loadedAllUserData=!0):!this.previousLoadedAllUserData&&s.hasFullDocumentData&&(this.previousLoadedAllUserData=!0,n.loadedAllUserData=!0);let $=l.canvasLocaleId;$!==this.previousActiveLocaleId&&(this.previousActiveLocaleId=$,o=!0,n.activeLocaleId=$);let F=s.assetMapLoaded;F!==this.previousIsReadyToRender&&(this.previousIsReadyToRender=F,o=!0,n.isReadyToRender=F);let I=d.performanceMode;I!==this.previousPerformanceMode&&(this.previousPerformanceMode=I,o=!0,n.performanceMode=I);let S="renderNodes"in e?e.renderNodes:void 0;Re(S,this.previousRenderNodes)||(this.previousRenderNodes=S,o=!0,n.renderNodes=S);let T="isDarkMode"in e?e.isDarkMode:void 0;T!==this.previousIsDarkMode&&(this.previousIsDarkMode=T,o=!0,n.isDarkMode=T);{let v=e.editor,P=v?.selection;P!==this.previousSelection&&(this.previousSelection=P,o=!0,n.selection=P);let N=v?.nodeInTextEditor;N!==this.previousNodeInTextEditor&&(this.previousNodeInTextEditor=N,o=!0,n.nodeInTextEditor=N);let Q=v?.nodesInEffectPreview;Re(Q,this.previousNodeInEffectPreview)||(this.previousActiveEffectIds=Q,o=!0,n.nodesInEffectPreview=Q);let w=v?.nodesInMoveToolRootFontSize;Re(w,this.previousNodesInMoveToolRootFontSize)||(this.previousNodesInMoveToolRootFontSize=w,o=!0,n.nodesInMoveToolBaseFontSize=w);let iA=v?.activeEffect;iA!==this.previousActiveEffect&&(this.previousActiveEffect=iA,o=!0,n.activeEffect=iA);let z=v?.activeEffectIds;Re(z,this.previousActiveEffectIds)||(this.previousActiveEffectIds=z,o=!0,n.activeEffectIds=z?new Set(z):null);let pA=v?.activeOverlayNodes;pA!==this.previousActiveOverlays&&(this.previousActiveOverlays=pA,o=!0,n.activeOverlayNodes=pA);let D=v?.dragAndDropPlaceholders;D!==this.previousPlaceholder&&(this.previousPlaceholder=D,o=!0,n.placeholder=D);let J=v?.rootFontSize;J!==this.previousRootFontSize&&(this.previousRootFontSize=J,o=!0,n.rootFontSize=J);let H=v?.scopeIdToSelectedCollectionItem;H&&H!==this.previousScopeIdToSelectedCollectionItem&&(this.previousScopeIdToSelectedCollectionItem=H,o=!0,n.scopeIdToSelectedCollectionItem=H,k&&k===this.previousRenderScope&&(n.renderScope=k));let Z=v?.shouldSetMinHeight;Z!==this.previousShouldSetMinHeight&&(this.previousShouldSetMinHeight=Z,o=!0,n.shouldSetMinHeight=Z);let sA=v?.activeLinkStyle;sA!==this.previousActiveLinkStyle&&(this.previousActiveLinkStyle=sA,o=!0,n.activeLinkStyle=sA??null)}return this.sendSandboxUpdate(o?n:void 0,r?t:void 0)});R(this,"groundNodeOverflowSizes",{});this.sandbox=A,this.log=e.log,this.engine=e.engine,this.wantsEngineUpdates=e.wantsEngineUpdates,this.renderState=e.renderState,A.setLocal(e.engine.stores,{renderedUpdate:this.onRenderedUpdate,error:e.handleSandboxError??(()=>{}),heartbeat:e.heartbeat??(()=>{})}),A.waitForServiceChannel().then(this.onChannelReady).catch(this.fail),A.controller&&A.controller.waitUntilConnected().then(()=>{A.flags&&new Xa(A.flags)}).catch(t=>{this.log.error("Error while waiting for flags service",t)})}sendSandboxUpdate(A,e){if(A||e){A?.tree&&(this.lastSandboxTreeUpdate=this.engine.update),A&&(A.timestamp=Date.now());let t={type:"SandboxUpdate",update:this.engine.update,document:A,transform:e};return this.renderServiceIfDiscovered?this.renderServiceIfDiscovered.update({fixmeOpaqueJSON:t}):this.sandbox.renderer&&this.sandbox.renderer.oneway.updateSandbox(t),!0}return!1}command(A,e){this.renderServiceIfDiscovered?this.renderServiceIfDiscovered.update({fixmeOpaqueJSON:{command:A,args:e}}):this.sandbox.renderer&&this.sandbox.renderer.oneway.updateSandbox({command:A,args:e})}updateGroundNodeOverflowSizes(){let A=this.engine.tree.get(this.previousRenderScope);Zo(A);let e=A?.children;if(!e)return;let t=!1;for(let o of e){let n=o.cache,a=this.groundNodeOverflowSizes[o.id];hm(n,a)||(t=!0,this.groundNodeOverflowSizes[o.id]={minX:n.minX,maxX:n.maxX,minY:n.minY,maxY:n.maxY})}let r=Object.keys(this.groundNodeOverflowSizes);if(r.length>e.length){t=!0;let o=new Set(r);for(let n of e)o.delete(n.id);for(let n of o)delete this.groundNodeOverflowSizes[n]}t&&this.command("updateGroundNodeOverflowSizes",this.groundNodeOverflowSizes)}async renderUpdates(A){let e=await this.readyForRenderingPromise;await e.willStartUpdates(),A(),this.update(),await e.waitForCompleteRenderAfterUpdates()}get renderService(){return this.renderServiceIfDiscovered||this.sandbox.renderer||void 0}async measureNodes(A){return this.renderService?.measureNodes(A)}async getFitTextViewBoxes(A){return this.renderService?.getFitTextViewBoxes(A)}async fetchJSON(A){return this.renderService?.fetchJSON(A)}async getComponentRenderingError(A){return this.renderService?.getComponentRenderingError(A)}async preloadFonts(A){return this.renderService?.preloadFonts(A)}async waitUntilPlaceholdersSettled(){await this.renderService?.waitUntilPlaceholdersSettled()}};var es=class{constructor(A,e){R(this,"log",kA("node-snapshots"));R(this,"engine");R(this,"renderer");R(this,"renderState",{renderNodes:{},transform:[0,0,1],isDarkMode:!1});this.engine=e,this.renderer=new js(A,{log:this.log.extend("renderer"),engine:this.engine,wantsEngineUpdates:!1,renderState:()=>this.renderState})}renderToSVG({nodeId:A}){this.log.debug("preparing SVG");let t=this.engine.tree.getNode(A);if(!t)throw Error(`Node ${A} doesn't exist`);if(!zE(t))throw Error(`Node ${A} must be exportable as SVG`);return XE({node:t,isDarkMode:this.engine.stores.documentSettingsStore.hasDarkAppearance,combinedVariableValueMap:t.cache.getUnsafeCombinedVariableValueMap()})}async prepareNodeSnapshot({nodeId:A,zoom:e=1,pixelRatio:t=1}){this.log.debug("preparing snapshot");let r=this.engine.tree,o=r.getNode(A);if(!o)throw Error(`Node ${A} doesn't exist`);let n=r.getRect(o),a=vR(r,o),i=Fm(r,o),s={...n,x:a.x-i.x,y:a.y-i.y};t!==1&&(e*=t),this.log.debug("rendering");let l=this.engine.stores.scopeStore.active;return await this.renderer.renderUpdates(()=>{let{treeStore:d,toolStore:p,scopeStore:k,modulesStore:g,documentSettingsStore:$,propertiesPanelStore:F,overlayStore:I,selectionStore:S,effectStore:T}=this.engine.stores;this.renderState.renderScope=d.treeIndex.getScopeIdFor(o.id),this.renderState.renderNodes={[o.id]:s},this.renderState.transform=[0,0,e],this.renderState.isDarkMode=$.hasDarkAppearance,this.renderState.editor={selection:S.ids,nodeInTextEditor:p.nodeInTextEditor,nodesInEffectPreview:T.nodesInEffectPreview,nodesInMoveToolRootFontSize:this.engine.getNodesInMoveToolRootFontSize(),activeEffect:T.activeEffect,activeEffectIds:T.activeEffectIds,activeOverlayNodes:I.activeOverlays,dragAndDropPlaceholders:p.dragAndDropPlaceholders,rootFontSize:ip(l,d.tree,g)??null,scopeIdToSelectedCollectionItem:k.scopeIdToSelectedCollectionItem,shouldSetMinHeight:!1,activeLinkStyle:F.activeLinkStyle}}),L.multiply(L.atOrigin(i),e)}};function vR(j,A){if(j.isGroundNode(A))return j.getRect(A);let e=j.getGroundNodeFor(A);return j.getCanvasBoundingRectCached(e)}function df(){vA({type:"add",variant:"warning",text:"This file format is currently unsupported",key:"image-export-unsupported",icon:"warning",duration:2e3})}function pf(){vA({type:"add",variant:"error",text:"Please update to the latest version",key:"image-export-not-available",icon:"error",duration:2e3})}async function kf(j,A){j=j.filter(i=>{for(let s of i.exportOptions)if(s.enabled)return!0;return!1});let e=j.length,t=j[0];E(t,"Node must be defined");let r=Ua(t),o=new Set;for(let i of j)for(let s of i.exportOptions)s.enabled&&o.add(s.type);let n=Array.from(o).join(", "),a={key:"export-nodes-progress",progress:{variant:"progress",text:e===1?`${r} is exporting as ${n}`:`${e} layers are exporting as ${n}`},success:{variant:"success",text:e===1?`${r} has been exported`:`${e} layers have been exported`},error:{variant:"error",text:e===1?`Unable to export ${r}`:"Unable to export layers"}};await mm(a,A)}var PR=kA("export"),Ac=Ck?"\\":"/",jc=new Set;jc.add("html");jc.add("webp");var $o=class $o extends es{constructor(e){super(new bn(VE.canvas,Ri.export,{width:100,height:100,offscreen:!Wj.isOn("sandboxExportDebugging")}),e);R(this,"exportMetrics",new Cn)}static async whenAvailable({toastIfNot:e}={toastIfNot:!1},t){let r=await bn.isAvailable();if(this.isAvailable&&r)return this.shared=this.shared??new $o(t),this.shared;e&&(Cn.trackError("ServiceChannel miss-match error. Unable to establish a connection."),pf())}static async exportNodes(e,t){let r=await $o.whenAvailable({toastIfNot:!0},t);if(E(r,"Expected image exporter to be available"),r.hasUnsupportedFiles(e))return df();let a=(await r.openSaveDialog(e))?.filePath;a&&await kf(e,async()=>{await r.exportNodes(e,a)})}hasUnsupportedFiles(e){for(let t of e)for(let r of t.exportOptions)if(jc.has(r.type)&&r.enabled)return!0;return!1}async exportNodes(e,t){let r=[],o=this.getCount(e);for(let i of e)for(let s of i.exportOptions){if(!s.enabled)continue;let l=s.type,d=this.createNamePath(i,s),p=i.id,k=s.scale,g=o===1?this.verifyNamePath(d,t):d;switch(l){case"png":r.push({nodeId:p,pixelRatio:k,type:"image/png",pathname:g,count:o,dialogFilePath:t,p3:this.engine.stores.persistedUserDefaults.p3});break;case"jpg":r.push({nodeId:p,pixelRatio:k,type:"image/jpeg",pathname:g,count:o,dialogFilePath:t,p3:this.engine.stores.persistedUserDefaults.p3});break;case"svg":r.push({nodeId:p,pixelRatio:k,type:"image/svg+xml",pathname:g,count:o,dialogFilePath:t,p3:this.engine.stores.persistedUserDefaults.p3});break;default:lA(l)}}let n;for(let i of r){let s=performance.now();PR.debug("snapshotting export",i);try{await this.writeToDisk(i),this.exportMetrics.add(i,{durationMs:Math.floor(performance.now()-s),errorReason:null,format:i.type,exportCount:o,success:!0,scope:"selection"})}catch(l){this.exportMetrics.add(i,{durationMs:Math.floor(performance.now()-s),errorReason:"Exporting snapshoting failed",format:i.type,exportCount:o,success:!1,scope:"selection"}),n=l}}let{metrics:a}=await this.renderer.sandbox.collectMetrics();if(this.exportMetrics.mergeElectronMetrics(a),this.exportMetrics.track(),n)throw n}createNamePath(e,t){let r=KE(Ua(e))||"export",o=t.nameExtension.lastIndexOf("/"),n=o>=0?t.nameExtension.slice(0,o+1):"",a=t.nameExtension.slice(o+1),i=t.type;return n+r+a+"."+i}getCount(e){let t=0;for(let r of e)for(let o of r.exportOptions)o.enabled&&t++;return t}async openSaveDialog(e){for(let t of e)for(let r of t.exportOptions)if(r.enabled)return this.renderer.sandbox.openSaveDialog({count:this.getCount(e),pathname:this.createNamePath(t,r)})}verifyNamePath(e,t){let r=e.split("/"),o=r[r.length-1];E(_(o),`Filename must be defined: ${r}`);let n=t.split(Ac),a=n[n.length-1];if(E(_(a),`Filename must be defined: ${n}`),o.toLowerCase()!==a.toLowerCase()){let s=r.slice(0,-1).join(Ac);return s?s+Ac+a:a}return e}async writeToDisk(e){let t=await this.prepareNodeSnapshot(e);if(this.exportMetrics.add(e,{nodeWidth:t.width,nodeHeight:t.height}),e.type==="image/svg+xml"){let r=this.renderToSVG(e);return this.renderer.sandbox.writeToDisk({...e,rect:t,svgString:r})}return this.renderer.sandbox.writeToDisk({...e,rect:t})}async writeToClipboard(e){let t=await this.prepareNodeSnapshot(e);if(this.exportMetrics.add(e,{nodeWidth:t.width,nodeHeight:t.height}),e.type==="image/svg+xml"){let r=this.renderToSVG({nodeId:e.nodeId});return this.renderer.sandbox.writeToClipboard({...e,rect:t,svgString:r})}return this.renderer.sandbox.writeToClipboard({...e,rect:t})}async getImageData(e){let t=await this.prepareNodeSnapshot(e);return e.type==="image/svg+xml"?this.renderToSVG({nodeId:e.nodeId}):this.renderer.sandbox.getImageData({...e,rect:t})}};R($o,"isAvailable",vk),R($o,"shared");var Tn=$o;var ts=yj(oh());function ec(j){let A=Dj.boundingBox(j),e=j.pathSegments.map(t=>t.merge({x:t.x-A.x,y:t.y-A.y}));return[{pathClosed:j.pathClosed,pathSegments:e},A]}function uf(j,A,e,t){let r=kA("app:importSVG"),o=j,n,a;if(t&&t.colorable){let $=zt(j,"image/svg+xml").documentElement;if(!$)throw new Error(`Unsupported SVG: ${j}}`);let F=$.getAttribute("fill"),I=!(F&&F.toLowerCase()==="none");if(I){if(t.fillType==="linear-gradient"&&t.fillLinearGradient instanceof uk)n={fillType:"linear-gradient",fillLinearGradient:t.fillLinearGradient};else if(t.fillType==="image"&&t.fillImage)n={fillType:"image",fillImage:t.fillImage,fillImageResize:t.fillImageResize,fillImagePixelWidth:t.fillImagePixelWidth,fillImagePixelHeight:t.fillImagePixelHeight};else if(t.fillType==="color"&&_(t.fillColor)){let S=(0,ts.getPaperLazily)(),v=new S.Color(t.fillColor).toCSS(!1);I&&$.setAttribute("style",`fill: ${v}; color: ${v}`);let P=$.getAttribute("stroke");P&&P.toLowerCase()==="currentcolor"&&$.setAttribute("stroke",v)}o=$}}let i=_R(o);o=i.svgElement,a=i.svgSize;let s=!1,d=(0,ts.getPaperLazily)().project.importSVG(o,{expandShapes:!0,insert:!1,size:e,onError:g=>{r.reportError(g),s=!0;let $=document&&document.getElementsByTagName("body");if($&&$[0]){let F=$[0].lastElementChild;for(;F&&F.tagName==="svg";)F.remove(),F=$[0].lastElementChild}}});if(s)return null;let p;try{p=mf({item:d,fillOverrides:n,tree:A()})}catch(g){return r.reportError(g),null}let k=p[0];return k?(zA(k)&&a&&k.set({width:a.width,height:a.height}),A().insertNodes(p).getNode(k.id)):null}function mf({item:j,tree:A,nodes:e=[],parent:t=null,parentAbsolutePosition:r=aA(0,0),fillOverrides:o}){let n=(0,ts.getPaperLazily)();return j instanceof n.Group?xR({group:j,nodes:e,parent:t,parentAbsolutePosition:r,tree:A,fillOverrides:o}):j instanceof n.PathItem?NR({item:j,nodes:e,parent:t,parentAbsolutePosition:r,fillOverrides:o}):(console.warn("Unhandled Paper item:",j),e)}function _R(j){let A=_(j)?zt(j,"image/svg+xml").documentElement:j;if(!A)throw new Error(`Unsupported SVG: ${j}}`);let e,t=A.getAttribute("viewBox"),r=A.getAttribute("width"),o=A.getAttribute("height");if(t){let[n,a,i,s]=t.split(" ");i&&s&&(A.setAttribute("width",i),A.setAttribute("height",s),e={width:parseInt(i),height:parseInt(s)})}else r&&o&&(e={width:parseInt(r),height:parseInt(o)});return Ef(A),{svgElement:A,svgSize:e}}function Ef(j){DR(j);for(let A of j.children)Ef(A)}function DR(j){let A=j.getAttribute("rx"),e=j.getAttribute("ry");!A&&!e||A&&e||(A?j.setAttribute("ry",A):e&&j.setAttribute("rx",e))}function NR({item:j,nodes:A=[],parent:e=null,parentAbsolutePosition:t=aA(0,0),fillOverrides:r}){let o=Ek({item:j,parentAbsolutePosition:t}),n=fk(j),a=e?e.id:mj;if(o.length===1){let s=o[0];E(s,"Path must be defined");let[{pathSegments:l,pathClosed:d},p]=ec(s),k=new un({parentid:a,pathSegments:l,pathClosed:d,...n,...r,...p});A.push(k)}else if(o.length){let s=ff(j),l=s.x-t.x,d=s.y-t.y,p=j.fillRule==="evenodd"?3:4,k=new ha({parentid:a,pathBoolean:p,...n,...r,x:l,y:d,width:s.width,height:s.height});A.push(k),o.forEach(g=>{let[{pathSegments:$,pathClosed:F},I]=ec(g),S=new un({parentid:k.id,pathSegments:$,pathClosed:F,...r,x:I.x-l,y:I.y-d,width:I.width,height:I.height});A.push(S)})}return A}function xR({group:j,tree:A,nodes:e=[],parent:t=null,parentAbsolutePosition:r=aA(0,0),fillOverrides:o}){let n=ff(j),a=t?t.id:mj,i,s;return a?(i=new nm({parentid:a,x:n.x-r.x,y:n.y-r.y,width:n.width,height:n.height}),s=aA(n.x,n.y)):(i=new Er({parentid:a,left:0,top:0,width:n.x+n.width,height:n.y+n.height,fillEnabled:!1}),s=aA(0,0)),e.push(i),j.children.forEach(l=>{mf({item:l,nodes:e,parent:i,parentAbsolutePosition:s,tree:A,fillOverrides:o})}),e}function ff(j){let{x:A,y:e,width:t,height:r}=j.bounds;return{x:A,y:e,width:t,height:r}}function OR(j){return Lj(j)&&"iconURL"in j}function Z8(j){return Lj(j.icon)?j.id==="WorkspacePluginsCategory"?!0:OR(j.icon):!1}var wR={DefaultCategory:!0,PluginsCategory:!0,ManagedCollectionPluginsCategory:!0,WorkspacePluginsCategory:!0};function A1(j){return _(j)?Object.hasOwn(wR,j):!1}var LR={FindNodesCategory:!0,PluginsCategory:!0,ManagedCollectionPluginsCategory:!0,WorkspacePluginsCategory:!0};function j1(j){return Object.hasOwn(LR,j)}function e1(j){return j?.kind==="item"}function $f(j){if(j!==void 0)switch(j){case 2:return"auto";case 0:return"fixed";case 3:return"fraction";case 1:return"percentage";case 4:return"viewport";default:lA(j)}}function Bf(j,{widthType:A,heightType:e},t){if(!EA(j))return;let r=A!==void 0&&j.widthType!==A,o=e!==void 0&&j.heightType!==e;!r&&!o||zm({widthType:$f(A),heightType:$f(e),source:t,nodeType:j.__class,componentId:X(j)?j.codeComponentIdentifier:void 0})}function Bo(j,A,e=!1){let t={};for(let r in j){let o={...j[r]};"itemsOrder"in o&&Array.isArray(o.itemsOrder)&&e&&(o.itemsOrder=gn(o.itemsOrder,A)),t[A.get(r)??r]=o}return t}var rs=class extends Map{get(A){let e=super.get(A);for(;e;){let t=super.get(e);if(t===void 0)break;e=t}return e}};function qR(j,A){if(pa(j)){if(!j.controls.target?.value)return;let e=A.get(j.controls.target.value);return e?{target:{...j.controls.target,value:e}}:void 0}if(Me(j)){if(!j.controls.variantId?.value)return;let e=A.get(j.controls.variantId.value);return e?{variantId:{...j.controls.variantId,value:e}}:void 0}if(f6(j)){if(!j.controls.overlay?.value)return;let e=A.get(j.controls.overlay.value);return e?{overlay:{...j.controls.overlay,value:e}}:void 0}}function gf(j,A,e,t){let r=X(A),o={},n=!1,a=ka(A);for(let i in a){let s=r?VA(i):i;if(!Ee(j,A,s))continue;let l=a[i];if(!Aj(l))continue;let d=[],p=!1;for(let k of l){if(t&&(f6(k)||Qi(k))){p=!0;continue}let $=qR(k,e);if(!$){d.push(k);continue}d.push({...k,controls:{...k.controls,...$}}),p=!0}p&&(r?o[VA(i)]={type:"eventhandler",value:d}:o[i]=d,n=!0)}n&&A.set(o,j)}function KR(j,A,e){let t={};function r(a){let i=j.get(a);i&&j.linkNodeChangesTo(i,A.id)}let o=cm(A,K);for(let a of o){if(!Ee(j,A,VA(a)))continue;let i=A.getRawControlProp(a);if(i){if(i.type==="slot"&&Aj(i.value)){let s=!1,l=i.value.map(d=>{if(!Lj(d))return d;let p="reference";if(!_(d[p]))return d;let k=e.get(d.reference);return k?(s=!0,r(k),{...d,[p]:k}):d});if(!s)continue;t[a]={type:"slot",value:l}}else if((i.type===null||i.type==="componentinstance")&&_(i.value)){let s=e.get(i.value);if(!s)continue;t[a]={type:"slot",value:[{id:"first-item",reference:s}]},r(s)}else if(Aj(i.value)){let s=!1,l=[];for(let d=0;d<i.value.length;d++){let p=i.value[d];if(!Li(p)||p.type!==null&&p.type!=="componentinstance"||!_(p.value))continue;let k=_p(p)?p.id:Ej(),g=e.get(p.value);l.push({id:k,reference:g??p.value}),g&&(r(g),s=!0)}if(!s)continue;t[a]={type:"slot",value:l}}}}if($e(t))return;let n=Hr(t);A.set(n,j)}function VR(j,A,e){let t={},r=K.componentForIdentifier(A.codeComponentIdentifier)?.properties;for(let o in r){if(!Ee(j,A,VA(o)))continue;let n=r[o];if(n?.type!=="scrollsectionref")continue;let a=A.getRawControlProp(o);if(!a)continue;let i=Hp(n,a);if(!i||cA(i)||!_(i.target))continue;let s=e.get(i.target);s&&(t[o]={type:"scrollsectionref",value:{...i,target:s}})}$e(t)||A.set(Hr(t),j)}function JR(j,A){if(ku(j)&&Aj(j.appearEffectScrollTargets)){let e=j.appearEffectScrollTargets.map(t=>{if(!t.target||cA(t.target))return t;let r=A.get(t.target);return r?{id:Ej(),variant:t.variant,target:r}:t});j.set({appearEffectScrollTargets:e})}if(du(j)&&_(j.styleAppearEffectScrollTarget)){let e=A.get(j.styleAppearEffectScrollTarget);e&&j.set({styleAppearEffectScrollTarget:e})}if(pu(j)&&Aj(j.styleTransformEffectScrollTargets)){let e=j.styleTransformEffectScrollTargets.map(t=>{if(!t.target||cA(t.target))return t;let r=A.get(t.target);return r?{id:Ej(),style:t.style,target:r}:t});j.set({styleTransformEffectScrollTargets:e})}if(su(j)&&j.dragEffectConstraintElement){let e=A.get(j.dragEffectConstraintElement);e&&j.set({dragEffectConstraintElement:e})}if(uu(j)&&_(j.textEffectScrollTarget)){let e=A.get(j.textEffectScrollTarget);e&&j.set({textEffectScrollTarget:e})}}function it(j,A,e,t){if(A=A.draftOrCurrent(),(Se(A)||$p(A))&&gf(j,A,e,t),X(A)&&(gf(j,A,e,t),KR(j,A,e),VR(j,A,e)),kn(A)&&JR(A,e),zr(A)&&A.formSubmitButtonId){let o=e.get(A.formSubmitButtonId);o&&A.set({formSubmitButtonId:o})}if(bu(A)&&A.dataSourceLoaderId){let o=e.get(A.dataSourceLoaderId);o&&A.set({dataSourceLoaderId:o})}if(Ti(A)&&A.collectionRepeatedItemId){let o=e.get(A.collectionRepeatedItemId);o&&A.set({collectionRepeatedItemId:o})}if(Kj(A)){let o=hf(A.dataIdentifier,e);o&&A.set({dataIdentifier:o})}if(tj(A)){let o=A.variables.map(n=>{if(!Aa(n))return n;let a=hf(n.dataIdentifier,e);return a?{...n,dataIdentifier:a}:n});Wt(A.variables,o)||A.set({variables:o})}ue(A)&&HR(A,e);let r=_u(j,A,o=>{if(!o.providerId)return;let n=e.get(o.providerId);if(n)return Jj(o.id,n)});if(r&&A.set(r),A.children)for(let o of A.children)it(j,o,e,t);return A}function hf(j,A){let e=AA(j);if(!KA(e))return null;let t=A.get(e.localIdName);return t?Ht(e.type,t,e.exportSpecifier).value:null}function HR(j,A){let e=j.getControlProps();for(let[t,r]of Object.entries(e)){if(r?.type==="collectionreference"&&_(r.value)){let o=A.get(r.value);o&&j.setControlProp(t,{...r,value:o})}if(r?.type==="multicollectionreference"&&!oA(r.value)&&!cA(r.value)){let o=r.value.map(n=>A.get(n)??n);Wt(r.value,o)||j.setControlProp(t,{...r,value:o})}}}function go(j){return j==="/"?"Home":(j=UR(j),j=QR(j),j=If(j),j=WR(j),j=j.split(" ").map(f7).join(" "),j)}function QR(j){return j.replace(/-+/gu," ")}function UR(j){return j.replace(Si,"")}var Rf=/\s*\/+[/\s]*/gu;function WR(j){return j.replace(Rf," / ")}function If(j){return j.replace(/^[/\s]+|[/\s]+$/gu,"")}var zR=/\s+/gu,XR=/-+/gu;function U1(j){if(j==="Home")return"/";let A=j;return A=If(A),A=A.replace(Rf,"-"),A=A.replace(zR,"-"),A=A.replace(XR,"-"),A=A.toLowerCase(),"/"+A}function pw(j,A){let e=A.instanceIdentifier,t=j.getPersistedModuleByLocalIdentifier(e),r=K.dataForIdentifier(e)??void 0;return{identifier:e,module:t,entity:r}}function kw(j){let A=j.variables.find(F6);if(A)return A.id}function uw(j){return j.annotations?.framerSlug}function mw(j,A="Collection"){return j.name?j.name.toLowerCase().includes("collection")?j.name:`${j.name.trim()} Collection`:A}function YR(j){switch(j.toLowerCase()){case"title":case"name":case"label":return!0;default:return!1}}function ZR(j){return Lp(j)&&YR(j.name)}function AI(j){return j.variables.find(ZR)}function jI(j,A){if(oA(A))return;let t=j.getControlProp(A.id)?.value||A.initialValue;if(_(t)&&t.length>0)return t}function eI(j){return j.variables.find(F6)}function tI(j,A){if(oA(A))return;let t=j.getControlProp(A.id)?.value||A.initialValue;if(_(t)&&t.length>0)return t}function Ew(j,A){let e=AI(j),t=jI(A,e);if(_(t))return t;let r=eI(j),o=tI(A,r);return _(o)?go(o):"Collection Item"}function tc(j){let{ids:A}=j.selection,e=A[0];if(!e)return null;let t=j.tree.getNode(e);if(tj(t))return t;if(ue(t)){let r=j.tree.getNode(t.parentid);if(tj(r))return r}return null}function fw(j){let A=tc(j);return A?A.id:null}function $w(j){let A=tc(j);return A?A.name:null}function Bw(j){let A=j.getContentManagementNode()?.loaded;return A?A.children.length:0}function gw(j,A,e){let t=ve(j,A);return!t||!e?!1:zk(t).every(o=>{if(!o)return!1;for(let n of e)if(n.endsWith(o))return!0;return!1})}function rc(j){return j.type==="richtext"&&_(j.value)}function rI(j,A){let e=AA(j);return t=>{let r=AA(t);if(!(!r||!e)&&(r.kind==="localModuleExport"&&e.kind==="localModuleExport"&&r.localId===e.localId||r.kind==="externalModuleExport"&&e.kind==="externalModuleExport"&&r.moduleId===e.moduleId&&r.exportSpecifier===e.exportSpecifier))return A}}function oc(j,A){let e=j.getControlProps(),t={};for(let[r,o]of Object.entries(e)){if(!rc(o))continue;let n=o.value.replaceAll(E6,(a,i)=>{let s=A(i);return s?`${dp}="${s}"`:a});o.value!==n&&(t[VA(r)]={...o,value:n})}return Object.keys(t).length>0?t:void 0}function Ff(j,A,e){let t=j.getContentManagementNode()?.loaded;if(!t)return;let r=rI(A,e);for(let o of t.children)for(let n of o.getUnsortedChildren()){let a=oc(n,r);a&&n.set(a)}}function oI(j,A){let e=j.getControlProps();for(let t of Object.values(e))if(rc(t)&&t.value.includes(A))return!0;return!1}function hw(j,A){let e=j.getContentManagementNode()?.loaded;if(!e)return!1;for(let t of e.children)for(let r of t.getUnsortedChildren())if(oI(r,A))return!0;return!1}function Rw(j){let A=new Set;for(let e of j.getUnsortedChildren()){let t=nc(e);for(let r of t)A.add(r)}return[...A]}function nc(j){let A=new Set,e=j.getControlProps();for(let t of Object.values(e)){if(!rc(t))continue;let r=t.value.matchAll(E6);for(let[,o]of r)cj(o)&&A.add(o)}return[...A]}function Iw(j,A,e){let t=dr(j.tree,A);if(!t)return;let r=e??t.getUnsortedChildren()[0];j.stores.scopeStore.select(nr,{keepHistory:!1}),j.selection.set(r??t)}function Fw(j){let A=tc(j);if(!A)return!1;let e=j.stores.contentManagementStore;return e.multiSelectedItems||e.isCreatingNewItem()?!1:!A.managedByPlugin}function Gf(j,A){let e=j.stores.scopeStore.active;return E(qr(e),"Content management node should be active"),e.children.toSorted(({name:t},{name:r})=>ju(t||"",r||"",A))}function Gw(j,A){let e=j.stores.scopeStore.active;Gf(j,A).forEach(({id:r},o)=>{j.moveNode(r,e.id,o)})}function Sw(j,A){let e=j.stores.scopeStore.active;E(qr(e),"Content management node should be active");let t=Gf(j,A);return e.children.every(({id:r},o)=>t[o]?.id===r)}function os(j){if(!j)return!1;let A=AA(j);return A?A.kind==="externalModuleExport"||A.kind==="localModuleExport":!1}function ns(j,A){X(j)&&os(j.codeComponentIdentifier)&&A(j.codeComponentIdentifier),i6(j)&&j.dataIdentifier&&A(j.dataIdentifier),Wr(j)&&os(j.codeOverrideIdentifier)&&A(j.codeOverrideIdentifier),tl(j)&&j.codeOverrides?.forEach(e=>{A(e.identifier)}),ue(j)&&nc(j).forEach(A)}function is(j,A){let e={};if(X(j)&&os(j.codeComponentIdentifier)){let r=A(j.codeComponentIdentifier);r&&(e.codeComponentIdentifier=r)}if(i6(j)&&j.dataIdentifier){let r=A(j.dataIdentifier);r&&(E(cj(r)),e.dataIdentifier=r)}if(Wr(j)&&os(j.codeOverrideIdentifier)){let r=A(j.codeOverrideIdentifier);r&&(e.codeOverrideIdentifier=r)}if(tl(j)&&j.codeOverrides){let r=!1,o=j.codeOverrides.map(n=>{let a=A(n.identifier);return a?(r=!0,{...n,identifier:a}):n});r&&(e.codeOverrides=o)}if(ue(j)){let r=oc(j,A);r&&Object.assign(e,r)}if(Object.keys(e).length!==0)return e}function Sf(j){return Oa(j)||tj(j)}async function yf(j,A,e){return(await Ia.post(`/web/projects/${e}/assets/duplicate-module`,{moduleId:j,saveId:A})).assets}var bf=75,nI={mutable:!0,update:0};function Mn(j,A,e,t,r=!1){function o(n,a,i=!1){let s=new n.constructor;s.assign(n,nI,{cache:s.cache,id:s.id}),Mp(s)&&(s.itemsOrder=void 0),n.cache.insideVariant=i;let l=er(n)?n.getChildrenInVisualOrder():n.children;l&&(s.children=l.map(k=>o(k,s.id,i)));let d={parentid:a},p=is(n,k=>{let g=AA(k);if(g.kind==="localModuleExport"){let $=A.get(g.localId);if($)return`${$}:${g.exportSpecifier}`}else if(g?.kind==="externalModuleExport"){let $=e.get(g.moduleId);if($)return Nr(g,$).value}});if(p&&Object.assign(d,p),jj(n)&&!MA(n)&&Object.assign(d,{replicaInfo:void 0,originalid:void 0,...n.replicaInfo.overrides[n.replicaInfo.master],_deleted:void 0}),r&&Object.assign(d,{duplicatedFrom:Ji(n.duplicatedFrom,n.id)}),s.assign(d),t){if(t.has(n.id)){let k=t.get(n.id);k&&t.set(k,s.id)}t.set(n.id,s.id),n.originalid&&!t.has(n.originalid)&&t.set(n.originalid,s.id)}return s}return o(j,void 0,MA(j))}function iI(j){let A=new Map;for(let e of j)if(e.type==="local"){let t=e.moduleId;A.set(e.localId,ee(t,e.saveId,e.file).value)}return A}async function Cf(j){let A=new Map;for await(let e of j)if(e.type==="local"&&e.moduleType==="css"){let t=await Tf({moduleId:e.moduleId,saveId:e.saveId}),{__treeSerializationVersion:r,...o}=t,n=r||bf,{root:a}=C6({root:o,version:n}),i=pl(a);ut(i)&&A.set(i.id,i)}return[...A.values()]}function vf(j,A,e){let t=iI(e.imports),r=new Map,o=[];for(let n of j.walk())ns(n,a=>{let i=AA(a);if(KA(i)){let s=t.get(i.localId);if(!s)return;let{moduleId:l,saveId:d,file:p}=AA(s);i=wd(i,l,d,p)}if(i.kind==="externalModuleExport"){let s=A.getPersistedModuleByGlobalId(i.moduleId);s?r.set(i.moduleId,s.localId):o.push(i)}});return{identifiers:o,localIdsToExternalIdentifiers:t,externalModuleIdsToLocalIds:r}}async function Tf({moduleId:j,saveId:A}){try{return await(await fetch(`${Be().modulesCDN}/${j}/${A}/tree.json`)).json()}catch(e){SA(e)}}async function Pf(j,A){let[e,t]=await Promise.all([Tf(A),j.stores.modulesStore.getModuleDependencies(A)]);E(e,"Can't get tree.json for module identifier"),E(t,"Can't get dependencies for module identifier");let{__treeSerializationVersion:r,...o}=e,n=r||bf,{root:a}=C6({root:o,version:n}),i=pl(a);return E(Sf(i),"Node should be un-linkable."),{node:i,dependencies:t}}async function Mf(j,A,e){let t=j.remoteDocument?.projectId;if(t&&A.assets.length>0)try{let r=await yf(e.moduleId,e.saveId,t);j.stores.assetStore.assetService?.addAssets(r)}catch{}}function sc(j){if(!CA(j)||IA(j))return 0;let A=0,e=j.children.length;return A+=e,j.children.forEach(t=>{A+=sc(t)}),A}function _f(j,A,e,t){let r=qa(e,K),o=new Map(Object.entries(r)),n=new Map;n.set(t,o);let a={};for(let i of j.walk()){let s=$a(A,t,i,n);s&&(a[i.originalid??i.id]=s)}return a}function Df(j){let{left:A,top:e,right:t,bottom:r,centerAnchorX:o,centerAnchorY:n,constraintsLocked:a,width:i,widthType:s,height:l,heightType:d,aspectRatio:p,name:k,...g}=j;return g}function Nf(j){let A=K.reactComponentForIdentifier(j.codeComponentIdentifier);if(!A)return;let e={},t=Object.keys(A.properties);for(let r of t){let o=A.properties[r];if(!o||o.type!=="eventhandler")continue;let n=j.getRawControlProp(r);if(!n)continue;let{value:a}=n;!Array.isArray(a)||a.length===0||(e[r]=a)}return e}function as(j,{opacity:A,rotation:e}){if(cA(A))j.opacity=A;else if(j?.opacity||A){let t=Y(A)?A:1;j.opacity=(j.opacity??1)*t}if(cA(e))j.rotation=e;else if(j?.rotation||e){let t=Y(e)?e:0;j.rotation=(j.rotation??0)+t}}function g4(j){return j.every(A=>mA(A)||Tj(A)||X(A))}function h4(j,A){return A?!1:j.every(e=>{if(!mA(e)&&!X(e)&&!JA(e)||RA(e)||mA(e)&&jo(e).length===0)return!1;if(X(e)){let t=e.getSupportedLayout(K);if(!Le(t.width)||!Le(t.height))return!1}return e.widthType!==2||e.heightType!==2})}function xf(j,A,e){for(let t of A)if(Tj(t)||X(t))t.set({widthType:2,heightType:2}),Tj(t)&&e&&fA("layout_fit_text",{source:e});else if(mA(t)){let r={widthType:2,heightType:2,aspectRatio:null};pe(t)||Ha(j,t,r),Hl(j.tree,"width",t),Hl(j.tree,"height",t),Su(t)&&(r.framePreset=null),t.set(r),e&&fA("layout_stack",{layoutType:"stack",source:e})}}function G4(j){return jj(j)&&!MA(j)}function Of(j){return gA(j)&&!sj(j)}function wf(j){return ej(j)&&!sj(j)}function ss(j,A){return Gi(A)&&(kA("app").warn("Inserting a symbol is no longer supported."),A.isMaster=!1,A.replicaInfo=null,A.originalid=null),E(!j.tree.has(A.id),"Tree should not contain node with same id as inserted template"),j.stores.scopeStore.insertNode(A),A}function Kf(j){let A={width:200,height:200,codeComponentIdentifier:j.identifier,intrinsicWidth:null,intrinsicHeight:null,slotsAreChildNodes:XA.isOn("componentSlotsAreChildNodes")},{defaultProps:e,annotations:t}=j;if(e!==void 0&&(e6(e.width)&&(A.width=e.width,A.intrinsicWidth=e.width),e6(e.height)&&(A.height=e.height,A.intrinsicHeight=e.height)),t){let r=Sk(t);r.width&&(A.width=r.width),r.height&&(A.height=r.height)}return new ur(A)}function L4(j){return j.sort(aI)}var Lf=new Map;function qf(j){let A=Lf.get(j);if(A)return A;let e=j.split("/").map(t=>t.trim()).join("");return Lf.set(j,e),e}function aI(j,A){if(j.name===null)return-1;if(A.name===null)return 1;let e=qf(j.name),t=qf(A.name);return e.localeCompare(t,void 0,{numeric:!0})}function q4(j){if(Wd(j)&&j.file==="./canvas.tsx"||j.identifier==="framer/Stack")return!1;let A=AA(j.identifier);return KA(A)&&A.type==="screen"?!1:j.type==="component"||j.type==="master"}function K4(j){let A=j.split("/"),e=A[A.length-1];return E(te(e),"Last section is required"),e.trim()}function V4(j,A){return j.name?j.name:A?rt(A):"Unknown"}function J4(j){let A=[];for(let e of K.getAllLocalModules())e.type==="component"&&e.file===j&&A.push(e);return A}function ls(j,{allowVariants:A,allowLockedNodes:e}={}){return!e&&Tt(j)||qj(j)||!A&&(MA(j)||sj(j))||wf(j)||Lo(j)||IA(j)||x7(j)?!1:EA(j)}async function Vf(j,A,e,t){function r(){dI(j,[A],e,t)}if(!X(e)){r();return}let o=AA(e.codeComponentIdentifier);if(!o||o.kind!=="externalModuleExport"){r();return}await j.stores.modulesStore.addExternalModulesToProject([o],{onTreeUpdate:r})}function sI(j,A,e){if(!jn(A))return;let t=nk(j.tree,A);if(!tA(t))return;E(t.isLoaded(),"smart component must be loaded"),e.set({formSubmitButtonId:A.id});let r=t.getPrimaryVariant();t.getReplicaVariants().forEach(o=>{dA.resetOverridesByProperty(j.tree,o,o,["htmlTag","link"])}),lu(r)&&r.set({htmlTag:"button",link:void 0})}function lI(j,A,e){if(!X(j)||!X(A)||!j.cache.formContainerAncestorId)return;let t=e.tree.get(j.cache.formContainerAncestorId);zr(t)&&sI(e,A,t)}function cI(j,A,e){let t=iu(e.tree,j);t&&au(j,t)&&t.set({dataSourceLoaderId:A.id})}function dI(j,A,e,t){let r={},o=new Set;A.forEach(n=>{let a=null;if(ej(n)){if(!oe(n))return;let g=Pe(j.tree,n),$=dA.getReplicaForTemplateNode(j.tree,n);if(!g||!$||!MA($))return;n=g,a=$}let i=ss(j,e);lI(n,i,j),cI(n,i,j);let s=j.tree.getNodeParent(n),l=s||j.tree.getScopeNodeFor(n)||j.stores.scopeStore.active,d=l.children.indexOf(n),p=Ja(j.tree,n,i,l);if(i.set(p),s&&gj(n)&&ht(i)){i.set(Rt(n));let g=new rs([[n.id,i.id]]);it(j.tree,s,g,Qj(s)||Xi(s)),o.add(i.id)}if(X(i)&&kI(n,i,new Set(Object.keys(p))),jj(n)&&!MA(n)&&X(i)&&pI(j,n,i),uI(j,l,n,i),CA(n))for(let g of n.children)Qj(g)&&j.moveNode(g.id,i.id);j.deleteNode(n.id),j.moveNode(i.id,l.id,d);let k=mI(j.tree,n,i);EA(i)&&k&&(t?j.tree.current(i)?.set({left:k.left,right:k.right,top:k.top,bottom:k.bottom,centerAnchorX:k.centerAnchorX,centerAnchorY:k.centerAnchorY}):j.tree.current(i)?.set(k)),a?r[n.id]=ne(a.id,i.id):r[n.id]=i.id});for(let n of j.selection.ids)o.add(r[n]??n);j.selection.set(Array.from(o))}function pI(j,A,e){if(MA(A))return;let t=e.getLocalSmartComponentNodeId();if(!t)return;let r=j.tree.getNode(t);if(!(!r||!tA(r))&&r.originalSymbolId===A.replicaInfo.master){for(let o of A.walk())if(!(!yu(o)||!o.isTarget)&&o.originalid){if(mA(o)&&o.fillType==="image"&&_(o.fillImage)){let n=e.getRawControlProp(`symbol_${o.originalid}`);n&&n.type==="image"&&(n.value=o.fillImage)}else if(Lo(o)){let n=e.getRawControlProp(`symbol_${o.originalid}`);n&&n.type==="string"&&(n.value=o.styledText.text)}}}}function kI(j,A,e){let t;A:for(let o of j.walk()){if(!Se(o)&&!X(o))continue;let n=ma(o);for(let[,a]of Object.entries(n))if(t===void 0)t=a;else if(t){t=null;break A}}if(!t)return;let r=K.componentForIdentifier(A.codeComponentIdentifier);if(r?.properties)for(let o in r.properties){if(e?.has(o)||r.properties[o]?.type!=="eventhandler")continue;let a={type:"eventhandler",value:t};A.set({[VA(o)]:a});return}}function uI(j,A,e,t){let r=A?Oo(A):null;if(!r||!aj(r))return;let o=j.tree.getSmartComponentNodeFor(r);if(o)for(let n of o.getReplicaVariants()){let a=n.replicaInfo;if(!(e.id in a.overrides))continue;let i={...a};i.overrides={...i.overrides};let s={},l=i.overrides[e.id];for(let d in l){let p=l[d];if(d==="_deleted"){if(!Aj(p))continue;let k=p.filter(g=>g in t);k.length&&(s._deleted=k)}else d in t&&(s[d]=p)}delete i.overrides[e.id],i.overrides[t.id]=s,j.tree.current(n)?.set({replicaInfo:i})}}function mI(j,A,e){if(!EA(A)||!EA(e))return;let t=A.constraintValues();if(Ar(A)&&Ar(e)&&(kp(A)&&(t.gridItemFillCellWidth=!0),pp(A)&&(t.gridItemFillCellHeight=!0)),!X(e))return t;if(bk(A)){let r=e.getSupportedLayout(K),o=j.getRect(A);A.widthType===2&&!Le(r.width)&&(t.widthType=0,t.width=o.width),A.heightType===2&&!Le(r.height)&&(t.heightType=0,t.height=o.height)}return t}function Jf(j){return Ud(j)?Kf(j):null}var Hf=yj(s6());function Qf(j){let A={};for(let e of j.walk()){let t={};se(e)&&(t.strokeDashArray=e.strokeDashArray,t.strokeDashOffset=e.strokeDashOffset,WA(e.strokeWidth)||(t.strokeWidth=e.strokeWidth)),Yt(e)&&(t.boxShadows=e.boxShadows),Ct(e)&&(t.radius=e.radius),sr(e)&&(t.radiusTopLeft=e.radiusTopLeft,t.radiusTopRight=e.radiusTopRight,t.radiusBottomRight=e.radiusBottomRight,t.radiusBottomLeft=e.radiusBottomLeft),Vo(e)&&(t.pathSegments=e.pathSegments),Ce(e)&&e.fillType==="image"&&e.fillImageResize==="tile"&&(t.fillImageTileSize=e.fillImageTileSize??1),A[e.id]=t}return(0,Hf.Map)(A)}function lc(j,A,e){A.forEach((t,r)=>{let o=j.getNode(r);if(!o)return;let n={};se(o)&&(Y(t.strokeWidth)&&(n.strokeWidth=nj(t.strokeWidth*e,2)),_(t.strokeDashArray)&&(n.strokeDashArray=fI(t.strokeDashArray,e)),Y(t.strokeDashOffset)&&(n.strokeDashOffset=nj(t.strokeDashOffset*e,2))),Ap(o)&&Q7(t.boxShadows)&&(n.boxShadows=EI(t.boxShadows,e)),Ct(o)&&(Y(t.radius)&&(n.radius=nj(t.radius*e,2)),Y(t.radiusTopLeft)&&(n.radiusTopLeft=nj(t.radiusTopLeft*e,2)),Y(t.radiusTopRight)&&(n.radiusTopRight=nj(t.radiusTopRight*e,2)),Y(t.radiusBottomRight)&&(n.radiusBottomRight=nj(t.radiusBottomRight*e,2)),Y(t.radiusBottomLeft)&&(n.radiusBottomLeft=nj(t.radiusBottomLeft*e,2))),Vo(o)&&t.pathSegments&&(n.pathSegments=o.pathSegments.map((a,i)=>{let l=t.pathSegments[i].radius*e;return a.merge({radius:l})})),Ce(o)&&Y(t.fillImageTileSize)&&(n.fillImageTileSize=t.fillImageTileSize*e),o.set(n)})}function EI(j,A){if(!(!j||WA(j)))return j.map(e=>wi(e,{x:nj(e.x*A,2),y:nj(e.y*A,2),blur:nj(e.blur*A,2),spread:nj(e.spread*A,2)}))}function fI(j,A){let e=[],t=j.split(",");for(let r of t){let o=parseFloat(r);if(!Y(o))continue;let n=nj(o*A,2);e.push(n)}return e.join(", ")}var OL=(j,A)=>{if(j===A)return!0;if(j.length!==A.length)return!1;let e=new Set(j);for(let t of A)if(!e.has(t))return!1;return!0},wL=(j,A,e)=>{let t=[];for(let r of j)cc(A,r,e)!==-1&&t.push(r);return t},Uf=(j,A,e)=>{if(!e)return Array.from(new Set([...j,...A]));let t=[...j];for(let r of A)cc(t,r,e)===-1&&t.push(r);return t},LL=(j,A,e)=>j.filter(t=>cc(A,t,e)===-1);function cc(j,A,e){return e?j.findIndex(t=>e(t,A)):j.indexOf(A)}function $I(j,A){let e=[];for(let r of A.segmentSelection){let o=j.getNode(r.id);!o||r.index>=o.pathSegments.length||e.push(r)}let t=A.segmentHandle;if(t){let r=j.getNode(t.id);(!r||t.index>=r.pathSegments.length)&&(t=null)}return{...A,segmentSelection:e,segmentHandle:t}}var Wf=class{constructor(A){this.addChanges=A;R(this,"state",{segmentSelection:[],selectionType:0,segmentHandle:null,segmentHovered:null,closestCurve:null,pointRounding:.5,snapConstraint:null})}validateSegmentSelection(A){this.state=$I(A,this.state),this.addChanges("PathSelection")}setSegmentSelection(A,e){this.state={...this.state,segmentSelection:A,selectionType:e},this.addChanges("PathSelection")}toggleSegmentSelection(A,e){this.state.selectionType!==e&&(this.state={...this.state,segmentSelection:A,selectionType:e});let t=A.filter(o=>this.state.segmentSelection.find(n=>o.id===n.id&&o.index===n.index)===void 0),r=this.state.segmentSelection.filter(o=>A.find(n=>n.id===o.id&&n.index===o.index)===void 0);this.state={...this.state,segmentSelection:Uf(t,r)},this.addChanges("PathSelection")}setSegmentHandle(A){this.state={...this.state,segmentHandle:A},this.addChanges("PathSelection")}setHoveredSegment(A){this.state={...this.state,segmentHovered:A},this.addChanges("PathSelection")}setClosestCurve(A){this.state={...this.state,closestCurve:A},this.addChanges("PathSelection")}setPathPointRounding(A){this.state={...this.state,pointRounding:A},this.addChanges("PathSelection")}setPathConstraint(A){this.state={...this.state,snapConstraint:A},this.addChanges("PathSelection")}};var _n=yj(s6());function Xf(j,A){return Bn(j,"canDesign")||A.length===0?!1:A.find(e=>!(!co(e)&&yt(e)&&!kt(e)&&!e.originalid))===void 0}function $q(j,A,e,t){let r=A.map(o=>pc(j,o,e,t)[0]);j.selection.set(r)}function pc(j,A,e,t){let r=j.tree,o;cl.isBasicShape(A)?o=cl.createPath(A):o=A.calculatedPaths();let n=sk(A,o),a=Nn(r,A,o),i=r.newId(),s=Dj.boundingBox(n),l=A$(A),d=mu(A);if(l.fillType==="linear-gradient"&&l.fillLinearGradient){l.fillType="linear-gradient";let k=Y(A.rotation)?A.rotation:0;l.fillLinearGradient=l.fillLinearGradient.updated({angle:l.fillLinearGradient.angle+k})}if(n.length===1){let k=Dj.offset(n[0],aA.reverse(s));j.createPath(A.parentid,{id:i,...k,...s,...l,...d})}else{let k=[],g=new ha({id:i,parentid:A.parentid,pathBoolean:4,...s,...l,...d});k.push(g);for(let $ of n){let F=Dj.boundingBox($),I={...F,...aA.subtract(F,s)},S=Dj.offset($,aA.reverse(F)),T=new un({parentid:i,...I,...S,...l});k.push(T)}j.tree.insertNodes(k)}let p=r.getParent(A.id);if(p!==null&&CA(p)){let k=p.children.indexOf(A);j.moveNode(i,p.id,k)}return j.deleteNode(A.id),t||j.selection.set(i),e===!0&&j.setTool(33),[i,a]}function BI(j){let A={};return j.forEach(e=>{A[e.id]||(A[e.id]=[]),A[e.id].push(e.index)}),A}function Bq(j,A){let e=1/A;return{x:Math.round(j.x*e)/e,y:Math.round(j.y*e)/e}}function gq(j,A){let e=j.getNode(A.id);if(!e||!e.pathSegments)return null;let t=e.pathSegments[A.index],r=A.handle===0?Bj.calculatedHandleIn(t):Bj.calculatedHandleOut(t);return j.convertPointToCanvas(e,r)}function zf(j,A){return A.handle===0?{x:j.handleOutX,y:j.handleOutY}:{x:j.handleInX,y:j.handleInY}}function hq(j,A,e,t,r){let o=j.getNode(A.id),n=o.pathSegments[A.index];return e=j.convertPointToNode(o,e),e=aA.subtract(e,n),he.update(o.pathSegments,A.index,a=>{let i=zf(a,A),s=a.handleMirroring==="straight",l=a.handleMirroring;t&&(i=zf(t,A),s=t.handleMirroring==="straight",l=t.handleMirroring),s&&(l="symmetric"),t&&r&&(l==="disconnected"||l==="asymmetric"?l="symmetric":l="disconnected"),l==="symmetric"&&(i=aA.reverse(e));let d=A.handle===0,p=d?e.x:i.x,k=d?e.y:i.y,g=d?i.x:e.x,$=d?i.y:e.y;return a.merge({handleOutX:g,handleOutY:$,handleInX:p,handleInY:k,handleMirroring:l})})}function Dn(j,A,e=!1,t){let r=j.tree,o=(0,_n.Map)(),n=(0,_n.Map)();if(!yt(A)&&!IA(A))return{descendantPaths:o,descendantBasicShapes:n};let a={};kc(r,A,a);let i=Object.keys(a);for(let d=0,p=i.length;d<p;d++){let k=i[d],g=a[k];o=o.set(k,g)}let s={};uc(r,A,s,e);let l=Object.keys(s);for(let d=0,p=l.length;d<p;d++){let k=l[d],g=s[k];n=n.set(k,g)}return n.forEach((d,p)=>{if(d!==null)return;let k=r.getNode(p);if(!k||!Xf(j,[k]))return;let[g,$]=pc(j,k,!1,!0),F=$[0];o=o.set(g,F),t&&t.includes(p)&&j.selection.toggle(g)}),{descendantPaths:o,descendantBasicShapes:n}}function Yf(j,A){let e=j.tree,t=(0,_n.Map)(),r=(0,_n.Map)();if(!IA(A))return{shapeContainerDescendantPaths:t,shapeContainerDescendantBasicShapes:r};let o={};kc(e,A,o,A);let n=Object.keys(o);for(let s=0,l=n.length;s<l;s++){let d=n[s],p=o[d];t=t.set(d,p)}let a={};uc(e,A,a,!1,!1,A);let i=Object.keys(a);for(let s=0,l=i.length;s<l;s++){let d=i[s],p=a[d];r=r.set(d,p)}return r.forEach((s,l)=>{if(s!==null)return;let d=e.getNode(l);if(!d||!Xf(j,[d]))return;let[p,k]=pc(j,d,!1,!0),g=k[0],$=_t(e,A,[g])[0];t=t.set(p,{pathSegments:$,pathClosed:!0})}),{shapeContainerDescendantPaths:t,shapeContainerDescendantBasicShapes:r}}function kc(j,A,e,t){if(kt(A)||Ko(A)||IA(A))for(let r of A.children)yt(r)&&kc(j,r,e,t);else if(co(A)){let r=Nn(j,A,A)[0].pathSegments;t&&(r=_t(j,t,[{pathSegments:r,pathClosed:A.pathClosed}])[0]),e[A.id]={pathSegments:r,pathClosed:A.pathClosed}}}function uc(j,A,e,t=!1,r=!1,o){if(kt(A)||Ko(A)||IA(A))for(let n of A.children){let i=St(n)&&Y(n.rotation)&&n.rotation%90!==0||t;yt(n)&&uc(j,n,e,i,r,o)}else if(!co(A)&&yt(A))if(t||r)e[A.id]=null;else{let n=L.pointsAtOrigin(j.getRect(A));e[A.id]=n.map(a=>{let i=j.convertPointToCanvas(A,a);return o?j.convertPointToNode(o,i,!0):i})}}function Nn(j,A,e,t=1){let r=[];return Array.isArray(e)?r=e:r=[e],r.map(({pathSegments:o,pathClosed:n})=>({pathSegments:o.map(i=>dc(j,A,i,t,void 0)),pathClosed:n}))}function dc(j,A,e,t=1,r){let o=aA.multiply(j.convertPointToCanvas(A,e,!0,r),t),n=aA.multiply(j.convertPointToCanvas(A,Bj.calculatedHandleIn(e),!0,r),t),a=aA.multiply(j.convertPointToCanvas(A,Bj.calculatedHandleOut(e),!0,r),t),i=aA.subtract(n,o),s=aA.subtract(a,o);return e.merge({...o,handleOutX:s.x,handleOutY:s.y,handleInX:i.x,handleInY:i.y})}function _t(j,A,e){return e.map(({pathSegments:t})=>t.map(r=>{let o=j.convertPointToNode(A,r),n=j.convertPointToNode(A,Bj.calculatedHandleIn(r)),a=j.convertPointToNode(A,Bj.calculatedHandleOut(r)),i=aA.subtract(n,o),s=aA.subtract(a,o);return r.merge({...o,handleOutX:s.x,handleOutY:s.y,handleInX:i.x,handleInY:i.y})}))}function Zf(j,A,e,t){return t.map(({pathSegments:r})=>r.map(o=>{let n={x:o.x,y:o.y},a=j.convertPointFromNodeToDescendant(A,e,n),i=j.convertPointFromNodeToDescendant(A,e,Bj.calculatedHandleIn(o)),s=j.convertPointFromNodeToDescendant(A,e,Bj.calculatedHandleOut(o)),l=aA.subtract(i,a),d=aA.subtract(s,a);return o.merge({...a,handleOutX:d.x,handleOutY:d.y,handleInX:l.x,handleInY:l.y})}))}function mc(j,A){return A.map(({pathSegments:e})=>e.map(t=>{let r=hj.convertPoint(j,t),o=hj.convertPoint(j,Bj.calculatedHandleIn(t)),n=hj.convertPoint(j,Bj.calculatedHandleOut(t)),a=aA.subtract(o,r),i=aA.subtract(n,r);return t.merge({...r,handleOutX:i.x,handleOutY:i.y,handleInX:a.x,handleInY:a.y})}))}function gI(j,A,e){let t=A.updateForPath(e);j.tree.current(A)?.set(t)}function Rq(j,A,e,t,r){let o=j.getParent(e.id),n=e.updateForPath(t);A.createPath(o?o.id:mj,{...n,id:r,rotation:e.rotation,...A$(e)})}function Iq(j,A,e){if(e===0)return A;let t=[],r=BI(A),o=Object.keys(r);for(let n=0,a=o.length;n<a;n++){let i=o[n],s=[],l=j.getNode(i),d=r[i],p=l.pathSegments.length;for(let k=0,g=d.length;k<g;k++){let $=d[k];s.push($);let F=$+1;F===p?s.push(0):s.push(F)}for(let k=0,g=s.length;k<g;k++){let $=s[k];t.push({id:l.id,index:$})}}return t}function Fq(j,A,e){for(let t of j)if(t.id===A&&t.index===e)return!0;return!1}function Gq(j,A,e,t,r,o){let n=Nn(j,r,r),a=_t(j,e,n)[0],i=!Dj.isLastSegment(e.pathSegments,e.pathClosed,t.index),s=Dj.isLastSegment(r.pathSegments,r.pathClosed,o.index);(!i&&s||i&&!s)&&(a=Dj.reverse(a));let d;i?d=he.unshift(e.pathSegments,...a):d=he.push(e.pathSegments,...a),A.deleteNode(r.id),gI(A,e,{pathSegments:d})}function hI(j,A,e){let t=w7(j,A);if(e===0){if(t)return aA.subtract(A,j);if(j.handleOutX!==0||j.handleOutY!==0){let o=Bj.calculatedHandleOut(j);return aA.subtract(o,j)}let r=Bj.calculatedHandleIn(A);return aA.subtract(r,j)}else{if(t)return aA.subtract(j,A);if(A.handleInX!==0||A.handleInY!==0){let o=Bj.calculatedHandleIn(A);return aA.subtract(o,A)}let r=Bj.calculatedHandleOut(j);return aA.subtract(r,A)}}function Sq(j,A){let e=j.getNode(A.id);if(!e)return null;let t=e.pathSegments[A.segmentIndex],r=e.pathSegments[A.segmentIndex+1];if(!t||!r)return null;let o=dc(j,e,t),n=dc(j,e,r),i=A.projectedTime<.5?Bj.point(o):Bj.point(n),s=hI(o,n,0);return t7(i,aA.add(i,s))}var RI=15;function yq(j,A,e,t){let r=5/t,o=RI/t,n=A.cache.canvasRect;if(n&&(n.x-e.x>r||n.y-e.y>r||e.x-(n.x+n.width)>r||e.y-(n.y+n.height)>r))return null;let a=Dj.toBezierJS(A,A),i=j.convertPointToNode(A,e),s=-1,l=1/0,d=0;for(let F=0,I=a.length;F<I;F++){let T=a[F].project(i),v=T.d,P=T.t;v>=l||P===0||P===1||(l=v,s=F,d=P)}if(s===-1)return null;let p=a[s],k=p.get(d),g=p.get(.5),$=aA.distance(i,g)<o;return{id:A.id,segmentIndex:s,distance:l,projectedPoint:k,projectedTime:d,midPoint:g,midPointInRange:$}}function A$(j){return{strokeEnabled:j.strokeEnabled,strokeAlignment:j.strokeAlignment,strokeWidth:j.strokeWidth,strokeColor:j.strokeColor,lineJoin:j.lineJoin,lineCap:j.lineCap,strokeMiterLimit:j.strokeMiterLimit,strokeDashArray:j.strokeDashArray,strokeDashOffset:j.strokeDashOffset,fillEnabled:j.fillEnabled,fillType:j.fillType,fillColor:j.fillColor,fillLinearGradient:j.fillLinearGradient,fillRadialGradient:j.fillRadialGradient,fillImage:j.fillImage,fillImageResize:j.fillImageResize,fillImageOriginalName:j.fillImageOriginalName,fillImagePixelWidth:j.fillImagePixelWidth,fillImagePixelHeight:j.fillImagePixelHeight,fillImagePositionX:j.fillImagePositionX,fillImagePositionY:j.fillImagePositionY,fillImageTileSize:j.fillImageTileSize,boxShadows:j.boxShadows,opacity:j.opacity}}function j$(j,A){let e=j.getRect(A),t={width:e.width,height:e.height};if(!mA(A)||!de(A))return t;let r=to(A);if(r.perSide)r.top&&(t.height-=r.top),r.bottom&&(t.height-=r.bottom),r.right&&(t.width-=r.right),r.left&&(t.width-=r.left);else if(r.top){let o=r.top*2;t.width-=o,t.height-=o}return t.width=Math.max(1,t.width),t.height=Math.max(1,t.height),t}function Wq(j,A,e,t){j.getNodesWithTrait(e,HA).forEach(o=>{let{descendantPaths:n}=Dn(A,o,!0,e),a=n.valueSeq().toArray(),i=Dj.boundingBox(a),s={...i};t==="horizontal"?(s.x=i.x+i.width,s.width=-i.width):(s.y=i.y+i.height,s.height=-i.height);let l=s.width>-1&&s.width<1?1:s.width,d=s.height>-1&&s.height<1?1:s.height,p=[i.x,i.x+i.width],k=[s.x,s.x+l],g=[i.y,i.y+i.height],$=[s.y,s.y+d],F=l/i.width,I=d/i.height;n.forEach((S,T)=>{let v=S.pathSegments.map(z=>z.merge({x:bj(z.x,p,k,!1),y:bj(z.y,g,$,!1),handleOutX:z.handleOutX*F,handleOutY:z.handleOutY*I,handleInX:z.handleInX*F,handleInY:z.handleInY*I}));E(A.tree===j);let P=j.get(T);if(!P)return;let N={pathSegments:v,pathClosed:P.pathClosed},w={pathSegments:_t(j,P,[N])[0],pathClosed:P.pathClosed},iA=P.updateForPath(w);P.set(iA)})})}function zq(j,A,e){let{tree:t}=j;A.forEach(r=>{let o=t.getRect(r),n=e(o);if(n.width&&n.width<1&&(n.width=1),n.height&&n.height<1&&(n.height=1),IA(r))II(j,r,n);else if(yt(r))FI(j,r,n);else{let a=t.getParent(r.id),i=a?j$(t,a):null,s=r.updateForSize(n,i?{sizing:i,positioning:i,viewport:r.cache.viewportRect,layout:Fe(a)}:null);t.current(r)?.set(s)}})}function II(j,A,e){let{tree:t}=j,r=t.getParent(A.id),o=r?t.getRect(r):null,n=A.updateForSize(e,o?{sizing:o,positioning:o,viewport:null,layout:Fe(r)}:null);n.sizeToFit=!1,t.current(A)?.set(n)}function FI(j,A,e){let{tree:t}=j,r=t.getRect(A),o=Ni.update(r,e,Xr(A)?Y(A.aspectRatio):!1),n={...r,...o},a=n.width>-1&&n.width<1?1:n.width,i=n.height>-1&&n.height<1?1:n.height,s=[r.x,r.x+r.width],l=[n.x,n.x+a],d=[r.y,r.y+r.height],p=[n.y,n.y+i],k=a/r.width,g=i/r.height,{descendantPaths:$,descendantBasicShapes:F}=Dn(j,A);$.forEach((I,S)=>{let v=_t(t,A,[I])[0].map(z=>z.merge({x:bj(z.x+r.x,s,l,!1)-r.x,y:bj(z.y+r.y,d,p,!1)-r.y,handleOutX:z.handleOutX*k,handleOutY:z.handleOutY*g,handleInX:z.handleInX*k,handleInY:z.handleInY*g})),P=Nn(t,A,{pathSegments:v,pathClosed:!0});E(j.tree===t);let N=t.get(S);if(!N)return;let w={pathSegments:_t(t,N,P)[0],pathClosed:N.pathClosed},iA=N.updateForPath(w);N.set(iA)}),F.forEach((I,S)=>{if(I===null)return;let P=I.map(D=>t.convertPointToNode(A,D)).map(D=>({x:bj(D.x+r.x,s,l,!1)-r.x,y:bj(D.y+r.y,d,p,!1)-r.y})).map(D=>t.convertPointToCanvas(A,D)),N=t.get(S);if(!N)return;let Q=P.map(D=>t.convertPointToNode(N,D)),w=L.boundingRectFromPoints(Q),iA=L.center(w),z=oa(N,iA),pA={x:z.x-w.width/2,y:z.y-w.height/2,width:w.width,height:w.height};N.set(pA)})}function e$(j,A,e,t,r,o){let{tree:n}=j,a=n.getNode(A.id),i=o.width>-1&&o.width<1?1:o.width,s=o.height>-1&&o.height<1?1:o.height,l=i/r.width,d=s/r.height;e.forEach((p,k)=>{let g=n.getNode(k);if(!g)return;let F={pathSegments:p.pathSegments.map(v=>v.merge({x:v.x*l,y:v.y*d,handleOutX:v.handleOutX*l,handleOutY:v.handleOutY*d,handleInX:v.handleInX*l,handleInY:v.handleInY*d})),pathClosed:p.pathClosed},S={pathSegments:Zf(n,a,g,[F])[0],pathClosed:g.pathClosed},T=g.updateForPath(S);g.set(T)}),t.forEach((p,k)=>{if(p===null)return;let g=p.map(S=>({x:S.x*l,y:S.y*d})),$=n.getNode(k),F=g.map(S=>n.convertPointFromNodeToDescendant(a,$,S,!1)),I=L.boundingRectFromPoints(F);j.tree.get(k)?.set(I)})}function t$(j,A,e,t,r,o=n=>n.canvasMatrix()){let n=t.width>-1&&t.width<1?1:t.width,a=t.height>-1&&t.height<1?1:t.height,i=[e.x,e.x+e.width],s=[t.x,t.x+n],l=[e.y,e.y+e.height],d=[t.y,t.y+a],p=n/e.width,k=a/e.height,g=r?{x:0,y:0}:A.rect;A.descendantPaths&&A.descendantPaths.forEach(($,F)=>{let S=(r?$.pathSegments:mc(A.canvasMatrix.inverse(),[$])[0]??[]).map(w=>w.merge({x:bj(w.x+g.x,i,s,!1)-g.x,y:bj(w.y+g.y,l,d,!1)-g.y,handleOutX:w.handleOutX*p,handleOutY:w.handleOutY*k,handleInX:w.handleInX*p,handleInY:w.handleInY*k})),T=r?{pathSegments:S,pathClosed:$.pathClosed}:{pathSegments:mc(A.canvasMatrix,[{pathSegments:S,pathClosed:$.pathClosed}])[0]??[],pathClosed:$.pathClosed},v=j.get(F);if(!v)return;let N={pathSegments:_t(j,v,[T])[0],pathClosed:v.pathClosed},Q=v.updateForPath(N);v.set(Q)}),A.descendantBasicShapes&&A.descendantBasicShapes.forEach(($,F)=>{if($===null)return;let S=(r?$:$.map(z=>hj.convertPoint(A.canvasMatrix.inverse(),z))).map(z=>({x:bj(z.x+g.x,i,s,!1)-g.x,y:bj(z.y+g.y,l,d,!1)-g.y})),T=r?S:S.map(z=>hj.convertPoint(A.canvasMatrix,z)),v=j.get(F);if(!v)return;let P=T.map(z=>hj.convertPoint(o(v).inverse(),z)),N=L.boundingRectFromPoints(P),Q=L.center(N),w=oa(v,Q),iA={x:j6(w.x-N.width/2),y:j6(w.y-N.height/2),width:N.width,height:N.height};v.set(iA)})}function o$(j,A,e,t,r){if(e!==1)for(let[o]of t.parentsInitialState){let n=t.parentsInitialState.get(o);if(!n)continue;let a=[];for(let i of A)n.selectedNodeIds.has(i.id)&&a.push(i);i$(a,e,bI(j,o,e,t,r),!0)}}function n$(j,A){let e=new Map,t=new Map,r={},o=new Set;for(let n of j.tree.withoutDescendants(A)){let a=n.parentid;if(!a)continue;let i=j.tree.getNode(a);E(i,"Parent must exist"),GI(j,n,t,o),yI(j,n,i,e),r[a]??=[],r[a].push(n)}for(let[n,a]of e){let i=r[n];E(i,"Nodes must exist"),a.selectionBoundingFrame=j.tree.getBoundingFrameForNodes(i)}return{parentsInitialState:e,nodesInitialState:t,nonScalableNodes:o}}function GI(j,A,e,t){for(let{node:r,skipChildren:o}of A.walkWithSkipChildren()){if(e.has(r.id))continue;let n=r.id===A.id,a=j.tree.isInlineVectorNode(r),i=HA(r)&&(a||n);if(!wI(r,n)){t.add(r.id),o();continue}let s=i?Dn(j,r):void 0,l=IA(r)?Yf(j,r):void 0,d=IA(r)||i?Qf(r.draftOrCurrent()):void 0,p=X(r)?SI(r):void 0;e.set(r.id,{rect:L.round(j.tree.getRect(r,!1),2),matrix:j.tree.transformMatrixToNode(r),codeComponentControlProps:p,scalableShapeStylesMap:d,...s,...l}),IA(r)&&o()}}function SI(j){let A=K.reactComponentForIdentifier(j.codeComponentIdentifier);if(!(!A||!A.properties))return j.getControlProps(A.properties)}function yI(j,A,e,t){let r=t.get(e.id)??{matrix:j.tree.transformMatrixToNode(e).invertSelf(),selectedNodeIds:new Set,selectionBoundingFrame:{x:0,y:0,width:0,height:0}};r.selectedNodeIds.add(A.id),t.set(e.id,r)}function bI(j,A,e,t,r){let o=t.parentsInitialState.get(A);E(o,"Parent must be present in initial state");let n=o.selectionBoundingFrame,a={...n,width:n.width*e,height:n.height*e};return{initialRect:n,resizedRect:a,engine:j,tree:j.tree,initialState:t,anchorPoint:r??{x:.5,y:.5}}}function i$(j,A,e,t){if(j.length===0)return!1;let r=!1;for(let o of j){if(e.initialState.nonScalableNodes.has(o.id))continue;let n=LI(o)&&i$(o.children,A,e,!1),a=CI(o,e,A,n,t);r||=a||n}return r}function CI(j,A,e,t,r){let o=xI(j,e,r),n=vI(j,A,e,t,r,o);return j.set(o),(n||t)&&MI(j,A,e,r),n}function vI(j,A,e,t,r,o){return JA(j)?TI(j,e,A,r,o):IA(j)?PI(j,e,A,r,o):HA(j)?qI(j,e,A):X(j)?KI(j,e,A,r,o):zA(j)?a$(j,e,A,t,r,o):!1}function TI(j,A,e,t,r){let o=!1;if(!j.textFitViewBoxSize){OI(j,e.tree);let n=j.draftOrCurrent().updateForScale(A);Object.assign(r,n),o=!0}return j.widthType!==2&&(o=ho("width",j,A,e,!1,t,r)||o),j.heightType!==2&&(o=ho("height",j,A,e,!1,t,r)||o),o}function PI(j,A,e,t,r){let o=e.initialState.nodesInitialState.get(j.id),n=o?.shapeContainerDescendantPaths,a=o?.shapeContainerDescendantBasicShapes,i=o?.scalableShapeStylesMap;return E(i,"Shape container styles should be available in initial state"),E(n,"Shape container paths should be available in initial state"),E(a,"Shape container shapes should be available in initial state"),e$(e.engine,j,n,a,j,{width:j.width*A,height:j.height*A}),lc(e.tree,i,A),ho("width",j,A,e,!0,t,r),ho("height",j,A,e,!0,t,r),!0}function MI(j,A,e,t){if(t)_I(j,e,A);else if(EA(j)){let r={};j.left&&(r.left=jA(j.left,e)),j.right&&(r.right=jA(j.right,e)),j.top&&(r.top=jA(j.top,e)),j.bottom&&(r.bottom=jA(j.bottom,e)),j.set(r)}}function _I(j,A,e){if(!EA(j)&&!sa(j))return;let t=e.initialState.nodesInitialState.get(j.id);E(t,"Node must be present in initial state");let r=j.parentid?e.initialState.parentsInitialState.get(j.parentid):void 0;E(r,"Node parent must be present in the initial state"),r.selectedNodeIds.size===1?DI(j,A,e,t):NI(j,e,t,r)}function DI(j,A,e,t){let r=t.rect,o={...r,width:r.width*A,height:r.height*A},a=HA(j)||IA(j)?j.clone({rotation:0}):j,i=ds(r,e.anchorPoint),s=ds(o,e.anchorPoint),l=hj.convertPoint(a.originAdjustedMatrix(null,r),i),d=hj.convertPoint(a.originAdjustedMatrix(null,o),s),p=aA.subtract(l,d),k=L.round(L.offset(o,p),2);if(EA(j)){let{widthType:g,heightType:$,maxHeight:F,minHeight:I,maxWidth:S,minWidth:T,...v}=H6(j.constraints(),k,e.tree.getParentSizeInfo(j,e.tree.getParent(j.id)),null,!1);j.set(v)}else j.set({x:k.x,y:k.y})}function NI(j,A,e,t){let r=aA.add(ds(A.initialRect,A.anchorPoint),A.initialRect),o=aA.add(ds(A.resizedRect,A.anchorPoint),A.resizedRect),n=aA.subtract(r,o),a=t.matrix??null,i=r$(a,A.initialRect),s=r$(a,L.offset(A.resizedRect,n)),l=[i.x,i.x+i.width],d=[s.x,s.x+s.width],p=[i.y,i.y+i.height],k=[s.y,s.y+s.height],g=e.rect,$={x:bj(g.x,l,d,!1),y:bj(g.y,p,k,!1)},F={x:bj(g.x+g.width,l,d,!1),y:bj(g.y+g.height,p,k,!1)},I=L.round(L.fromTwoPoints($,F));if(EA(j)){let S=H6(j.constraints(),I,A.tree.getParentSizeInfo(j,A.tree.getParent(j.id)),null,!1);delete S.widthType,delete S.heightType,j.set(S)}else j.set({x:I.x,y:I.y})}function r$(j,A){if(!j)return A;let e=hj.convertPointsWithClipping(j,L.cornerPoints(A));return L.boundingRectFromPoints(e)}function xI(j,A,e){let t={};return At(j)&&(t.borderWidth=jA(j.borderWidth,A),t.borderBottom=jA(j.borderBottom,A),t.borderLeft=jA(j.borderLeft,A),t.borderTop=jA(j.borderTop,A),t.borderRight=jA(j.borderRight,A)),Yt(j)&&(t.boxShadows=l$(j.boxShadows,A)),se(j)&&(t.strokeWidth=jA(j.strokeWidth,A)),et(j)&&(t.padding=jA(j.padding,A),t.paddingBottom=jA(j.paddingBottom,A),t.paddingLeft=jA(j.paddingLeft,A),t.paddingTop=jA(j.paddingTop,A),t.paddingRight=jA(j.paddingRight,A)),sr(j)&&(t.radiusBottomLeft=jA(j.radiusBottomLeft,A),t.radiusBottomRight=jA(j.radiusBottomRight,A),t.radiusTopLeft=jA(j.radiusTopLeft,A),t.radiusTopRight=jA(j.radiusTopRight,A)),Ct(j)&&(t.radius=jA(j.radius,A)),vi(j)&&(t.gridColumnMinWidth=jA(j.gridColumnMinWidth,A),t.gridColumnWidth=jA(j.gridColumnWidth,A),j.gridRowHeightType==="fixed"&&(t.gridRowHeight=jA(j.gridRowHeight,A))),de(j)&&(t.gap=s$(j.gap,A)),$r(j)&&(t.formInputFontSize=c$(j.formInputFontSize,A),j.formInputFontLetterSpacingUnit==="px"&&(t.formInputFontLetterSpacing=jA(j.formInputFontLetterSpacing,A)),j.formInputFontLineHeightUnit==="px"&&(t.formInputFontLineHeight=jA(j.formInputFontLineHeight,A))),dn(j)&&(t.blur=jA(j.blur,A,0),t.backgroundBlur=jA(j.backgroundBlur,A,0)),Ce(j)&&j.fillType==="image"&&j.fillImageResize==="tile"&&(t.fillImageTileSize=jA(j.fillImageTileSize??1,A)),Yr(j)&&(t.minWidth=cs(j.minWidth,A,e),t.maxWidth=cs(j.maxWidth,A,e),t.minHeight=cs(j.minHeight,A,e),t.maxHeight=cs(j.maxHeight,A,e)),t}function a$(j,A,e,t,r,o){if(!We(j))return o.width=jA(j.width,A),o.height=jA(j.height,A),!0;let n=!1;return n=ho("width",j,A,e,t,r,o)||n,n=ho("height",j,A,e,t,r,o)||n,n}function OI(j,A){let e=j.getTextStylePresets(!1);for(let t of e){let r=A.getNode(t);ut(r)&&j.draftOrCurrent().detachTextStylePreset(r,!1)}}function ho(j,A,e,t,r,o,n){let a=j==="width"?"widthType":"heightType",i=A[a],s=t.initialState.nodesInitialState.get(A.id)?.rect;E(s,"node should have cached rect");let l=j==="width"?"gridItemFillCellWidth":"gridItemFillCellHeight";if(Ar(A)&&A[l]&&o)return n[l]=!1,n[j]=jA(s[j],e),n[a]=0,!0;switch(i){case 0:return n[j]=jA(A[j],e),!0;case 4:return n[j]=jA(A[j],e,4),!0;case 1:return o?(n[j]=jA(A[j],e,4),!0):!1;case 3:return o?(n[j]=jA(s[j],e),n[a]=0,!0):!1;case 2:if(!r){let p=t.tree.getNodeParent(A),g=(p&&Ie(p)?p.layout:void 0)==="grid"?s[j]:A[j];return n[j]=jA(g,e),n[a]=0,!0}return!1;default:lA(i)}}function wI(j,A){let e=X(j)?j.getSupportedLayout(K):void 0;return!(e?.width==="auto"&&e?.height==="auto"||RA(j)||Qj(j)&&!A)}function LI(j){return!(!j.children||IA(j)||HA(j))}function jA(j,A,e=2){return Y(j)?nj(j*A,e):j}function s$(j,A){return Y(j)?jA(j,A):_(j)?Oi(j,e=>jA(e,A)):j}function cs(j,A,e){if(oA(j))return j;let[t,r]=yp(j);return Number.isNaN(t)||r==="%"&&!e?j:$t(jA(t,A,0),r)}function l$(j,A){if(!(!j||WA(j)))return j.map(e=>e.type==="realistic"?e:wi(e,{x:jA(e.x,A),y:jA(e.y,A),spread:jA(e.spread,A)}))}function qI(j,A,e){let t=e.initialState.nodesInitialState.get(j.id);return t?(t$(e.tree,{canvasMatrix:t.matrix,rect:t.rect,descendantPaths:t.descendantPaths,descendantBasicShapes:t.descendantBasicShapes},e.initialRect,e.resizedRect,!0,r=>{let o=e.initialState.nodesInitialState.get(r.id);return E(o,"Basic shape initial state must exist"),o.matrix}),t.scalableShapeStylesMap&&lc(e.tree,t.scalableShapeStylesMap,A),!0):!1}function ds(j,A){return{x:j.width*A.x,y:j.height*A.y}}function KI(j,A,e,t,r){let o=zA(j)?a$(j,A,e,!1,t,r):!1,n=e.initialState.nodesInitialState.get(j.id)?.codeComponentControlProps;if(!n)return o;for(let a in n){let i=n[a];if(!(!i||WA(i.value)))switch(i.type){case"borderradius":r[VA(a)]={...i,value:JI(i.value,A)};break;case"padding":r[VA(a)]={...i,value:HI(i.value,A)};break;case"gap":r[VA(a)]={...i,value:s$(i.value,A)};break;case"boxshadow":r[VA(a)]={...i,value:l$(i.value,A)};break;case"font":r[VA(a)]={...i,value:UI(i.value,A)};break;case"border":r[VA(a)]={...i,value:WI(i.value,A)};break;case"array":case"boolean":case"collectionreference":case"color":case"slot":case"cursor":case"customcursor":case"date":case"enum":case"eventhandler":case"file":case"link":case"linkrelvalues":case"multicollectionreference":case"number":case"object":case"pagescope":case"richtext":case"scrollsectionref":case"string":case"transition":case"fusednumber":case"image":case"trackingid":case"vectorsetitem":break;default:lA(i)}}return o}function VI(j){return j.includes("%")}function JI(j,A){return WA(j)||VI(j)?j:Oi(j,e=>jA(e,A))}function HI(j,A){return WA(j)?j:Oi(j,e=>jA(e,A))}var QI={px:2,rem:3};function c$(j,A){if(oA(j))return j;let[e,t]=Y(j)?[j,"px"]:xi(j);return $t(jA(e,A,QI[t]),t)}function UI(j,A){if(oA(j))return j;let e=c$(j.fontSize,A);return{...j,fontSize:e,lineHeight:j.lineHeight?.[1]==="px"?[jA(j.lineHeight[0],A),"px"]:j.lineHeight,letterSpacing:j.letterSpacing?.[1]==="px"?[jA(j.letterSpacing[0],A),"px"]:j.letterSpacing}}function WI(j,A){return!j||cA(j)?j:{...j,borderWidth:jA(j.borderWidth,A),borderTop:jA(j.borderTop,A),borderRight:jA(j.borderRight,A),borderBottom:jA(j.borderBottom,A),borderLeft:jA(j.borderLeft,A)}}var Bc;(lt=>{function j(c){return c.selection.ids.length>0}lt.hasSelection=j;function A(c){return c.some(u=>E$(u))}lt.canCopyNodes=A;function e(c){return c.some(u=>d$(u))}lt.canDuplicateNodes=e;function t(c,u){return A(u)&&i(c,u)}lt.canCutNodes=t;function r(c,u,m=void 0,f=!0){let{documentSettingsStore:h,codeGenerationStore:G,selectionStore:y,modalStore:b,canvasStore:C,scopeStore:M,treeStore:x}=c.stores,O=x.tree,nA=O.withoutDescendants(O.getNodes(u)),uA=M.active,FA=nA.length===1?nA[0]:void 0;if(!oA(FA)&&Vi(FA)&&!RA(FA)&&mA(FA)&&tA(uA)){let rA=O.getRect(FA),Ne=Rn(O,uA,FA,rA),Sj=lt.createVariant(c.stores,uA,FA,Ne);return Sj?new Set([Sj.id]):void 0}let $A=nA.find(rA=>RA(rA));if($A){let rA=x.tree.getScopeNodeFor($A);if(rA&&V(rA)){c.stores.modalStore.set({type:"DuplicateWebPage",source:"context_menu",duplicateFromId:rA.id});return}}let BA=nA.map(rA=>O.getRect(rA)),GA=new Map,qA=new Set,TA=[],bA=new Map,Gj=new Map,fj=0;if(nA.forEach((rA,Ne)=>{if(!d$(rA))return;let Sj=O.getParent(rA.id);if(qo(rA))if(Sj&&X(Sj)){if(!Bp(Sj,K))return}else return;for(let UA of rA.walk())mA(UA)&&fj++;let wA=c.cloneNode(rA,!1,!0,GA);if(GA.set(rA.id,wA.id),Gj.set(rA.id,wA.id),qA.add(wA.id),bA.set(rA,wA),rA.isMaster)vl({});else if(rA.replicaInfo){let{master:UA}=rA.replicaInfo,rj=UA&&O.getNode(UA);rj&&xo(rj)||vl({})}else c7(rA)&&(!m||m.node&&d7(m.node))&&nE(c,rA,GA);if(m){let UA=O.getParent(rA.id);if(m.node){let rj=m.node;if(gA(m.node)&&(rj=Pe(O,m.node),!rj))return;if(Gt(c.tree,rj,wA,c.stores.scopeStore.active.id,K)){let wj=UA&&LA(UA)&&LA(rj),ct=UA&&mA(UA)&&mA(rj);if(wj||ct)c.moveNode(wA.id,rj.id,m.insertionIndex);else if(EA(wA)){c.moveNode(wA.id,rj.id,m.insertionIndex);let Dr=O.getParentSizeInfo(wA,rj,!0,!1),Vt=wA.updateForSize(BA[Ne]??{},Dr);UA||(Vt.left=0,Vt.top=0),c.tree.current(wA)?.set(Vt)}else lt.convertNodeToNewParent(c,wA,UA,m.node,m.insertionIndex,rA);if(sj(m.node)){Ml(c,wA,m.node,rj,qA,GA);let _r=dA.getReplicaForTemplateNode(O,m.node);if(_r){let Dr=ne(_r.id,wA.id);Gj.set(rA.id,Dr)}}}}else lt.convertNodeToNewParent(c,wA,UA,m.node,m.insertionIndex,rA),LA(UA)&&BA[Ne]&&c.tree.current(wA)?.set(wA.updateForSize(BA[Ne],null))}}),!m){let rA=nA.some(Sj=>O.isGroundNode(Sj)),Ne=nA.some(Sj=>St(Sj)&&Sj.resolveValue("rotation")!==0);if(nA.length){let Sj=nA.map(_j=>O.convertFrameToCanvas(_j)),wA=L.merge(...Sj),UA,rj=w(c,u),wj=iA(O,nA),ct=nA.some(_j=>HA(_j)),_r=c.stores.documentSettingsStore.lastDuplicationMap,Dr=!1;if(!ct&&rj&&!wj&&!Ne&&_r){let _j=_r.keys(),qs=c.tree.getBoundingFrameForNodes(O.getNodes(_j));Dr=!0,UA=aA.subtract(wA,qs)}let Vt=UA||{y:0,x:0},Ls=nA[0];if(!ct&&rA&&!Dr&&Ls){let _j=sE(O,c.stores.scopeStore.active,Ls,wA,nA.every(jt)?{x:c.tree.getRect(Ls).width}:UA);Vt=aA.subtract(_j,wA)}for(let _j of nA){let{x:qs,y:Zg,width:Ah,height:jh}=O.getRect(_j),xe=bA.get(_j);if(!xe)continue;let To=c.tree.getParent(_j.id),Po=c.tree.getParent(xe.id);if(Po&&To&&sj(To)){Ml(c,xe,To,Po,qA,GA);let Md=dA.getReplicaForTemplateNode(O,To);if(Md){let rh=ne(Md.id,xe.id);Gj.set(_j.id,rh)}}if(Po&&LA(Po))continue;let Td=qs+Vt.x,Pd=Zg+Vt.y,eh=c.tree.getParentSizeInfo(_j,To),th=xe.updateForRect({rect:{x:HA(_j)?Td:Math.round(Td),y:HA(_j)?Pd:Math.round(Pd),width:Ah,height:jh},parentSizeInfo:eh,constraintsLocked:!1,shouldGuessPinToBottom:!0,shouldGuessPinToRight:Uj(c.tree,xe,Po)});c.tree.current(xe)?.set(th),rA&&O.isGroundNode(xe)&&TA.push(xe.rect())}}}c.stores.documentSettingsStore.lastDuplicationMap=Gj;let De=[];for(let rA of bA.values())it(O,rA,GA,!1),jt(rA)&&De.push(rA);if(De.length&&c.codeGenerationStore.createVectorSet(De),TA.length){let rA=L.merge(...TA);c.stores.canvasStore.scrollToCenter(L.center(rA))}return f&&qA.size>0&&c.selection.set(qA,{sticky:!0}),fj>0&&fA("layout_frame",{source:"duplication",count:fj}),qA}lt.duplicateNodes=r;function o(c){if(c.length>=50)return!0;let m=c.length;return c.forEach(f=>{m+=sc(f)}),m>=50}function n(c,u,m){let f=c.tree.withoutDescendants(u);function h(){let G=[],y=[];f.forEach(b=>{if(oe(b))if(Yi(c.tree,b))y.push(b);else{let C=c.tree.get(b.originalid);C&&$c(C)&&G.push(C.id)}else $c(b)&&G.push(b.id)}),y.forEach(b=>b.set({visible:!1})),c.deleteNodes(G),c.stores.selectionStore.clear(),c.setHighlight(null)}m&&o(f)?c.stores.modalStore.set({type:"Confirmation",variant:"destructive",title:"Delete Selection",description:"You are about to delete the selected layers for all project collaborators.",confirmLabel:"Delete",onConfirm:h,source:"delete_node"}):h()}lt.deleteOrHideNodes=n;function a(c,u){c.tool.deleteAction?c.tool.deleteAction():u&&n(c,u,!0)}lt.deleteAction=a;function i(c,u){return c.tool.deleteAction?!!c.tool.canDelete&&c.tool.canDelete():!!u&&u.some(m=>YI(m))}lt.canDeleteOrHideNodes=i;function s(c,u){return Ve(u)?!1:ej(u)?oe(u):!Qr(u)}lt.canRenameNode=s;function l(c,u){return u.filter(m=>s(c,m)).length===1}lt.canRename=l;function d(c,u){return c.stores.chromeStore.contentPanelTab!=="Pages"||c.stores.scopeStore.active.id===c.tree.root.homePageNodeId||u.length!==0?!1:V(c.stores.scopeStore.active)||dj(c.stores.scopeStore.active)}lt.canRenameActivePage=d;function p(c,u){if(d(c,u)){let m=c.stores.scopeStore.active.id,f=rr(c.tree,m)?.id||m;xa(f)}else u.length===1&&(c.stores.chromeStore.layersExpanded=!0,c.stores.chromeStore.contentPanelTab="Layers",c.runBeforeNextFrame(()=>{let m=document.querySelectorAll(".layerPanelPlaceholder.active");if(m.length===1&&m[0]){let f=new MouseEvent("dblclick",{view:window,bubbles:!0,cancelable:!0}),h=m[0].parentElement;h&&h.dispatchEvent(f)}}))}lt.rename=p;async function k(c,u){if(!Tn.isAvailable)return;let m=kA("generateLayerNames");vA({type:"add",key:"generate-layer-names",text:"Snapshotting layer\u2026",variant:"progress",duration:1/0});let f=await Tn.whenAvailable({toastIfNot:!0},c);if(f){let h=await f.getImageData({nodeId:u.id,type:"image/png",pixelRatio:1});m.debug("imageData",h);let G=JSON.stringify(u.toJS()),y="Here is an image and the document structure for a webpage section. Please provide me a nice and short name for every node in this hierarchy to display in the layer panel. Make them specific to their visual content and avoid generic names like 'Frame' or 'Stack'. Also avoid numbering them, as they do not have to be unique.";vA({type:"add",key:"generate-layer-names",text:"Generating layer names\u2026",variant:"progress",duration:1/0});let b=await rE({messages:[{role:"user",content:y},{role:"user",content:h},{role:"user",content:G}],model:"google/gemini-2.0-flash-001",schema:{$schema:"http://json-schema.org/draft-07/schema#",type:"array",items:{type:"object",properties:{nodeId:{type:"string"},name:{type:"string"}},required:["nodeId","name"]}}});vA({type:"add",key:"generate-layer-names",text:"Updating layers\u2026",variant:"progress",duration:1/0}),await c.processWhenReadyAsync(()=>{for(let C of b){let{nodeId:M,name:x}=C;if(typeof M!="string"||typeof x!="string")continue;let O=c.tree.get(M);m.debug("nodeId",O,x),O&&O.set({name:x})}}),vA({type:"remove",key:"generate-layer-names"})}}lt.generateLayerNames=k;function g(c,u){let m=c.tree,f=m.withoutDescendants(u),h=Mr(f);T(m,u,h)&&Gd(c,h,"front")}lt.sendToFront=g;function $(c,u){let m=c.tree,f=m.withoutDescendants(u),h=Mr(f);S(m,u,h)&&Gd(c,h,"back")}lt.sendToBack=$;function F(c,u){let m=c.tree,f=m.withoutDescendants(u),h=Mr(f);T(m,u,h)&&Sd(c,h,1)}lt.sendForward=F;function I(c,u){let m=c.tree,f=m.withoutDescendants(u),h=Mr(f);S(m,u,h)&&Sd(c,h,-1)}lt.sendBackward=I;function S(c,u,m){if(Fd(u))return!1;if(!m){let f=c.withoutDescendants(u);m=Mr(f)}return yd(c,m,-1)}lt.sendBackwardEnabled=S;function T(c,u,m){if(Fd(u))return!1;if(!m){let f=c.withoutDescendants(u);m=Mr(f)}return yd(c,m,1)}lt.sendForwardEnabled=T;function v(c,u){return NA(c,u,0)}lt.addFrame=v;function P(c,u){return NA(c,u,1)}lt.addStack=P;function N(c,u){let m=c.stores.scopeStore.active,f=c.tree.withoutDescendants(u);return f.length>1&&ZA(c,f)&&(!V(m)||f.every(h=>c.tree.isGroundNode(h)))}lt.canWrapInAutoSizedFrame=N;function Q(c,u,m){let f=v(c,u);E(f!==void 0,"new frame ID must be defined");let h=c.tree.getNode(f);E(h!==null,"new frame must exist");let G=c.tree.withoutDescendants([h]);return xf(c,G,m),h}lt.wrapInAutoSizedFrame=Q;function w(c,u){let{documentSettingsStore:m,selectionStore:f}=c.stores;if(!m.lastDuplicationMap||!Gn(u,f.ids))return!1;let h=[...m.lastDuplicationMap.values()];if(!Gn(f.ids,h))return!1;let G=[...m.lastDuplicationMap.keys()];return Gn(f.previousIds,G)}function iA(c,u){let m=c.getCommonGroundNode(u);return!!m&&LA(m)}function z(c,u,m){if(m!==null){let f=u.flatMap(b=>c.convertCornerPointsToCanvas(b)),h=c.transformMatrixToNode(m),G=(Y6(m)?h:hj.flatProjectionMatrix(h)).invertSelf(),y=f.map(b=>hj.convertPoint(G,b));return L.roundToOutside(L.boundingRectFromPoints(y))}return L.roundToOutside(L.merge(...u.map(f=>c.convertFrameToCanvas(f))))}lt.getUntransformedBoundingRect=z;function pA(c,u,m,f,h,G){let y={top:m.y,left:m.x,width:m.width,height:m.height,fillEnabled:!1},b=h.length===1?h[0]:null;E(b!==void 0,"node must be defined",h),f&&Object.assign(y,D(u,m,f,b,G));let C=f===null,M=V(c.stores.scopeStore.active);return y.overflow=C||M?ye():"visible",y}function D(c,u,m,f,h){let G=c.getViewportRect(m),y=c.getRect(m),b=f?c.getParentSizeInfo(f,m):{sizing:y,positioning:y,viewport:G,layout:Fe(m)},C=!!f&&EA(f),M=J(f,h),x=Tk({rect:u,parentSizeInfo:b,currentConstraints:M,constraintsLocked:C,shouldGuessPinToBottom:ot(c,null,m),shouldGuessPinToRight:Uj(c,null,m),floatingPosition:null});return h&&m?{...eo(f,m),...H(f),...x,widthType:de(m)?3:1,heightType:2,width:1,left:0}:{...eo(f,m),...H(f),...x}}function J(c,u){let f=!!c&&EA(c)?c.constraints():void 0;if(!f)return;let h={...f};return!u&&h.widthType===2&&(h.widthType=0),!u&&h.heightType===2&&(h.heightType=0),h}function H(c){if(!(!c||!zA(c)))return{width:c.width,height:c.height}}function Z(c,u,m,f,h,G,y,b,C){let M=G?.id??mj;switch(u){case 0:{let x=c.createFrame(M,{id:m,...C},f);return c.moveNode(x.id,M,y),E(x&&CA(x),"Fail to create a wrapping frame: the created frame should have the `children` field"),b.forEach(O=>{let nA=vo(c.tree,O,G,x);c.moveNode(O.id,x.id),c.tree.current(O)?.set(nA)}),x}case 1:{let x=sA(c,m,M,C,b,h);return c.moveNode(x.id,M,y),x}case 2:{let x=c.createShapeContainer(M,{id:m,...C});return c.moveNode(x.id,M,y),E(x&&CA(x),"Fail to create a wrapping frame: the created frame should have the `children` field"),b.forEach(O=>{let nA=vo(c.tree,O,G,x);c.moveNode(O.id,x.id),c.tree.current(O)?.set(nA)}),x}default:lA(u)}}function sA(c,u,m,f,h,G,y){let b=Jl(c,h,G),C=c.createNode(fe,{id:u,...f,...b},m,y);E(pe(C),"Fail to create stack: the created node should have stack layout");let{stackDirection:M}=b;return ME(c,u,G,h,M),C}function NA(c,u,m){let f=c.tree;if(!ZA(c,u))return;let h=f.sortVisually(f.withoutDescendants(u)),G=h[0]?f.getParent(h[0].id):null,y=G&&sj(G),b=y?c.tree.getNode(G.originalid):G,C=!0,M=y?h.map(BA=>{if(!ej(BA))return BA;let GA=c.tree.getNode(BA.originalid);return E(GA,"Fail to create a wrapping frame: the original node must exist"),C&&(C=!GA.cache.visible),GA}):h,x=G?.children.findIndex(BA=>h.includes(BA))??-1,O=f.newId(),nA=z(f,M,b),uA=pA(c,f,nA,b,M,m===1),FA=Z(c,m,O,M[0]?.id,nA,b,x,M,uA),$A=O;if(y){E(G,"Fail to create a wrapping frame: parentNode should not be null"),E(gA(G),"Fail to create a wrapping frame: parentNode should be a replica node"),C&&hn(c,FA,G,b);let BA=dA.getReplicaForTemplateNode(c.tree,G);E(BA,"Fail to create a wrapping frame: replica must exist");let GA=z(f,h,G),qA=pA(c,f,GA,G,h,m===1);mn(f,BA,FA.id,qA),dA.replicaWithChanges(c.tree,BA.draftOrCurrent());let TA=ne(BA.id,O);$A=TA;let bA=c.tree.get(TA);if(E(bA&&CA(bA),"Fail to create a wrapping frame: replica wrapping node should exist and should have the `children` field"),m===0||m===2)h.forEach(Gj=>{let fj=vo(f,Gj,G,bA);c.tree.current(Gj)?.set(fj)});else if(m===1){E(mA(FA),"Fail to create a wrapping frame: the wrapping node should be a FrameNode"),E(pe(FA),"Fail to create a wrapping frame: the wrapping node should have stack layout");let Gj=Jl(c,h,GA);mn(f,BA,FA.id,Gj),TE(c,FA,Gj.stackDirection,h,GA)}}return c.stores.selectionStore.set($A),O}function kj(c){return Uo(c)||MA(c)||gj(c)||Di(c)||Ve(c)||qo(c)?!1:ej(c)?oe(c):!0}function ZA(c,u){if(u.length===0)return!1;switch(c.tool.enum){case 0:case 1:case 6:break;default:return!1}if(!u.every(y=>kj(y)))return!1;let m=c.tree,f=m.withoutDescendants(u),[h,G]=f.reduce(([y,b],C)=>{let M=m.isInlineVectorNode(C)||!HA(C)&&!gj(C),x=f[0]?m.getParentId(f[0]):void 0,O=m.getParentId(C);return[y&&x===O,b&&M]},[!0,!0]);return h&&G}lt.wrappingEnabled=ZA;function uj(c){return c.some(Xe)}lt.overflowEnabled=uj;function lj(c){c.stores.chromeStore.removePanelOverrides(),c.stores.chromeStore.chromeIsVisible=!0,c.stores.chromeStore.pagesExpanded=!0,c.stores.chromeStore.contentPanelTab="Pages";let u=new Set(c.stores.scopeStore.getDesignPageNodes().map(f=>f.name??"")),m=c.createNode(fu,{name:Nj("Exploration",u,{startIndex:u.size+1,omitCountIfFirst:!1})},c.tree.root.id);c.stores.scopeStore.select(m.id,{keepHistory:!1}),c.runAtEndOfFrame(()=>xa(m.id))}lt.createDesignPage=lj;function Mj(c){c.stores.chromeStore.removePanelOverrides(),c.stores.chromeStore.chromeIsVisible=!0,c.stores.chromeStore.pagesExpanded=!0,c.stores.chromeStore.contentPanelTab="Pages";let u=new Set(c.stores.scopeStore.getCanvasPageNodes().map(G=>G.name??"")),m=c.createNode(Gk,{name:Nj("Canvas",u,{startIndex:u.size+1,omitCountIfFirst:!1})},c.tree.root.id),f=Gu("iPhone_390_844"),h=c.createFrame(m.id,{width:f.screenWidth,height:f.screenHeight,name:f.title,framePreset:f.id,isScreen:!0});c.stores.codeGenerationStore.updateComponent(h.id).catch(SA),c.stores.scopeStore.select(m.id,{keepHistory:!1}),Vm({pageId:m.id}),c.runAtEndOfFrame(()=>xa(m.id))}lt.createCanvasPage=Mj,lt.toggleContentManagementScope=c=>{let u=c.stores.chromeStore.mainView;if(u===2){c.stores.scopeStore.selectPreviousActiveScope();return}switch(u){case 0:c.cancelTool();break;case 5:c.stores.chromeStore.setLocalizationsVisible(!1);break;case 6:c.stores.analyticsStore.close();break;case 4:c.stores.siteSettingsStore.close();break;case 1:c.stores.codeEditorStore.closeEditor();break;case 3:break;default:lA(u)}let m=c.tree.getContentManagementNode()?.loaded;if(m&&m.children.length>0){let f=c.stores.scopeStore.active,h=c.selection.nodes.at(0);c.stores.scopeStore.select(m.id,{keepHistory:!1});let G=ZI(c,f,h);if(G){c.selection.set(G);return}if(c.selection.ids.length===0){let y=m.children[0];y&&c.selection.set(y.id)}}else c.stores.chromeStore.toggleContentManagementSidebar()};function le(c,u){c.stores.chromeStore.chromeIsVisible=!0,c.stores.scopeStore.select(nr,{keepHistory:!1}),c.selection.set(u)}lt.openContentCollection=le;function li(c,u,m,f){c.stores.modalStore.set({type:"CreateComponent",source:u,onSuccess:h=>{if(Cj(h.name)||Cj(c.tree.getEntityRootNode()))return;let G=La(c.tree,h.name,m??en);hr(c.tree,G,h.id),f?.(h)}})}lt.makeComponent=li;function ci(c,u){return Xg(c,u)}lt.canMakeComponent=ci;function xs(c,u){if(u.length!==1||Zt(c.stores.scopeStore.active))return;let m=u[0];m&&Gi(m)&&dA.canMakeMaster(m)&&c.tree.current(m)?.set({isMaster:!0,replicaInfo:null,originalid:null})}lt.makeMaster=xs;function Ed(c,u){for(let m of u)if(m.originalid&&gA(m)&&dA.overrideKeys(c,[m]).size>0)return!0;return!1}lt.canResetToMasterValues=Ed;function fd(c,u){for(let m of u){if(!m.originalid)continue;let h=dA.getReplicaForTemplateNode(c,m);h&&dA.resetOverrides(c,h,m)}}lt.resetToMasterValues=fd;function $d(c,u,m){for(let f of u){if(!gA(f))continue;let h=dA.getReplicaForTemplateNode(c,f);h&&dA.resetOverridesByProperty(c,h,f,m)}}lt.resetPropertiesToMasterValues=$d;function Os(c,u){if(u.length===0)return!1;for(let m of u){if(aj(m))return!1;if(Vi(m)){let f=c.tree.getScopeNodeFor(m);if(!f)return!1;if(tA(f)){let{hover:h,pressed:G}=f.getGesturesForTopLevelVariant(m);return!(h||G)}return V(f)&&!RA(m)}if(jj(m))return!0}return!1}lt.canDetachFromMaster=Os;function di(c,u){let m=new Map;u.filter(jj).forEach(h=>{if(!ls(h,{allowVariants:!0}))return;let G=h.clone({parentid:null});G.replicaInfo=null,rp(G)&&(G.isVariant=void 0);for(let C of G.walk())C.originalid=null;E(h.id!==G.id),c.tree.insertNode(G);let y=c.tree.getParent(h.id)||c.stores.scopeStore.active,b=y.children.indexOf(h);c.tree.removeNode(h),c.moveNode(G.id,y.id,b),c.tree.current(G)?.set(G.constraintValues()),m.set(h.id,G.id)}),it(c.tree,c.tree.root,m,!1);let f=c.stores.selectionStore.ids.map(h=>m.get(h)??h);return c.stores.selectionStore.set(f),m}lt.detachFromMaster=di;function ws(c,u){if(!pi(u))return;let m=Pr(u);u.filter(so).forEach(h=>h.set({visible:!m})),c.setHighlight(mj)}lt.visibility=ws;function pi(c){return c.some(so)}lt.visibilityEnabled=pi;let Pr=c=>c.every(u=>u.isVisible());function ty(c){return Pr(c)?"Hide":"Show"}lt.visibilityTitle=ty;function ry(c,u){let m=c.withoutDescendants(u);if(!Ng(m))return;let f=!Bd(m),h=new Set;for(let G of m){if(!pr(G))continue;let y=G.cache.lockedByParent,b=f===y?void 0:f;G.set({locked:b});for(let C of G.descendants())h.add(C)}for(let G of h)pr(G)&&G.locked!==void 0&&G.set({locked:void 0})}lt.toggleLock=ry;function Ng(c){return c.some(pr)}lt.toggleLockEnabled=Ng;function Bd(c){return c.some(u=>pr(u)&&Tt(u))}function oy(c){return Bd(c)?"Unlock":"Lock"}lt.toggleLockTitle=oy;function ny(c){return c.every(jt)}lt.copyURLEnabled=ny;function iy(c){return c.length>0&&c.every(h=>gd(h))?`Remove ${c.length>1?"Viewboxes":"Viewbox"}`:`Remove ${c.length>0&&c.find(h=>!LA(h))===void 0?"Stack":"Frame"}${c.length>1?"s":""}`}lt.removeFrameTitle=iy;function ay(c,u){xg(c,u)&&Kg(c,u)}lt.removeFrame=ay;function xg(c,u){if(u.length===0)return!1;let m=c.stores.scopeStore.active.id;return u.every(f=>{if(!mA(f)&&!LA(f)&&!gd(f)||!f.children||f.children.length===0||qj(f)||jj(f)||ej(f)&&!oe(f))return!1;let h=c.tree.getParent(f.id);if(!h)return!0;for(let G of f.children)if(!Gt(c.tree,h,G,m,K))return!1;return!0})}lt.removeFrameEnabled=xg;function gd(c){return IA(c)&&!jt(c)}function sy(c,u){u.forEach(m=>{let f=c.getParentSizeInfo(m);if(m.intrinsicWidth!==null&&m.intrinsicHeight!==null){let h={width:m.intrinsicWidth,height:m.intrinsicHeight},G=h.width/h.height;if(Uo(m))m.set(pm(m,h,{aspectRatio:G}),c);else if(Xr(m)&&m.aspectRatio){m=m.set({aspectRatio:null},c);let y=m.updateForSize(h,f);y.aspectRatio=G,m.set(y,c)}else m.set(m.updateForSize(h,f),c)}})}lt.resetToIntrinsicSize=sy;function vo(c,u,m,f){let h=c.getRect(u),G=c.getOriginPoint(u),y=c.convertPointToCanvas(u,{x:h.width*G.x,y:h.height*G.y});if(f){let x=c.transformMatrixToNode(f),O=Y6(f)?x:hj.flatProjectionMatrix(x);y=hj.convertPoint(O.inverse(),y)}let b={...h,x:y.x-h.width*G.x,y:y.y-h.height*G.y},C=u.updateForRect({rect:b,parentSizeInfo:c.getParentSizeInfo(u,f),constraintsLocked:!1,shouldGuessPinToBottom:f?ot(c,u,f):!0,shouldGuessPinToRight:Uj(c,u,f)});return LA(f)||(C.widthType===3&&(C.widthType=0,C.width=h.width),C.heightType===3&&(C.heightType=0,C.height=h.height)),St(u)&&(C.rotation=u.resolveValue("rotation")-qg(c,m,f)),f&&de(f)&&!ta(u)&&!ra(u)&&(C.top=null,C.left=null,C.bottom=null,C.right=null),Object.assign(C,eo(u,f)),C}lt.convertNodeToNewParentUpdate=vo;function ly(c,u,m,f,h=-1,G){let{tree:y}=c,b=u;if(ej(u)&&(b=Pe(y,u),!b))return null;let C=f;if(f&&gA(f)&&(C=Pe(y,f),!C))return null;let M=m;if(m&&gA(m)&&(M=Pe(y,m),!M))return null;let x=vo(y,G??b,ej(u)?M:m,ej(u)?C:f);if(c.tree.current(b)?.set(x),c.moveNode(b.id,C?C.id:c.stores.scopeStore.active.id,h),b.id!==u.id){E(m,"Current parent must exist when editing variants");let nA=dA.getReplicaForTemplateNode(y,m);E(nA,"The current parent should located in a variant node");let uA=f?dA.getReplicaForTemplateNode(y,f):null;if(nA.id===uA?.id){let FA=vo(y,u,m,f);y.current(u)?.set(FA)}}return{originalNode:b,originalCurrentParent:M,originalNewParent:C}}lt.convertNodeToNewParent=ly;function hd(c,u){if(!wr(c)&&!Tt(c)&&(u.push(c.id),!!c.children))for(let m of c.children)hd(m,u)}function Rd(c,u){let m=new Set;return u.forEach(f=>{let h=c.getParent(f.id);h&&m.add(h.id)}),m}function cy(c,u){let m=c.withoutDescendants(c.getNodes(u));return Rd(c,m).size>0}lt.canSelectAncestor=cy;function dy(c,u){Id(c,u,"parent")}lt.selectParent=dy;function py(c,u){Id(c,u,"groundNode")}lt.selectGroundNode=py;function Id(c,u,m){let{tree:f}=c,h=f.withoutDescendants(f.getNodes(u)),G=null;if(m==="groundNode"){let M=new Set(h.map(x=>f.getGroundNodeFor(x).id));M.size>0&&(G=Array.from(M))}else{let M=Rd(f,h);M.size>0&&(G=Array.from(M))}if(!G)return!1;let{selectionStore:y,overlayStore:b}=c.stores;y.set(G,{sticky:!0,switchToLayers:!0});let C=h.length===1?h[0]:null;return C&&b.activeOverlays.has(C.id)&&b.exitEditMode(y,!1),c.setHighlight(null),!0}lt.selectAncestor=Id;function ky(c,u){let m=c.tree,f=[];if(c.tool.selectAll){c.tool.selectAll();return}else{let h=u.map(G=>{let y=m.get(G);if(HA(y)){let C=om(m,y);return C&&m.isGroundNode(C)?C.id:mj}let b=m.getGroundFrameAncestor(G,!0);return b!==null?b.id:mj});if(new Set(h).size===1&&h[0]!==null){let G=h[0];f=m.getSubtreeNodes(G).filter(y=>Tt(y)?!1:y.id!==G).map(y=>y.id)}if(f.length===0)for(let G of c.stores.scopeStore.active.children)hd(G,f)}c.stores.selectionStore.set(f)}lt.selectAll=ky;function uy(c,u){let m=new Set;for(let f of u){let h=c.tree.get(f);if(!h)continue;let G=c.tree.getSiblingsIncludingSelf(h);for(let y of G)m.add(y.id)}c.stores.selectionStore.set(m)}lt.selectAllSiblings=uy;function my(c,u){return c.tree.getNodes(u).some(m=>CA(m)&&m.children.length>0)}lt.canSelectChildren=my;function Ey(c,u){let m=new Set;for(let f of u){let h=c.tree.get(f);if(!h)continue;let G=jo(h);for(let y of G)m.add(y.id)}m.size>0&&c.stores.selectionStore.set(m)}lt.selectAllChildren=Ey;function fy(c,u){let m=u.length>0?c.tree.getNodes(u):c.stores.scopeStore.active.getGroundNodes(),f=[];m.map(b=>{Tj(b)?f.push(...c.tree.getSiblingsIncludingSelf(b)):f.push(b)});let h=new Set,G=new Set,y=b=>{if(!h.has(b.id)){if(Tj(b)&&G.add(b.id),b.children)for(let C of b.children)y(C);h.add(b.id)}};for(let b of f)y(b);c.stores.selectionStore.set(G)}lt.selectAllTextNodes=fy;function $y(c,u){let[m]=c.tree.getNodes(u);if(!m||!Tj(m))return;let f=[],h=JA(m)?ze(m.getTextStylePresets(!1)):void 0,G=ze(m.getFonts(!1)),y=ze(m.getFontSizes(!1).map(C=>Jo(C)?$t(...C):Y(C)?$t(C,"px"):C)),b=ze(m.getTextColors(!1));if(!(Bt(h)||je(h))&&!(Bt(G)||je(G))&&!(Bt(y)||je(y))&&!(Bt(b)||je(b))){for(let C of c.stores.scopeStore.active.walk())sj(C)||!Tj(C)||(JA(C)?ze(C.getTextStylePresets(!1)):void 0)!==h||ze(C.getFonts(!1))!==G||ze(C.getFontSizes(!1).map(uA=>Jo(uA)?$t(...uA):Y(uA)?$t(uA,"px"):uA))!==y||ze(C.getTextColors(!1))!==b||f.push(C);c.stores.selectionStore.set(f)}}lt.selectAllTextNodesWithSameFontStyles=$y;function By(c,u){let m=c.tree.getNodes(u);E(u.length===1,"Cannot have multiple layers selected");let[f]=m;if(!f||!mA(f))return;let h=[],y=op(c.tree,f.id)??c.stores.scopeStore.active;for(let b of y.walk())mA(b)&&Og(f,b,c.tree)&&h.push(b);c.stores.selectionStore.set(h)}lt.selectAllLayersWithSameFill=By;function Og(c,u,m){if(bt(c)&&!c.fillEnabled||bt(u)&&!u.fillEnabled)return!1;let{fillType:f}=c;if(f!==u.fillType||f===void 0)return!1;switch(f){case"color":return!_(c.fillColor)||!_(u.fillColor)?!1:Ii.equals(Ol(c.fillColor,m,void 0),Ol(u.fillColor,m,void 0));case"linear-gradient":return c.fillLinearGradient&&u.fillLinearGradient?c.fillLinearGradient.equals(u.fillLinearGradient):!1;case"radial-gradient":return c.fillRadialGradient&&u.fillRadialGradient?c.fillRadialGradient.equals(u.fillRadialGradient):!1;case"conic-gradient":return c.fillConicGradient&&u.fillConicGradient?c.fillConicGradient.equals(u.fillConicGradient):!1;case"image":return c.fillImage===u.fillImage;default:lA(f)}}function Fd(c){return c.some(u=>na(u)?ej(u)?!oe(u):!1:!0)}function Mr(c){let u={};return c.forEach(m=>{let f=m.parentid?m.parentid:Ho,h=u[f];h||(h=[],u[f]=h),h.push(m)}),u}function Gd(c,u,m){let f=c.tree;for(let h in u){let G=h===Ho?f.root:f.get(h);if(!G||!u[h])continue;let y=f.sortVisually(u[h]);m==="back"&&y.reverse();let b=m==="front"?-1:0,C=sj(G)&&ke(G);y.forEach(M=>{let x=M.originalid?f.get(M.originalid):M;E(x,"Cannot send",M.id,"backward/forward: original node must exist."),C&&na(x)?O6(x.id,G,b):c.tree.moveNodeIndex(x,b)})}}function wg(c,u,m){let f=c.tree.getParent(m.id);if(!f)return null;let h=f.children.indexOf(m),G=u==="backward"?h-1:h+1,y=f.children[G];if(!y||!be(y))return null;let b=c.tree.convertFrameToCanvas(m),C=c.tree.convertFrameToCanvas(y);if(u==="backward")return{...b,y:C.y};let M=C.height-b.height;return{...b,y:C.y+M}}function Lg(c,u,m){let f=wg(c,u,m),{canvasStore:h}=c.stores;!f||L.containsRect(h.getCanvasVisibleRectTakingOverlaysIntoAccount(),f)||h.zoomToCenter(f,{zoom:h.zoom,maxZoom:.5,animated:!0})}function Sd(c,u,m){let f=c.tree,h=Object.keys(u).length===1;for(let G in u){let y=G===Ho?f.root:f.get(G);if(!y||!CA(y))continue;let b=sj(y)&&ke(y),C=u[G],M=h&&C?.length===1,x=er(y)?y.getChildrenInVisualOrder():y.children,O=!1;for(let nA=0,uA=x.length;nA<uA;nA++){let FA=m===1?uA-nA-1:nA,$A=x[FA];if(!C?.includes($A))O=!0;else if(O)if(b&&na($A))E($A.originalid,"Cannot send nodes: nodes in a replica variant parent must have originalid."),O6($A.originalid,y,FA+m);else{M&&Qa(f,$A)&&Lg(c,m===-1?"backward":"forward",$A);let GA=$A.originalid?f.get($A.originalid):$A,qA=y.originalid?f.get(y.originalid):y;E(GA,"Cannot send node",$A.id,": original child node does not exist."),E(qA,"Cannot send node",y.id,": original parent node does not exist."),c.moveNode(GA.id,qA.id,FA+m)}}}}function yd(c,u,m){for(let f in u){let h=f===Ho?c.root:c.get(f);if(!h||!CA(h))continue;let G=u[f],y=er(h)?h.getChildrenInVisualOrder():h.children,b=!1;for(let C=0,M=y.length;C<M;C++){let x=m===1?M-C-1:C,O=y[x];if(!G?.includes(O))b=!0;else if(b)return!0}}return!1}function qg(c,u,m){let f=0,h=0;return u&&(f=c.totalAncestorRotation(u)),m&&(h=c.totalAncestorRotation(m)),Math.round(h-f)}function gy(c){if(c.length!==1)return!1;let u=c[0];return u&&co(u)&&!u.originalid}lt.reversePathDirectionEnabled=gy;function hy(c,u){let m=c.current(u);m&&m.set({pathSegments:Dj.reverse(m.pathSegments)})}lt.reversePathDirection=hy;function Ry(c,u){let m=Fn(u,c);return m.length===0?!1:m.every(f=>HA(f)&&!f.originalid&&jo(f).length>0)}lt.canUngroup=Ry;function Kg(c,u){if(u.length===0)return;let m=c.tree,f=m.sortVisually(Fn(u,m)),h=m.withoutDescendants(f),G=[];return h.forEach(y=>{if(!CA(y))return;let b=y,C=null;if(ej(y)){if(b=Pe(m,y),!b)return;C=dA.getReplicaForTemplateNode(m,y)}let M=m.getParent(y.id);if(y.children.length>0){let x=m.getIndex(y),O=b?.id??y.id;[...jo(y)].forEach((uA,FA)=>{let $A=uA;if(ej(uA)&&($A=Pe(m,uA),!$A))return;if(Qj($A)){m.removeNode($A);return}let BA=M,GA=BA;if(BA&&gA(BA)&&(GA=Pe(m,BA),!GA))return;let qA=lt.convertNodeToNewParentUpdate(m,$A,b,GA);if(c.moveNode($A.id,GA?.id??null,x+FA,O),c.tree.current($A)?.set(qA),O=$A.id,C){let TA=lt.convertNodeToNewParentUpdate(m,uA,y,BA);c.tree.current(uA)?.set(TA)}G.push(uA.id)}),c.deleteNode(b.id)}}),c.stores.selectionStore.set(G),G}lt.ungroup=Kg;function Iy(c){return!c.hasPreferredSize(K)}lt.canSetDefaultSize=Iy;function Fy(c,u){if(u.hasPreferredSize(K))return;let m=u.getPreferredSize(K),f={aspectRatio:null};m.width==="auto"?(f.width=1,f.widthType=2):Y(m.width)&&(f.width=m.width,f.widthType=0),m.height==="auto"?(f.height=1,f.heightType=2):Y(m.height)&&(f.height=m.height,f.heightType=0),EA(u)&&Y(u.top)&&Y(u.bottom)&&(f.bottom=null),EA(u)&&Y(u.left)&&Y(u.right)&&(f.right=null),Bf(u,f,"context_menu_default_size_item"),u.set(f,c.tree)}lt.setDefaultSize=Fy;function Vg(c,u){if(!c.stores.toolStore.isDefaultToolActive)return!1;let m=Fn(u,c.tree);return m.length===0?!1:m.every(f=>HA(f)&&!f.originalid)}lt.canJoinInGroup=Vg;function Gy(c,u){let m=c.tree;if(E(u.length>0,"No nodes"),!Vg(c,u))return;let f=Fn(u,m),h=m.sortVisually(m.withoutDescendants(f)),G=h[0],y=G?m.getParent(G.id):void 0,b=y?y.id:mj,C=G?m.getIndex(G):void 0,M=m.newId();c.createShapeGroup(b,{id:M},C),h.forEach(x=>{let O=lt.convertNodeToNewParentUpdate(m,x,m.getParent(x.id),y);c.moveNode(x.id,M),c.tree.current(x)?.set(O)}),c.stores.selectionStore.set(M)}lt.joinInGroup=Gy;function Sy(c,u){if(u.originalid)return null;let m={width:u.width,height:u.height},f=uf(u.svg,Ra.createEmpty,m,u);if(f){f.name=u.name||u.originalFilename,f.parentid=u.parentid;let h=c.cloneNode(f),G=u.parentid===null,y=G?"rgb(255,255,255)":"transparent",{aspectRatio:b,...C}=u.constraintValues();c.tree.current(h)?.set({...C,width:f.width,height:f.height,fillEnabled:G,fillColor:y});let M=c.tree.getParent(u.id);if(M!==null&&CA(M)){let x=M.children.indexOf(u);c.moveNode(h.id,M.id,x)}return bd(c,h.id,m),c.deleteNode(u.id),h.id}return null}lt.convertSVGToShape=Sy;function bd(c,u,m){let f=c.tree.get(u);if(!IA(f))return;let h=f.width>=f.height?"width":"height",G=h==="width"?"height":"width",y=m[h]/f[h];if(y===1)return;o$(c,[f],y,n$(c,[f]),Jg(f));let b=c.tree.current(f);E(b,"Node must exist after scaling");let C=m[G]-b[G];if(C===0)return;b.set({[G]:m[G]});let M=G==="width"?"x":"y";for(let x of b.children){let O=c.tree.current(x);!O||!sa(O)||O.set({[M]:O[M]+C/2})}}lt.scaleVector=bd;function Jg(c){let u=c.constraints(),m=0,f=0;return u.top===!1&&u.bottom===!1?f=.5:u.top===!1&&(f=1),u.left===!1&&u.right===!1?m=.5:u.left===!1&&(m=1),{x:m,y:f}}function yy(c,u){if(u.length>1)return!1;let m=dA.getReplicaForTemplateNode(c,u[0]);if(!m)return!1;let f=dA.getMaster(c,m);if(wr(f))return!1;for(let h=0,G=u.length;h<G;h++){let y=u[h];if(dA.overrideKeys(c,[y]).size>0)return!0}return!1}lt.canUpdateMasterFromInstance=yy;function by({tree:c},u){function m(C,M){for(let x of["id","update","cache","children","mutable","parentid","originalid","isMaster","isVariant","isBreakpoint","replicaInfo","duplicatedFrom","gesture"])delete C[x];if(M)for(let x of dA.positionKeysToIgnore)delete C[x];return C}function f(C,M){let x;if(M)for(let O of dA.positionKeysToIgnore)C[O]!==void 0&&(x=x||{},x[O]=C[O]);return C.gesture&&(x||(x={}),x.gesture=C.gesture),x}let h=dA.getReplicaForTemplateNode(c,u[0]);if(!h)return;let G=dA.getMaster(c,h);if(wr(G))return;let y={...h.replicaInfo.overrides},b={...h.replicaInfo,overrides:y};for(let C=0,M=u.length;C<M;C++){let x=u[C];if(!x?.originalid)continue;let O=c.get(x.originalid),nA=m(x.raw(),jj(x));O?.set(nA);let uA=f(y[x.originalid]??{},jj(x));uA?y[x.originalid]=uA:delete y[x.originalid]}h.asDraft().replicaInfo=b}lt.updateMasterFromInstance=by;function Cy(c,u){let m=Cd(c,u);return!m||xo(m)?0:l7(m)?2:1}lt.canGoToMaster=Cy;let Cd=(c,u)=>{let m=null;for(let h=0,G=u.length;h<G;h++){let y=u[h],b=dA.getReplicaForTemplateNode(c,y);if(b){if(!m)m=b.originalid;else if(m!==b.originalid)return null}}if(!m)return null;let f=c.getNode(m);return!f||!qj(f)?null:f};function vy(c,u){if(u.length===1){let f=c.tree.getNode(u[0]?.originalid);if(!f)return;vd(c,f);return}let m=Cd(c.tree,u);m&&(dA.showMaster(c.tree,m),vd(c,m))}lt.goToMaster=vy;function vd(c,u){let m=c.tree.getScopeNodeFor(u),f=c.stores.scopeStore.active;qj(u)&&dA.showMaster(c.tree,u),m===null&&(c.moveNode(u.id,f.id),m=f),c.stores.scopeStore.select(m.id,{keepHistory:!1}),c.stores.selectionStore.set(u);let h=c.tree.convertFrameToCanvas(u);c.stores.canvasStore.scrollToCenter(L.center(h))}lt.showNodeOnCanvas=vd;function Ty(c,u){c.exitMode(),c.stores.modalStore.set({type:"CodeFileCreation",source:"main_menu",creationType:"Component",parentId:u})}lt.createCodeComponent=Ty;function Py(c){c.exitMode(),c.stores.modalStore.set({type:"CodeFileCreation",source:"main_menu",creationType:"Override"})}lt.createCodeOverride=Py;function My(c,u,m,f,{gesture:h,overrides:G,overrideSize:y,variantName:b,viewportHeight:C,selectAndCenter:M=!0}={}){h&&E(Vi(m),"gesture variant should inherit from top level variant");let{treeStore:x,scopeStore:O,selectionStore:nA,canvasStore:uA}=c,FA=u.getPrimaryVariant(),$A=null;if(!h){let qA=new Set(u.getTopLevelVariants().map(TA=>TA.name??""));b?$A=Nj(b,qA):$A=Nj(RA(m)?"Breakpoint":"Variant",qA,{startIndex:qA.size+1,omitCountIfFirst:!1})}if(G||(G=h?void 0:m.replicaInfo?.overrides),$A&&RA(m)){let qA=BE(x,$A,m);qA&&(G?G=jr(qA,G):G=qA);let TA={};m.children.forEach(bA=>{if(!ke(bA)||EA(bA)&&bA.widthType===2||!(bA.originalid?x.tree.getNode(bA.originalid):bA))return;let fj=x.tree.getRect(bA);Vl(x.tree,bA,fj,m,f.width,TA)}),G||(G={}),G=jr(G,TA)}let BA=dA.create(x.tree,FA,{overrides:G,inheritsFrom:h?m.id:void 0,duplicatedFrom:Xo(m)});if(O.insertNode(BA,u.id,-1),!BA)return;let GA={top:f.y,left:f.x,gesture:h,isBreakpoint:Ur(u)?!0:void 0,name:$A};if(C&&(GA.viewportHeight=C),y&&(GA.width=f.width,GA.widthType=0,RA(BA)||(GA.height=f.height,GA.heightType=0)),BA.set(GA),tA(u)){let qA=Fa(h)?"variant":h??"variant";Um({variantId:BA.id,variantType:qA,componentId:u.id})}else RA(BA)&&fA("breakpoint_create",{scopeId:u.id,breakpointId:BA.id,width:BA.width});return M&&(nA.set(BA.id),uA.scrollToCenter(L.center(f))),BA}lt.createVariant=My;function Hg(c,u){return c.filter(m=>pa(m)?tu(m)!==u:Me(m)?lE(m)!==u:!0)}function _y(c,u,m){for(let f of u.walk()){let h=ma(f);for(let[G,y]of Object.entries(h)){let b=Hg(y,m);if(b.length!==y.length){if(Se(f))c.tree.current(f)?.set({[G]:b});else if(X(f)){let C={type:"eventhandler",value:b};c.tree.current(f)?.set({[G]:C})}}}}}lt.removeActionsWithTarget=_y;function Dy(c,u){let m=c.tree.getParent(u.id)||c.stores.scopeStore.active;if(gA(m))return!1;let f=c.stores.treeStore.getPartialIndexes();return u.codeComponentIdentifier in f.localSmartComponentNameByIdentifier}lt.canDetachVariantInstance=Dy;function Ny(c,u,m,f){if(!m)return null;let h={...qa(u,K),...Nf(u)},G=new Map;m.getTopLevelVariants().forEach(TA=>G.set(TA.id,TA));let y=_(h.variant)&&G.get(h.variant)||m.getPrimaryVariant();E(mA(y),"Variant must be a frame node");let b=c.tree.getParent(u.id)||c.tree.getScopeNodeFor(u)||c.stores.scopeStore.active;if(gA(b))return null;let C=new Map,M=Mn(y,new Map,new Map,C);C.set(u.id,M.id);let x=c.tree.getScopeNodeFor(b);if(V(x)||tA(x)){let TA=x.getTopLevelReplicaVariants();for(let bA of TA){let Gj=ne(bA.id,u.id),fj=c.tree.getNode(Gj);if(!fj||!X(fj))continue;let De=fj.getResolvedControlPropValues(K).variant;if(!_(De))continue;if(f){let wj=f.get(De);wj&&(De=wj)}let rA=_(De)?G.get(De):void 0;if(!rA||!mA(rA)||!MA(rA))continue;let Ne=Bo(_f(rA,c.tree,fj,m.id),C),Sj={},wA=C.get(y.id)??y.id;if(Wo(rA)){let wj=Bo(rA.replicaInfo.overrides,C,!0);Object.assign(Sj,{...wj,[wA]:Df(wj[wA]??{})})}let UA=jr(Ne,Sj);if(Wo(rA)){let{opacity:wj,rotation:ct}=bA.replicaInfo.overrides?.[u.id]||{};as(UA[wA]??{},{opacity:wj,rotation:ct})}else if(bA.replicaInfo.overrides?.[u.id]){let{opacity:wj,rotation:ct}=rA;as(bA.replicaInfo.overrides[u.id]??{},{opacity:wj,rotation:ct})}let rj={};fj.heightType===2&&(rj.heightType=rA.heightType,rj.height=rA.height),fj.widthType===2&&(rj.widthType=rA.widthType,rj.width=rA.width),c.tree.current(bA)?.set({replicaInfo:{...bA.replicaInfo,overrides:jr({...bA.replicaInfo.overrides,[u.id]:{}},{...UA,[wA]:{...bA.replicaInfo.overrides[u.id],...UA[wA],...rj}})}})}}let O=Ja(c.tree,u,M,b);as(O,{opacity:cA(y.opacity)?h[y.opacity.id]:y.opacity,rotation:cA(y.rotation)?h[y.rotation.id]:y.rotation});let nA=u.constraintValues(),uA=y.constraintValues();nA.widthType===2&&uA.widthType!==2&&(nA.widthType=uA.widthType),nA.heightType===2&&uA.heightType!==2&&(nA.heightType=uA.heightType),M.set({...nA,...O,...b?Rt(u):void 0,isVariant:!1,isMaster:!1,gesture:void 0,replicaInfo:null,originalid:null,name:u.name??rt(u)});let FA=Du(m),$A=new Map([...FA??[],...Object.entries(h)]),BA=new Map;BA.set(m.id,$A);let GA={};for(let TA of M.walk()){if(TA.originalid=null,ru(TA))for(let[bA,Gj]of Object.entries(TA.getActions(K)))Gj&&TA.set({[bA]:Gj.filter(fj=>Qi(fj)||Hi(fj))});if($A.size>0){let bA=$a(c.tree,m.id,TA,BA,GA);bA&&TA.set(bA)}}E(M.id!==y.id);let qA=b.children.indexOf(u);c.tree.insertNode(M,b.id,qA);for(let TA of u.children)Qj(TA)&&c.tree.moveNode(TA,GA[TA.id]??M.id);return it(c.tree,b,C,Qj(b)||Xi(b)),c.deleteNode(u.id),gj(M)&&c.stores.overlayStore.showOverlay(c.stores.selectionStore,M,M.parentid),M}lt.detachSmartComponentOrWebPageInstance=Ny;function xy(c){Qg(c,{openLibrary:!0})}lt.toggleTeamLibrary=xy;function Qg(c,{openLibrary:u}={}){let{modalStore:m,popoverStore:f}=c.stores;m.active.type==="QuickActions"?m.dismiss():(c.cancelTool(),f.active=0,m.set({type:"QuickActions",source:"main_menu",initialCategory:u?{type:"TeamLibraryCategory"}:void 0}),u?fA("ui_interaction",{page:"main-menu",id:"team-library"}):fA("ui_interaction",{page:"main-menu",id:"quick-actions"}))}lt.toggleQuickActions=Qg;function Oy(c){return!!RA(c)}lt.canCreateBreakpoint=Oy;function wy(c,u,m,f,h){let{modalStore:G}=c.stores;G.active.type!=="CustomBreakpoint"&&(c.cancelTool(),G.set({type:"CustomBreakpoint",actionType:u,baseNodeId:m,name:f,width:h,source:"undefined"}))}lt.showCustomBreakpointModal=wy;function Ly(c,u,m,f,h,G,y,b){let C={...f,width:h};lt.createVariant(c.stores,m,u,C,{overrideSize:!0,variantName:G,viewportHeight:y,selectAndCenter:b})}lt.createBreakpoint=Ly;function Ug(c){return c.some(u=>u!==c&&qj(u))}lt.containsMaster=Ug;function Wg(c){return mA(c)||Kr(c)||IA(c)||Tj(c)||y7(c)||b7(c)||C7(c)}lt.nodeTypeCanBePrimaryVariantSource=Wg;function zg(c,u){return!(!Wg(u)||uE(c,u)||MA(u)||jj(u)||qj(u)||Ug(u))}lt.canConvertNodeToSmartComponentPrimaryVariant=zg;function Xg(c,u){let m=u.length;if(m===0)return!0;let f=u[0];return E(f,"node must be defined",u),m===1&&zg(c.tree,f)}lt.canMakeSmartComponent=Xg;function Yg(c,u){if(u.length!==1)return!1;let f=u[0];if(E(f,"node must be defined",u),!mA(f)||gA(f))return!1;let h=c.tree.get(f.parentid);return Hj(h)}lt.canMakeWebPagePrimaryBreakpoint=Yg;function qy(c,u){if(!Yg(c,u))return;let m=u[0];E(m,"node must be defined",u),c.createWebPage({primaryBreakpointId:m.id,shouldRemovePanelOverrides:!1})}lt.convertNodeToWebPagePrimaryBreakpoint=qy;function Ky(c,u,m="Template",f,h){let G=new fe({...Dt,...zI(f),isMaster:!0,isVariant:!0,isBreakpoint:!0,widthType:0,heightType:0,width:f?.width??1200,name:f?.name??"Desktop"}),y=new im;G.addChild(y);let b=Nj(m,XI(c)),C=new xu({baseVariantId:G.id,name:b});E(C.isLoaded(),"A newly created LayoutTemplateNode must be loaded."),C.addChild(G),c.latestTree().insertNode(C);let M=La(c,b,h??tn);return hr(c,M,C.id),fA("layout_template_create",{source:u}),C}lt.createLayoutTemplate=Ky;function Vy(c,u,m=!0,f=null,h=Ej(),G="context_menu",y=0){let b=new al({name:u,id:h});if(E(b.isLoaded(),"A newly created VectorSetNode must be loaded"),c.tree.latestTree().insertNode(b),hr(c.tree,f??Ao,b.id),m)for(let M of eF())c.tree.latestTree().insertNode(M,b.id);let C=c.tree.current(b);return E(C,"A newly created VectorSetNode must exist"),c.stores.codeGenerationStore.createVectorSet(C.getVectorSetItems()),fA("vector_set_create",{source:G,items:m?3:y}),b}lt.createVectorSet=Vy;async function Jy(c,u,m){let f=c.tree.get(m);if(!re(f))return;let h=f.isLoaded()?f:await f.load();if(!h)return;let G=h.children.find(jt);if(!jt(G))return;let y=c.tree.getRect(G);c.process(()=>{let b=k$(c,u),C=[],M=bt(G)?{fillEnabled:G.fillEnabled,fillType:G.fillType,fillColor:G.fillColor}:void 0;for(let x of b){let O=c.tree.get(x);if(!O)continue;let nA=c.tree.getIndex(O),uA=Rn(c.tree,h,O,y,y.width),FA=p$(O,uA,M);if(jt(FA)){if(c.tree.insertNode(FA,h.id),C.push(FA),bd(c,FA.id,y),fA("vector_set_item_create",{source:"context_menu"}),m!==c.stores.scopeStore.active.id){let $A=new ur({...u$(O),codeComponentIdentifier:Ht("vector",FA.id,"default").value,width:O.width,height:O.height,widthType:0,heightType:0,slotsAreChildNodes:XA.isOn("componentSlotsAreChildNodes"),name:O.name});c.tree.insertNode($A,O.parentid,nA)}c.tree.removeNode(O)}}C.length!==0&&(c.stores.scopeStore.select(f.id,{keepHistory:!1}),c.stores.selectionStore.set(C),c.stores.chromeStore.layersExpanded=!0,c.stores.chromeStore.contentPanelTab="Layers",c.stores.codeGenerationStore.createVectorSet(C))})}lt.addToVectorSet=Jy;function Hy(c,u,m="Icon Set",f="context_menu"){let h=new al({name:m});E(h.isLoaded(),"A newly created VectorSetNode must be loaded");let G=k$(c,u),y=0,b=[];for(let C of G){let M=c.tree.get(C);if(!M)continue;let x=c.tree.getRect(M),O=p$(M,{x:y,y:0});if(!jt(O))continue;let nA=c.tree.getIndex(M);b.push(O),h.addChild(O),y+=x.width*2;let uA=new ur({...u$(M),codeComponentIdentifier:Ht("vector",O.id,"default").value,width:M.width,height:M.height,widthType:0,heightType:0,slotsAreChildNodes:XA.isOn("componentSlotsAreChildNodes"),name:M.name});c.tree.insertNode(uA,M.parentid,nA),c.tree.removeNode(M)}c.tree.latestTree().insertNode(h),hr(c.tree,Ao,h.id),c.stores.codeGenerationStore.createVectorSet(b),c.stores.scopeStore.select(h.id,{keepHistory:!1}),c.stores.selectionStore.set(b),c.stores.chromeStore.layersExpanded=!0,c.stores.chromeStore.contentPanelTab="Layers",fA("vector_set_create",{source:f,items:G.size})}lt.createVectorSetFromNodes=Hy;function Qy(c,u,m,f,h){let G=m.clone({children:[],name:"Vector"}),{scopeStore:y,codeGenerationStore:b,selectionStore:C,canvasStore:M}=c;y.insertNode(G,u.id),E(EA(G),"Vector must be pinnable."),G.set({top:f.y,left:f.x}),b.createVectorSet([G]),C.set(G.id),M.scrollToCenter(L.center(f)),fA("vector_set_item_create",{source:h})}lt.createVectorSetItem=Qy})(Bc||={});var Dt={height:Nu,left:0,top:0,layout:"stack",stackDirection:"vertical",stackAlignment:"center",stackDistribution:"start",stackWrapEnabled:!1,gap:0,padding:0,paddingPerSide:!1,paddingLeft:0,paddingBottom:0,paddingTop:0,paddingRight:0,overflow:ye()};function zI(j){if(!j||!Ie(j)||!et(j)||!bt(j))return;let A=to(j);return{gap:j.resolveValue("gap")??Dt.gap,padding:A.perSide?Dt.padding:A.top,paddingPerSide:A.perSide??Dt.paddingPerSide,paddingLeft:A.left??Dt.paddingLeft,paddingBottom:A.bottom??Dt.paddingBottom,paddingTop:A.top??Dt.paddingTop,paddingRight:A.right??Dt.paddingRight,fillEnabled:j.resolveValue("fillEnabled"),fillType:j.resolveValue("fillType"),fillColor:j.resolveValue("fillColor"),fillLinearGradient:j.resolveValue("fillLinearGradient"),fillRadialGradient:j.resolveValue("fillRadialGradient"),fillConicGradient:j.resolveValue("fillConicGradient"),fillImage:WA(j.fillImage)?void 0:j.fillImage,fillImageOriginalName:j.resolveValue("fillImageOriginalName"),fillImageResize:j.resolveValue("fillImageResize"),fillImagePixelWidth:j.resolveValue("fillImagePixelWidth"),fillImagePixelHeight:j.resolveValue("fillImagePixelHeight"),fillImagePositionX:j.resolveValue("fillImagePositionX"),fillImagePositionY:j.resolveValue("fillImagePositionY"),fillImageTileSize:j.resolveValue("fillImageTileSize")}}function XI(j){let A=new Set;return j.root.children.forEach(e=>{!ij(e)||!e.name||A.add(e.name)}),A}function E$(j){return!(Qr(j)||Di(j)||Ve(j))}function $c(j){return!(aj(j)||Di(j)||Ve(j)||ej(j))}function YI(j){return oe(j)&&j.isVisible()?!0:$c(j)}function d$(j){return E$(j)?ej(j)?oe(j):!0:!1}function xn(j,A){if(Kj(A)){let e=dr(j.tree,A.dataIdentifier);if(e)return e.id}return null}function ZI(j,A,e){if(e){let r=xn(j,e);if(r)return r;for(let o of e.ancestors()){let n=xn(j,o);if(n)return n}}let t=xn(j,A);if(t)return t;if(e)for(let r of e.walk()){let o=xn(j,r);if(o)return o}for(let{node:r,skipChildren:o}of A.walkWithSkipChildren())if(e&&r.id===e.id)o();else{let n=xn(j,r);if(n)return n}return null}function p$(j,{x:A,y:e},t){if(HA(j)){let r=new Er({...t,isVectorSetItem:!0,width:j.width,height:j.height,left:A,top:e,name:j.name}),o=j.clone({x:0,y:0});return r.addChild(o),r}return j.clone({...t,isVectorSetItem:!0,left:A,top:e})}function k$(j,A){return new Set(A.map(e=>{if(!e)return null;if(IA(e))return e.originalid??e.id;let t=j.tree.getAncestorThatMatches(e,o=>AF(j,o),!0,!0);if(!t)return null;let r=j.tree.getNodeParent(t);return r&&IA(r)?r.originalid??r.id:t.originalid??t.id}))}function AF(j,A){return HA(A)&&j.tree.isRootVectorNode(A)}function u$(j){return EA(j)?{top:j.top,bottom:j.bottom,left:j.left,right:j.right,centerAnchorX:j.centerAnchorX,centerAnchorY:j.centerAnchorY,constraintsLocked:j.constraintsLocked}:{top:j.y,left:j.x}}var jF="rgb(0, 153, 255)",Ec={fillType:"color",fillColor:jF,fillEnabled:!0},fc={isVectorSetItem:!0,top:0,width:40,height:40,autoSize:!1},eF=()=>{let j=new dl({...Ec,x:-3,y:-3,width:46,height:46,polygonSides:3,centered:!0,radius:1}),A=new dl({...Ec,x:0,y:0,width:40,height:40,polygonSides:4,centered:!0,radius:1}),e=new sm({...Ec,x:2,y:2,width:36,height:36}),t=new Er({...fc,name:"Triangle"});t.addChild(j);let r=new Er({...fc,left:80,name:"Diamond"});r.addChild(A);let o=new Er({...fc,left:160,name:"Oval"});return o.addChild(e),[t,r,o]};function ps(j){let A={},e=j.getPresetsListNode();if(!e)return A;for(let t of e.children)if(!jj(t)){if(ut(t)){let r=qu(t.tag);A[r]??=t.id;continue}if(mt(t)){A.stylePresetLink??=t.id;continue}if(Et(t)){A.stylePresetInlineCode??=t.id;continue}if(_i(t)){A.stylePresetImage??=t.id;continue}if(T7(t)){A.stylePresetBlockquote??=t.id;continue}if(Mi(t)){A.stylePresetTable??=t.id;continue}if(Vr(t)){let r=zo(t.componentIdentifier);A[r]??=t.id;continue}lA(t)}return A}function lJ(j,A){let e=ps(j),t={};for(let r in e){let o=A[r];j.get(o)||(t[r]=e[r])}Object.keys(t).length>0&&A.set(t)}function cJ(j,A,e="",t={}){let r=document.createElement(A);r.innerText=e;let o=ga(j,A);if(o)cp(r,o.id);else{let n=hk[A],a=n.fontSize,i;K7(a)?i=xi(a):Y(a)&&(i=[a,"px"]),sp(r.style,ap.transforms,{...n,fontSize:i})}return new Am({html:r.outerHTML,...ps(j),...t})}function f$(j,A,e,t){let r=`${t}/${e.segment}`;j.add(r);for(let o of e.children)f$(j,A,o,r)}function $$(j){let A=new Set,e=Zr(j);if(!e)return A;for(let t of e.children)f$(A,j,t,"");return A}function B$(j){j=[...j].sort((e,t)=>e[0]-t[0]||e[1]-t[1]);let A=[];for(let e of j){if(e[0]===e[1])continue;let t=A[A.length-1];if(!t){A.push(e);continue}if(e[0]<=t[1]){t[1]<e[1]&&(t[1]=e[1]);continue}A.push(e)}return A}function g$(j,A){let e=[],t=0;for(let[r,o]of j){if(r<=t){t=o;continue}e.push([t,r]),t=o}return A!==void 0&&t<A&&e.push([t,A]),e}var tF=/\/+/gu,rF=/\/{2,}/gu,oF=new RegExp(`-?${p7}-?`,"g"),nF=/\s+/gu,iF=/[?#[\]@!$&'()*+,;="<>%{}|\\^`]/gu;function aF(j){return j.startsWith("/")?j:"/"+j}function sF(j){return j.replace(rF,"/")}function lF(j){return j.toLowerCase().replaceAll(iF,"").replaceAll(nF,"-")}function ks(j){let A=cF(j,tF,oF),e=g$(A,j.length);return j.startsWith("/")?j=h$(j,e,lF):j=h$(j,e,O7),j=aF(j),j=sF(j),j}function cF(j,...A){let e=[];for(let t of A)for(let r of j.matchAll(t))E(r.index!==void 0),e.push([r.index,r.index+r[0].length]);return B$(e)}function h$(j,A,e){let t="",r=0;for(let[o,n]of A)o>r&&(t+=j.substring(r,o)),t+=e(j.substring(o,n)),r=n;return r<j.length&&(t+=j.substring(r)),t}var R$=":missing-slug";function gc(j,A){if(!A)return"/unknown";let e=K.dataForIdentifier(j);if(!e)return A;let t=e.properties;if(!t)return A;let r=new Set(Object.keys(t)),o=0,n=A.replace(Si,(i,s)=>{if(o++,r.has(s))return i;for(let[d,p]of Object.entries(t))if(s.toLowerCase()===(p?.title??d).toLowerCase())return`:${d}`;let l=e.annotations?.framerSlug;return l?`:${l}`:R$});if(o>0)return n;n.endsWith("/")||(n+="/");let a=e.annotations?.framerSlug;return a?n+`:${a}`:n+R$}function dF(j){if(ja(j.tree)){let A=$$(j.tree),e=new Set(j.stores.scopeStore.getWebPageNodesWithCollection().map(t=>ve(j.tree,t)).filter(_));return new Set([...A,...e])}return new Set(j.stores.scopeStore.getWebPageNodes().map(A=>ve(j.tree,A)).filter(_))}function pF(j){let A=j.split("/"),e=A[A.length-1];return e?da(e):!1}var hc=(j,A,e,t=!1)=>{j=ks(j);let r=dF(A),o=A.tree.root.homePageNodeId,n=!!e&&e.id===o;j==="/"&&!n&&(j="/page"),e?.dataIdentifier&&(j=gc(e.dataIdentifier,j));let a=j.endsWith("/")&&!n,i=j;a&&(i=j.slice(0,-1));let s=ve(A.tree,e);return r.has(j)&&(t||j!==s)&&(r.add(i),pF(i)&&(i+="/copy"),i=Nj(i,r,{withDash:!0})),{path:a?`${i}/`:i,suggestedName:go(j)}};var at=yj(Or()),I$="dismissedInstantNPMToast",F$="showedInstantNPMToast",G$="instant-npm-toast",_J=()=>window.localStorage.getItem(F$)==="true",S$=()=>window.localStorage.getItem(I$)==="true";function kF(){return(0,at.jsxs)(at.Fragment,{children:[(0,at.jsx)(kl,{children:"You installed an external NPM library."}),(0,at.jsxs)("a",{href:"https://www.framer.com/developers/#faq",target:"_blank",children:[" ",(0,at.jsx)(kl,{children:"Learn More"})]})]})}function y$(){window.localStorage.setItem(F$,"true"),vA({type:"add",variant:"info",text:(0,at.jsx)(kF,{}),key:G$,duration:1/0,action:{title:"Dismiss",onClick:()=>window.localStorage.setItem(I$,"true")}})}function DJ(){vA({type:"remove",key:G$})}function uF(j){if(j.length>=255)throw new TypeError("Alphabet too long");let A=new Uint8Array(256);for(let s=0;s<A.length;s++)A[s]=255;for(let s=0;s<j.length;s++){let l=j.charAt(s),d=l.charCodeAt(0);if(A[d]!==255)throw new TypeError(l+" is ambiguous");A[d]=s}let e=j.length,t=j.charAt(0),r=Math.log(e)/Math.log(256),o=Math.log(256)/Math.log(e);function n(s){if(s instanceof Uint8Array||(ArrayBuffer.isView(s)?s=new Uint8Array(s.buffer,s.byteOffset,s.byteLength):Array.isArray(s)&&(s=Uint8Array.from(s))),!(s instanceof Uint8Array))throw new TypeError("Expected Uint8Array");if(s.length===0)return"";let l=0,d=0,p=0,k=s.length;for(;p!==k&&s[p]===0;)p++,l++;let g=(k-p)*o+1>>>0,$=new Uint8Array(g);for(;p!==k;){let S=s[p],T=0;for(let v=g-1;(S!==0||T<d)&&v!==-1;v--,T++)S+=256*$[v]>>>0,$[v]=S%e>>>0,S=S/e>>>0;if(S!==0)throw new Error("Non-zero carry");d=T,p++}let F=g-d;for(;F!==g&&$[F]===0;)F++;let I=t.repeat(l);for(;F<g;++F)I+=j.charAt($[F]);return I}function a(s){if(typeof s!="string")throw new TypeError("Expected String");if(s.length===0)return new Uint8Array;let l=0,d=0,p=0;for(;s[l]===t;)d++,l++;let k=(s.length-l)*r+1>>>0,g=new Uint8Array(k);for(;l<s.length;){let S=s.charCodeAt(l);if(S>255)return;let T=A[S];if(T===255)return;let v=0;for(let P=k-1;(T!==0||v<p)&&P!==-1;P--,v++)T+=e*g[P]>>>0,g[P]=T%256>>>0,T=T/256>>>0;if(T!==0)throw new Error("Non-zero carry");p=v,l++}let $=k-p;for(;$!==k&&g[$]===0;)$++;let F=new Uint8Array(d+(k-$)),I=d;for(;$!==k;)F[I++]=g[$++];return F}function i(s){let l=a(s);if(l)return l;throw new Error("Non-base"+e+" character")}return{encode:n,decodeUnsafe:a,decode:i}}var b$=uF;var Rc="0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz",mF=b$(Rc),EF=8/Math.log2(62),wJ=j=>mF.encode(j).padStart(Math.ceil(j.length*EF),"0"),On=(j=20)=>Array(j).fill(0).map(()=>Rc[Math.floor(Math.random()*Rc.length)]).join("");var C$="https://app.framerstatic.com/framer_compiler_bg-UTRYLQ4Z.wasm";var st=kA("compiler");async function jH(){await Ln()}function v$(j){return{code:`const err = new Error(${JSON.stringify(String(j))}); err.name = "CompilationError"; throw err;`,sourceMap:void 0,annotations:{},exportedNames:[],reExportedModules:[],imports:{absolute:[],relative:[],bare:[]}}}function T$(j,A,e){let t={...A.exports};e&&(t.__FramerMetadata__={type:"variable"},j=j.concat(`
export const __FramerMetadata__ = `,JSON.stringify({exports:t})));let r=Object.entries(t).filter(([,n])=>n.type!=="tsType").map(([n])=>n),o={};for(let[n,a]of Object.entries(A.exports))a.annotations&&(o[n]=a.annotations);return{moduleCode:j,annotations:o,exportedNames:r}}async function P$({localId:j,name:A,source:e,includeSourceMap:t=!0}){let r=await Ln();try{let{code:o,metadata:n,map:a}=await r.transformSync(e,{fileName:Xj(A).source,framerContractVersion:1,mediaType:"tsx",minify:!1,compress:!1,mangle:!1,sourceMap:t,useReactRefresh:!0}),i=`
if (!window.$RefreshReg$) throw new Error("React refresh preamble was not loaded. Something is wrong.");
const prevRefreshReg = window.$RefreshReg$;
const prevRefreshSig = window.$RefreshSig$;
window.$RefreshReg$ = window.reactRefreshRuntime.getRefreshReg("${j}");
window.$RefreshSig$ = window.reactRefreshRuntime.createSignatureFunctionForTransform;

${o}

window.$RefreshReg$ = prevRefreshReg;
window.$RefreshSig$ = prevRefreshSig;`,{moduleCode:s,annotations:l,exportedNames:d}=T$(i,n,!0);return{code:s,sourceMap:a??void 0,imports:n.requestedModules,annotations:l,exportedNames:d,reExportedModules:n.reExportedModules}}catch(o){let n=`Failed to compile development module ${A}: ${o}`;return st.debug(n,"(enable trace logging to see full source)"),st.trace(e),j.startsWith("codeFile/")||(st.reportCriticalError(new Error(n),{moduleName:A,moduleSource:e}),fA("application_error",{message:n,area:"compiler"})),v$(o)}}async function eH(j,A){await(await Ln()).transformSync(A,{fileName:Xj(j).source,framerContractVersion:1,mediaType:"tsx",minify:!0,compress:!1,mangle:!1,sourceMap:!1,useReactRefresh:!1})}async function M$({name:j,source:A,type:e,includeSourceMap:t=!0,addFramerMetadata:r=!0,telemetrySession:o}){let n=On(10),a=`compile-${j}-${n}`,i=`\u{1F4DD} Compile ${j}`;st.debug("Compiling module",j,"; with source map:",t),En(a);let s=await Ln(),l=o?.start("transform"),d=e==="collection";try{let{code:p,map:k,metadata:g}=await s.transformSync(A,{fileName:Xj(j).source,framerContractVersion:1,mediaType:"tsx",minify:!0,compress:d,mangle:d,sourceMap:t,useReactRefresh:!1}),{moduleCode:$,annotations:F,exportedNames:I}=T$(p,g,r);return{code:$,sourceMap:k??void 0,imports:g.requestedModules,annotations:F,exportedNames:I,reExportedModules:g.reExportedModules}}catch(p){let k=`Failed to compile module ${j}: ${p}`;return st.debug(k,"(enable trace logging to see full source)"),st.trace(A),j.startsWith("codeFile/")||(st.reportCriticalError(new Error(k),{moduleName:j,moduleSource:A}),fA("application_error",{message:k,area:"compiler"})),v$(p)}finally{l?.end(),D$(i,a)}}async function _$(j){let e=`analyze-imports-${On(10)}`,t="\u{1F575}\u{1F3FB} Analyze Imports";En(e);try{return{ok:!0,value:await(await Ln()).analyzeImports(j)}}catch(r){return st.warn("Failed to analyze imports:",r),r instanceof Error?{ok:!1,error:r}:{ok:!1,error:new Error(`${r}`)}}finally{D$(t,e)}}var us;async function Ln(){if(!us){let j=new Worker(_k("./modulesCompilerWorker.js")),A=Pk(j);us=A.initWithPathToWasm(C$).then(()=>({transformSync:A.transformSync,analyzeImports:A.analyzeImports})),us.catch(()=>{if($m()||!Nd.isProduction)throw new Error(`\u274C Your dev setup is struggling to run the compiler\u2019s WASM binary.
To fix it, run "make clean" followed by "make dev".`)})}return us}function D$(j,A){Ga(j,A),performance.getEntriesByName(j,"measure").forEach(({name:e,duration:t})=>{st.debug(e,"took",t.toFixed(2),"ms"),Gm(e)}),Sa(A)}function N$(j,A){if(!X(j))return;let e=j.getSupportedLayout(K),t=j.getCurrentVariantSize(K);Ws(e.width)&&t?.widthType!==0&&(A.widthType=2,A.left!==null&&A.right!==null&&(A.right=null)),Ws(e.height)&&t?.heightType!==0&&(A.heightType=2,A.top!==null&&A.bottom!==null&&(A.bottom=null))}function x$(j,A,e=!0){j.processWhenReady(()=>{let{overlayStore:t,selectionStore:r,scopeStore:o,canvasStore:n,persistedUserDefaults:a}=j.stores;o.selectByNode(A.id),r.set(A.id);let i=j.tree.get(A.cache.overlayAncestorId);if(Qj(i)?t.showOverlay(r,i,i.parentid):t.hideAll(),e){let s=j.tree.getBoundingFrameForNodes([A]);n.zoomToCenter(s,{animated:a.animateOnZoom,maxZoom:1})}})}var Sr=class extends Error{constructor(e,t,r,o=!1){super(e);this.missing=t;this.error=r;this.wasTimeout=o}};function cH(j){return j instanceof Sr}var Ic=kA("ensureComponentsInLoader"),$F=500,BF=30*1e3;async function ms(j,A,e,t){let r=O$(A,j).length;if(r===0)return;let o=t??BF+r*2e3;Ic.debug("modules:",A.length,", new:",r,", timeout:",o),await gF(j,e,o);let n=O$(A,j);if(n.length===0)return;let a=hF(A,j);throw Ic.debug("components loaded, but some are missing",{missing:n,errors:a}),new Sr("ensureComponentsInLoader: Some modules are missing.",n,a)}async function gF(j,A,e){let t=performance.now(),r=await RF(async()=>(await Vs(e),"timeout"),async()=>{await A.whenIdle();let o=A.revision;return E(o>=0,"moduleStore.revision cannot be negative"),await A.loadAllLocalModules(),o});if(r==="timeout")throw new Sr("ensureComponentsInLoader: Modules store not ready in time.",[],[],!0);for(let o=0;o<1e3;o++){let n=j.modulesRevision;if(r<=n)break;if(performance.now()-t>e)throw Ic.debug("component loader not updated in time: want:",r,"got:",n),new Sr("ensureComponentsInLoader: Component loader not updated in time.",[],[],!0);await Vs($F)}}function O$(j,A){let e=new Set;for(let t of j)A.componentForIdentifier(t)||e.add(t);return Array.from(e)}function hF(j,A){let e=new Set;for(let t of j)Cj(A.errorForIdentifier(t))||e.add(t);return Array.from(e)}async function RF(...j){return Promise.race(j.map(async A=>A()))}async function w$(j,A){let e=[];j.forEach(t=>{let r=AA(t);r&&r.kind==="externalModuleExport"&&e.push(r)}),e.length&&await A.preloadExternalModules(e),await ms(K,j,A)}function Es(j,A,e,t,r){if(cA(e.htmlContent))return;let o=j.getScopeNodeFor(A);E(o&&Ur(o),"Can't find scope with breakpoints");let a=o.getTopLevelVariants().map(i=>{let s=aj(i)?e.id:ne(i.id,e.id),l=j.get(s);return E(l&&JA(l),"Can't find rich text node in breakpoint"),[i,l]});for(let[i,s]of a){E(zA(i),"Can't read width attribute of node");let l=Ba(t,d=>(d.breakpointWidth??0)>i.width)??r;s.detachTextStylePreset(l,!0)}}var Fc=["formButtonSuccessVariant","formButtonPendingVariant","formButtonErrorVariant","formButtonIncompleteVariant","whileOpenEffectVariant","appearEffectVisibleVariantId","appearEffectObscuredVariantId","dataLoaderLoadingVariant","dataLoaderDisabledVariant"];function L$(j,A,e){let t=A.tokenOverrides;!t||$e(t)||(q$(j,e,t),A.set({tokenOverrides:void 0}))}function q$(j,A,e){IF(j,A.id,e);let t=[];for(let r of A.variables){if(!V$(r)){t.push(r);continue}switch(r.type){case"border":t.push(tr(r.initialValue)?{...r,initialValue:{...r.initialValue,borderColor:yr(r.initialValue.borderColor,e)}}:r);break;case"color":t.push({...r,initialValue:yr(r.initialValue,e)});break;default:lA(r,"Unsupported variable type.")}}A.set({variables:t})}function IF(j,A,e){let t=j.tree.get(A);if(t)for(let{node:r,skipChildren:o}of t.walkWithSkipChildren()){if(gA(r)){o();continue}if(K$(r,e),FF(j,r,e),!X(r)||r.isVectorInstance)continue;let n=r.getLocalSmartComponentNodeId();if(!n){r.set({tokenOverrides:e});continue}let a=j.tree.get(n);tA(a)&&a.isLoaded()&&(q$(j,a,e),j.codeGenerationStore.updateComponent(a.id))}}function FF(j,A,e){let t=It(j.tree,A);for(let r of t){let{relatedNode:o,replicaRoot:n}=r;n.replicaInfo.overrides[A.id]&&K$(o,e)}}function K$(j,A){if(Ce(j)){let e=yr(j.fillColor,A);e&&j.set({fillColor:e})}if(At(j)){let e=yr(j.borderColor,A);e&&j.set({borderColor:e})}if(se(j)){let e=yr(j.strokeColor,A);e&&j.set({strokeColor:e})}if(JA(j)){let e=new Map;for(let t in A){if(!m6(t))continue;let r=A[t],o=ep(t);o&&e.set(o,`var(${t}, ${r})`)}j.replaceColorTokenVariables(e)}else if(X(j)){let e=K.componentForIdentifier(j.codeComponentIdentifier);if(!e)return;let t=j.getControlProps(e.properties);if(!t)return;for(let r in t){let o=t[r];if(!(!o||!V$(o)))switch(o.type){case"border":if(!tr(o.value))break;j.setControlProp(r,{...o,value:{...o.value,borderColor:yr(o.value.borderColor,A)}});break;case"color":j.setControlProp(r,{...o,value:yr(o.value,A)});break;default:lA(o,"Unsupported control type.")}}}}function yr(j,A){if(Cj(j)||!He(j))return j;let e=jp(j);if(!m6(e))return j;let t=A[e];return t?`var(${e}, ${t})`:j}function V$(j){switch(j.type){case"color":case"border":return!0;case"array":case"boolean":case"number":case"string":case"richtext":case"eventhandler":case"image":case"file":case"scrollsectionref":case"customcursor":case"cursor":case"transition":case"boxshadow":case"gap":case"padding":case"borderradius":case"collectionreference":case"multicollectionreference":case"trackingid":case"vectorsetitem":case"date":case"enum":case"link":case"linkrelvalues":case"fusednumber":case"object":case"font":case"pagescope":case"slot":case"slug":case"controlReference":case"nodePropertyControlReference":return!1;default:lA(j,"Check if we support this variable type.")}}function J$(j){if(!V(j))return!1;for(let A of j.children)if(!RA(A)||CA(A)&&A.children.length>0)return!1;return!0}function H$(j,A,e){if(Kj(e))return;let t;j.stores.scopeStore.removeNode(A);let r=rr(j.tree,e.id);r&&j.tree.removeNode(r);let o=j.tree.root.homePageNodeId,n=rr(j.tree,A.id);n&&(A.id===o?j.tree.removeNode(n):n.set({webPageId:e.id})),j.tree.current(e)?.set({name:A.name,pagePath:A.pagePath}),j.tree.has(o)||(t??={},t.homePageNodeId=e.id),t&&j.tree.root.set(t)}function qn(j,A){return j.filter(e=>e.originalid===A.id).sort((e,t)=>(t.breakpointWidth??0)-(e.breakpointWidth??0))}function j5(j,A){let e=j.getPresetsListNode();E(e,"Can't find PresetsListNode");let t=e.children.filter(ut);return qn(t,A)}function G5(j,A,e){if(!JA(e))return;let t=e.getStylePresetsForCodeGeneration(j);for(let r of t){let o=j.getNodes(r.cache.replicaInstances??[]);for(let n of o)A[n.id]??=n.toJS();A[r.id]??=r.toJS()}}function Gc(j,A,e){for(let t of A){let r=j[t];if(!r)continue;let o=e(r);o&&o.id!==r&&j.set({[t]:o.id})}}function U$({engine:j,node:A,pastedPresetMap:e,stylePresetNodes:t,fromSameProject:r,breakpointVariantIds:o,shouldCreateNewPresets:n}){if(!t)return;let a={pastedPresetMap:e,stylePresetNodes:t,shouldCreateNewPresets:n},i=d=>GF(j,d,a);if(Gc(A,Lu,i),A.remapTextStylePresets(i),r)return;let s=Oo(A),l=j.tree.getGroundNodeFor(A);for(let d of A.getStylePresetIdsForCodeGeneration()){let p=t.find(g=>g.id===d);if(!p||!Jr(p))continue;let k=qn(t,p);if(s){Es(j.tree,s,A,k,p);continue}if(o?.has(l.id)&&zA(l)){let g=Ba(k,$=>($.breakpointWidth??0)>l.width)??p;A.detachTextStylePreset(g,!1);continue}A.detachTextStylePreset(p,!1)}}function GF(j,A,{pastedPresetMap:e,stylePresetNodes:t,shouldCreateNewPresets:r}){if(!t)return;let o=t.find(p=>p.id===A);if(!o)return;let n=j.tree.get(A);if(n&&Jr(n)&&n.equals(o))return e.set(A,n),n;if(!r)return;let i=mr(j.tree),s=i.getTextStylePresets().find(p=>p.equals(o));if(s&&Jr(s))return e.set(A,s),s;let l=n?o.clone():o.cloneWithIds();j.tree.insertNode(l,i.id),e.set(A,l);let d=t.filter(p=>p.originalid===A);for(let p of d){let k=j.tree.get(A);if(k&&v7(k)&&k.equals(p)){e.set(A,k);continue}let $=k?p.clone():p.cloneWithIds();j.tree.insertNode($,i.id),e.set(A,$)}return l}function W$({engine:j,node:A,pastedPresetMap:e,stylePresetNodes:t}){if(!t)return;let r={pastedPresetMap:e,stylePresetNodes:t},o=n=>SF(j,n,r);Gc(A,Ku,o),A.remapLinkStylePresets(o)}function SF(j,A,{pastedPresetMap:e,stylePresetNodes:t}){if(!t)return;let r=t.find(l=>l.id===A);if(!r||!mt(r))return;let o=j.tree.get(A);if(o&&mt(o)&&o.equals(r))return e.set(A,o),o;let a=mr(j.tree),i=a.getLinkStylePresets().find(l=>l.equals(r));if(i&&mt(i))return e.set(A,i),i;let s=o?r.clone():r.cloneWithIds();return j.tree.insertNode(s,a.id),e.set(A,s),s}function z$({engine:j,node:A,pastedPresetMap:e,stylePresetNodes:t}){if(!t)return;let r={pastedPresetMap:e,stylePresetNodes:t},o=n=>yF(j,n,r);Gc(A,Vu,o),A.remapInlineCodeStylePresets(o)}function yF(j,A,{pastedPresetMap:e,stylePresetNodes:t}){if(!t)return;let r=t.find(l=>l.id===A);if(!r||!Et(r))return;let o=j.tree.get(A);if(o&&Et(o)&&o.equals(r))return e.set(A,o),o;let a=mr(j.tree),i=a.getInlineCodeStylePresets().find(l=>l.equals(r));if(i&&Et(i))return e.set(A,i),i;let s=o?r.clone():r.cloneWithIds();return j.tree.insertNode(s,a.id),e.set(A,s),s}function S5(j){if(V(j))return{id:j.id,pagePath:j.pagePath,webMetadata:j.webMetadata,customHTML:j.customHTML,dataIdentifier:j.dataIdentifier}}function y5(j,A,e,t){let r={},o=new Set;function n(a){ns(a,i=>{if(t.has(i))return;let s=bF(j,i);s&&(r[i]=s);let l=eu(i,j.tree,j.stores.modulesStore,o);l&&Object.assign(r,l)})}for(let a of A.walk())n(a);return V(e)&&n(e),{moduleData:r}}function bF(j,A){let e=AA(A);if(e&&e.kind==="localModuleExport"){let t=j.stores.modulesStore.getPersistedModuleByLocalId(e.localId);return t?(E(t.files.module,"expected module typed file in persisted module"),ee(t.id,t.saveId,t.files.module,e.exportSpecifier)):void 0}if(e&&e.kind==="externalModuleExport")return e}function CF(j,A,e){let t=AA(A);if(KA(t))return E(j.stores.modulesStore.initialized,"Cannot paste modules before modulesStore has been initialized."),j.stores.modulesStore.getPersistedModuleByLocalId(t.localId)?.id===e.moduleId?null:e.value;if(ce(t)&&t.kind==="externalModuleExport"){let r=j.stores.modulesStore.getPersistedModuleByGlobalId(t.moduleId)?.localId;return r?Nr(t,r).value:null}return null}function vF(j,A,e,t,r){let o=t.cloneWithIds();o.set(r),j.removeNode(t),j.insertNode(o,A,e)}function b5(j,A,e){if(!e)return A;for(let t of A.root.walk())CA(t)&&t.children.forEach((r,o)=>{if(e){let n=is(r,i=>{let s=e[i];if(!s)return;let l=CF(j,i,s);return l||void 0});if(!n)return;let a=A.current(r);if(!a)return;vF(A,t.id,o,a,n)}});return A.commit()}function TF(j){return jj(j)&&zA(j)}function C5(j,A,e){let t=j.get(e.id);if(!t)return;let r=Oo(t);if(!r||!RA(r))return;let o=j.getNodes(r.cache.replicaInstances??[]).filter(TF);for(let{width:n,replicaInfo:a}of o){let i=A.get(n)??{},s=a.overrides[e.id];s&&(i[e.id]=s),A.set(n,i)}zA(r)&&!A.get(r.width)&&A.set(r.width,{})}function Ro(j,A,e,t){if(He(A)){let r=Ki(A),o=j.get(r);if(o&&!(o.id in e)){let n=o.cloneWithIds();e[n.id]=n.toJS(),t&&(t[o.id]=gt())}}else if(H7(A))Ro(j,A.color,e,t);else if(kk(A)||pk(A)||mk(A))for(let r of A.stops)Ro(j,r.value,e,t);else if(Aj(A))for(let r of A)Ro(j,r,e,t);else tr(A)&&Ro(j,A.borderColor,e,t)}function v5(j,A,e,t){if(JA(A)){let r=A.getInlineStyleTokenVariables();Ro(j,r,e,t)}for(let r in A)Ro(j,A[r],e,t)}function T5(j,A,e){let t=e-A;return Math.ceil(j/100*t+A)}function Q$({collectedCollections:j,node:A,tree:e}){if(Kj(A)){let t=AA(A.dataIdentifier);if(!KA(t))return;let r=e.getNodeWithTrait(t.localIdName,tj);r&&(j.set(A.dataIdentifier,r),Q$({collectedCollections:j,node:r,tree:e}))}if(tj(A))for(let t of A.variables){if(!Aa(t))continue;let r=AA(t.dataIdentifier);if(!KA(r))continue;let o=e.getNodeWithTrait(r.localIdName,tj);o&&(j.has(t.dataIdentifier)||(j.set(t.dataIdentifier,o),Q$({collectedCollections:j,node:o,tree:e})))}}function O5(j){return dj(j)?j.getGroundNodes().length===0:!1}function w5(j){if(!V(j))return!1;let A=j.getGroundNodes();return A.length>1?!1:A.length===0?!0:A[0]?.children?.length===0}function L5(j){return j?!j.children||j.children.length===0:!1}function q5(j,A){let e=j.get(A);if(!ft(e))return!1;for(let t of e.walk())if(ft(t)&&t.webPageId)return!0;return!1}function Sc(j,A=!0){let e=j.trim().split("/").filter(Boolean).map(t=>{let r="/"+t,o=ks(r);return o.startsWith("/")?o.slice(1):o});return j.endsWith("/")&&A&&e.push(""),e}function K5(j){return`/${Sc(j).join("/")}`}function PF(j){return j===""}function V5(j){return!!(j.webPageId&&PF(j.segment))}function MF(j,A){let e=A.get(j);if(!ft(e))return;let t=A.get(e.webPageId);if(V(t)||e.children.length>0)return;let r=e.parentid;A.removeNode(e),r&&MF(r,A)}function J5(j,A){if(!j)return;let e=K.dataForIdentifier(j);if(e)return Uk(void 0,e,A??vp)}function X$(j,A,e,t,r){let o=Sc(t,V(A,!0));E(o.length>0,"Path must have at least one segment");let n=Zr(j.tree,{shouldAssert:!0});return o.forEach((a,i)=>{let s=i===o.length-1,l=s?r?.positionInParent:void 0,d=da(a)?e:void 0;d&&(a=gc(d,a));let p=n.children.find(g=>g.segment===a),k=p&&s&&A;if(!p||k&&p.webPageId){let g=new em({segment:a,webPageId:s?A?.id:void 0,dataIdentifier:d});j.tree.insertNode(g,n.id,l),n=g}else k&&p.set({webPageId:A.id,dataIdentifier:d}),n=p}),E(ft(n),"Current parent should be the created RouteSegmentNode"),n}function Y$(j,A){let e=rr(j,A);return j.get(e?.parentid)?.children.findIndex(r=>r.id===e?.id)}function _F(j,A,e){let t=new Set(j.stores.scopeStore.getSmartComponentNodes().map(r=>r.name).filter(_));return e||A===null?Nj(e??"Component",t):Nj(A,t)}function yc(j,A,e,t,{insertionIndex:r,preferredName:o,enterIsolation:n=!0,localIdsToExternalIdentifiers:a=new Map,externalModuleIdsToLocalIds:i=new Map,instance:s,renamedIds:l=new Map,isAutoDetach:d=!1,intrinsicSize:p,textStylePresets:k,linkStylePresets:g,inlineCodeStylePresets:$,pastedPresetMap:F=new Map,fromInsertSidebar:I=!1,abTesting:S=!1}={}){let T=d?Ra.createEmpty():j.tree,v={children:[]};if(V(A)){let D=A.id===j.tree.root.homePageNodeId?"Home":ve(j.tree,A),{suggestedName:J,path:H}=hc(o??D??"Page",j,A,!0);v.pagePath=H,v.name=J}else v.name=_F(j,A.name,o);let P=A.clone(v);l.set(A.id,P.id),tA(A)&&Hm({componentId:P.id,source:t});let N=P.instanceIdentifier,Q=RA(e),w=Mn(e,a,i,l,Q),iA=[w];P.baseVariantId=w.id,P.addChild(w);for(let D of A.children)if(!(D.id===e.id||Qr(D)))if(jj(D)&&MA(D)){let J=Bo(D.replicaInfo.overrides,l,!0);if(EA(D)){J[w.id]??={};let Z=J[w.id];Z.top=D.top,Z.left=D.left,Z.right=D.right,Z.bottom=D.bottom,Z.centerAnchorX=D.centerAnchorX,Z.centerAnchorY=D.centerAnchorY}let H=dA.create(j.tree,w,{overrides:J,duplicatedFrom:Xo(D)});l.set(D.id,H.id),iA.push(H),P.addChild(H)}else{let J=Mn(D,a,i,void 0,Q);iA.push(J),l.set(D.id,J.id),P.addChild(J)}T.insertNode(P,void 0,r);for(let D=0;D<A.children.length;D++){let J=A.children[D];if(!Qr(J))continue;let H=dA.create(T,w,{overrides:Bo(J.replicaInfo.overrides,l,!0),inheritsFrom:l.get(J.replicaInfo.inheritsFrom),duplicatedFrom:Xo(J)});l.set(J.id,H.id),iA.push(H),T.insertNode(H,P.id,D)}let z=ps(T);for(let D of iA){if(it(T,D,l,!1),!k&&!g&&!$)continue;let J=[];for(let H of D.walk())JA(H)&&J.push(H);for(let H of J){let Z=H.getStylePresetIdsForCodeGeneration();if(g&&W$({engine:j,node:H,pastedPresetMap:F,stylePresetNodes:g}),$&&z$({engine:j,node:H,pastedPresetMap:F,stylePresetNodes:$}),k){if(I)U$({engine:j,node:H,pastedPresetMap:F,stylePresetNodes:k,fromSameProject:!0,shouldCreateNewPresets:I});else for(let sA of k)if(Z.has(sA.id))if(V(A)&&RA(D)){if(qj(D)){let NA=qn(k,sA);Es(T,w,H,NA,sA)}}else(qj(D)||Ee(T,H,"html"))&&H.detachTextStylePreset(sA,!1)}}for(let H of J){Ee(T,H,"html")&&(H.remapTextStylePresets((Z,sA)=>{let NA=gk(sA)?sA:"p",kj=H.getNodeTextStylePreset(T,NA)??ga(T,NA)??Ik.createDefault(NA);return Zu(j,kj),kj}),H.remapLinkStylePresets(()=>{let Z=H.getNodeLinkStylePreset(T)??Xu(T)??Ou.createDefault();return Yu(j,Z),Z}),H.remapInlineCodeStylePresets(()=>{let Z=H.getNodeInlineCodeStylePreset(T)??Wu(T)??new vu;return zu(j,Z),Z}));for(let Z in z)Ee(T,H,Z)&&H.set({[Z]:z[Z]})}}for(let D of F.values())gA(D)||j.codeGenerationStore.createModuleFromComponentSource(D).catch(SA);if(d)return T.commit(),P.draftOrCurrent();{let D=T.get(P.baseVariantId);if(D&&aj(D))for(let J of P.children)Wo(J)&&J.replicaInfo.master===D.id&&dA.registerInInheritedNode(D,J)}j.process(()=>{if(!s)return;let D=j.tree.current(s);if(!D)return;let J={},H={},Z=s.getRawControlProps();if(Z.variant?.value&&_(Z.variant.value)){let sA=l.get(Z.variant.value)??w.id,NA={type:"enum",value:sA};J.variant=NA}for(let sA of Fc){let NA=s[sA];_(NA)&&(H[sA]=l.get(NA)??void 0)}It(j.tree,D).forEach(({relatedNode:sA,replicaRoot:NA})=>{let kj=NA.replicaInfo.overrides[sA.originalid];if(!kj)return;let ZA={};for(let Oj of Fc){if(!(Oj in kj))continue;let le=kj[Oj];_(le)&&(H[Oj]=l.get(le)??void 0)}if(sA.set(ZA),!(VA("variant")in kj))return;let uj=sA.getRawControlProp("variant");if(!uj||!_(uj.value))return;let lj=l.get(uj.value);if(!lj)return;let Mj={type:"enum",value:lj};sA.set(Hr({variant:Mj}))}),D.set({codeComponentIdentifier:N,...H,...Hr(J)})});let pA=j.codeGenerationStore.createModuleFromComponentSource(P,p);if(s&&pA.then(j.wrapHandler(()=>{if(s=j.tree.get(s?.id),!s)return;let D=j.stores.treeStore.tree.getScopeNodeFor(s)?.loaded;if(!D||!Zt(D))return;let J=j.stores.treeStore.tree.get(D.baseVariantId);J&&aj(J)&&j.codeGenerationStore.updateComponent(D.id).catch(SA)})).catch(SA),n&&(j.stores.chromeStore.contentPanelTab="Layers",j.stores.scopeStore.select(P.id,{keepHistory:!0})),ja(j.tree)&&V(P)&&!S){E(_(v.pagePath),"pagePath should be a string");let D=Y$(j.tree,A.id),J=Y(D)?D+1:void 0;X$(j,P,P.dataIdentifier,v.pagePath,{positionInParent:J})}return P.draftOrCurrent()}async function Z$(j,{identifier:A,enterIsolation:e,instance:t,isAutoDetach:r,renamedIds:o=new Map,info:n}){let{node:a,dependencies:i}=await Pf(j,A);E(Oa(a),"Should be a generated node.");let s=j.tree.get(t?.originalid??t?.id);E(!s||X(s),"instance should be a code component.");let l=a.children.find(I=>I.id===a.baseVariantId);E(l&&aj(l),"Unlink: Can't unlink a tree which doesn't have a Primary Variant node");let{identifiers:d,localIdsToExternalIdentifiers:p,externalModuleIdsToLocalIds:k}=vf(a,j.stores.modulesStore,i);if(await w$(d.map(I=>I.value),j.stores.modulesStore),d.some(I=>{let S=K.dataForIdentifier(I.value);return S?rk(S):!1})){vA({type:"add",variant:"info",text:"Remove collection references before unlinking"});return}let $=await Cf(i.imports);return await Mf(j,i,A),await j.stores.modulesStore.addExternalModulesToProject(d,{onTreeUpdate:()=>{let I=j.tree.current(s),S=Ue(n.module.metadata.intrinsicWidth)??200,T=Ue(n.module.metadata.intrinsicHeight)??200,v=yc(j,a,l,"unlink",{enterIsolation:e,localIdsToExternalIdentifiers:p,externalModuleIdsToLocalIds:k,instance:I,renamedIds:o,isAutoDetach:r,intrinsicSize:{width:S,height:T},textStylePresets:$});return I&&tA(v)&&L$(j,I,v),v}})}async function AB(j,A){let e=await Z$(j,A);if(!e)return;E(tA(e),"node should be a smart component");let{isAutoDetach:t}=A;return t||await j.codeGenerationStore.untilCompiled(e.id),e.draftOrCurrent()}async function jB(j,A){let[e]=await j.stores.modulesStore.preloadExternalModules([A]);if(!e)return;let t=await Z$(j,{identifier:A,enterIsolation:!1,info:e});E(V(t),"node should be a web page");let{path:r,suggestedName:o}=hc(t.name??"Page",j,t,!0);return j.processWhenReady(()=>{j.tree.current(t)?.set({name:o,pagePath:r});let n=j.stores.scopeStore.active;J$(n)&&H$(j,n,t),j.stores.scopeStore.select(t.id,{keepHistory:!1})}),t}function eB(j,A,e,t){let r=yc(j,A,e,"duplicate",{enterIsolation:!1,preferredName:t,insertionIndex:j.tree.root.children.findIndex(o=>o.id===A.id)+1});j.stores.persistedUserDefaults.newContentAsDraft&&r.set({isDraft:!0,duplicatedFrom:Ji(r.duplicatedFrom,A.id)}),j.stores.scopeStore.select(r.id,{keepHistory:!1})}function tB(j,A){let[e,...t]=A.selection.ids;if(!e||t.length)return null;let r=A.tree,o=r.getNode(e),n=!1;for(;!n&&o&&(n=Gt(r,o,j,A.stores.scopeStore.active.id,K),!n);)o=r.getParent(o.id);return o}var Nt=".tsx";var DF=["arguments","await","break","case","catch","class","const","continue","debugger","default","delete","do","else","enum","eval","export","extends","false","finally","for","function","if","implements","import","in","instanceof","interface","let","new","null","package","private","protected","public","return","static","super","switch","this","throw","true","try","typeof","var","void","while","with","yield","Infinity","NaN","document","undefined","window"],NF=["toolbar"],xF=/^[$A-Z_a-z\xAA\xB5\xBA\xC0-\xD6\xD8-\xF6\xF8-\u02C1\u02C6-\u02D1\u02E0-\u02E4\u02EC\u02EE\u0370-\u0374\u0376\u0377\u037A-\u037D\u037F\u0386\u0388-\u038A\u038C\u038E-\u03A1\u03A3-\u03F5\u03F7-\u0481\u048A-\u052F\u0531-\u0556\u0559\u0560-\u0588\u05D0-\u05EA\u05EF-\u05F2\u0620-\u064A\u066E\u066F\u0671-\u06D3\u06D5\u06E5\u06E6\u06EE\u06EF\u06FA-\u06FC\u06FF\u0710\u0712-\u072F\u074D-\u07A5\u07B1\u07CA-\u07EA\u07F4\u07F5\u07FA\u0800-\u0815\u081A\u0824\u0828\u0840-\u0858\u0860-\u086A\u08A0-\u08B4\u08B6-\u08BD\u0904-\u0939\u093D\u0950\u0958-\u0961\u0971-\u0980\u0985-\u098C\u098F\u0990\u0993-\u09A8\u09AA-\u09B0\u09B2\u09B6-\u09B9\u09BD\u09CE\u09DC\u09DD\u09DF-\u09E1\u09F0\u09F1\u09FC\u0A05-\u0A0A\u0A0F\u0A10\u0A13-\u0A28\u0A2A-\u0A30\u0A32\u0A33\u0A35\u0A36\u0A38\u0A39\u0A59-\u0A5C\u0A5E\u0A72-\u0A74\u0A85-\u0A8D\u0A8F-\u0A91\u0A93-\u0AA8\u0AAA-\u0AB0\u0AB2\u0AB3\u0AB5-\u0AB9\u0ABD\u0AD0\u0AE0\u0AE1\u0AF9\u0B05-\u0B0C\u0B0F\u0B10\u0B13-\u0B28\u0B2A-\u0B30\u0B32\u0B33\u0B35-\u0B39\u0B3D\u0B5C\u0B5D\u0B5F-\u0B61\u0B71\u0B83\u0B85-\u0B8A\u0B8E-\u0B90\u0B92-\u0B95\u0B99\u0B9A\u0B9C\u0B9E\u0B9F\u0BA3\u0BA4\u0BA8-\u0BAA\u0BAE-\u0BB9\u0BD0\u0C05-\u0C0C\u0C0E-\u0C10\u0C12-\u0C28\u0C2A-\u0C39\u0C3D\u0C58-\u0C5A\u0C60\u0C61\u0C80\u0C85-\u0C8C\u0C8E-\u0C90\u0C92-\u0CA8\u0CAA-\u0CB3\u0CB5-\u0CB9\u0CBD\u0CDE\u0CE0\u0CE1\u0CF1\u0CF2\u0D05-\u0D0C\u0D0E-\u0D10\u0D12-\u0D3A\u0D3D\u0D4E\u0D54-\u0D56\u0D5F-\u0D61\u0D7A-\u0D7F\u0D85-\u0D96\u0D9A-\u0DB1\u0DB3-\u0DBB\u0DBD\u0DC0-\u0DC6\u0E01-\u0E30\u0E32\u0E33\u0E40-\u0E46\u0E81\u0E82\u0E84\u0E86-\u0E8A\u0E8C-\u0EA3\u0EA5\u0EA7-\u0EB0\u0EB2\u0EB3\u0EBD\u0EC0-\u0EC4\u0EC6\u0EDC-\u0EDF\u0F00\u0F40-\u0F47\u0F49-\u0F6C\u0F88-\u0F8C\u1000-\u102A\u103F\u1050-\u1055\u105A-\u105D\u1061\u1065\u1066\u106E-\u1070\u1075-\u1081\u108E\u10A0-\u10C5\u10C7\u10CD\u10D0-\u10FA\u10FC-\u1248\u124A-\u124D\u1250-\u1256\u1258\u125A-\u125D\u1260-\u1288\u128A-\u128D\u1290-\u12B0\u12B2-\u12B5\u12B8-\u12BE\u12C0\u12C2-\u12C5\u12C8-\u12D6\u12D8-\u1310\u1312-\u1315\u1318-\u135A\u1380-\u138F\u13A0-\u13F5\u13F8-\u13FD\u1401-\u166C\u166F-\u167F\u1681-\u169A\u16A0-\u16EA\u16EE-\u16F8\u1700-\u170C\u170E-\u1711\u1720-\u1731\u1740-\u1751\u1760-\u176C\u176E-\u1770\u1780-\u17B3\u17D7\u17DC\u1820-\u1878\u1880-\u1884\u1887-\u18A8\u18AA\u18B0-\u18F5\u1900-\u191E\u1950-\u196D\u1970-\u1974\u1980-\u19AB\u19B0-\u19C9\u1A00-\u1A16\u1A20-\u1A54\u1AA7\u1B05-\u1B33\u1B45-\u1B4B\u1B83-\u1BA0\u1BAE\u1BAF\u1BBA-\u1BE5\u1C00-\u1C23\u1C4D-\u1C4F\u1C5A-\u1C7D\u1C80-\u1C88\u1C90-\u1CBA\u1CBD-\u1CBF\u1CE9-\u1CEC\u1CEE-\u1CF3\u1CF5\u1CF6\u1CFA\u1D00-\u1DBF\u1E00-\u1F15\u1F18-\u1F1D\u1F20-\u1F45\u1F48-\u1F4D\u1F50-\u1F57\u1F59\u1F5B\u1F5D\u1F5F-\u1F7D\u1F80-\u1FB4\u1FB6-\u1FBC\u1FBE\u1FC2-\u1FC4\u1FC6-\u1FCC\u1FD0-\u1FD3\u1FD6-\u1FDB\u1FE0-\u1FEC\u1FF2-\u1FF4\u1FF6-\u1FFC\u2071\u207F\u2090-\u209C\u2102\u2107\u210A-\u2113\u2115\u2119-\u211D\u2124\u2126\u2128\u212A-\u212D\u212F-\u2139\u213C-\u213F\u2145-\u2149\u214E\u2160-\u2188\u2C00-\u2C2E\u2C30-\u2C5E\u2C60-\u2CE4\u2CEB-\u2CEE\u2CF2\u2CF3\u2D00-\u2D25\u2D27\u2D2D\u2D30-\u2D67\u2D6F\u2D80-\u2D96\u2DA0-\u2DA6\u2DA8-\u2DAE\u2DB0-\u2DB6\u2DB8-\u2DBE\u2DC0-\u2DC6\u2DC8-\u2DCE\u2DD0-\u2DD6\u2DD8-\u2DDE\u2E2F\u3005-\u3007\u3021-\u3029\u3031-\u3035\u3038-\u303C\u3041-\u3096\u309D-\u309F\u30A1-\u30FA\u30FC-\u30FF\u3105-\u312F\u3131-\u318E\u31A0-\u31BA\u31F0-\u31FF\u3400-\u4DB5\u4E00-\u9FEF\uA000-\uA48C\uA4D0-\uA4FD\uA500-\uA60C\uA610-\uA61F\uA62A\uA62B\uA640-\uA66E\uA67F-\uA69D\uA6A0-\uA6EF\uA717-\uA71F\uA722-\uA788\uA78B-\uA7BF\uA7C2-\uA7C6\uA7F7-\uA801\uA803-\uA805\uA807-\uA80A\uA80C-\uA822\uA840-\uA873\uA882-\uA8B3\uA8F2-\uA8F7\uA8FB\uA8FD\uA8FE\uA90A-\uA925\uA930-\uA946\uA960-\uA97C\uA984-\uA9B2\uA9CF\uA9E0-\uA9E4\uA9E6-\uA9EF\uA9FA-\uA9FE\uAA00-\uAA28\uAA40-\uAA42\uAA44-\uAA4B\uAA60-\uAA76\uAA7A\uAA7E-\uAAAF\uAAB1\uAAB5\uAAB6\uAAB9-\uAABD\uAAC0\uAAC2\uAADB-\uAADD\uAAE0-\uAAEA\uAAF2-\uAAF4\uAB01-\uAB06\uAB09-\uAB0E\uAB11-\uAB16\uAB20-\uAB26\uAB28-\uAB2E\uAB30-\uAB5A\uAB5C-\uAB67\uAB70-\uABE2\uAC00-\uD7A3\uD7B0-\uD7C6\uD7CB-\uD7FB\uF900-\uFA6D\uFA70-\uFAD9\uFB00-\uFB06\uFB13-\uFB17\uFB1D\uFB1F-\uFB28\uFB2A-\uFB36\uFB38-\uFB3C\uFB3E\uFB40\uFB41\uFB43\uFB44\uFB46-\uFBB1\uFBD3-\uFD3D\uFD50-\uFD8F\uFD92-\uFDC7\uFDF0-\uFDFB\uFE70-\uFE74\uFE76-\uFEFC\uFF21-\uFF3A\uFF41-\uFF5A\uFF66-\uFFBE\uFFC2-\uFFC7\uFFCA-\uFFCF\uFFD2-\uFFD7\uFFDA-\uFFDC\u{10000}-\u{1000B}\u{1000D}-\u{10026}\u{10028}-\u{1003A}\u{1003C}\u{1003D}\u{1003F}-\u{1004D}\u{10050}-\u{1005D}\u{10080}-\u{100FA}\u{10140}-\u{10174}\u{10280}-\u{1029C}\u{102A0}-\u{102D0}\u{10300}-\u{1031F}\u{1032D}-\u{1034A}\u{10350}-\u{10375}\u{10380}-\u{1039D}\u{103A0}-\u{103C3}\u{103C8}-\u{103CF}\u{103D1}-\u{103D5}\u{10400}-\u{1049D}\u{104B0}-\u{104D3}\u{104D8}-\u{104FB}\u{10500}-\u{10527}\u{10530}-\u{10563}\u{10600}-\u{10736}\u{10740}-\u{10755}\u{10760}-\u{10767}\u{10800}-\u{10805}\u{10808}\u{1080A}-\u{10835}\u{10837}\u{10838}\u{1083C}\u{1083F}-\u{10855}\u{10860}-\u{10876}\u{10880}-\u{1089E}\u{108E0}-\u{108F2}\u{108F4}\u{108F5}\u{10900}-\u{10915}\u{10920}-\u{10939}\u{10980}-\u{109B7}\u{109BE}\u{109BF}\u{10A00}\u{10A10}-\u{10A13}\u{10A15}-\u{10A17}\u{10A19}-\u{10A35}\u{10A60}-\u{10A7C}\u{10A80}-\u{10A9C}\u{10AC0}-\u{10AC7}\u{10AC9}-\u{10AE4}\u{10B00}-\u{10B35}\u{10B40}-\u{10B55}\u{10B60}-\u{10B72}\u{10B80}-\u{10B91}\u{10C00}-\u{10C48}\u{10C80}-\u{10CB2}\u{10CC0}-\u{10CF2}\u{10D00}-\u{10D23}\u{10F00}-\u{10F1C}\u{10F27}\u{10F30}-\u{10F45}\u{10FE0}-\u{10FF6}\u{11003}-\u{11037}\u{11083}-\u{110AF}\u{110D0}-\u{110E8}\u{11103}-\u{11126}\u{11144}\u{11150}-\u{11172}\u{11176}\u{11183}-\u{111B2}\u{111C1}-\u{111C4}\u{111DA}\u{111DC}\u{11200}-\u{11211}\u{11213}-\u{1122B}\u{11280}-\u{11286}\u{11288}\u{1128A}-\u{1128D}\u{1128F}-\u{1129D}\u{1129F}-\u{112A8}\u{112B0}-\u{112DE}\u{11305}-\u{1130C}\u{1130F}\u{11310}\u{11313}-\u{11328}\u{1132A}-\u{11330}\u{11332}\u{11333}\u{11335}-\u{11339}\u{1133D}\u{11350}\u{1135D}-\u{11361}\u{11400}-\u{11434}\u{11447}-\u{1144A}\u{1145F}\u{11480}-\u{114AF}\u{114C4}\u{114C5}\u{114C7}\u{11580}-\u{115AE}\u{115D8}-\u{115DB}\u{11600}-\u{1162F}\u{11644}\u{11680}-\u{116AA}\u{116B8}\u{11700}-\u{1171A}\u{11800}-\u{1182B}\u{118A0}-\u{118DF}\u{118FF}\u{119A0}-\u{119A7}\u{119AA}-\u{119D0}\u{119E1}\u{119E3}\u{11A00}\u{11A0B}-\u{11A32}\u{11A3A}\u{11A50}\u{11A5C}-\u{11A89}\u{11A9D}\u{11AC0}-\u{11AF8}\u{11C00}-\u{11C08}\u{11C0A}-\u{11C2E}\u{11C40}\u{11C72}-\u{11C8F}\u{11D00}-\u{11D06}\u{11D08}\u{11D09}\u{11D0B}-\u{11D30}\u{11D46}\u{11D60}-\u{11D65}\u{11D67}\u{11D68}\u{11D6A}-\u{11D89}\u{11D98}\u{11EE0}-\u{11EF2}\u{12000}-\u{12399}\u{12400}-\u{1246E}\u{12480}-\u{12543}\u{13000}-\u{1342E}\u{14400}-\u{14646}\u{16800}-\u{16A38}\u{16A40}-\u{16A5E}\u{16AD0}-\u{16AED}\u{16B00}-\u{16B2F}\u{16B40}-\u{16B43}\u{16B63}-\u{16B77}\u{16B7D}-\u{16B8F}\u{16E40}-\u{16E7F}\u{16F00}-\u{16F4A}\u{16F50}\u{16F93}-\u{16F9F}\u{16FE0}\u{16FE1}\u{16FE3}\u{17000}-\u{187F7}\u{18800}-\u{18AF2}\u{1B000}-\u{1B11E}\u{1B150}-\u{1B152}\u{1B164}-\u{1B167}\u{1B170}-\u{1B2FB}\u{1BC00}-\u{1BC6A}\u{1BC70}-\u{1BC7C}\u{1BC80}-\u{1BC88}\u{1BC90}-\u{1BC99}\u{1D400}-\u{1D454}\u{1D456}-\u{1D49C}\u{1D49E}\u{1D49F}\u{1D4A2}\u{1D4A5}\u{1D4A6}\u{1D4A9}-\u{1D4AC}\u{1D4AE}-\u{1D4B9}\u{1D4BB}\u{1D4BD}-\u{1D4C3}\u{1D4C5}-\u{1D505}\u{1D507}-\u{1D50A}\u{1D50D}-\u{1D514}\u{1D516}-\u{1D51C}\u{1D51E}-\u{1D539}\u{1D53B}-\u{1D53E}\u{1D540}-\u{1D544}\u{1D546}\u{1D54A}-\u{1D550}\u{1D552}-\u{1D6A5}\u{1D6A8}-\u{1D6C0}\u{1D6C2}-\u{1D6DA}\u{1D6DC}-\u{1D6FA}\u{1D6FC}-\u{1D714}\u{1D716}-\u{1D734}\u{1D736}-\u{1D74E}\u{1D750}-\u{1D76E}\u{1D770}-\u{1D788}\u{1D78A}-\u{1D7A8}\u{1D7AA}-\u{1D7C2}\u{1D7C4}-\u{1D7CB}\u{1E100}-\u{1E12C}\u{1E137}-\u{1E13D}\u{1E14E}\u{1E2C0}-\u{1E2EB}\u{1E800}-\u{1E8C4}\u{1E900}-\u{1E943}\u{1E94B}\u{1EE00}-\u{1EE03}\u{1EE05}-\u{1EE1F}\u{1EE21}\u{1EE22}\u{1EE24}\u{1EE27}\u{1EE29}-\u{1EE32}\u{1EE34}-\u{1EE37}\u{1EE39}\u{1EE3B}\u{1EE42}\u{1EE47}\u{1EE49}\u{1EE4B}\u{1EE4D}-\u{1EE4F}\u{1EE51}\u{1EE52}\u{1EE54}\u{1EE57}\u{1EE59}\u{1EE5B}\u{1EE5D}\u{1EE5F}\u{1EE61}\u{1EE62}\u{1EE64}\u{1EE67}-\u{1EE6A}\u{1EE6C}-\u{1EE72}\u{1EE74}-\u{1EE77}\u{1EE79}-\u{1EE7C}\u{1EE7E}\u{1EE80}-\u{1EE89}\u{1EE8B}-\u{1EE9B}\u{1EEA1}-\u{1EEA3}\u{1EEA5}-\u{1EEA9}\u{1EEAB}-\u{1EEBB}\u{20000}-\u{2A6D6}\u{2A700}-\u{2B734}\u{2B740}-\u{2B81D}\u{2B820}-\u{2CEA1}\u{2CEB0}-\u{2EBE0}\u{2F800}-\u{2FA1D}]+/u,OF=/[\0-#%-/:-@[-^`{-\xA9\xAB-\xB4\xB6-\xB9\xBB-\xBF\xD7\xF7\u02C2-\u02C5\u02D2-\u02DF\u02E5-\u02EB\u02ED\u02EF-\u02FF\u0375\u0378\u0379\u037E\u0380-\u0385\u0387\u038B\u038D\u03A2\u03F6\u0482\u0488\u0489\u0530\u0557\u0558\u055A-\u055F\u0589-\u0590\u05BE\u05C0\u05C3\u05C6\u05C8-\u05CF\u05EB-\u05EE\u05F3-\u060F\u061B-\u061F\u066A-\u066D\u06D4\u06DD\u06DE\u06E9\u06FD\u06FE\u0700-\u070F\u074B\u074C\u07B2-\u07BF\u07F6-\u07F9\u07FB\u07FC\u07FE\u07FF\u082E-\u083F\u085C-\u085F\u086B-\u089F\u08B5\u08BE-\u08D2\u08E2\u0964\u0965\u0970\u0984\u098D\u098E\u0991\u0992\u09A9\u09B1\u09B3-\u09B5\u09BA\u09BB\u09C5\u09C6\u09C9\u09CA\u09CF-\u09D6\u09D8-\u09DB\u09DE\u09E4\u09E5\u09F2-\u09FB\u09FD\u09FF\u0A00\u0A04\u0A0B-\u0A0E\u0A11\u0A12\u0A29\u0A31\u0A34\u0A37\u0A3A\u0A3B\u0A3D\u0A43-\u0A46\u0A49\u0A4A\u0A4E-\u0A50\u0A52-\u0A58\u0A5D\u0A5F-\u0A65\u0A76-\u0A80\u0A84\u0A8E\u0A92\u0AA9\u0AB1\u0AB4\u0ABA\u0ABB\u0AC6\u0ACA\u0ACE\u0ACF\u0AD1-\u0ADF\u0AE4\u0AE5\u0AF0-\u0AF8\u0B00\u0B04\u0B0D\u0B0E\u0B11\u0B12\u0B29\u0B31\u0B34\u0B3A\u0B3B\u0B45\u0B46\u0B49\u0B4A\u0B4E-\u0B55\u0B58-\u0B5B\u0B5E\u0B64\u0B65\u0B70\u0B72-\u0B81\u0B84\u0B8B-\u0B8D\u0B91\u0B96-\u0B98\u0B9B\u0B9D\u0BA0-\u0BA2\u0BA5-\u0BA7\u0BAB-\u0BAD\u0BBA-\u0BBD\u0BC3-\u0BC5\u0BC9\u0BCE\u0BCF\u0BD1-\u0BD6\u0BD8-\u0BE5\u0BF0-\u0BFF\u0C0D\u0C11\u0C29\u0C3A-\u0C3C\u0C45\u0C49\u0C4E-\u0C54\u0C57\u0C5B-\u0C5F\u0C64\u0C65\u0C70-\u0C7F\u0C84\u0C8D\u0C91\u0CA9\u0CB4\u0CBA\u0CBB\u0CC5\u0CC9\u0CCE-\u0CD4\u0CD7-\u0CDD\u0CDF\u0CE4\u0CE5\u0CF0\u0CF3-\u0CFF\u0D04\u0D0D\u0D11\u0D45\u0D49\u0D4F-\u0D53\u0D58-\u0D5E\u0D64\u0D65\u0D70-\u0D79\u0D80\u0D81\u0D84\u0D97-\u0D99\u0DB2\u0DBC\u0DBE\u0DBF\u0DC7-\u0DC9\u0DCB-\u0DCE\u0DD5\u0DD7\u0DE0-\u0DE5\u0DF0\u0DF1\u0DF4-\u0E00\u0E3B-\u0E3F\u0E4F\u0E5A-\u0E80\u0E83\u0E85\u0E8B\u0EA4\u0EA6\u0EBE\u0EBF\u0EC5\u0EC7\u0ECE\u0ECF\u0EDA\u0EDB\u0EE0-\u0EFF\u0F01-\u0F17\u0F1A-\u0F1F\u0F2A-\u0F34\u0F36\u0F38\u0F3A-\u0F3D\u0F48\u0F6D-\u0F70\u0F85\u0F98\u0FBD-\u0FC5\u0FC7-\u0FFF\u104A-\u104F\u109E\u109F\u10C6\u10C8-\u10CC\u10CE\u10CF\u10FB\u1249\u124E\u124F\u1257\u1259\u125E\u125F\u1289\u128E\u128F\u12B1\u12B6\u12B7\u12BF\u12C1\u12C6\u12C7\u12D7\u1311\u1316\u1317\u135B\u135C\u1360-\u137F\u1390-\u139F\u13F6\u13F7\u13FE-\u1400\u166D\u166E\u1680\u169B-\u169F\u16EB-\u16ED\u16F9-\u16FF\u170D\u1715-\u171F\u1735-\u173F\u1754-\u175F\u176D\u1771\u1774-\u177F\u17D4-\u17D6\u17D8-\u17DB\u17DE\u17DF\u17EA-\u180A\u180E\u180F\u181A-\u181F\u1879-\u187F\u18AB-\u18AF\u18F6-\u18FF\u191F\u192C-\u192F\u193C-\u1945\u196E\u196F\u1975-\u197F\u19AC-\u19AF\u19CA-\u19CF\u19DA-\u19FF\u1A1C-\u1A1F\u1A5F\u1A7D\u1A7E\u1A8A-\u1A8F\u1A9A-\u1AA6\u1AA8-\u1AAF\u1ABE-\u1AFF\u1B4C-\u1B4F\u1B5A-\u1B6A\u1B74-\u1B7F\u1BF4-\u1BFF\u1C38-\u1C3F\u1C4A-\u1C4C\u1C7E\u1C7F\u1C89-\u1C8F\u1CBB\u1CBC\u1CC0-\u1CCF\u1CD3\u1CFB-\u1CFF\u1DFA\u1F16\u1F17\u1F1E\u1F1F\u1F46\u1F47\u1F4E\u1F4F\u1F58\u1F5A\u1F5C\u1F5E\u1F7E\u1F7F\u1FB5\u1FBD\u1FBF-\u1FC1\u1FC5\u1FCD-\u1FCF\u1FD4\u1FD5\u1FDC-\u1FDF\u1FED-\u1FF1\u1FF5\u1FFD-\u200C\u200E-\u203E\u2041-\u2053\u2055-\u2070\u2072-\u207E\u2080-\u208F\u209D-\u20CF\u20DD-\u20E0\u20E2-\u20E4\u20F1-\u2101\u2103-\u2106\u2108\u2109\u2114\u2116-\u2118\u211E-\u2123\u2125\u2127\u2129\u212E\u213A\u213B\u2140-\u2144\u214A-\u214D\u214F-\u215F\u2189-\u220B\u220D-\u2BFF\u2C2F\u2C5F\u2CE5-\u2CEA\u2CF4-\u2CFF\u2D26\u2D28-\u2D2C\u2D2E\u2D2F\u2D68-\u2D6E\u2D70-\u2D7E\u2D97-\u2D9F\u2DA7\u2DAF\u2DB7\u2DBF\u2DC7\u2DCF\u2DD7\u2DDF\u2E00-\u2E2E\u2E30-\u3004\u3008-\u3020\u3030\u3036\u3037\u303D-\u3040\u3097\u3098\u309B\u309C\u30A0\u30FB\u3100-\u3104\u3130\u318F-\u319F\u31BB-\u31EF\u3200-\u33FF\u4DB6-\u4DFF\u9FF0-\u9FFF\uA48D-\uA4CF\uA4FE\uA4FF\uA60D-\uA60F\uA62C-\uA63F\uA670-\uA673\uA67E\uA6F2-\uA716\uA720\uA721\uA789\uA78A\uA7C0\uA7C1\uA7C7-\uA7F6\uA828-\uA83F\uA874-\uA87F\uA8C6-\uA8CF\uA8DA-\uA8DF\uA8F8-\uA8FA\uA8FC\uA92E\uA92F\uA954-\uA95F\uA97D-\uA97F\uA9C1-\uA9CE\uA9DA-\uA9DF\uA9FF\uAA37-\uAA3F\uAA4E\uAA4F\uAA5A-\uAA5F\uAA77-\uAA79\uAAC3-\uAADA\uAADE\uAADF\uAAF0\uAAF1\uAAF7-\uAB00\uAB07\uAB08\uAB0F\uAB10\uAB17-\uAB1F\uAB27\uAB2F\uAB5B\uAB68-\uAB6F\uABEB\uABEE\uABEF\uABFA-\uABFF\uD7A4-\uD7AF\uD7C7-\uD7CA\uD7FC-\uF8FF\uFA6E\uFA6F\uFADA-\uFAFF\uFB07-\uFB12\uFB18-\uFB1C\uFB29\uFB37\uFB3D\uFB3F\uFB42\uFB45\uFBB2-\uFBD2\uFD3E-\uFD4F\uFD90\uFD91\uFDC8-\uFDEF\uFDFC-\uFDFF\uFE10-\uFE1F\uFE30-\uFE32\uFE35-\uFE4C\uFE50-\uFE6F\uFE75\uFEFD-\uFF0F\uFF1A-\uFF20\uFF3B-\uFF3E\uFF40\uFF5B-\uFF65\uFFBF-\uFFC1\uFFC8\uFFC9\uFFD0\uFFD1\uFFD8\uFFD9\uFFDD-\uFFFF\u{1000C}\u{10027}\u{1003B}\u{1003E}\u{1004E}\u{1004F}\u{1005E}-\u{1007F}\u{100FB}-\u{1013F}\u{10175}-\u{101FC}\u{101FE}-\u{1027F}\u{1029D}-\u{1029F}\u{102D1}-\u{102DF}\u{102E1}-\u{102FF}\u{10320}-\u{1032C}\u{1034B}-\u{1034F}\u{1037B}-\u{1037F}\u{1039E}\u{1039F}\u{103C4}-\u{103C7}\u{103D0}\u{103D6}-\u{103FF}\u{1049E}\u{1049F}\u{104AA}-\u{104AF}\u{104D4}-\u{104D7}\u{104FC}-\u{104FF}\u{10528}-\u{1052F}\u{10564}-\u{105FF}\u{10737}-\u{1073F}\u{10756}-\u{1075F}\u{10768}-\u{107FF}\u{10806}\u{10807}\u{10809}\u{10836}\u{10839}-\u{1083B}\u{1083D}\u{1083E}\u{10856}-\u{1085F}\u{10877}-\u{1087F}\u{1089F}-\u{108DF}\u{108F3}\u{108F6}-\u{108FF}\u{10916}-\u{1091F}\u{1093A}-\u{1097F}\u{109B8}-\u{109BD}\u{109C0}-\u{109FF}\u{10A04}\u{10A07}-\u{10A0B}\u{10A14}\u{10A18}\u{10A36}\u{10A37}\u{10A3B}-\u{10A3E}\u{10A40}-\u{10A5F}\u{10A7D}-\u{10A7F}\u{10A9D}-\u{10ABF}\u{10AC8}\u{10AE7}-\u{10AFF}\u{10B36}-\u{10B3F}\u{10B56}-\u{10B5F}\u{10B73}-\u{10B7F}\u{10B92}-\u{10BFF}\u{10C49}-\u{10C7F}\u{10CB3}-\u{10CBF}\u{10CF3}-\u{10CFF}\u{10D28}-\u{10D2F}\u{10D3A}-\u{10EFF}\u{10F1D}-\u{10F26}\u{10F28}-\u{10F2F}\u{10F51}-\u{10FDF}\u{10FF7}-\u{10FFF}\u{11047}-\u{11065}\u{11070}-\u{1107E}\u{110BB}-\u{110CF}\u{110E9}-\u{110EF}\u{110FA}-\u{110FF}\u{11135}\u{11140}-\u{11143}\u{11147}-\u{1114F}\u{11174}\u{11175}\u{11177}-\u{1117F}\u{111C5}-\u{111C8}\u{111CD}-\u{111CF}\u{111DB}\u{111DD}-\u{111FF}\u{11212}\u{11238}-\u{1123D}\u{1123F}-\u{1127F}\u{11287}\u{11289}\u{1128E}\u{1129E}\u{112A9}-\u{112AF}\u{112EB}-\u{112EF}\u{112FA}-\u{112FF}\u{11304}\u{1130D}\u{1130E}\u{11311}\u{11312}\u{11329}\u{11331}\u{11334}\u{1133A}\u{11345}\u{11346}\u{11349}\u{1134A}\u{1134E}\u{1134F}\u{11351}-\u{11356}\u{11358}-\u{1135C}\u{11364}\u{11365}\u{1136D}-\u{1136F}\u{11375}-\u{113FF}\u{1144B}-\u{1144F}\u{1145A}-\u{1145D}\u{11460}-\u{1147F}\u{114C6}\u{114C8}-\u{114CF}\u{114DA}-\u{1157F}\u{115B6}\u{115B7}\u{115C1}-\u{115D7}\u{115DE}-\u{115FF}\u{11641}-\u{11643}\u{11645}-\u{1164F}\u{1165A}-\u{1167F}\u{116B9}-\u{116BF}\u{116CA}-\u{116FF}\u{1171B}\u{1171C}\u{1172C}-\u{1172F}\u{1173A}-\u{117FF}\u{1183B}-\u{1189F}\u{118EA}-\u{118FE}\u{11900}-\u{1199F}\u{119A8}\u{119A9}\u{119D8}\u{119D9}\u{119E2}\u{119E5}-\u{119FF}\u{11A3F}-\u{11A46}\u{11A48}-\u{11A4F}\u{11A9A}-\u{11A9C}\u{11A9E}-\u{11ABF}\u{11AF9}-\u{11BFF}\u{11C09}\u{11C37}\u{11C41}-\u{11C4F}\u{11C5A}-\u{11C71}\u{11C90}\u{11C91}\u{11CA8}\u{11CB7}-\u{11CFF}\u{11D07}\u{11D0A}\u{11D37}-\u{11D39}\u{11D3B}\u{11D3E}\u{11D48}-\u{11D4F}\u{11D5A}-\u{11D5F}\u{11D66}\u{11D69}\u{11D8F}\u{11D92}\u{11D99}-\u{11D9F}\u{11DAA}-\u{11EDF}\u{11EF7}-\u{11FFF}\u{1239A}-\u{123FF}\u{1246F}-\u{1247F}\u{12544}-\u{12FFF}\u{1342F}-\u{143FF}\u{14647}-\u{167FF}\u{16A39}-\u{16A3F}\u{16A5F}\u{16A6A}-\u{16ACF}\u{16AEE}\u{16AEF}\u{16AF5}-\u{16AFF}\u{16B37}-\u{16B3F}\u{16B44}-\u{16B4F}\u{16B5A}-\u{16B62}\u{16B78}-\u{16B7C}\u{16B90}-\u{16E3F}\u{16E80}-\u{16EFF}\u{16F4B}-\u{16F4E}\u{16F88}-\u{16F8E}\u{16FA0}-\u{16FDF}\u{16FE2}\u{16FE4}-\u{16FFF}\u{187F8}-\u{187FF}\u{18AF3}-\u{1AFFF}\u{1B11F}-\u{1B14F}\u{1B153}-\u{1B163}\u{1B168}-\u{1B16F}\u{1B2FC}-\u{1BBFF}\u{1BC6B}-\u{1BC6F}\u{1BC7D}-\u{1BC7F}\u{1BC89}-\u{1BC8F}\u{1BC9A}-\u{1BC9C}\u{1BC9F}-\u{1D164}\u{1D16A}-\u{1D16C}\u{1D173}-\u{1D17A}\u{1D183}\u{1D184}\u{1D18C}-\u{1D1A9}\u{1D1AE}-\u{1D241}\u{1D245}-\u{1D3FF}\u{1D455}\u{1D49D}\u{1D4A0}\u{1D4A1}\u{1D4A3}\u{1D4A4}\u{1D4A7}\u{1D4A8}\u{1D4AD}\u{1D4BA}\u{1D4BC}\u{1D4C4}\u{1D506}\u{1D50B}\u{1D50C}\u{1D515}\u{1D51D}\u{1D53A}\u{1D53F}\u{1D545}\u{1D547}-\u{1D549}\u{1D551}\u{1D6A6}\u{1D6A7}\u{1D6C1}\u{1D6DB}\u{1D6FB}\u{1D715}\u{1D735}\u{1D74F}\u{1D76F}\u{1D789}\u{1D7A9}\u{1D7C3}\u{1D7CC}\u{1D7CD}\u{1D800}-\u{1D9FF}\u{1DA37}-\u{1DA3A}\u{1DA6D}-\u{1DA74}\u{1DA76}-\u{1DA83}\u{1DA85}-\u{1DA9A}\u{1DAA0}\u{1DAB0}-\u{1DFFF}\u{1E007}\u{1E019}\u{1E01A}\u{1E022}\u{1E025}\u{1E02B}-\u{1E0FF}\u{1E12D}-\u{1E12F}\u{1E13E}\u{1E13F}\u{1E14A}-\u{1E14D}\u{1E14F}-\u{1E2BF}\u{1E2FA}-\u{1E7FF}\u{1E8C5}-\u{1E8CF}\u{1E8D7}-\u{1E8FF}\u{1E94C}-\u{1E94F}\u{1E95A}-\u{1EDFF}\u{1EE04}\u{1EE20}\u{1EE23}\u{1EE25}\u{1EE26}\u{1EE28}\u{1EE33}\u{1EE38}\u{1EE3A}\u{1EE3C}-\u{1EE41}\u{1EE43}-\u{1EE46}\u{1EE48}\u{1EE4A}\u{1EE4C}\u{1EE50}\u{1EE53}\u{1EE55}\u{1EE56}\u{1EE58}\u{1EE5A}\u{1EE5C}\u{1EE5E}\u{1EE60}\u{1EE63}\u{1EE65}\u{1EE66}\u{1EE6B}\u{1EE73}\u{1EE78}\u{1EE7D}\u{1EE7F}\u{1EE8A}\u{1EE9C}-\u{1EEA0}\u{1EEA4}\u{1EEAA}\u{1EEBC}-\u{1FFFF}\u{2A6D7}-\u{2A6FF}\u{2B735}-\u{2B73F}\u{2B81E}\u{2B81F}\u{2CEA2}-\u{2CEAF}\u{2EBE1}-\u{2F7FF}\u{2FA1E}-\u{E00FF}\u{E01F0}-\u{10FFFF}]+/gu,wF=/^\.+$/u,tQ=(j,A)=>{if(j===null||j.trim().length===0)return null;let e=1,t=j.replace(/_\d+$/u,""),r=j;for(;A.includes(r)||LF(r);)r=`${t}_${e}`,e++;return r},LF=j=>DF.includes(j)||window.hasOwnProperty(j)&&!NF.includes(j);function bc(j,A){if(!A)return null;let e=A.trim();if(e.length===0)return null;let t=j==="selector"?"_":"$";if(j==="directory"){if(wF.test(e))return null}else xF.test(e)||(e=t+e);return e=e.replace(OF,"_"),e=e.replace(/_+/gu,"_"),e=e.replace(/^\$_/u,t),e}function Fo(j){return bc("variable",j)}function rQ(j){let A=bc("selector",j);return A&&(A=A.replace(/^\$/gu,"_")),A}function rB(j){return bc("directory",j)}function oB(j){let e=Fo(j)||"MyComponent",t=e+Nt,r=qF(e);return{name:t,content:r}}function qF(j){return`// Get Started: https://www.framer.com/developers

import { addPropertyControls, ControlType } from "framer"
import { motion } from "framer-motion"

/**
 * @framerSupportedLayoutWidth auto
 * @framerSupportedLayoutHeight auto
 */
export default function ${j}(props) {
    const { tint } = props

    return (
        <motion.div
            style={{
                margin: 50,
                width: 100,
                height: 100,
                borderRadius: 25,
                backgroundColor: tint,
            }}
            animate={{ scale: 1.5 }}
            whileHover={{ rotate: 90 }}
        />
    )
}

addPropertyControls(${j}, {
    tint: {
        title: "Tint",
        type: ControlType.Color,
        defaultValue: "#09F",
    },
})
`}function KF(j){return`import { forwardRef, type ComponentType } from "react"
import { createStore } from "https://framer.com/m/framer/store.js@^1.0.0"
import { randomColor } from "https://framer.com/m/framer/utils.js@^0.9.0"

// Learn more: https://www.framer.com/developers/overrides/

const useStore = createStore({
    background: "#0099FF",
})

export function withRotate(Component): ComponentType {
    return forwardRef((props, ref) => {
        return (
            <Component
                ref={ref}
                {...props}
                animate={{ rotate: 90 }}
                transition={{ duration: 2 }}
            />
        )
    })
}

export function withHover(Component): ComponentType {
    return forwardRef((props, ref) => {
        return <Component ref={ref} {...props} whileHover={{ scale: 1.05 }} />
    })
}

export function withRandomColor(Component): ComponentType {
    return forwardRef((props, ref) => {
        const [store, setStore] = useStore()

        return (
            <Component
                ref={ref}
                {...props}
                animate={{
                    background: store.background,
                }}
                onClick={() => {
                    setStore({ background: randomColor() })
                }}
            />
        )
    })
}
`}function nB(j){let e=Fo(j)||"MyOverrides",t=e+Nt,r=KF(e);return{name:t,content:r}}function Kn(j){return j.endsWith(".json")?!0:/\.[tj]sx?$/u.test(j)}var VF=/^(?:[\w-]+\/)*[\w-]+(?:\.[\w-]+)*$/u;function fQ(j){let{path:A}=iB(j);return VF.test(A)}function JF(j,A){if(Kn(j))return j;let[e,t]=hi(A);return t&&(t=`.${t}`),(!t||!Kn(t))&&(t=Nt),j+t}function $Q(j){return Kn(j)||(j+=".tsx"),j}function HF(j){let A=j.lastIndexOf("/");return A<0?"":j.slice(0,A)}function QF(j){let A=j.lastIndexOf("/")+1;return j.slice(A)}function Cc(...j){let A="";return j.forEach(e=>{for(;e.startsWith("/");)e=e.slice(1);for(;e.endsWith("/");)e=e.slice(0,-1);e!==""&&(A!==""&&(A+="/"),A+=e)}),A}function iB(j,A=!0){j=j.trim();let[e,t]=hi(QF(j));t&&(t=`.${t}`);let r=HF(j).split("/").map(a=>rB(a)).filter(a=>!!a).join("/"),o=Fo(e)||"MyComponent";return(!Kn(t)||t===Nt)&&A&&(o=E7(o)),{path:Cc(r,o+t),dirName:r,name:o,extension:t}}function BQ(j,A="component"){j=j.trim();let{dirName:e,name:t,extension:r}=iB(j);if(Kn(r)&&r!==Nt){let a=t+r;return{path:Cc(e,a),content:""}}let o=A==="component"?oB(t):nB(t),n=JF(t+r,o.name);return{path:Cc(e,n),content:o.content}}function Vn(j,A){if(!j.has(A))return A;let e=1,t,[r,o]=hi(A);o&&(o=`.${o}`);do t=r+"_"+String(e++)+o;while(j.has(t));return t}function vc(j){let A=Array.isArray(j)?j:Object.values(j);return new Set(A.map(e=>e.path))}function gQ(j){return j==="typescript"||j==="javascript"}function Tc(j){let A={};for(let[e,t]of j)lB(A,e,t);return A}function Go(j,A,e){return YA(j,t=>{lB(t,A,e)})}function $s(j,A){return j[A]?YA(j,e=>{let t=e[A];if(t){for(let r of t.dependents){let o=e[r];o&&(o.dependencies.delete(A),fs(o)&&delete e[r])}for(let r of t.dependencies){let o=e[r];o&&(o.dependents.delete(A),fs(o)&&delete e[r])}delete e[A]}}):j}function br(j,A,e,t,r){let o=new Set,n=[A];for(t=t||new Set,r=r||new Set;n.length>0;){let a=n.pop();if(!a||o.has(a))continue;o.add(a);let i=j[a];if(i){if(t.has(a))r.add(a);else if(!t.size)e.add(a);else{let s=!1;for(let l of i.dependents)if(t.has(l)||r.has(l)){s=!0;break}s?r.add(a):e.add(a)}for(let s of i.dependents)o.has(s)||n.push(s)}}}function sB(j,A){let e=new Set,t=[A];for(;WF(t);){let r=t.shift(),o=j[r];if(o){for(let n of o.dependents)e.has(n)||(e.add(n),t.push(n));if(e.has(A))return!0}}return!1}function UF(j,A){let e=me(j,A);if(e)return e.startsWith("collection")&&!A.startsWith("collection")&&!A.startsWith("draftCollection")?e.replace("collection","draftCollection"):e}function lB(j,A,e){let t=j[A];if(!t){if(e.length===0)return;t=aB(j,A)}let r=new Set(t.dependencies);for(let o of e){let n=UF(o,A);if(!n)continue;t.dependencies.add(n);let a=j[n];a||(a=aB(j,n)),a.dependents.add(A),t.dependencies.add(n),r.delete(n)}for(let o of r){let n=j[o];n&&(n.dependents.delete(A),fs(n)&&delete j[o])}fs(t)&&delete j[A]}function fs(j){return j.dependents.size===0&&j.dependencies.size===0}function aB(j,A){let e={dependents:new Set,dependencies:new Set};return j[A]=e,e}function WF(j){return j.length>0}var zF=1;function XF(j){return j==="screen"||j==="canvasComponent"}function Pc(j){let A=j.metadata.compatibleCmsVersion;return Y(A)?A:0}function YF(j){let A=yA(j);return j.imports.relative.some(e=>{let t=me(e,A);return _(t)&&t.startsWith("collection")})}function Mc(j){return XF(j.type)&&YF(j)}function vQ(j){return Mc(j)&&Pc(j)<zF}var So,Jn,yo=class{constructor(A){this.limit=A;xA(this,So,0);xA(this,Jn,[])}async run(A,e){if(eA(this,So)===this.limit){let t=new Promise(r=>{eA(this,Jn).push(r)});e&&(t=Promise.race([t,ZF(e)])),await t}dB(e),Ks(this,So)._++;try{return await A()}finally{Ks(this,So)._--,eA(this,Jn).shift()?.()}}};So=new WeakMap,Jn=new WeakMap;var cB=new WeakMap;function ZF(j){let A=cB.get(j);return A||(dB(j),A=new Promise((e,t)=>{j.addEventListener("abort",()=>{t(j.reason)},{once:!0})}),cB.set(j,A)),A}function dB(j){if(j?.aborted)throw j.reason}function Hn(j){let A=new Set;if(!j)return A;if(V(j)&&np(j)){let e=pB(j.layoutTemplateIdentifier);e&&A.add(e)}for(let{node:e,skipChildren:t}of j.walkWithSkipChildren()){if(!X(e))continue;if(gA(e)){t();continue}let r=pB(e.codeComponentIdentifier);r&&A.add(r)}return A}function pB(j){let A=AA(j);if(!(!A||!KA(A)))return yA({type:A.type,name:A.localIdName})}var kB;(function(j){j[j.Static=1]="Static",j[j.Dynamic=2]="Dynamic",j[j.ImportMeta=3]="ImportMeta",j[j.StaticSourcePhase=4]="StaticSourcePhase",j[j.DynamicSourcePhase=5]="DynamicSourcePhase"})(kB||(kB={}));var AG=new Uint8Array(new Uint16Array([1]).buffer)[0]===1;function Dc(j,A="@"){if(!DA)return Nc.then(()=>Dc(j));let e=j.length+1,t=(DA.__heap_base.value||DA.__heap_base)+4*e-DA.memory.buffer.byteLength;t>0&&DA.memory.grow(Math.ceil(t/65536));let r=DA.sa(e-1);if((AG?eG:jG)(j,new Uint16Array(DA.memory.buffer,r,e)),!DA.parse())throw Object.assign(new Error(`Parse error ${A}:${j.slice(0,DA.e()).split(`
`).length}:${DA.e()-j.lastIndexOf(`
`,DA.e()-1)}`),{idx:DA.e()});let o=[],n=[];for(;DA.ri();){let i=DA.is(),s=DA.ie(),l=DA.it(),d=DA.ai(),p=DA.id(),k=DA.ss(),g=DA.se(),$;DA.ip()&&($=a(j.slice(p===-1?i-1:i,p===-1?s+1:s))),o.push({n:$,t:l,s:i,e:s,ss:k,se:g,d:p,a:d})}for(;DA.re();){let i=DA.es(),s=DA.ee(),l=DA.els(),d=DA.ele(),p=j.slice(i,s),k=p[0],g=l<0?void 0:j.slice(l,d),$=g?g[0]:"";n.push({s:i,e:s,ls:l,le:d,n:k==='"'||k==="'"?a(p):p,ln:$==='"'||$==="'"?a(g):g})}function a(i){try{return(0,eval)(i)}catch{}}return[o,n,!!DA.f(),!!DA.ms()]}function jG(j,A){let e=j.length,t=0;for(;t<e;){let r=j.charCodeAt(t);A[t++]=(255&r)<<8|r>>>8}}function eG(j,A){let e=j.length,t=0;for(;t<e;)A[t]=j.charCodeAt(t++)}var DA,Nc=WebAssembly.compile((_c="AGFzbQEAAAABKwhgAX8Bf2AEf39/fwBgAAF/YAAAYAF/AGADf39/AX9gAn9/AX9gA39/fwADMTAAAQECAgICAgICAgICAgICAgICAgIAAwMDBAQAAAUAAAAAAAMDAwAGAAAABwAGAgUEBQFwAQEBBQMBAAEGDwJ/AUHA8gALfwBBwPIACwd6FQZtZW1vcnkCAAJzYQAAAWUAAwJpcwAEAmllAAUCc3MABgJzZQAHAml0AAgCYWkACQJpZAAKAmlwAAsCZXMADAJlZQANA2VscwAOA2VsZQAPAnJpABACcmUAEQFmABICbXMAEwVwYXJzZQAUC19faGVhcF9iYXNlAwEKm0EwaAEBf0EAIAA2AoAKQQAoAtwJIgEgAEEBdGoiAEEAOwEAQQAgAEECaiIANgKECkEAIAA2AogKQQBBADYC4AlBAEEANgLwCUEAQQA2AugJQQBBADYC5AlBAEEANgL4CUEAQQA2AuwJIAEL0wEBA39BACgC8AkhBEEAQQAoAogKIgU2AvAJQQAgBDYC9AlBACAFQSRqNgKICiAEQSBqQeAJIAQbIAU2AgBBACgC1AkhBEEAKALQCSEGIAUgATYCACAFIAA2AgggBSACIAJBAmpBACAGIANGIgAbIAQgA0YiBBs2AgwgBSADNgIUIAVBADYCECAFIAI2AgQgBUEANgIgIAVBA0EBQQIgABsgBBs2AhwgBUEAKALQCSADRiICOgAYAkACQCACDQBBACgC1AkgA0cNAQtBAEEBOgCMCgsLXgEBf0EAKAL4CSIEQRBqQeQJIAQbQQAoAogKIgQ2AgBBACAENgL4CUEAIARBFGo2AogKQQBBAToAjAogBEEANgIQIAQgAzYCDCAEIAI2AgggBCABNgIEIAQgADYCAAsIAEEAKAKQCgsVAEEAKALoCSgCAEEAKALcCWtBAXULHgEBf0EAKALoCSgCBCIAQQAoAtwJa0EBdUF/IAAbCxUAQQAoAugJKAIIQQAoAtwJa0EBdQseAQF/QQAoAugJKAIMIgBBACgC3AlrQQF1QX8gABsLCwBBACgC6AkoAhwLHgEBf0EAKALoCSgCECIAQQAoAtwJa0EBdUF/IAAbCzsBAX8CQEEAKALoCSgCFCIAQQAoAtAJRw0AQX8PCwJAIABBACgC1AlHDQBBfg8LIABBACgC3AlrQQF1CwsAQQAoAugJLQAYCxUAQQAoAuwJKAIAQQAoAtwJa0EBdQsVAEEAKALsCSgCBEEAKALcCWtBAXULHgEBf0EAKALsCSgCCCIAQQAoAtwJa0EBdUF/IAAbCx4BAX9BACgC7AkoAgwiAEEAKALcCWtBAXVBfyAAGwslAQF/QQBBACgC6AkiAEEgakHgCSAAGygCACIANgLoCSAAQQBHCyUBAX9BAEEAKALsCSIAQRBqQeQJIAAbKAIAIgA2AuwJIABBAEcLCABBAC0AlAoLCABBAC0AjAoL3Q0BBX8jAEGA0ABrIgAkAEEAQQE6AJQKQQBBACgC2Ak2ApwKQQBBACgC3AlBfmoiATYCsApBACABQQAoAoAKQQF0aiICNgK0CkEAQQA6AIwKQQBBADsBlgpBAEEAOwGYCkEAQQA6AKAKQQBBADYCkApBAEEAOgD8CUEAIABBgBBqNgKkCkEAIAA2AqgKQQBBADoArAoCQAJAAkACQANAQQAgAUECaiIDNgKwCiABIAJPDQECQCADLwEAIgJBd2pBBUkNAAJAAkACQAJAAkAgAkGbf2oOBQEICAgCAAsgAkEgRg0EIAJBL0YNAyACQTtGDQIMBwtBAC8BmAoNASADEBVFDQEgAUEEakGCCEEKEC8NARAWQQAtAJQKDQFBAEEAKAKwCiIBNgKcCgwHCyADEBVFDQAgAUEEakGMCEEKEC8NABAXC0EAQQAoArAKNgKcCgwBCwJAIAEvAQQiA0EqRg0AIANBL0cNBBAYDAELQQEQGQtBACgCtAohAkEAKAKwCiEBDAALC0EAIQIgAyEBQQAtAPwJDQIMAQtBACABNgKwCkEAQQA6AJQKCwNAQQAgAUECaiIDNgKwCgJAAkACQAJAAkACQAJAIAFBACgCtApPDQAgAy8BACICQXdqQQVJDQYCQAJAAkACQAJAAkACQAJAAkACQCACQWBqDgoQDwYPDw8PBQECAAsCQAJAAkACQCACQaB/ag4KCxISAxIBEhISAgALIAJBhX9qDgMFEQYJC0EALwGYCg0QIAMQFUUNECABQQRqQYIIQQoQLw0QEBYMEAsgAxAVRQ0PIAFBBGpBjAhBChAvDQ8QFwwPCyADEBVFDQ4gASkABELsgISDsI7AOVINDiABLwEMIgNBd2oiAUEXSw0MQQEgAXRBn4CABHFFDQwMDQtBAEEALwGYCiIBQQFqOwGYCkEAKAKkCiABQQN0aiIBQQE2AgAgAUEAKAKcCjYCBAwNC0EALwGYCiIDRQ0JQQAgA0F/aiIDOwGYCkEALwGWCiICRQ0MQQAoAqQKIANB//8DcUEDdGooAgBBBUcNDAJAIAJBAnRBACgCqApqQXxqKAIAIgMoAgQNACADQQAoApwKQQJqNgIEC0EAIAJBf2o7AZYKIAMgAUEEajYCDAwMCwJAQQAoApwKIgEvAQBBKUcNAEEAKALwCSIDRQ0AIAMoAgQgAUcNAEEAQQAoAvQJIgM2AvAJAkAgA0UNACADQQA2AiAMAQtBAEEANgLgCQtBAEEALwGYCiIDQQFqOwGYCkEAKAKkCiADQQN0aiIDQQZBAkEALQCsChs2AgAgAyABNgIEQQBBADoArAoMCwtBAC8BmAoiAUUNB0EAIAFBf2oiATsBmApBACgCpAogAUH//wNxQQN0aigCAEEERg0EDAoLQScQGgwJC0EiEBoMCAsgAkEvRw0HAkACQCABLwEEIgFBKkYNACABQS9HDQEQGAwKC0EBEBkMCQsCQAJAAkACQEEAKAKcCiIBLwEAIgMQG0UNAAJAAkAgA0FVag4EAAkBAwkLIAFBfmovAQBBK0YNAwwICyABQX5qLwEAQS1GDQIMBwsgA0EpRw0BQQAoAqQKQQAvAZgKIgJBA3RqKAIEEBxFDQIMBgsgAUF+ai8BAEFQakH//wNxQQpPDQULQQAvAZgKIQILAkACQCACQf//A3EiAkUNACADQeYARw0AQQAoAqQKIAJBf2pBA3RqIgQoAgBBAUcNACABQX5qLwEAQe8ARw0BIAQoAgRBlghBAxAdRQ0BDAULIANB/QBHDQBBACgCpAogAkEDdGoiAigCBBAeDQQgAigCAEEGRg0ECyABEB8NAyADRQ0DIANBL0ZBAC0AoApBAEdxDQMCQEEAKAL4CSICRQ0AIAEgAigCAEkNACABIAIoAgRNDQQLIAFBfmohAUEAKALcCSECAkADQCABQQJqIgQgAk0NAUEAIAE2ApwKIAEvAQAhAyABQX5qIgQhASADECBFDQALIARBAmohBAsCQCADQf//A3EQIUUNACAEQX5qIQECQANAIAFBAmoiAyACTQ0BQQAgATYCnAogAS8BACEDIAFBfmoiBCEBIAMQIQ0ACyAEQQJqIQMLIAMQIg0EC0EAQQE6AKAKDAcLQQAoAqQKQQAvAZgKIgFBA3QiA2pBACgCnAo2AgRBACABQQFqOwGYCkEAKAKkCiADakEDNgIACxAjDAULQQAtAPwJQQAvAZYKQQAvAZgKcnJFIQIMBwsQJEEAQQA6AKAKDAMLECVBACECDAULIANBoAFHDQELQQBBAToArAoLQQBBACgCsAo2ApwKC0EAKAKwCiEBDAALCyAAQYDQAGokACACCxoAAkBBACgC3AkgAEcNAEEBDwsgAEF+ahAmC/4KAQZ/QQBBACgCsAoiAEEMaiIBNgKwCkEAKAL4CSECQQEQKSEDAkACQAJAAkACQAJAAkACQAJAQQAoArAKIgQgAUcNACADEChFDQELAkACQAJAAkACQAJAAkAgA0EqRg0AIANB+wBHDQFBACAEQQJqNgKwCkEBECkhA0EAKAKwCiEEA0ACQAJAIANB//8DcSIDQSJGDQAgA0EnRg0AIAMQLBpBACgCsAohAwwBCyADEBpBAEEAKAKwCkECaiIDNgKwCgtBARApGgJAIAQgAxAtIgNBLEcNAEEAQQAoArAKQQJqNgKwCkEBECkhAwsgA0H9AEYNA0EAKAKwCiIFIARGDQ8gBSEEIAVBACgCtApNDQAMDwsLQQAgBEECajYCsApBARApGkEAKAKwCiIDIAMQLRoMAgtBAEEAOgCUCgJAAkACQAJAAkACQCADQZ9/ag4MAgsEAQsDCwsLCwsFAAsgA0H2AEYNBAwKC0EAIARBDmoiAzYCsAoCQAJAAkBBARApQZ9/ag4GABICEhIBEgtBACgCsAoiBSkAAkLzgOSD4I3AMVINESAFLwEKECFFDRFBACAFQQpqNgKwCkEAECkaC0EAKAKwCiIFQQJqQbIIQQ4QLw0QIAUvARAiAkF3aiIBQRdLDQ1BASABdEGfgIAEcUUNDQwOC0EAKAKwCiIFKQACQuyAhIOwjsA5Ug0PIAUvAQoiAkF3aiIBQRdNDQYMCgtBACAEQQpqNgKwCkEAECkaQQAoArAKIQQLQQAgBEEQajYCsAoCQEEBECkiBEEqRw0AQQBBACgCsApBAmo2ArAKQQEQKSEEC0EAKAKwCiEDIAQQLBogA0EAKAKwCiIEIAMgBBACQQBBACgCsApBfmo2ArAKDwsCQCAEKQACQuyAhIOwjsA5Ug0AIAQvAQoQIEUNAEEAIARBCmo2ArAKQQEQKSEEQQAoArAKIQMgBBAsGiADQQAoArAKIgQgAyAEEAJBAEEAKAKwCkF+ajYCsAoPC0EAIARBBGoiBDYCsAoLQQAgBEEGajYCsApBAEEAOgCUCkEBECkhBEEAKAKwCiEDIAQQLCEEQQAoArAKIQIgBEHf/wNxIgFB2wBHDQNBACACQQJqNgKwCkEBECkhBUEAKAKwCiEDQQAhBAwEC0EAQQE6AIwKQQBBACgCsApBAmo2ArAKC0EBECkhBEEAKAKwCiEDAkAgBEHmAEcNACADQQJqQawIQQYQLw0AQQAgA0EIajYCsAogAEEBEClBABArIAJBEGpB5AkgAhshAwNAIAMoAgAiA0UNBSADQgA3AgggA0EQaiEDDAALC0EAIANBfmo2ArAKDAMLQQEgAXRBn4CABHFFDQMMBAtBASEECwNAAkACQCAEDgIAAQELIAVB//8DcRAsGkEBIQQMAQsCQAJAQQAoArAKIgQgA0YNACADIAQgAyAEEAJBARApIQQCQCABQdsARw0AIARBIHJB/QBGDQQLQQAoArAKIQMCQCAEQSxHDQBBACADQQJqNgKwCkEBECkhBUEAKAKwCiEDIAVBIHJB+wBHDQILQQAgA0F+ajYCsAoLIAFB2wBHDQJBACACQX5qNgKwCg8LQQAhBAwACwsPCyACQaABRg0AIAJB+wBHDQQLQQAgBUEKajYCsApBARApIgVB+wBGDQMMAgsCQCACQVhqDgMBAwEACyACQaABRw0CC0EAIAVBEGo2ArAKAkBBARApIgVBKkcNAEEAQQAoArAKQQJqNgKwCkEBECkhBQsgBUEoRg0BC0EAKAKwCiEBIAUQLBpBACgCsAoiBSABTQ0AIAQgAyABIAUQAkEAQQAoArAKQX5qNgKwCg8LIAQgA0EAQQAQAkEAIARBDGo2ArAKDwsQJQvcCAEGf0EAIQBBAEEAKAKwCiIBQQxqIgI2ArAKQQEQKSEDQQAoArAKIQQCQAJAAkACQAJAAkACQAJAIANBLkcNAEEAIARBAmo2ArAKAkBBARApIgNB8wBGDQAgA0HtAEcNB0EAKAKwCiIDQQJqQZwIQQYQLw0HAkBBACgCnAoiBBAqDQAgBC8BAEEuRg0ICyABIAEgA0EIakEAKALUCRABDwtBACgCsAoiA0ECakGiCEEKEC8NBgJAQQAoApwKIgQQKg0AIAQvAQBBLkYNBwsgA0EMaiEDDAELIANB8wBHDQEgBCACTQ0BQQYhAEEAIQIgBEECakGiCEEKEC8NAiAEQQxqIQMCQCAELwEMIgVBd2oiBEEXSw0AQQEgBHRBn4CABHENAQsgBUGgAUcNAgtBACADNgKwCkEBIQBBARApIQMLAkACQAJAAkAgA0H7AEYNACADQShHDQFBACgCpApBAC8BmAoiA0EDdGoiBEEAKAKwCjYCBEEAIANBAWo7AZgKIARBBTYCAEEAKAKcCi8BAEEuRg0HQQBBACgCsAoiBEECajYCsApBARApIQMgAUEAKAKwCkEAIAQQAQJAAkAgAA0AQQAoAvAJIQQMAQtBACgC8AkiBEEFNgIcC0EAQQAvAZYKIgBBAWo7AZYKQQAoAqgKIABBAnRqIAQ2AgACQCADQSJGDQAgA0EnRg0AQQBBACgCsApBfmo2ArAKDwsgAxAaQQBBACgCsApBAmoiAzYCsAoCQAJAAkBBARApQVdqDgQBAgIAAgtBAEEAKAKwCkECajYCsApBARApGkEAKALwCSIEIAM2AgQgBEEBOgAYIARBACgCsAoiAzYCEEEAIANBfmo2ArAKDwtBACgC8AkiBCADNgIEIARBAToAGEEAQQAvAZgKQX9qOwGYCiAEQQAoArAKQQJqNgIMQQBBAC8BlgpBf2o7AZYKDwtBAEEAKAKwCkF+ajYCsAoPCyAADQJBACgCsAohA0EALwGYCg0BA0ACQAJAAkAgA0EAKAK0Ck8NAEEBECkiA0EiRg0BIANBJ0YNASADQf0ARw0CQQBBACgCsApBAmo2ArAKC0EBECkhBEEAKAKwCiEDAkAgBEHmAEcNACADQQJqQawIQQYQLw0JC0EAIANBCGo2ArAKAkBBARApIgNBIkYNACADQSdHDQkLIAEgA0EAECsPCyADEBoLQQBBACgCsApBAmoiAzYCsAoMAAsLIAANAUEGIQBBACECAkAgA0FZag4EBAMDBAALIANBIkYNAwwCC0EAIANBfmo2ArAKDwtBDCEAQQEhAgtBACgCsAoiAyABIABBAXRqRw0AQQAgA0F+ajYCsAoPC0EALwGYCg0CQQAoArAKIQNBACgCtAohAANAIAMgAE8NAQJAAkAgAy8BACIEQSdGDQAgBEEiRw0BCyABIAQgAhArDwtBACADQQJqIgM2ArAKDAALCxAlCw8LQQBBACgCsApBfmo2ArAKC0cBA39BACgCsApBAmohAEEAKAK0CiEBAkADQCAAIgJBfmogAU8NASACQQJqIQAgAi8BAEF2ag4EAQAAAQALC0EAIAI2ArAKC5gBAQN/QQBBACgCsAoiAUECajYCsAogAUEGaiEBQQAoArQKIQIDQAJAAkACQCABQXxqIAJPDQAgAUF+ai8BACEDAkACQCAADQAgA0EqRg0BIANBdmoOBAIEBAIECyADQSpHDQMLIAEvAQBBL0cNAkEAIAFBfmo2ArAKDAELIAFBfmohAQtBACABNgKwCg8LIAFBAmohAQwACwuIAQEEf0EAKAKwCiEBQQAoArQKIQICQAJAA0AgASIDQQJqIQEgAyACTw0BIAEvAQAiBCAARg0CAkAgBEHcAEYNACAEQXZqDgQCAQECAQsgA0EEaiEBIAMvAQRBDUcNACADQQZqIAEgAy8BBkEKRhshAQwACwtBACABNgKwChAlDwtBACABNgKwCgtsAQF/AkACQCAAQV9qIgFBBUsNAEEBIAF0QTFxDQELIABBRmpB//8DcUEGSQ0AIABBKUcgAEFYakH//wNxQQdJcQ0AAkAgAEGlf2oOBAEAAAEACyAAQf0ARyAAQYV/akH//wNxQQRJcQ8LQQELLgEBf0EBIQECQCAAQaYJQQUQHQ0AIABBlghBAxAdDQAgAEGwCUECEB0hAQsgAQtGAQN/QQAhAwJAIAAgAkEBdCICayIEQQJqIgBBACgC3AkiBUkNACAAIAEgAhAvDQACQCAAIAVHDQBBAQ8LIAQQJiEDCyADC4MBAQJ/QQEhAQJAAkACQAJAAkACQCAALwEAIgJBRWoOBAUEBAEACwJAIAJBm39qDgQDBAQCAAsgAkEpRg0EIAJB+QBHDQMgAEF+akG8CUEGEB0PCyAAQX5qLwEAQT1GDwsgAEF+akG0CUEEEB0PCyAAQX5qQcgJQQMQHQ8LQQAhAQsgAQu0AwECf0EAIQECQAJAAkACQAJAAkACQAJAAkACQCAALwEAQZx/ag4UAAECCQkJCQMJCQQFCQkGCQcJCQgJCwJAAkAgAEF+ai8BAEGXf2oOBAAKCgEKCyAAQXxqQcoIQQIQHQ8LIABBfGpBzghBAxAdDwsCQAJAAkAgAEF+ai8BAEGNf2oOAwABAgoLAkAgAEF8ai8BACICQeEARg0AIAJB7ABHDQogAEF6akHlABAnDwsgAEF6akHjABAnDwsgAEF8akHUCEEEEB0PCyAAQXxqQdwIQQYQHQ8LIABBfmovAQBB7wBHDQYgAEF8ai8BAEHlAEcNBgJAIABBemovAQAiAkHwAEYNACACQeMARw0HIABBeGpB6AhBBhAdDwsgAEF4akH0CEECEB0PCyAAQX5qQfgIQQQQHQ8LQQEhASAAQX5qIgBB6QAQJw0EIABBgAlBBRAdDwsgAEF+akHkABAnDwsgAEF+akGKCUEHEB0PCyAAQX5qQZgJQQQQHQ8LAkAgAEF+ai8BACICQe8ARg0AIAJB5QBHDQEgAEF8akHuABAnDwsgAEF8akGgCUEDEB0hAQsgAQs0AQF/QQEhAQJAIABBd2pB//8DcUEFSQ0AIABBgAFyQaABRg0AIABBLkcgABAocSEBCyABCzABAX8CQAJAIABBd2oiAUEXSw0AQQEgAXRBjYCABHENAQsgAEGgAUYNAEEADwtBAQtOAQJ/QQAhAQJAAkAgAC8BACICQeUARg0AIAJB6wBHDQEgAEF+akH4CEEEEB0PCyAAQX5qLwEAQfUARw0AIABBfGpB3AhBBhAdIQELIAEL3gEBBH9BACgCsAohAEEAKAK0CiEBAkACQAJAA0AgACICQQJqIQAgAiABTw0BAkACQAJAIAAvAQAiA0Gkf2oOBQIDAwMBAAsgA0EkRw0CIAIvAQRB+wBHDQJBACACQQRqIgA2ArAKQQBBAC8BmAoiAkEBajsBmApBACgCpAogAkEDdGoiAkEENgIAIAIgADYCBA8LQQAgADYCsApBAEEALwGYCkF/aiIAOwGYCkEAKAKkCiAAQf//A3FBA3RqKAIAQQNHDQMMBAsgAkEEaiEADAALC0EAIAA2ArAKCxAlCwtwAQJ/AkACQANAQQBBACgCsAoiAEECaiIBNgKwCiAAQQAoArQKTw0BAkACQAJAIAEvAQAiAUGlf2oOAgECAAsCQCABQXZqDgQEAwMEAAsgAUEvRw0CDAQLEC4aDAELQQAgAEEEajYCsAoMAAsLECULCzUBAX9BAEEBOgD8CUEAKAKwCiEAQQBBACgCtApBAmo2ArAKQQAgAEEAKALcCWtBAXU2ApAKC0MBAn9BASEBAkAgAC8BACICQXdqQf//A3FBBUkNACACQYABckGgAUYNAEEAIQEgAhAoRQ0AIAJBLkcgABAqcg8LIAELPQECf0EAIQICQEEAKALcCSIDIABLDQAgAC8BACABRw0AAkAgAyAARw0AQQEPCyAAQX5qLwEAECAhAgsgAgtoAQJ/QQEhAQJAAkAgAEFfaiICQQVLDQBBASACdEExcQ0BCyAAQfj/A3FBKEYNACAAQUZqQf//A3FBBkkNAAJAIABBpX9qIgJBA0sNACACQQFHDQELIABBhX9qQf//A3FBBEkhAQsgAQucAQEDf0EAKAKwCiEBAkADQAJAAkAgAS8BACICQS9HDQACQCABLwECIgFBKkYNACABQS9HDQQQGAwCCyAAEBkMAQsCQAJAIABFDQAgAkF3aiIBQRdLDQFBASABdEGfgIAEcUUNAQwCCyACECFFDQMMAQsgAkGgAUcNAgtBAEEAKAKwCiIDQQJqIgE2ArAKIANBACgCtApJDQALCyACCzEBAX9BACEBAkAgAC8BAEEuRw0AIABBfmovAQBBLkcNACAAQXxqLwEAQS5GIQELIAELnAQBAX8CQCABQSJGDQAgAUEnRg0AECUPC0EAKAKwCiEDIAEQGiAAIANBAmpBACgCsApBACgC0AkQAQJAIAJFDQBBACgC8AlBBDYCHAtBAEEAKAKwCkECajYCsAoCQAJAAkACQEEAECkiAUHhAEYNACABQfcARg0BQQAoArAKIQEMAgtBACgCsAoiAUECakHACEEKEC8NAUEGIQAMAgtBACgCsAoiAS8BAkHpAEcNACABLwEEQfQARw0AQQQhACABLwEGQegARg0BC0EAIAFBfmo2ArAKDwtBACABIABBAXRqNgKwCgJAQQEQKUH7AEYNAEEAIAE2ArAKDwtBACgCsAoiAiEAA0BBACAAQQJqNgKwCgJAAkACQEEBECkiAEEiRg0AIABBJ0cNAUEnEBpBAEEAKAKwCkECajYCsApBARApIQAMAgtBIhAaQQBBACgCsApBAmo2ArAKQQEQKSEADAELIAAQLCEACwJAIABBOkYNAEEAIAE2ArAKDwtBAEEAKAKwCkECajYCsAoCQEEBECkiAEEiRg0AIABBJ0YNAEEAIAE2ArAKDwsgABAaQQBBACgCsApBAmo2ArAKAkACQEEBECkiAEEsRg0AIABB/QBGDQFBACABNgKwCg8LQQBBACgCsApBAmo2ArAKQQEQKUH9AEYNAEEAKAKwCiEADAELC0EAKALwCSIBIAI2AhAgAUEAKAKwCkECajYCDAttAQJ/AkACQANAAkAgAEH//wNxIgFBd2oiAkEXSw0AQQEgAnRBn4CABHENAgsgAUGgAUYNASAAIQIgARAoDQJBACECQQBBACgCsAoiAEECajYCsAogAC8BAiIADQAMAgsLIAAhAgsgAkH//wNxC6sBAQR/AkACQEEAKAKwCiICLwEAIgNB4QBGDQAgASEEIAAhBQwBC0EAIAJBBGo2ArAKQQEQKSECQQAoArAKIQUCQAJAIAJBIkYNACACQSdGDQAgAhAsGkEAKAKwCiEEDAELIAIQGkEAQQAoArAKQQJqIgQ2ArAKC0EBECkhA0EAKAKwCiECCwJAIAIgBUYNACAFIARBACAAIAAgAUYiAhtBACABIAIbEAILIAMLcgEEf0EAKAKwCiEAQQAoArQKIQECQAJAA0AgAEECaiECIAAgAU8NAQJAAkAgAi8BACIDQaR/ag4CAQQACyACIQAgA0F2ag4EAgEBAgELIABBBGohAAwACwtBACACNgKwChAlQQAPC0EAIAI2ArAKQd0AC0kBA39BACEDAkAgAkUNAAJAA0AgAC0AACIEIAEtAAAiBUcNASABQQFqIQEgAEEBaiEAIAJBf2oiAg0ADAILCyAEIAVrIQMLIAMLC+wBAgBBgAgLzgEAAHgAcABvAHIAdABtAHAAbwByAHQAZgBvAHIAZQB0AGEAbwB1AHIAYwBlAHIAbwBtAHUAbgBjAHQAaQBvAG4AcwBzAGUAcgB0AHYAbwB5AGkAZQBkAGUAbABlAGMAbwBuAHQAaQBuAGkAbgBzAHQAYQBuAHQAeQBiAHIAZQBhAHIAZQB0AHUAcgBkAGUAYgB1AGcAZwBlAGEAdwBhAGkAdABoAHIAdwBoAGkAbABlAGkAZgBjAGEAdABjAGYAaQBuAGEAbABsAGUAbABzAABB0AkLEAEAAAACAAAAAAQAAEA5AAA=",typeof Buffer<"u"?Buffer.from(_c,"base64"):Uint8Array.from(atob(_c),j=>j.charCodeAt(0)))).then(WebAssembly.instantiate).then(({exports:j})=>{DA=j}),_c;function xc(j){return j!==void 0?{ok:!0,value:j}:{ok:!0}}function Oc(j){return{ok:!1,error:j}}function uB(j){return j.then(A=>xc(A),A=>Oc(A))}var tG=/^\s*(['"](\..*)['"])\s*$/mu,Qn=class extends Error{constructor(e){super();this.persistedMissingRelativeImports=e;this.name="RewriteRelativeImportsError"}};function Bs(j){return j instanceof Qn}async function gs(j,A){await Nc;let[e]=Dc(j),t=j,r=new Set,o=[...e].reverse();for(let{s:n,e:a,d:i}of o){if(i===-2)continue;if(i===-1){let F=j.substring(n,a);if(!F.startsWith("."))continue;let I=A[F];I===void 0&&(r.add(F),I=EB(F)),t=mB(t,I,n,a);continue}let s=j.substring(n,a),d=s.replace(/\/\*[\s\S]*?\*\/|([^\\:]|^)\/\/.*$/gm,"$1").trim().match(tG);if(!d)continue;let p=d[1],k=d[2];if(p===void 0||k===void 0)continue;let g=A[k];g===void 0&&(r.add(k),g=EB(k));let $=s.replace(new RegExp(wc(p),"g"),JSON.stringify(g));t=mB(t,$,n,a)}return r.size>0?Oc({partiallyProcessedCode:t,unresolvedRelativeImports:r,parsedImports:e}):xc(t)}function mB(j,A,e,t){return j.slice(0,e)+A+j.slice(t)}function wc(j){return j.replace(/[.*+\-?^${}()|[\]\\]/gu,"\\$&")}function EB(j){return`!missing/${j}`}var W=kA("modules-storage"),$B=Object.freeze({}),BB=Object.freeze({});function Jc(j){return j&&j.type==="codeFile"?(E(_(j.sourceContent),"code module entry is missing source content"),!0):!1}function Lc(j){return j.name===Js&&j.type===Ld}function rG(j){return j.id===ge}function gB(j,A){return!!j&&j.saveId===A.saveId&&j.id===A.moduleId}var hs=class extends Error{constructor(){super("A circular dependency was detected."),this.name="CircularDependencyError"}},Un="update-modules-storage",oG=0;async function QA(j){let A=performance.now(),e=`acquire-modules-storage-lock-${oG++}`;return En(e),$l.request(Un,()=>{let t=performance.now()-A;return Ga(`\u{1F513} Acquire ${Un} lock`,e),Sa(e),W.debug("\u{1F513} Acquired the",Un,"lock in",t.toFixed(2),"ms"),t>1e3&&W.warn("\u2757 Long wait: it took",t.toFixed(0),"ms to acquire the",Un,"lock."),j()})}var Rs=class{constructor(A,e,t,r){this.storage=A;this.localId=e;this.type=t;this.debugModuleStoreAndComponentLoaderRevisionsMatch=r}get id(){let A=this.storage.getPersistedModuleByLocalId(this.localId);if(A)return A.id;let e=this.storage.getModuleTreeData(this.localId);return E(e,"Module must exist"),e.moduleId}get saveId(){let A=this.storage.getTransientSaveByLocalId(this.localId);if(A)return A.saveId;let e=this.storage.getPersistedModuleByLocalId(this.localId);return E(e,"Module must exist"),e.saveId}get transientSVGIcon(){let A=this.storage.getTransientSaveByLocalId(this.localId);if(A)return A.svgIcon}externalModuleIdentifier(A="default"){let e=this.storage.getTransientSaveByLocalId(this.localId);if(e){let r=Xj(e.name);return ee(this.id,e.saveId,r.module,A)}let t=this.storage.getPersistedModuleByLocalId(this.localId);return E(t?.files.module,"ModulesStorage: Expected module typed file in persisted module."),ee(this.id,t.saveId,t.files.module,A)}delete(){return this.storage.delete(this.localId)}publish(A,e,t){return this.storage.publish(this.localId,{namespace:A,name:e,version:t})}sourceRevision(){let A=this.storage.getTransientSaveByLocalId(this.localId);if(A)return A.sourceRevision;let e=this.storage.getPersistedModuleByLocalId(this.localId);if(e)return Hc(e)}annotations(A,e){let t=this.storage.getTransientSaveByLocalId(this.localId),r=t?.annotations?io(t.annotations):this.storage.getModuleTreeData(this.localId)?.annotations;return A&&this.debugModuleStoreAndComponentLoaderRevisionsMatch()&&nG(r,A),e?r?.[e]:r}},Kc=class extends Rs{constructor(e,t,r,o,n){super(e,t,r,o);this.name=n}currentSourceEquals(e,t){let r=this.storage.getPersistedModuleByLocalId(this.localId);return!r||r.submodules.length||t.submodules?.size?!1:r.sourceContent===e}updateSource(e,t={}){return this.storage.updateSources([{localId:this.localId,source:e,options:{...t,stableName:!0}}])}persist(e){return this.storage.upsert(this.localId,{...e,type:this.type,name:this.name})}getKitSectionsStructure(){let e=this.storage.getTransientSaveByLocalId(this.localId);return e?e.kitSectionsStructure:this.storage.getKitSectionsStructure(this.name)}};function nG(j,A){if(!j)return;let e=AA(A.identifier);E(KA(e)&&cj(e),"Entity must have an identifier."),A.annotations&&e.exportSpecifier in j&&!Fi(j[e.exportSpecifier],io({default:A.annotations}).default,!0)&&W.reportError("Static annotations are not synchronized with runtime annotations.",{identifier:A.identifier})}function Hc(j){let A=j?.metadata.sourceRevision;return Y(A)?A:void 0}var Vc=class extends Rs{updateSource(A,e){return this.storage.updateSources([{localId:this.localId,source:A,options:e??{}}])}persist(A){return this.storage.update(this.localId,A)}rename(A){return this.storage.rename(this.localId,A)}},Wn=class{constructor(A,e,t=()=>!0){this.storage=A;this.type=e;this.moduleStoreAndComponentLoaderRevisionsMatch=t}async create(A){return this.storage.create({...A,type:this.type})}getByStableName(A){return new Kc(this.storage,Oe(this.type,A),this.type,this.moduleStoreAndComponentLoaderRevisionsMatch,A)}getByLocalId(A){return new Vc(this.storage,A,this.type,this.moduleStoreAndComponentLoaderRevisionsMatch)}getUniqueName(A){return this.storage.getUniqueNameForType(this.type,A)}},Is=class{constructor(A,e,t,r,o,n,a,i,s){this.getModulesService=A;this.compile=e;this.process=t;this.processWhenReady=r;this.signalNonUserEvent=o;this.runWhenIdle=n;this.treeStore=a;this.getActiveScope=i;this.makeDocumentReadOnly=s;R(this,"useTreeAsLocalModuleList",!1);R(this,"writeLocalModulesToTree",!1);R(this,"dependenciesModule");R(this,"persistedModules",new Map);R(this,"persistedLocalIdsByTypeSlashNameCache",new WeakMap);R(this,"transientSaves",new Map);R(this,"lastSnapshot",{dependenciesModule:void 0,modules:new Map,depsGraph:{},initialized:!1});R(this,"modulesService");R(this,"lazyServerModulesForTransientSaves",new Map);R(this,"backgroundJob",null);R(this,"backgroundAbortController",null);R(this,"initialized",!1);R(this,"initializationStarted",!1);R(this,"readOnlyTree",!1);R(this,"resolveInitialization",()=>{throw new Error("initializationPromise has not executed yet")});R(this,"rejectInitialization",()=>{throw new Error("initializationPromise has not executed yet")});R(this,"initializationPromise",new Promise((A,e)=>{this.resolveInitialization=A,this.rejectInitialization=e}));R(this,"didSetupModuleEventStream",!1);R(this,"transientInfo",null);R(this,"previousLocalModuleNodes",[]);R(this,"treeNodesToUpdate",new Map);R(this,"treeNodesToDelete",[]);R(this,"goingToStartUsingLocalModulesInTree",!1);R(this,"listeners",new Set);R(this,"transientSaveRetries",new Map);R(this,"transientSaveRelativeImportRetries",new Set);R(this,"downloadQueue",new yo(1200))}hasPendingServerModules(){return this.lazyServerModulesForTransientSaves.size>0}processOnePendingServerModule(){return this.lazyServerModulesForTransientSaves.size===0?Promise.resolve(!1):QA(async()=>{for(let[,A]of this.lazyServerModulesForTransientSaves)for(let e of A){let t=this.persistedModules.get(e)?.localId;if(!t)continue;let r=this.persistedModules.get(t);if(r?.kind!=="server")continue;W.debug("\u{1F343} Process one server \u2192 local module",e);let o=await this.createLocalModuleFromModule(r),n=YA(this.persistedModules,a=>{a.set(r.localId,o)});return this.setNextInternalState({dependenciesModule:this.dependenciesModule,persistedModules:n,depsGraph:this.lastSnapshot.depsGraph,didRemoteChange:!1,transientSaves:this.transientSaves}),!0}return!1})}async changeScope(A){if(!this.hasPendingServerModules())return;let e=Hn(A);!e||e.size===0||(await QA(async()=>{let t=new Set,r=this.lastSnapshot.depsGraph;for(let[i,s]of this.lazyServerModulesForTransientSaves)br(r,i,s,e,t);let o=[];for(let i of t){let s=this.getModuleWithTypeSlashName(i);s?.kind==="server"&&o.push(this.createLocalModuleFromModule(s))}if(W.debug("\u{1F343} Prioritizing making visible modules local after changing scope:",A.id,"/ Visible:",e,"/ Visible Dependencies:",t,"/ Server modules:",o.length),o.length===0)return;let n=await Promise.all(o),a=YA(this.persistedModules,i=>{for(let s of n)i.set(s.localId,s)});this.setNextInternalState({dependenciesModule:this.dependenciesModule,persistedModules:a,depsGraph:r,didRemoteChange:!1,transientSaves:this.transientSaves})}),this.makeLazyServerModulesLocalWhenIdle().catch(SA))}async makeVisibleDependentServerModulesLocal(A){if(!XA.isOn("prioritizedModuleEvaluation"))return;let e=this.getActiveScope(),t=new Set,r=Hn(e),o=new Set;for(let i of A){let s=this.typeAndNameFromLocalId(i.localId,i.options.stableName),l=yA(s),d=this.lastSnapshot.depsGraph;br(d,l,o,r,t),this.lazyServerModulesForTransientSaves.set(l,o),t.delete(l)}let n=[];for(let i of t){let s=this.getModuleWithTypeSlashName(i);s?.kind==="server"&&n.push(this.createLocalModuleFromModule(s))}W.debug("\u{1F343} Prioritizing dependent server modules after updating:",A.map(i=>i.localId),"/ Visible:",t,"/ Lazy:",o,"/ Server modules:",n.length);let a=this.persistedModules;if(n.length>0){let i=await Promise.all(n);a=YA(a,s=>{for(let l of i)s.set(l.localId,l)})}this.persistedModules=a}async makeLazyServerModulesLocalWhenIdle(){this.cancelBackgroundJob(),this.backgroundAbortController=new AbortController;let{signal:A}=this.backgroundAbortController;return this.backgroundJob=(async()=>{try{for(;this.hasPendingServerModules()&&!A.aborted;){let e=new qd;if(this.runWhenIdle(()=>{if(A.aborted){e.resolve(!1);return}this.processOnePendingServerModule().then(e.resolve,e.reject)}),!await e)break}}finally{this.backgroundJob=null,this.backgroundAbortController=null}})(),this.backgroundJob}cancelBackgroundJob(){this.backgroundAbortController&&this.backgroundAbortController.abort()}getTransientSave(A){return this.transientSaves.get(A)}resetModuleStateAndPermissions(A){this.readOnlyTree=A==="readonly",this.useTreeAsLocalModuleList=this.readOnlyTree,!this.readOnlyTree&&this.modulesService&&this.setupModuleEventStreamIfNeeded(),this.treeNodesToUpdate.clear(),this.treeNodesToDelete=[],this.transientSaves.size>0&&(W.reportErrorOncePerMinute(new Error("Discarding transient saves"),{count:this.transientSaves.size}),this.setNextInternalState({dependenciesModule:this.dependenciesModule,persistedModules:this.persistedModules,transientSaves:new Map,depsGraph:this.lastSnapshot.depsGraph,didRemoteChange:!0}))}async waitForModulesToSave(){let A=Array.from(this.transientSaves.keys());for(let t of A)this.transientSaves.has(t)&&await this.update(t,{});let e=this.transientSaves.size;e>0&&W.warn("waitForModulesToSave: transientSaves seems to be growing, ignoring rest:",e)}async initialize(){return this.initializationStarted?this.initializationPromise:(this.initializationStarted=!0,this.initializeInternal().then(this.resolveInitialization,A=>{W.reportError(A,{context:"Failed to initialize ModulesStorage: "}),this.rejectInitialization(A)}),this.initializationPromise)}setupModuleEventStreamIfNeeded(){this.didSetupModuleEventStream||(this.didSetupModuleEventStream=!0,E(this.modulesService,"ModulesStorage.useModuleEventStream: expected modules service to be initialized"),this.modulesService.moduleEventsStream().read(async({events:A})=>{let e=A.filter(sG);this.handleRemoteModuleSaveEvents(e).catch(W.reportError);let t=A.filter(lG);this.handleRemoteModuleDeleteEvents(t).catch(W.reportError)}).catch(A=>{W.reportError(A,{context:"Failed to read ModulesAPI event stream: "})}))}async initializeInternal(){if(this.modulesService=await this.getModulesService(),!this.modulesService)return;let A=this.treeStore.tree.getLocalModuleNodes();this.writeLocalModulesToTree=!!A,this.useTreeAsLocalModuleList||this.setupModuleEventStreamIfNeeded();let e,t=performance.now();if(ya("modulesStorageStart"),this.useTreeAsLocalModuleList&&A){W.info("init from tree data"),this.previousLocalModuleNodes=A;let i=A.map(s=>({moduleId:s.save.moduleId,saveId:s.save.saveId}));e=await this.modulesService.lookUpModules({queries:i})}else W.info("init from module list"),e=await this.modulesService.list({});ya("modulesStorageInit"),W.debug("listing modules took:",performance.now()-t,"millis");let r=e.data.find(Lc);r&&await this.updateDependenciesModule(r);let o=new Map,n=new Set;await Promise.all(e.data.map(async i=>{if(yA(i)===ge)return;let s=await this.createServerModuleFromData(i);W.trace("init - create module",s.localId,s.id,s.saveId,s.savedAt),o.set(s.localId,s),n.add(s.localId)}));let a=this.createDependencyGraph(o);this.initialized=!0,this.setNextInternalState({dependenciesModule:this.dependenciesModule,persistedModules:o,transientSaves:this.transientSaves,depsGraph:a,didRemoteChange:!0}),ya("modulesStorageFirstPublish"),this.processTreeUpdates()}createDependencyGraph(A){let e=[];for(let t of A.values()){let r=yA(t),o=t.imports.relative;e.push([r,o])}return Tc(e)}processTreeUpdates(){if(this.initialized){if(this.readOnlyTree)if(this.useTreeAsLocalModuleList){if(!this.treeStore.tree.has(ie)){W.info("detected removal of local modules list node, stopping to use tree as local module list"),this.useTreeAsLocalModuleList=!1,this.setupModuleEventStreamIfNeeded();return}}else{if(!this.treeStore.tree.has(ie))return;W.info("detected insertion of a local modules list node, starting to use tree as local module list"),this.useTreeAsLocalModuleList=!0}this.syncLocalModules(),this.tryWriteTreeData()}}async syncLocalModules(){if(!this.useTreeAsLocalModuleList)return;let A=this.treeStore.tree.getLocalModulesListNode()?.children;if(!A||this.previousLocalModuleNodes===A)return;let e=[],t=_d(this.previousLocalModuleNodes,r=>[r.id,r]);this.previousLocalModuleNodes=A;for(let r of A){let o=t.get(r.id);if(t.delete(r.id),o===r)continue;let n=r.save,a=this.persistedModules.get(r.id);gB(a,n)||rG(r)&&gB(this.dependenciesModule,n)||(e.push({moduleId:n.moduleId,saveId:n.saveId}),W.debug("syncLocalModules to update:",r.id))}if(t.size>0&&(W.debug("syncLocalModules removing:",t.keys()),this.handleRemoteModuleDeletes(Array.from(t.values()).map(r=>r.save.moduleId))),e.length>0){W.debug("syncLocalModules updating:",e),E(this.modulesService,"ModulesStorage.refresh: expected modules service to be initialized");let r=performance.now(),o=await this.modulesService.lookUpModules({queries:e});W.debug("lookupModules took:",performance.now()-r,"millis"),await this.handleRemoteModuleSaves(o.data)}}canWriteTree(){return!this.treeStore.tree.isViewOnly}tryWriteTreeData(){this.canWriteTree()&&(this.treeNodesToUpdate.size===0&&this.treeNodesToDelete.length===0||this.processWhenReady(()=>{if(!this.canWriteTree())return;let A=this.treeStore.tree;this.signalNonUserEvent(),A.lineage.setEditReason("localmodules"),this.createLocalModulesListNodeIfNeeded(A);for(let e of this.treeNodesToDelete)this.persistedModules.get(e)||(W.debug("tryWriteTreeData, remove:",e),A.remove(e));this.treeNodesToDelete=[];for(let[e,{treeVersion:t,errors:r,persistedModule:o}]of this.treeNodesToUpdate.entries())this.persistedModules.get(e)?.saveId===o.saveId&&(W.debug("tryWriteTreeData, write:",e,t,o.id,o.saveId,r),this.updateNode(A,e,t,o,r));this.treeNodesToUpdate.clear()}))}updateTreeNodeWithOwnTreeVersion(A,e){!this.writeLocalModulesToTree&&!this.maybeUpgradeDocument()||this.process(()=>{this.signalNonUserEvent(),this.treeStore.tree.lineage.setEditReason("localmodules"),this.createLocalModulesListNodeIfNeeded(this.treeStore.tree);let r=this.treeStore.tree.get(A)?.save.treeVersion??this.treeStore.remoteTreeVersion;W.debug("updateTreeNodeWithCurrentTreeVersion:",A,r,e.id,e.saveId),this.updateNode(this.treeStore.tree,A,r,e)})}updateTreeNode(A,e,t,r,o){return!this.writeLocalModulesToTree&&!this.maybeUpgradeDocument()?!0:this.canWriteTree()?(this.process(()=>{this.signalNonUserEvent(),this.treeStore.tree.lineage.setEditReason("localmodules"),this.createLocalModulesListNodeIfNeeded(this.treeStore.tree),W.debug("updateTreeNode:",A,e,t.id,t.saveId),this.updateNode(this.treeStore.tree,A,e,t,r,o)}),!0):(W.debug("updateTreeNode - readonly, buffering change"),this.treeNodesToUpdate.set(A,{treeVersion:e,persistedModule:t,errors:r,kitSectionsStructure:o}),!0)}removeTreeNode(A){this.writeLocalModulesToTree&&(this.canWriteTree()?this.process(()=>{W.debug("removeTreeNode:",A),this.treeStore.tree.remove(A)}):this.treeNodesToDelete.push(A))}updateNode(A,e,t,r,o,n){E(this.writeLocalModulesToTree,"not using tree for local modules");let a=A.get(e)?.asDraft()??new K6({id:e});E(a instanceof K6);let i=r.metadata.pluginId,s={treeVersion:t,moduleId:r.id,saveId:r.saveId,imports:r.imports?.relative,title:r.title,name:r.name,type:r.type,sourceRevision:r.sourceRevision,annotations:r.annotations?io(r.annotations):a.save.annotations,pluginId:_(i)?i:a.save.pluginId};a.set({save:s}),a.tree()||A.insertNode(a,ie);let l=r.name;if(!A.has(l))return;if(Aj(n)){let k=A.get(l);V(k)&&k.set({kitSectionsStructure:n})}if(!o)return;let d=A.get(Bu);if(W.debug("Writing serialization errors from artifacts to tree for",l),d?.children?.forEach(k=>{let g=k.sourceNodeId??k.scopeId,$=oA(k.sourceNodeModuleType)||r.type===k.sourceNodeModuleType;!g||g!==l||!$||!gu(k.type)||A.remove(k.id)}),o.length===0)return;let p=A.ensureErrorListNode();o.forEach(k=>A.insertNode(k,p.id))}getModuleTreeData(A){return this.treeStore.tree.getNodeWithTrait(A,vt)?.save}getKitSectionsStructure(A){return this.treeStore.tree.getNodeWithTrait(A,V)?.kitSectionsStructure}createLocalModulesListNodeIfNeeded(A){if(E(this.writeLocalModulesToTree,"not using tree for local modules"),A.has(ie)||!this.canWriteTree())return;W.debug("ensureAllModulesExistInTree:",this.persistedModules.size),A.insertNode(new Fk);let e=this.treeStore.remoteTreeVersion;this.persistedModules.forEach(t=>{this.updateNode(A,t.localId,e,t)}),this.dependenciesModule&&this.updateNode(A,ge,e,this.dependenciesModule)}usingLocalModulesInTree(){return this.treeStore.tree.has(ie)||this.goingToStartUsingLocalModulesInTree}async startUsingLocalModulesInTree(){if(!this.canWriteTree())throw Error("Project is read only.");this.goingToStartUsingLocalModulesInTree=!0,this.process(()=>{if(this.startUsingLocalModulesInTree){if(!this.canWriteTree())throw Error("Project is read only.");this.treeStore.tree.lineage.setEditReason("startUsingLocalModulesInTree"),this.goingToStartUsingLocalModulesInTree=!1,this.writeLocalModulesToTree=!0,this.createLocalModulesListNodeIfNeeded(this.treeStore.tree)}})}stopUsingLocalModulesInTree(){this.goingToStartUsingLocalModulesInTree=!1,this.process(()=>{if(!this.canWriteTree())throw Error("Project is read only.");this.treeStore.tree.lineage.setEditReason("stopUsingLocalModulesInTree"),this.treeStore.tree.remove(ie),this.writeLocalModulesToTree=!1,this.setupModuleEventStreamIfNeeded()})}maybeUpgradeDocument(){return this.process(()=>{if(!this.canWriteTree()){W.warn("cannot upgrade document if we cannot write, but should not be saving modules either");return}W.info("upgrading document to use local modules list node"),this.signalNonUserEvent(),this.treeStore.tree.lineage.setEditReason("maybeUpgradeDocument"),this.writeLocalModulesToTree=!0,this.createLocalModulesListNodeIfNeeded(this.treeStore.tree)}),this.writeLocalModulesToTree}getModuleWithTypeSlashName(A){let e=this.findPersistedModuleLocalIdByTypeSlashName(this.persistedModules,A);if(e)return this.persistedModules.get(e)}async updateDependenciesModule(A){E(Lc(A),"updateDependenciesModule called with non dependencies module data");let e=await this.getDependenciesFiles(A),t=e?.dependenciesMapContent;if(!t){let r=JSON.parse(e.importMapContent),o=no(r);t=JSON.stringify(o),this.readOnlyTree?W.reportError(new Error("modules storage is read only"),{context:"modules storage is read only while calling updateDependenciesModule"}):(await this.updateDependenciesLocked(r,o),W.info("The missing dependencies file has now been created."))}this.dependenciesModule={kind:"dependencies",...A,id:A.id,localId:A.localId,type:"config",name:A.name,importMapContent:e.importMapContent,dependenciesMapContent:t}}async createServerModuleFromData(A){let e={kind:"server",...A,id:A.id,localId:A.localId,moduleURL:A.baseURL+A.files.module,update:performance.now()};if((e.type==="codeFile"||e.type==="webPageMetadata")&&(e.sourceContent=await this.fetchSourceContentFromData(A)),Mc(e)&&Pc(e)===0){e.sourceContent=await this.fetchSourceContentFromData(A);let t=e.sourceContent.includes("useQueryData")?1:0;e.metadata={...e.metadata,compatibleCmsVersion:t}}return e}async fetchSourceContentFromData(A){let e=A.baseURL+A.files.source;return(await fetch(e)).text()}async refresh(){if(this.initialized&&!this.useTreeAsLocalModuleList)return W.debug("refresh: acquiring lock"),QA(()=>this.refreshLocked())}async refreshLocked(){W.debug("refresh: start"),E(this.modulesService,"ModulesStorage.refresh: expected modules service to be initialized");let{data:A}=await this.modulesService.list({});W.debug("refresh: there's",A.length,"modules to process");let e=new Map,t=new Set;await Promise.all(A.map(async o=>{let n=o.localId;if(Lc(o)){this.dependenciesModule?.saveId!==o.saveId&&await this.updateDependenciesModule(o);return}let a=this.persistedModules.get(n);if(a?.saveId===o.saveId)e.set(n,a);else{let i=await this.createServerModuleFromData(o);W.debug("refresh - updating module",i.localId,i.id,i.saveId,i.savedAt),e.set(n,i)}t.add(n)}));let r=this.createDependencyGraph(e);this.setNextInternalState({dependenciesModule:this.dependenciesModule,persistedModules:e,transientSaves:this.transientSaves,depsGraph:r,didRemoteChange:!0}),W.debug("refresh: finish")}whenInitialized(){return this.initializationPromise}async whenIdle(){await Promise.all([this.whenInitialized(),QA(()=>{})])}isProcessing(){return!!(!this.initialized||this.transientSaves.size>0||$l.isLocked(Un))}hasLocalChanges(){return this.transientSaves.size>0}addListener(A){this.listeners.add(A)}removeListener(A){this.listeners.delete(A)}notifyListeners(A){this.listeners.forEach(e=>{try{e(A)}catch(t){W.reportError(t)}})}subscribe(A){return this.addListener(A),A(hB(this.dependenciesModule,void 0,this.persistedModules,this.transientSaves,this.lastSnapshot.depsGraph,new Map,this.initialized,!1,!1)),()=>this.removeListener(A)}getDependentsOfModule(A){return this.lastSnapshot.depsGraph[A]?.dependents}getUniqueNameForType(A,e){let t=new Set;for(let r of this.persistedModules.values())r.type===A&&t.add(r.name);return Vn(t,e)}async updateSources(A){return QA(async()=>{let e=!1;for(let{localId:t,source:r,options:o}of A){let n=Date.now();try{await this.updateSourceLocked(t,{...o,source:r}),e=!0}catch(a){a instanceof hs&&vA({type:"add",variant:"error",text:"Instances of your component won't update if they are nested within themselves.",key:"component-circular-dependency",icon:"error",duration:Number.POSITIVE_INFINITY}),W.reportError(a)}finally{let a=Date.now()-n;W.debug("\u23F1 update source",t,"in",a,"ms")}}return await this.makeVisibleDependentServerModulesLocal(A),this.setNextInternalState({dependenciesModule:this.dependenciesModule,persistedModules:this.persistedModules,transientSaves:this.transientSaves,depsGraph:this.lastSnapshot.depsGraph,didRemoteChange:!1}),this.makeLazyServerModulesLocalWhenIdle().catch(SA),e})}async updateDependenciesSource(A,e){return QA(async()=>{E(this.dependenciesModule,"Dependency files must already exist to be updated.");let t=A===_o?e:this.dependenciesModule.importMapContent,r=A===Do?e:this.dependenciesModule.dependenciesMapContent;return this.updateDependenciesLocked(JSON.parse(t),JSON.parse(r))})}async compileSubmodules(A,e){let t={};return await Promise.all([...e].map(async([r,o])=>{let n=await this.compile({name:r,source:o,type:A,includeSourceMap:!1,addFramerMetadata:!1});for(let i of n.imports.relative){let s=Cm(i);if(!(s&&e.has(s)))throw new Error("Submodules only support relative imports of other submodules")}let a=ba(r);t[a]=n.code})),t}typeAndNameFromLocalId(A,e=!1){if(e)return ui(A);for(let t of this.lastSnapshot.modules.values())if(t?.localId===A)return t;throw new Error(`Module entry for local id ${A} missing in internal snapshot`)}async updateSourceLocked(A,{source:e,submodules:t,binaryAssets:r=BB,stableName:o=!1,assets:n,preventCircularImports:a,telemetrySession:i,treeVersion:s,sourceRevision:l,svgIcon:d,kitSectionsStructure:p}){await this.whenInitialized();let k=this.typeAndNameFromLocalId(A,o),g=yA(k),$=await this.compile({localId:A,name:g,source:e,type:k.type,includeSourceMap:qc(k.type),telemetrySession:i}),F=$B;t&&(F=await this.compileSubmodules(k.type,t));let I=Go(this.lastSnapshot.depsGraph,g,$.imports.relative);if(a&&sB(I,g))throw new hs;let S=cG(k.type,$.annotations),T=YA(this.transientSaves,v=>{let P=v.get(A),N,Q=S?.framerIntrinsicWidth;Q&&(N={...N,intrinsicWidth:Number.parseInt(Q,10)});let w=S?.framerIntrinsicHeight;if(w&&(N={...N,intrinsicHeight:Number.parseInt(w,10)}),N={...N,compilerContractVersion:1,treeAnnotations:!0,localModuleImportMapEntries:this.moduleUsesLocalImportMapSpecifiers(g)},P)P.saveId=Cr(),P.moduleContent=$.code,P.sourceContent=e,P.sourceMapContent=$.sourceMap,P.submoduleContents=F,P.binaryAssetContents=r,P.imports=$.imports,P.exports=$.exportedNames,P.reExportedModules=$.reExportedModules,P.treeVersion=s??this.treeStore.remoteTreeVersion,P.sourceRevision=l??P.sourceRevision,P.annotations=$.annotations,P.svgIcon=d??P.svgIcon,P.kitSectionsStructure=p??P.kitSectionsStructure,P.update=performance.now(),n&&(P.assets=Array.from(n)),N&&(P.metadata={...P.metadata,...N});else{let iA={localId:A,type:k.type,name:k.name,saveId:Cr(),moduleContent:$.code,sourceContent:e,sourceMapContent:$.sourceMap,submoduleContents:F,binaryAssetContents:r,imports:$.imports,exports:$.exportedNames,reExportedModules:$.reExportedModules,treeVersion:s,sourceRevision:l,svgIcon:d,kitSectionsStructure:p,annotations:$.annotations,update:performance.now()};n&&(iA.assets=Array.from(n)),N&&(iA.metadata=N),v.set(A,iA)}});this.transientInfo||=new Set,this.transientInfo.add(A),this.transientSaves=T,this.lastSnapshot={...this.lastSnapshot,depsGraph:I}}async create(A){return QA(()=>this.createLocked(A))}async createLocked(A){await this.whenInitialized();let{type:e,name:t,source:r,...o}=A,n=yA({type:e,name:t}),a=await this.compile({name:n,source:r,type:e,includeSourceMap:qc(e)}),i={localId:void 0,type:e,name:t,saveId:Cr(),moduleContent:a.code,sourceContent:r,sourceMapContent:a.sourceMap,submoduleContents:$B,binaryAssetContents:BB,imports:a.imports,exports:a.exportedNames,reExportedModules:a.reExportedModules,treeVersion:A.treeVersion||this.treeStore.remoteTreeVersion,sourceRevision:A.sourceRevision,svgIcon:A.svgIcon,kitSectionsStructure:A.kitSectionsStructure,annotations:a.annotations,update:performance.now()},s=await this.createBatchSaveForUpdatedModule("$new",i,this.persistedModules,new Map,new Map,{type:e,name:t,...o});E(!this.readOnlyTree,"modules storage is read only"),E(this.modulesService);let{data:l}=await this.modulesService.saveBatch({batch:[s]}),{updatedModuleLocalId:d,nextPersistedModules:p}=this.processTransientSaveData({nextPersistedModules:this.persistedModules,transientSave:i,data:l}),k=Go(this.lastSnapshot.depsGraph,n,a.imports.relative);return this.setNextInternalState({dependenciesModule:this.dependenciesModule,persistedModules:p,transientSaves:this.transientSaves,depsGraph:k,didRemoteChange:!0}),d}async update(A,e){let t=this.persistedModules.get(A);return E(t,"Trying to update an unknown module with localId:",A),QA(async()=>{let r=Date.now();try{return await this.whenInitialized(),await this.upsertBatchLocked({[A]:{...e,name:t.name,type:t.type}})}finally{let o=Date.now()-r;W.debug("\u23F1 update",A,"in",o,"ms")}})}async rename(A,e){return QA(()=>this.renameLocked(A,e))}async renameLocked(A,e){await this.whenInitialized();let t=this.persistedModules,r=this.lastSnapshot.depsGraph,o=t.get(A);E(o,"Trying to rename an unknown module with localId:",A);let n=this.treeStore.remoteTreeVersion,a=yA(o);E(!this.readOnlyTree,"modules storage is read only"),E(this.modulesService);let i=await this.modulesService.update({moduleId:o.id,name:e});E(i,"invalid update reply");let s=r[a]?.dependents,l=[],d={},p=yA(i);if(a!==p&&(r=$s(r,a),r=Go(r,p,o.imports.relative)),s){let k=[],g=[];for(let I of t.values()){let S=yA(I);s.has(S)&&(I.kind==="local"?k.push(I):g.push(I))}if(g.length>0){let I=await Promise.all(g.map(S=>this.createLocalModuleFromModule(S)));t=YA(t,S=>{for(let T of I)S.set(T.localId,T),k.push(T)})}let $=[];for(let I of k){let S=yA(I),T=W6(S,`${o.type}/${e}`);E(T,"Failed to create relative path to",o.type,"/",e);let v=W6(S,a);E(v);let P=I.imports.relative.indexOf(v);if(P===-1){W.warn(I.localId,"doesn't import",v);continue}let N=[...I.imports.relative];N[P]=T;let Q={absolute:I.imports.absolute,bare:I.imports.bare,relative:N},w=FB(I.sourceContent,v,T),iA=FB(I.moduleContent,v,T);d[I.localId]={sourceContent:w,moduleContent:iA,imports:Q},E(I.files.source);let z={type:I.type,moduleId:I.id,name:I.name,saveId:Cr(),patchSaveId:I.saveId,files:[{name:I.files.source,type:"source",content:w}],imports:Q};$.push(z)}E(!this.readOnlyTree,"modules storage is read only");let{data:F}=await this.modulesService.saveBatch({batch:$});l=F}t=YA(t,k=>{if(this.updateTreeNode(A,n,i)){o.kind==="server"?k.set(A,{...i,kind:"server",localId:i.localId,id:i.id,moduleURL:i.baseURL+i.files.module,sourceContent:o.sourceContent,update:performance.now()}):k.set(A,{...i,kind:"local",localId:i.localId,id:i.id,moduleURL:i.baseURL+i.files.module,sourceContent:o.sourceContent,moduleContent:o.moduleContent,sourceMapContent:o.sourceMapContent,submoduleContents:o.submoduleContents,binaryAssetContents:o.binaryAssetContents,update:performance.now()});for(let $ of l){let F=$.localId,I=k.get(F);E(I?.kind==="local","dependent module must be local:",F);let S=d[F];E(S,"dependent module update must exist:",F),this.updateTreeNode(F,n,$)&&(k.set(F,{...$,kind:"local",localId:F,id:$.id,moduleURL:$.baseURL+$.files.module,moduleContent:S.moduleContent,sourceContent:S.sourceContent,sourceMapContent:I.sourceMapContent,submoduleContents:I.submoduleContents,binaryAssetContents:I.binaryAssetContents,imports:S.imports,exports:$.exports,reExportedModules:$.reExportedModules,submodules:$.submodules,binaryAssets:$.binaryAssets,sourceRevision:I.sourceRevision,update:I.update}),r=Go(r,yA($),S.imports.relative))}}}),this.setNextInternalState({dependenciesModule:this.dependenciesModule,persistedModules:t,transientSaves:this.transientSaves,depsGraph:r,didRemoteChange:!0})}async upsert(A,e){return QA(async()=>{let t=Date.now();try{return await this.whenInitialized(),await this.upsertBatchLocked({[A]:e})}finally{let r=Date.now()-t;W.debug("\u23F1 upsert",A,"in",r,"ms")}})}async upsertBatch(A){return QA(async()=>{let e=Date.now();try{return await this.whenInitialized(),await this.upsertBatchLocked(A)}finally{let t=Date.now()-e;W.debug("\u23F1 upsert batch in",t,"ms")}})}async delete(A){return QA(()=>this.deleteLocked(A))}async deleteLocked(A){let e=Array.isArray(A)?A:[A];if(!e.length)return;await this.whenInitialized();let t=e.map(d=>{let p=this.persistedModules.get(d);return E(p,"Trying to delete an unknown module",d,"It was never persisted."),p}),{modulesService:r}=this;E(r);let o=await Promise.allSettled(t.map(d=>r.delete({moduleId:d.id}))),n=new Set,a=new Set;for(let d of o){if(d.status==="rejected"){W.warn(String(d.reason));continue}n.add(d.value.localId),a.add(d.value.id)}e=e.filter(d=>n.has(d)),t=t.filter(d=>a.has(d.id)),E(e.length>0,"Failed to delete module(s)");let i=this.lastSnapshot.depsGraph;for(let d of t){let p=yA(d);i=$s(i,p)}let s=YA(this.persistedModules,d=>{for(let p of e)d.delete(p),this.removeTreeNode(p)}),l=YA(this.transientSaves,d=>{for(let p of e)d.delete(p)});this.setNextInternalState({dependenciesModule:this.dependenciesModule,persistedModules:s,transientSaves:l,depsGraph:i,didRemoteChange:!0})}async publish(A,e){return QA(()=>this.publishLocked(A,e))}async publishLocked(A,{namespace:e,name:t,version:r}){await this.whenInitialized();let o=this.persistedModules.get(A);E(o,"Trying to publish an unknown module",A,"It was never persisted."),E(!this.readOnlyTree,"modules storage is read only"),E(this.modulesService);let n=await this.modulesService.publish({moduleId:o.id,saveId:o.saveId,namespace:e,name:t,version:r}),a=YA(this.persistedModules,i=>{let s=i.get(A);s&&i.set(A,{...s,lastPublish:{namespaceId:n.namespaceId,name:n.name,version:n.version,importURL:n.importURL}})});return this.setNextInternalState({dependenciesModule:this.dependenciesModule,persistedModules:a,transientSaves:this.transientSaves,depsGraph:this.lastSnapshot.depsGraph,didRemoteChange:!0}),n}async addNpmDependencies(A){return QA(async()=>{await this.whenInitialized();let e;this.dependenciesModule?.importMapContent?e=JSON.parse(this.dependenciesModule?.importMapContent):e={imports:{}};let t;this.dependenciesModule?.dependenciesMapContent?t=JSON.parse(this.dependenciesModule?.dependenciesMapContent):t={dependencies:{}};let r=Array.isArray(A)?A:[A];if(r=r.filter(i=>{if(an.has(i.target)||cn(i.target))return!1;let s=ln(i);return!e.imports[s]}),r.length===0)return{dependenciesMap:t};r=r.map(i=>{if(t.dependencies[i.target]){let l=e.imports[i.target]??Object.entries(e?.imports).find(([p])=>p.startsWith(i.target))?.[1];E(l,"The import map should contain a import that is in the dependencies map");let d=qk(l)?.version;return d?{...i,target:`${i.target}@${d}`}:i}let s=sn[i.target];return s?{...i,target:`${i.target}@${s}`}:i});let{importMap:o,resolvedDependencies:n}=await Dk(e,r,an,sn),a=await this.extendCurrentDependenciesMap(n);return n.forEach(({name:i,version:s})=>fA("npm_dependency_add",{name:i,semver:s})),W.debug({newImportMap:o,newDependenciesMap:a}),await this.updateDependenciesLocked(o,a),{dependenciesMap:a}})}async reinstallNpmDependencies(){return QA(async()=>{let{currentImportMap:A,currentDependenciesMap:e}=this.getCurrentDependencies();delete A.scopes;let{importMap:t}=await Nk(A,an,sn);return await this.updateDependenciesLocked(t,e),t})}async uninstallBlockedNpmDependencies(){return QA(async()=>{let{currentImportMap:A,currentDependenciesMap:e}=this.getCurrentDependencies(),t=U6(e),r=await Ok(A);return await this.updateDependenciesLocked(r,t),r})}async clearNpmDependencies(){return QA(async()=>this.updateDependenciesLocked({imports:{}},{dependencies:{}}))}async removeBlockedNpmDependencies(){return QA(async()=>{let{currentImportMap:A,currentDependenciesMap:e}=this.getCurrentDependencies(),t=U6(e);return await this.updateDependenciesLocked(A,e),t})}async rebuildImportMapFromDependencies(){return QA(async()=>{let A=this.dependenciesModule?.dependenciesMapContent,e=A?JSON.parse(A):{dependencies:{}},t=await Lk(e,an,sn);return await this.updateDependenciesLocked(t,e),t})}async unsafeUpgradeDependency(A,e,t){return QA(async()=>{let{currentImportMap:r,currentDependenciesMap:o}=this.getCurrentDependencies(),n=await wk(r,A,e,t),a=no(n),i=oo(a,o);return await this.updateDependenciesLocked(n,i),n})}async extendCurrentImportMap(A,e){return QA(async()=>{let{currentImportMap:t,currentDependenciesMap:r}=this.getCurrentDependencies(),o=ro(t,A),n=oo(r,e);return this.updateDependenciesLocked(o,n)})}async extendCurrentDependenciesMap(A){let e={};for(let r of A)e[r.name]=r.version;let t=this.dependenciesModule?.dependenciesMapContent?JSON.parse(this.dependenciesModule?.dependenciesMapContent):{dependencies:{}};return t.dependencies=Object.assign(e,t.dependencies),t}getCurrentDependencies(){let A=this.dependenciesModule?.importMapContent?JSON.parse(this.dependenciesModule?.importMapContent):{imports:{}},e=this.dependenciesModule?.dependenciesMapContent?JSON.parse(this.dependenciesModule?.dependenciesMapContent):{dependencies:{}};return{currentImportMap:A,currentDependenciesMap:e}}async updateDependenciesLocked(A,e){let t=JSON.stringify(A,null,4),r=JSON.stringify(e,null,4);if(t===this.dependenciesModule?.importMapContent&&r===this.dependenciesModule?.dependenciesMapContent)return;let o={moduleId:"$upsertName",name:Js,saveId:Cr(),type:"config",files:[{name:"importMap.json",type:"importMap",content:t},{name:"dependencies.json",type:"dependencies",content:r}],imports:{absolute:[],relative:[],bare:[]}};E(!this.readOnlyTree,"modules storage is read only"),E(this.modulesService);let{data:[n]}=await this.modulesService.saveBatch({batch:[o]});E(n,"Modules API must return an updated import map after savebatch"),this.updateTreeNodeWithOwnTreeVersion(ge,n);let a={kind:"dependencies",importMapContent:t,dependenciesMapContent:r,...n,id:n.id,localId:n.localId,type:n.type,name:n.name};this.setNextInternalState({dependenciesModule:a,persistedModules:this.persistedModules,transientSaves:this.transientSaves,depsGraph:this.lastSnapshot.depsGraph,didRemoteChange:!0})}getPersistedDependenciesModule(){return this.dependenciesModule}getPersistedModuleByGlobalId(A){for(let e of this.persistedModules.values())if(e.id===A)return e}getPersistedModuleByLocalId(A){return this.persistedModules.get(A)}getTransientSaveByLocalId(A){return this.transientSaves.get(A)}async handleRemoteModuleDeleteEvents(A){if(!this.useTreeAsLocalModuleList)return this.handleRemoteModuleDeletes(A.map(e=>e.id))}async handleRemoteModuleDeletes(A){await QA(async()=>{let e=[],t=[];for(let a of A){let i=this.getPersistedModuleByGlobalId(a);i&&(t.push(yA(i)),e.push(i.localId))}let r=YA(this.persistedModules,a=>{for(let i of e)a.delete(i)}),o=YA(this.transientSaves,a=>{for(let i of e)a.delete(i)}),n=this.lastSnapshot.depsGraph;for(let a of t)n=$s(n,a);this.setNextInternalState({dependenciesModule:this.dependenciesModule,persistedModules:r,transientSaves:o,depsGraph:n,didRemoteChange:!0})})}async handleRemoteModuleSaveEvents(A){if(!this.useTreeAsLocalModuleList)return this.handleRemoteModuleSaves(A.map(e=>e.module))}async handleRemoteModuleSaves(A){let e=[],t=[];for(let n of A)yA(n)===ge?e.push(n):t.push(n);let r,o=e.length>0?e[e.length-1]:void 0;if(o){let{importMapContent:n,dependenciesMapContent:a}=await this.getDependenciesFiles(o);E(a,"No dependencies file exists for the remote update!"),r={kind:"dependencies",...o,id:o.id,localId:o.localId,type:"config",name:o.name,importMapContent:n,dependenciesMapContent:a}}await QA(async()=>{r&&(this.dependenciesModule=r);let n=this.persistedModules,a=this.lastSnapshot.depsGraph,i=await Promise.all(t.map(s=>this.createServerModuleFromData(s)));for(let s of i){let l=yA(s),d=s.localId;n=YA(n,p=>{p.set(d,s)}),this.transientSaves.has(d)||(a=Go(this.lastSnapshot.depsGraph,l,s.imports.relative))}this.setNextInternalState({dependenciesModule:this.dependenciesModule,persistedModules:n,transientSaves:this.transientSaves,depsGraph:a,didRemoteChange:!0,multiplayerChange:!0})})}getPatchTransientSave(A,e,t){return{saveId:t,type:e.type,name:e.name,localId:A,moduleContent:e.moduleContent,sourceContent:e.sourceContent,sourceMapContent:e.sourceMapContent,submoduleContents:e.submoduleContents,binaryAssetContents:e.binaryAssetContents,imports:e.imports,exports:e.exports,reExportedModules:e.reExportedModules,sourceRevision:e.sourceRevision,update:e.update}}async upsertBatchLocked(A){if(this.readOnlyTree)return;let e=this.persistedModules,t=new Map,r=[],o=new Map;for(let d of e.values()){let p=yA(d);o.set(p,d.localId),r.push([p,d.imports.relative])}let n=new Map;for(let d in A){let p=d,k=A[p];E(k,"No persist params found for",p);let g=this.transientSaves.get(p),$=g??e.get(p);E($,"No module found for",p);let F=yA($);n.set(F,g?.saveId??Cr()),t.set(F,Xj(k.name)),o.set(F,p),g&&r.push([F,g.imports.relative])}let a=Tc(r),i=new Map,s=YA(this.transientSaves,d=>{for(let p in A)d.delete(p)}),l;try{let{batch:d,nextPersistedModules:p}=await this.createBatch(A,i,e,a,o,n,t);E(!this.readOnlyTree,"modules storage is read only"),E(this.modulesService);let{data:k}=await this.modulesService.saveBatch({batch:d});e=YA(p,g=>{for(let $ of k.values()){let F=$.localId,I=i.get(F);if(!I){let Q=g.get(F);E(Q,F,"is not in persistedModules"),this.updateTreeNodeWithOwnTreeVersion(F,$),Q.saveId=$.saveId,Q.moduleURL=$.baseURL+$.files.module;continue}let S={kind:"local",...$,id:$.id,localId:$.localId,imports:I.imports,moduleURL:$.baseURL+$.files.module,sourceContent:I.sourceContent,sourceMapContent:I.sourceMapContent,moduleContent:I.moduleContent,submoduleContents:I.submoduleContents,binaryAssetContents:I.binaryAssetContents,sourceRevision:I.sourceRevision,annotations:I.annotations,update:I.update},T=A[F]?.errors,v=I.kitSectionsStructure,P=I.treeVersion??this.treeStore.remoteTreeVersion;if(!this.updateTreeNode($.localId,P,S,T,v))return;g.set(F,S)}})}catch(d){e=this.persistedModules;let p=Array.from(i.values()).map(F=>F.saveId).join("-"),k=this.transientSaveRetries.get(p)??0,{error:g,dropTransient:$}=this.handlePersistenceError(d,k,()=>{this.transientSaveRetries.set(p,k+1),setTimeout(async()=>{let F=Object.entries(i).every(([I,S])=>{let T=I,v=this.transientSaves.get(T);return v&&v.saveId===S.saveId});Bs(g)&&(this.transientSaveRelativeImportRetries.add(p),await this.refresh()),F&&(W.debug("retrying saving batchId with id:",p),this.upsertBatchLocked(A))},1e3+k*1e3)});if(!$)return;l=g}if(this.setNextInternalState({dependenciesModule:this.dependenciesModule,persistedModules:e,transientSaves:s,depsGraph:this.lastSnapshot.depsGraph,didRemoteChange:!0}),l)throw l}async createBatch(A,e,t,r,o,n,a){let i=[];for(let p in A){let k=p,g=A[k];E(g,"No persist params found for",k);let $=this.transientSaves.get(k);if(!$){let I=t.get(k);E(I,`Trying to persist ${k} but it doesn't have neither a corresponding transient save nor an existing persisted module.`),I.kind==="server"&&(I=await this.createLocalModuleFromModule(I),t=YA(t,T=>{I&&T.set(I.localId,I)}));let S=n.get(k);E(S,"No save id found for",k),$=this.getPatchTransientSave(k,I,S)}e.set(k,$);let F=await this.createBatchSaveForUpdatedModule(this.persistedModules.get(k)?.id??"$upsertName",$,t,n,a,g);i.push(F)}let s=new Map;for(let p in A){let k=p,g=A[k];E(g,"No persist params found for",k);let $=yA(g),F=new Set;br(r,$,F),s.set(k,F)}let l=[];for(let p of s.values())for(let k of p){let g=o.get(k);E(g,"Cannot find localId for",k);let $=t.get(g);$?.kind==="server"&&l.push(this.createLocalModuleFromModule($))}if(l.length>0){let p=await Promise.all(l);t=YA(t,k=>{for(let g of p)k.set(g.localId,g)})}for(let p of s.values())for(let k of p)n.has(k)||n.set(k,Cr());let d=new Set;for(let[p,k]of s){let[g]=ca(p);for(let $ of k){let F=o.get($);if(E(F,"Cannot find localId for",$),e.has(F)||d.has($)||t.get(F)?.metadata.localModuleImportMapEntries===!0&&this.moduleUsesLocalImportMapSpecifiers($)&&(g!=="codeFile"||!r[$]?.dependencies.has(p)))continue;d.add($);let T=await this.createBatchSaveForDependentModule(F,t,n,a);i.push(T)}}return{batch:i,nextPersistedModules:t}}handlePersistenceError(A,e,t){let r=A instanceof Error?A.message:"",o=A instanceof Hs?A.code:0,n=A instanceof Hs?A.status:0,a=o===1002,i=o===-1e3,s=n>=300&&n!==400&&n!==403,l=i||s||Bs(A),d=20,p=2;if(Bs(A)&&XA.isOn("retryRelativeImportRewriting"))return!l||e>=p?(W.reportError("Relative imports error, exceeded max retries, making document read only:",{missing:A.persistedMissingRelativeImports}),this.makeDocumentReadOnly(),vA({type:"add",variant:"warning",text:"Framer can\u2019t save your latest changes. Please reload the page to continue working.",key:"client-outdated",duration:Number.POSITIVE_INFINITY,icon:"warning",showCloseButton:"never",action:{title:"Reload",onClick:()=>{W.reportError("ModulesStorage: Reloaded due to relative imports error.",{missing:A.persistedMissingRelativeImports}),window.top.location.reload()}}}),{error:A,dropTransient:!0}):(W.debug("Relative imports error, will retry:",{missing:A.persistedMissingRelativeImports}),t(),{error:A,dropTransient:!1});if(a&&e>0)W.debug("Ignoring duplicated save id.");else{if(a)return W.debug("Duplicate save id error, will drop transient save:",A),{error:A,dropTransient:!0};if(l&&e<d)return W.info("Connection error, will retry:",{message:r,code:o,status:n,retryCount:e}),t(),{dropTransient:!1};if(l)W.error("Error saving: too many retries, will drop transient save:",{message:r,code:o,status:n,retryCount:e});else return W.debug("Error saving, will drop transient save:",A),{error:A,dropTransient:!0}}return{dropTransient:!1}}moduleUsesLocalImportMapSpecifiers(A){let[e,t]=ca(A);if(e==="layoutTemplate")return!0;if(e==="collection")return XA.isOn("collectionLocalModuleImportMapEntries");if(e==="screen"){let r=this.treeStore.tree.get(t);if(Cj(r)||V(r))return!0}return!1}processTransientSaveData({nextPersistedModules:A,transientSave:e,data:t},r,o){let n=e.treeVersion??this.treeStore.remoteTreeVersion,a;return A=YA(A,i=>{let s=t.values(),l=s.next().value;a=l.localId;let d={kind:"local",...l,id:l.id,localId:a,imports:e.imports,moduleURL:l.baseURL+l.files.module,sourceContent:e.sourceContent,sourceMapContent:e.sourceMapContent,moduleContent:e.moduleContent,submoduleContents:e.submoduleContents,binaryAssetContents:e.binaryAssetContents,sourceRevision:e.sourceRevision,annotations:e.annotations,update:e.update};if(this.updateTreeNode(l.localId,n,d,r,o)){i.set(a,d);for(let k of s){let g=i.get(k.localId);E(g,k.localId,"is not in persistedModules"),this.updateTreeNodeWithOwnTreeVersion(k.localId,k),g.saveId=k.saveId,g.moduleURL=k.baseURL+k.files.module}}}),E(a,"Updated module",e,"is not found in the response"),{nextPersistedModules:A,updatedModuleLocalId:a}}setNextInternalState({dependenciesModule:A,persistedModules:e,transientSaves:t,depsGraph:r,didRemoteChange:o,multiplayerChange:n=!1}){this.dependenciesModule=A,this.persistedModules=e,this.transientSaves=t;let a=hB(A,this.lastSnapshot.dependenciesModule,e,t,r,this.lastSnapshot.modules,this.initialized,o,n),i=this.lastSnapshot.initialized;this.lastSnapshot={dependenciesModule:a.dependenciesModule,modules:a.modules,depsGraph:a.depsGraph,initialized:a.initialized},!(a.metadata.patches.length===0&&a.initialized===i)&&this.notifyListeners(a)}async createLocalModuleFromModule(A){W.debug("compiling server module:",A.localId);let e=A.sourceContent;e||(e=await this.fetchSourceContentFromData(A));let t={},r={},o=this.downloadQueue,n=new Array;for(let s of A.submodules)n.push(o.run(async()=>{let l=await fetch(A.baseURL+s);t[s]=await l.text()}));for(let s of A.binaryAssets)n.push(o.run(async()=>{let d=await(await fetch(A.baseURL+s)).arrayBuffer();r[s]=new Uint8Array(d)}));await Promise.all(n);let a=yA(A),i=await this.compile({localId:A.localId,name:a,source:e,type:A.type,includeSourceMap:qc(A.type)});for(let[s,l]of this.lazyServerModulesForTransientSaves)l.delete(a),l.size===0&&this.lazyServerModulesForTransientSaves.delete(s);return{...A,kind:"local",id:A.id,localId:A.localId,sourceContent:e,moduleContent:i.code,sourceMapContent:i.sourceMap,submoduleContents:t,binaryAssetContents:r,imports:i.imports,sourceRevision:Hc(A),annotations:i.annotations}}async createBatchSaveForUpdatedModule(A,e,t,r,o,n){let a=yA(e),{localId:i,moduleContent:s,sourceContent:l,sourceMapContent:d,submoduleContents:p={},binaryAssetContents:k={},metadata:g,sourceRevision:$,imports:F,type:I,name:S,annotations:T,update:v,...P}=e;switch(A){case"$new":E(i===void 0,`Attempted to create ${a} but it already has localId: ${i}`);break;case"$upsertName":default:E(i!==void 0,`The transient save for the provided moduleId: ${A} doesn't have localId`)}let{type:N,name:Q,metadata:w,files:iA,...z}=n;E(N===I&&Q===S,`Mismatched type/name between save and parameters: ${N}/${Q} !== ${I}/${S}`);let pA=Xj(Q),D=s;F.relative.length>0&&(D=await this.replaceRelativeImportsWithAbsolute(a,s,F.relative,t,r,wo(p),o)),d&&(D+=`
//# sourceMappingURL=./${pA.sourceMap}`);let J=(iA??[]).concat([{name:pA.module,type:"module",content:D},{name:pA.source,type:"source",content:l}]);d&&J.push({name:pA.sourceMap,type:"sourceMap",content:d});for(let[Z,sA]of Object.entries(p))J.push({name:Z,type:"submodule",content:sA});for(let[Z,sA]of Object.entries(k))J.push({name:Z,type:"binaryAsset",bytes:sA});let H={};if(g||w)if(i){let Z=t.get(i);E(Z||A==="$upsertName",`Cannot safely update metadata for ${A} (${i})`),H.metadata={...Z?.metadata,...g,...w,sourceRevision:$}}else H.metadata={...g,...w,sourceRevision:$};return{...P,moduleId:A,type:N,name:Q,files:J,imports:F,...z,...H}}async createBatchSaveForDependentModule(A,e,t,r){let o=e.get(A);E(o,A,"is not found in persistedModules"),E(o.kind==="local","persisted module is not a local module");let n=yA(o),a=Xj(o.name),i=o.imports,s=o.moduleContent;i.relative.length>0&&(s=await this.replaceRelativeImportsWithAbsolute(n,o.moduleContent,i.relative,e,t,wo(o.submoduleContents),r));let l=t.get(n);E(l,"newSaveIds don't contain saveId for",n);let d={},p=this.moduleUsesLocalImportMapSpecifiers(n);return o.metadata.localModuleImportMapEntries!==p&&(d.metadata={...o.metadata,localModuleImportMapEntries:p}),{type:o.type,moduleId:o.id,name:o.name,saveId:l,patchSaveId:o.saveId,files:[{name:a.module,type:"module",content:s}],imports:i,...d}}findPersistedModuleLocalIdByTypeSlashName(A,e){return this.ensurePersistedLocalIdsByTypeSlashNameCacheFor(A).get(e)}ensurePersistedLocalIdsByTypeSlashNameCacheFor(A){let e=this.persistedLocalIdsByTypeSlashNameCache.get(A);if(!e){e=new Map;for(let[t,r]of A.entries())e.set(yA(r),t);this.persistedLocalIdsByTypeSlashNameCache.set(A,e)}return e}async replaceRelativeImportsWithAbsolute(A,e,t,r,o,n,a){let{modulesCDN:i}=Be(),s={};for(let $ of n){let F=Ca($);s[F]=F}let l=this.moduleUsesLocalImportMapSpecifiers(A),d=new Set;for(let $ of t){if($ in s)continue;let F=me($,A);if(!F)continue;let I=this.findPersistedModuleLocalIdByTypeSlashName(r,F);if(!I){d.add(F),W.error("Cannot resolve",$,"from",A);continue}let S=r.get(I);E(S);let{id:T,files:v}=S,P=o.get(F)??S.saveId,N=a?.get(F)?.module??v.module;E(_(N),"Must have a module file name to build a local module import map specifier."),s[$]=l?mi(I,N):`${i}/${T}/${P}/${N}`}let p=await gs(e,s);if(p.ok)return p.value;if(A.startsWith("codeFile"))return p.error.partiallyProcessedCode;let k=new Set,g=this.treeStore.tree;for(let $ of p.error.unresolvedRelativeImports){let F=me($,A);if(!F)continue;let[I]=ca(F);if(!(I==="codeFile"||!g.getNodeWithTrait(F,vt))){k.add(F);break}}if(k.size===0)return W.reportError("Failed to rewrite relative imports due to unpersisted relative dependencies",{relativeImports:t,unresolved:Array.from(p.error.unresolvedRelativeImports)}),p.error.partiallyProcessedCode;if(W.reportError("Failed to rewrite relative imports",{typeSlashName:A,missing:Array.from(k)}),!XA.isOn("retryRelativeImportRewriting"))return p.error.partiallyProcessedCode;throw new Qn(k)}async getDependenciesFiles({baseURL:A,files:e}){let[t,r]=await Promise.allSettled([fetch(A+e.importMap).then(a=>{if(a.ok!==!0)throw new Error("failed to load importMap file");return a.text()}),fetch(A+e.dependencies).then(a=>{if(a.ok!==!0)throw new Error("failed to load dependencies file");return a.text()})]);E(t.status==="fulfilled","The importMap has to exist on the module");let o=t.value,n;return r.status==="fulfilled"?n=r.value:W.warn("No dependencies file was found!"),{importMapContent:o,dependenciesMapContent:n}}};function iG(j,A){return`${Be().modulesCDN}/${A.id}/${j.saveId}/${A.files.module}`}function hB(j,A,e,t,r,o,n,a,i){let s=new Set(o.keys()),l=new Set(t.keys()),d=[],[p,k]=Ta(o,F=>{for(let I of e.values()){let S=I.localId,T=yA(I),v=t.get(S),P;if(v)P={kind:"local",localId:S,type:v.type,name:v.name,moduleURL:iG(v,I),moduleContent:v.moduleContent,sourceContent:v.sourceContent,sourceMapContent:v.sourceMapContent,submoduleContents:v.submoduleContents,binaryAssetContents:v.binaryAssetContents,relativeImports:v.imports.relative,files:I.files,sourceRevision:v.sourceRevision,kitSectionsStructure:v.kitSectionsStructure,svgIcon:v.svgIcon,update:v.update};else{let N=Hc(I);P=I.kind==="local"?{kind:"local",localId:S,type:I.type,name:I.name,moduleURL:I.moduleURL,moduleContent:I.moduleContent,sourceContent:I.sourceContent,sourceMapContent:I.sourceMapContent,submoduleContents:I.submoduleContents,binaryAssetContents:I.binaryAssetContents,relativeImports:I.imports.relative,files:I.files,sourceRevision:N,svgIcon:void 0,kitSectionsStructure:void 0,update:I.update}:{kind:"server",localId:S,type:I.type,name:I.name,moduleURL:I.moduleURL,sourceContent:I.sourceContent,relativeImports:I.imports.relative,files:I.files,sourceRevision:N,update:I.update}}RB(F,T,P),l.delete(S),s.delete(T)}for(let I of l){let S=t.get(I);if(E(S),!S.localId)continue;let T=Xj(S.name),v={kind:"local",localId:S.localId,type:S.type,name:S.name,moduleURL:`./transient/${S.saveId}/${T.module}`,moduleContent:S.moduleContent,sourceContent:S.sourceContent,sourceMapContent:S.sourceMapContent,submoduleContents:S.submoduleContents,binaryAssetContents:S.binaryAssetContents,relativeImports:S.imports.relative,files:T,sourceRevision:S.sourceRevision,svgIcon:S.svgIcon,kitSectionsStructure:S.kitSectionsStructure,update:S.update};RB(F,I,v),s.delete(yA(v))}for(let I of s)F.delete(I),d.push(I)}),g={};for(let F of d){let I=o.get(F);I&&(g[F]=I.localId)}let $=YA(A,F=>{if(j){if(!F)return{kind:"dependencies",localId:ge,type:j.type,name:j.name,importMapContent:j.importMapContent,dependenciesMapContent:j.dependenciesMapContent};F.importMapContent=j.importMapContent,F.dependenciesMapContent=j.dependenciesMapContent}});return $&&$!==A&&k.push({op:A?"replace":"add",path:[yA($)],value:$}),{dependenciesModule:$,modules:p,deletedLocalIdsByTypeSlashNames:g,depsGraph:r,initialized:n,metadata:{patches:k,hasLocalChanges:t.size>0,didRemoteChange:a,multiplayerChange:i}}}function RB(j,A,e){let t=j.get(A);if(!t){j.set(A,e);return}if(t.kind!==e.kind){j.set(A,e);return}if(t.kind==="server"){E(e.kind==="server"),IB(t,e);return}E(e.kind==="local"),aG(t.relativeImports,e.relativeImports)||(t.relativeImports=e.relativeImports),m7(t.files,e.files)||(t.files=e.files);let{relativeImports:r,files:o,...n}=e;IB(t,n)}function IB(j,A){Object.assign(j,A)}function aG(j,A){if(!j&&!A)return!0;if(j&&A){let e=j.length;if(e!==A.length)return!1;for(let t=0;t<e;t++)if(j[t]!==A[t])return!1;return!0}else return!1}function sG(j){return j.type==="save"}function lG(j){return j.type==="delete"}function Cr(){return On()}function qc(j){return j==="codeFile"||j==="canvasComponent"}function FB(j,A,e){return j.replace(new RegExp(`\\b(from\\s*)(["'])${wc(A)}\\2`,"g"),`$1${JSON.stringify(e)}`)}function cG(j,A){switch(j){case"canvasComponent":case"layoutTemplate":case"screen":case"prototype":case"collection":case"draftCollection":case"webPageMetadata":case"siteMetadata":case"vector":case"vectorSet":return A.default;case"codeFile":case"css":case"componentPresets":case"config":case"localization":case"design":return Object.values(A)[0];default:lA(j)}}function GB(j,A){if(!j||j.length===0)return A?.placeholder??"";if(j.length===1)return j[0]&&j[0]!==""?j[0]:A?.placeholder??"";let e=[...j],t="";if(A?.max&&A.max<j.length){let r=j.length-A.max;e=e.slice(0,A.max),t=`${r} ${r>1?"others":"other"}`}else t=e.pop()??"";return e.length>1?`${e.join(", ")}, and ${t}`:`${e.join(", ")} and ${t}`}var wU=Oe("componentPresets","componentPresets");function SB(j,A){let e=j.getPresetsListNode();return e?e.getComponentPresets().find(t=>t.componentIdentifier===A)??null:null}function yB(j,A){let{treeStore:e}=j.stores;if(e.tree.has(A.id))return;let t=SB(e.tree,A.componentIdentifier),r=mr(e.tree),o=Uu(r.children,a=>Vr(a)&&a.componentIdentifier!==A.componentIdentifier);o!==-1&&(o+=1),e.tree.insertNode(A,r.id,o),lo(j)&&j.stores.codeGenerationStore.createModuleFromComponentSource(r).catch(SA),ce(A.componentIdentifier)&&j.stores.modulesStore.addExternalModulesToProject([A.componentIdentifier],{onTreeUpdate(){}});let n=zo(A.componentIdentifier);t||j.runWithFullyLoadedTree(()=>{let a=e.getLoadedIndexes();for(let i of a.richTextNodes)i.htmlContent&&Ee(e.tree,i,n)&&i.setComponentPreset(A.componentIdentifier,A.id)},{runInBackground:!0,name:"insertComponentPreset"})}function dG(j,A){if(SB(j.tree,A.componentIdentifier))return;let t=el.createDefault(A);yB(j,t)}function LU(j,A,e){j.processWhenReady(()=>{let r=mr(j.tree).getComponentPresets(),o=new Set;for(let a of r)a.name&&o.add(a.name);let n=el.createDefault(A,{name:Nj(A.name,o)});yB(j,n);try{e&&e(n)}catch{}})}function qU(j,A){return j.getPresetsListNode()?.getComponentPresets().filter(t=>t.componentIdentifier===A)??[]}function bB(j,A,e){let t=AA(A);function r(n){let a=AA(n);return a.kind==="externalModuleExport"&&t.kind==="externalModuleExport"&&a.moduleId===t.moduleId&&a.exportSpecifier===t.exportSpecifier}let o=j.getPresetsListNode();if(o){let n=o.getComponentPresets();for(let a of n)r(a.componentIdentifier)&&a.set({componentIdentifier:e})}E(!j.getService("loader"),"Tree should be fully loaded");for(let n of j.root.walk()){if(!JA(n))continue;let a=n.getComponentPresets();for(let[i,s]of a){let l=zo(i);r(i)&&Ee(j,n,l)&&(n.setComponentPreset(e,s),n.setComponentPreset(i,void 0))}}}function KU(j,A,e){let t=A.find(r=>r.componentIdentifier===e);t&&dG(j,t)}function zn(j){let A=AA(j);if(!(!A||!cj(A)||!ce(A)))return`${A.moduleId}:${A.exportSpecifier}`}function CB(j){let A=new Map;for(let e of j){let t=zn(e);t&&A.set(t,e)}return A}function vB(j,A){let e=j.getRawControlProps();for(let t in e){let r=e[t]?.type,o=e[t]?.value;if(r!=="vectorsetitem"||!_(o)||!cj(o))continue;let n=zn(o);if(!n||!A.has(n))continue;let a=A.get(n);a&&j.setControlProp(t,{type:"vectorsetitem",value:a})}}function TB(j,A){for(let e of A){vB(e,j);let t=zn(e.codeComponentIdentifier);if(!t||!j.has(t))continue;let r=j.get(t);r&&e.set({codeComponentIdentifier:r})}}function PB(j,A){let e=A.getContentManagementNode();if(e){E(e.isLoaded(),"CMS Should always be loaded.");for(let{node:t,skipChildren:r}of e.walkWithSkipChildren()){if(tj(t)){if(!t.variables.some(a=>a.type==="vectorsetitem")){r();continue}MB(t,j)}if(!ue(t))continue;let o=t.getControlProps();for(let n in o){let a=o[n]?.value;if(o[n]?.type!=="vectorsetitem"||!_(a)||!cj(a))continue;let s=zn(a);if(!s||!j.has(s))continue;let l=j.get(s);l&&t.setControlProp(n,{...o[n],value:l})}}}}function MB(j,A){let e=!1,t=j.variables.map(r=>{if(r.type!=="vectorsetitem")return r;let{initialValue:o}=r,n=o.identifier;if(!n)return r;let a=zn(n);if(!a||!A.has(a))return r;let i=A.get(a);return i?(e=!0,{...r,initialValue:{...o,identifier:i}}):r});e&&j.set({variables:t})}function _B(j,A){for(let e of A.root.children){if(V(e)){vB(e,j);continue}(tA(e)||ij(e))&&MB(e,j)}}function DB(j,A){let e=0,t,r=(...n)=>{e=Date.now(),t=void 0,j(...n)};function o(...n){let a=Date.now(),i=A-(a-e);i<=0||i>A?(t&&(window.clearTimeout(t),t=void 0),e=a,j.apply(this,n)):t||(t=window.setTimeout(r,i,...n))}return o.cancel=()=>{t&&(window.clearTimeout(t),t=void 0)},o}var Fj=kA("modules-store"),NB=new Set(["codeFile","canvasComponent","screen","layoutTemplate","vector"]),pG=500;function Qc(j){let{module:A,exportSpecifier:e}=j,{id:t,saveId:r,files:o}=A;return E(o.module,"module file must exist for a saved module"),ee(t,r,o.module,e)}var bo,Yn,Zn,xt,xB=class extends ae{constructor(e,t,r,o,n,a,i){super();this.treeStore=e;this.loadedExternalModulesStore=t;this.chromeStore=r;this.modulesAPIServicePromise=o;this.makeDocumentReadOnly=n;this.insertTemporaryImportMap=a;this.loadAllLocalModules=i;R(this,"dependenciesModule");R(this,"localModules",new Map);R(this,"fastRefreshModules",new Map);R(this,"externalModulesDynamicInfo",new Map);R(this,"revision",0);xA(this,bo,new Map);R(this,"moduleDepsGraph",{});R(this,"modulesStorage");R(this,"moduleUpdatesEmitter",new we);R(this,"fastRefreshModulesEmitter",new we);xA(this,Yn);xA(this,Zn,new Map);xA(this,xt,new Map);R(this,"debugModuleStoreAndComponentLoaderRevisionsMatch",()=>this.revision===K.modulesRevision);R(this,"checkForExternalModuleUpdates",async()=>{if(this.treeStore.tree.isViewOnly)return;let e=this.treeStore.tree.getExternalModulesListNode();if(!e||!e.children?.length)return;let t=[],r=new Map;e.children.forEach(i=>{let s=AA(i.codeComponentIdentifier);if(E(s?.kind==="externalModuleExport","expected ExternalModuleNode identifier to be of kind externalModuleExport"),i.type==="vector"){let l=i.annotation("framerVector");if(!aa(l))return;let d=l.set.moduleId,p=r.get(d)??[];p.push(s),r.set(d,p)}else t.push(s)});for(let[i,s]of r){let l=this.treeStore.tree.get(i);if(!Je(l))continue;let d=l.annotation("framerVectorSet");V6(d)&&(yk(d)||t.push(...s))}let o=t.map(({moduleId:i,saveId:s})=>({moduleId:i,saveId:s}));if(!o.length)return;let n=[],a=[];for(let i=0;i<o.length;i++){let s=o[i];if(E(s,"query is expected to be defined."),n.push(s),n.length<pG&&i<o.length-1)continue;let{modules:l}=await this.lookUpModules(n,{includeStatus:!0});a.push(...l),n=[]}this.treeStore.tree.isViewOnly||this.updateExternalModuleNodes(a.map((i,s)=>{let l=t[s];return E(l,"External module missing a matching identifier"),{module:i,exportSpecifier:l.exportSpecifier}}),{onTreeUpdate(){}}).catch(SA)});R(this,"updatesPollId");R(this,"compileFastRefreshModule",async({localId:e,name:t,source:r,includeSourceMap:o=!0})=>{let{type:n,name:a}=ui(e);if(!NB.has(n))return;let i=n==="codeFile"?Xj(t).source:a,{code:s,imports:l,sourceMap:d}=await P$({localId:e,source:r,name:i,includeSourceMap:o}),p={kind:"fast-refresh",localId:e,type:n,name:i,sourceContent:r,moduleContent:s,relativeImports:l.relative,sourceMapContent:d,binaryAssetContents:void 0,submoduleContents:{},update:0},[k,g]=Ta(this.fastRefreshModules,$=>{$.set(t,p)});this.fastRefreshModules=k,this.fastRefreshModulesEmitter.emit({patches:g,dependentModules:[],prioritizedModules:[],revision:++this.revision,initialized:!0})});R(this,"compile",({localId:e,name:t,source:r,includeSourceMap:o=!0,type:n,telemetrySession:a})=>{let i=M$({name:t,source:r,includeSourceMap:o,type:n,telemetrySession:a});return this.fastRefreshEnabled&&e&&this.compileFastRefreshModule({localId:e,name:t,source:r,includeSourceMap:o}).catch(SA),i});this.modulesStorage=new Is(()=>this.modulesAPIServicePromise.catch(s=>{throw Fj.error(s,{context:"Failed to discover ModulesAPI service:"}),s}),this.compile,this.process,this.processWhenReady,this.signalNonUserEvent,this.runWhenIdle,e,()=>this.getActiveScope(),()=>this.makeDocumentReadOnly()),this.fastRefreshModulesEmitter.onNewStream=s=>(Fj.debug("onNewStream - fast refresh",s),{latest:this.getAllModulesAsUpdateEvent(!0)}),this.moduleUpdatesEmitter.onNewStream=s=>(Fj.debug("onNewStream - module updates",s),{latest:this.getAllModulesAsUpdateEvent(!1)}),this.modulesStorage.subscribe(s=>{let l=s.dependenciesModule?.importMapContent,d=this.dependenciesModule?.importMapContent,p=!1,k=!1,g=!1,$=!1;if(l&&d&&l!==d){let N=JSON.parse(l),Q=d?JSON.parse(d):void 0;for(let[w,iA]of Object.entries(N.imports??{})){eA(this,bo).set(w,"success");let z=Q?.imports?.[w];if(!z){p=!0;continue}z!==iA&&(k=!0)}g=!k&&!p,$=s.metadata.multiplayerChange||k||g}$&&s.metadata.multiplayerChange,this.dependenciesModule=s.dependenciesModule,this.localModules=s.modules;let F=this.moduleDepsGraph;this.moduleDepsGraph=s.depsGraph;let I=new Set,S=[],T=[],v=!1;for(let N of s.metadata.patches){let Q=N.path[0];if(E(typeof Q=="string"),Q===ge){v=!0;for(let w of s.modules.keys())I.add(w);break}N.op==="remove"&&N.path.length===1?T.push(Q):S.push(Q)}let P=new Set;if(!v){let N=this.getActiveScope(),Q=Hn(N);Fj.debug("Calculated visible code component module typeSlashNames",Q);for(let w of S)br(s.depsGraph,w,I,Q,P);for(let w of T)br(F,w,I,Q,P);S.forEach(w=>{I.delete(w)}),T.forEach(w=>{I.delete(w),P.delete(w)})}Fj.debug("prioritized evaluation sending to sandbox",{dependentModules:I,visibleDependentModules:P},"highprio size",P.size,"dep size",I.size),this.moduleUpdatesEmitter.emit({patches:s.metadata.patches,dependentModules:Array.from(I),prioritizedModules:Array.from(P),revision:++this.revision,initialized:s.initialized})})}getActiveScope(){if(this.chromeStore.mainView===5)return;let e=this.treeStore.tree.getNode(eA(this,Yn));if(e)return E(e?.loaded,"Active scope node should be loaded"),e.loaded}setActiveScope(e){hA(this,Yn,e)}initialize(){return this.initialized?this.modulesStorage.refresh():(this.setupPollingExternalModulesUpdates(),this.modulesStorage.initialize())}get initialized(){return this.modulesStorage.initialized}whenInitialized(){return this.modulesStorage.whenInitialized()}whenIdle(){return this.modulesStorage.whenIdle()}refresh(){return this.modulesStorage.refresh()}deleteModules(e){return this.modulesStorage.delete(e)}upsertBatch(e){return this.modulesStorage.upsertBatch(e)}forType(e){return new Wn(this.modulesStorage,e,this.debugModuleStoreAndComponentLoaderRevisionsMatch)}getNpmDependencyInstallStatus(e){return eA(this,bo).get(ln(e))??"unknown"}async addNpmDependencies(e){let r=typeof this.dependenciesModule>"u"&&!S$(),o=await uB(this.modulesStorage.addNpmDependencies(e)),n=Array.isArray(e)?e:[e],a=n.filter(({target:l})=>!cn(l));for(let l of a)eA(this,bo).set(ln(l),o.ok?"success":"failure");if(!o.ok)throw o.error;r&&y$();let i=Object.keys(o.value.dependenciesMap.dependencies),s=n.map(({target:l})=>l).filter(l=>!i.includes(l)&&cn(l));if(s.length>0){let l=GB(s,{max:5,placeholder:"package"});vA({type:"add",variant:"warning",text:`${l} ${s.length===1?"is":"are"} incompatible with Framer`,duration:5e3})}return o.value}changeScope(e){this.setActiveScope(e.id),this.modulesStorage.changeScope(e)}async reinstallNpmDependencies(){return{importMap:await this.modulesStorage.reinstallNpmDependencies()}}async uninstallBlockedNpmDependencies(){return{importMap:await this.modulesStorage.uninstallBlockedNpmDependencies()}}async unsafeUpgradeDependency(e,t,r){return{importMap:await this.modulesStorage.unsafeUpgradeDependency(e,t,r)}}async clearNpmDependencies(){return this.modulesStorage.clearNpmDependencies()}async removeBlockedNpmDependencies(){return{dependenciesMap:await this.modulesStorage.removeBlockedNpmDependencies()}}async rebuildImportMapFromDependencies(){return{importMap:await this.modulesStorage.rebuildImportMapFromDependencies()}}async updateSources(e){return this.modulesStorage.updateSources(e)}async updateDependenciesSource(e,t){await this.modulesStorage.updateDependenciesSource(e,t)}getDependentsOfModule(e){return this.modulesStorage.getDependentsOfModule(e)}async getFileStorageOnLoad(){return await Br.updated,this.getFileStorage()}getFileStorage(){let e=this,{modulesStorage:t}=this,r=new Wn(t,"codeFile",this.debugModuleStoreAndComponentLoaderRevisionsMatch);return{get initialized(){return t.initialized},whenInitialized(){return t.whenInitialized()},hasLocalChanges(){return t.hasLocalChanges()},async addFile({path:o,content:n,pluginId:a}){let i=Xn(e.dependenciesModule,e.localModules),s=Vn(vc(i),o),l=await r.create({name:s,source:n,metadata:{pluginId:a}}),d=e.getModuleEntryByLocalId(l);return E(d,"Module entry for file not found",l),d},async deleteFile(o){return t.delete(o)},async updateFile(o,n){await t.updateSources([{localId:o,source:n,options:{}}]);let a=e.getModuleEntryByLocalId(o);return E(a,"Module entry for file not found",o),await t.update(o,{}),a},async renameFile(o,{newPath:n}){let a=Xn(e.dependenciesModule,e.localModules);n=Vn(vc(a),n),await t.rename(o,n);let i=e.getModuleEntryByLocalId(o);return E(i,"Module entry for file not found",o),i},getFileById(o){return Xn(e.dependenciesModule,e.localModules)[o]},getFileByName(o){let n=Xn(e.dependenciesModule,e.localModules);return Object.values(n).find(a=>a?.path===o)},subscribe(o){return t.subscribe(n=>{let a={hasLocalChanges:n.metadata.hasLocalChanges,didRemoteChange:n.metadata.didRemoteChange,changes(){return kG(n.metadata.patches,n.dependenciesModule,n.modules,n.deletedLocalIdsByTypeSlashNames)}};o({files:Xn(n.dependenciesModule,n.modules),metadata:a})})}}}async getModuleDependencies(e){let t=await this.modulesAPIServicePromise;return E(t,"Modules API service not initialized correctly"),await t.getModuleDependencies(e)}getModuleEntryByLocalId(e){for(let t of this.localModules.values())if(t.localId===e)return t}getPersistedDependenciesModule(){return this.modulesStorage.getPersistedDependenciesModule()}getPersistedModuleByGlobalId(e){return this.modulesStorage.getPersistedModuleByGlobalId(e)}getPersistedModuleByLocalId(e){return this.modulesStorage.getPersistedModuleByLocalId(e)}getPersistedModuleByLocalIdentifier(e){let t=AA(e);if(KA(t))return this.getPersistedModuleByLocalId(t.localId)}tryConvertExternalCodeComponentIdentifierToLocal(e){let t=AA(e);if(t?.kind!=="externalModuleExport")return;let r=this.getPersistedModuleByGlobalId(t.moduleId);if(r)return ki(r.localId,t.exportSpecifier).value}async listNamespaces(){let e=await this.modulesAPIServicePromise;return E(e,"Modules API service not initialized correctly"),await e.listNamespaces()}async lookUpModule(e,t){let{modules:r,dependencies:o}=await this.lookUpModules([e],t),n=r[0];E(n,"Module does not exist, looking up:",e);let a={module:n};return o&&(a.dependencies=o[n.ownerType]?.[n.ownerId]),a}async lookUpModules(e,t){let r=await this.modulesAPIServicePromise;if(!r)return Fj.error("Modules API service not initialized correctly"),{modules:[],dependencies:{}};let{data:o,dependencies:n}=await r.lookUpModules({queries:e,...t}),a=new Map(this.externalModulesDynamicInfo);for(let s of o){let l=s.id,{localId:d,title:p,description:k,lastPublish:g,status:$}=s;a.set(l,{localId:d,title:p,description:k,lastPublish:g,status:$??a.get(l)?.status})}this.externalModulesDynamicInfo=a;let i={modules:o};return n&&(i.dependencies=n),i}trackExternalComponentInsert(e,t){let r=gt();for(let o of e)Wm({insertId:r,insertType:t,codeComponentId:o})}async installExternalModulesDependencies(e){let t=[],r=[];for(let o of e){let n=eA(this,Zn).get(o);n?r.push(n):t.push(o)}if(t.length>0){let o=this.installDependenciesForModuleURLs(t);for(let n of t)eA(this,Zn).set(n,o);r.push(o)}return Promise.allSettled(r).then(o=>{for(let n of o)n.status!=="fulfilled"&&Fj.error("Failed to install external module",n.reason)})}isProcessingModules(){return this.modulesStorage.isProcessing()}resetModuleStateAndPermissions(e){this.modulesStorage.resetModuleStateAndPermissions(e)}getTransientSave(e){return this.modulesStorage.getTransientSave(e)}startUsingLocalModulesInTree(){return this.modulesStorage.startUsingLocalModulesInTree()}stopUsingLocalModulesInTree(){return this.modulesStorage.stopUsingLocalModulesInTree()}usingLocalModulesInTree(){return this.modulesStorage.usingLocalModulesInTree()}createFastRefreshModuleFromModule(e){if(NB.has(e.type)){if(e.kind==="server"){let t=this.getPersistedModuleByLocalId(e.localId);E(t?.kind==="server","Only server modules should have no sourceContent"),this.modulesStorage.createLocalModuleFromModule(t).catch(SA);return}this.compileFastRefreshModule({name:yA(e),localId:e.localId,source:e.sourceContent}).catch(SA)}}getModuleWithTypeSlashName(e){return this.modulesStorage.getModuleWithTypeSlashName(e)}waitForModulesToSave(){return this.modulesStorage.waitForModulesToSave()}installDependenciesForModuleURLs(e){return Fj.info(`\u{1F986} Installing external modules:
	`,e.join(`
	`)),this.lookUpModules(e.map(t=>({url:t})),{includeDependencies:!0}).then(async({dependencies:t={}})=>{let r=Object.values(t).flatMap(a=>Object.values(a)),o,n;for(let{dependencies:a,importMap:i}of r)if(i){o=ro(o??{imports:{}},i);let s=a??no(i);n=oo(n??{dependencies:{}},s)}o&&n&&await this.modulesStorage.extendCurrentImportMap(o,n)})}async addOrUpdateExternalVectors(e){await this.modulesStorage.whenInitialized();let{modules:t}=await this.lookUpModules(e.filter(n=>{let a=this.treeStore.tree.getNodeWithTrait(n.moduleId,Je);return a?AA(a.codeComponentIdentifier).saveId!==n.saveId:!0}),{includeDependencies:!1,includeStatus:!0}),r=new Map,o="default";for(let n of t){let a=Qc({module:n,exportSpecifier:o}),i=this.treeStore.tree.getNodeWithTrait(n.id,Je);cj(i?.codeComponentIdentifier)&&AA(i.codeComponentIdentifier).saveId===n.saveId||r.set(a.value,{module:n,exportSpecifier:o})}await Promise.all(Array.from(r.keys(),n=>{let a=AA(n);return E(a,"Identifier must be a valid module identifier"),this.loadedExternalModulesStore.ensureModuleEvaluatedInSandbox(a).catch(i=>{Fj.error(`Failed to evaluate external module "${n}"`,i)})})),await new Promise((n,a)=>{this.runWithFullyLoadedTree(()=>{this.updateExternalModuleNodes(Array.from(r.values()),{onTreeUpdate:()=>{let i=CB(r.keys());TB(i,this.treeStore.getLoadedIndexes().codeComponents),PB(i,this.treeStore.tree),_B(i,this.treeStore.tree)},updateSave:!0}).then(n).catch(a)},{name:"update_external_module_version",runInBackground:!0})})}async addOrUpdateVectorSetAndVectors(e){await this.addOrUpdateExternalVectors([e]);let r=this.treeStore.tree.getNodeWithTrait(e.moduleId,Je)?.annotation("framerVectorSet");V6(r)&&await this.addOrUpdateExternalVectors(r.items.map(o=>({moduleId:o.moduleId,saveId:o.saveId??""})))}async addExternalModulesToProject(e,t){let r=e.map(n=>typeof n=="string"?AA(n):n),o=await this.preloadExternalModules(r);return this.updateExternalModuleNodes(o,t)}async preloadExternalModules(e){await this.modulesStorage.whenInitialized();let t=new Map;for(let s of e)t.set(s.bareValue,s);let r=[],o=[],n=[];for(let[s,l]of t){let{moduleId:d,saveId:p}=l;if(!!this.modulesStorage.getPersistedModuleByGlobalId(d)){Fj.reportError("Attempted to treat local module as external module",{identifier:l});continue}let g=this.treeStore.tree.getNode(d);if(g&&AA(g.codeComponentIdentifier).saveId===p&&!this.loadedExternalModulesStore.hasModuleForIdentifier(l)){o.push(l);continue}let $=eA(this,xt).get(s);if($){n.push({identifier:l,preloadPromise:$});continue}eA(this,xt).set(s,Qt()),r.push(l)}let a=new Map;for(let{identifier:s,preloadPromise:l}of n)try{let d=await l;a.set(s.value,d)}catch{eA(this,xt).set(s.bareValue,Qt()),r.push(s)}if(r.length)try{let s=Array.from(r.values(),({moduleId:k,saveId:g})=>({moduleId:k,saveId:g})),{modules:l,dependencies:d}=await this.lookUpModules(s,{includeDependencies:!0,includeStatus:!0}),p=0;for(let k of r){let g=l[p++];E(g,"Module must be defined"),a.set(k.value,{module:g,dependencies:d?.[g.ownerType]?.[g.ownerId],exportSpecifier:k.exportSpecifier}),o.push(k)}}catch(s){Fj.reportError(s);for(let l of r)eA(this,xt).get(l.bareValue)?.reject(s);throw Error(`Failed to preload modules: ${s}`)}let i;for(let s of o){let l=a.get(s.value);if(!l)continue;let{dependencies:d}=l;d?.importMap&&(i=ro(i??{imports:{}},d.importMap))}i&&await this.insertTemporaryImportMap(i),await Promise.all(Array.from(o.values(),s=>this.loadedExternalModulesStore.ensureModuleEvaluatedInSandbox(s).catch(l=>{Fj.error(`Failed to evaluate external module "${s.value}"`,l)})));for(let s of r){let l=a.get(s.value);E(l,"Expected to have module information for:",s.value);let d=eA(this,xt).get(s.bareValue);E(d,"Expected to find a preload promise for:",s.bareValue),d.resolve(l)}return[...a.values()]}async updateExternalModuleNodes(e,{onTreeUpdate:t,updateSave:r=!1}){let o,n;for(let{dependencies:a}of e)if(a?.importMap){o=ro(o??{imports:{}},a.importMap);let i=a.dependencies??no(a?.importMap);n=oo(n??{dependencies:{}},i)}return o&&!xk(o)&&n&&await this.modulesStorage.extendCurrentImportMap(o,n),await Promise.all(e.map(a=>this.loadedExternalModulesStore.ensureModuleEvaluatedInSandbox(Qc(a)))),this.processWhenReadyAsync(()=>{if(this.treeStore.tree.isViewOnly)throw Error("unable to edit");for(let a of e){let{id:i,type:s,metadata:l,ownerId:d,ownerType:p}=a.module,k=Qc(a),{title:g,status:$}=this.externalModulesDynamicInfo.get(k.moduleId)??a.module,F=this.treeStore.tree.getExternalModulesListNode();F||(F=new Ru,this.treeStore.tree.insertNode(F,this.treeStore.tree.root.id)),E(_7(F));let I=l.pluginId,S={codeComponentIdentifier:k.value,type:s,scopeNodeId:Vk(a.module),intrinsicWidth:Ue(l.intrinsicWidth)??200,intrinsicHeight:Ue(l.intrinsicHeight)??200,ownerId:d,ownerType:p,group:$?.group,updateSaveId:$?.updateSaveId,namespaceId:a.module.lastPublish?.namespaceId,pluginId:_(I)?I:void 0},T=K.componentForIdentifier(k.value);E(T,"Component not found in the component loader",k.value);let v=T.annotations??void 0;S.annotations=Iu(s)?io({default:v}).default:v;let P=T.name??g;S.title=P;let N=this.treeStore.tree.getNode(i);if(N)if(r)N.set(S);else{let{group:Q,updateSaveId:w}=S;N.set({group:Q,updateSaveId:w})}else N=new Fu({id:i,...S}),this.treeStore.tree.insertNode(N,F.id)}return t()})}setupPollingExternalModulesUpdates(){let e=DB(()=>{this.checkForExternalModuleUpdates().catch(Fj.reportError)},1e4),t=()=>{e(),this.updatesPollId===void 0&&(this.updatesPollId=window.setInterval(this.checkForExternalModuleUpdates,6e4))},r=()=>{window.clearInterval(this.updatesPollId),this.updatesPollId=void 0};function o(){return!document.hidden&&navigator.onLine}o()&&t();function n(){setTimeout(()=>{o()?t():r()},500)}document.addEventListener("visibilitychange",n),window.addEventListener("offline",n),window.addEventListener("online",n)}getCodeComponentNodesForExternalModuleExport(e){return this.treeStore.getLoadedIndexes().codeComponents.filter(t=>{if(!X(t)||gA(t)&&!t.isVectorInstance)return!1;let r=AA(t.codeComponentIdentifier);return r?.kind!=="externalModuleExport"?!1:r.moduleId===e.moduleId&&r.exportSpecifier===e.exportSpecifier})}get fastRefreshEnabled(){return this.chromeStore.codeEditorPreviewVisible}async updateExternalModuleComponentInstances(e){let t=AA(e);E(t?.kind==="externalModuleExport","parsed 'ExternalModuleNodes.id' should be of kind externalModuleExport");let{moduleId:r,exportSpecifier:o}=t,n=this.externalModulesDynamicInfo.get(r)?.status?.updateSaveId;if(!n){Fj.warn("Could not update module",r,"latest status missing");return}let{module:a,dependencies:i}=await this.lookUpModule({moduleId:r,saveId:n},{includeDependencies:!0,includeStatus:!0});E(a.files.module,"Module file must be defined");let s=ee(r,n,a.files.module,o);try{await this.loadedExternalModulesStore.ensureModuleEvaluatedInSandbox(s).catch(Fj.reportError),await new Promise((l,d)=>{this.runWithFullyLoadedTree(()=>{this.updateExternalModuleNodes([{module:a,dependencies:i,exportSpecifier:o}],{onTreeUpdate:()=>{this.getCodeComponentNodesForExternalModuleExport(t).forEach(k=>k.set({codeComponentIdentifier:s.value})),Ff(this.treeStore.tree,t.value,s.value),bB(this.treeStore.tree,t.value,s.value)},updateSave:!0}).then(l).catch(d)},{name:"update_external_module_version",modalTitle:"Updating the module version"})}),this.trackExternalComponentInsert([s.value],"update")}catch(l){Fj.reportError(l)}}async replaceRelativeImportsWithImportMapSpecifiers(e,t,r){let o={};for(let a of r){let i=me(a,e);if(!i)continue;let s;if(s=this.fastRefreshModules.get(i),s||(s=this.modulesStorage.getModuleWithTypeSlashName(i)),!s){Fj.error("Cannot resolve",a,"from",e);continue}let l,{name:d,localId:p}=s;if(s.kind==="fast-refresh")l=Xj(d).module;else{let{files:k}=s;E(_(k.module),"Must have a module file name to build a local module import map specifier."),l=k.module}o[a]=mi(p,l)}let n=await gs(t,o);return E(n.ok),n.value}getModules(e=!1){let t={};for(let[r,o]of this.localModules)t[r]=o;if(e)for(let[r,o]of this.fastRefreshModules)t[r]=o;return{dependenciesModule:this.dependenciesModule,modules:t,revision:this.revision,initialized:this.modulesStorage.initialized}}getAllModulesAsUpdateEvent(e=!1){let{dependenciesModule:t,modules:r,initialized:o,revision:n}=this.getModules(e),a=[];t&&a.push({op:"add",path:[`${t.type}/${t.name}`],value:t});for(let i of Object.values(r))a.push({op:"add",path:[`${i.type}/${i.name}`],value:i});return{patches:a,dependentModules:[],prioritizedModules:[],initialized:o,revision:n}}getModulesUpdatesService(e=!1){return{moduleUpdatesStream:()=>e?this.fastRefreshModulesEmitter.newStream({replay:"latest"}):this.moduleUpdatesEmitter.newStream({replay:"latest"})}}hasScreenModuleLoaded(e){let t=Ht("screen",e,"default").value;return K.componentForIdentifier(t)!==null}postProcess(){this.modulesStorage.processTreeUpdates()}};bo=new WeakMap,Yn=new WeakMap,Zn=new WeakMap,xt=new WeakMap;function Xn(j,A){let e={};if(Wj.isOn("showImportMap")&&j){let{importMap:t,dependenciesMap:r}=OB(j);e[t.id]=t,e[r.id]=r}for(let t of A.values())Jc(t)&&(e[t.localId]={id:t.localId,path:t.name,content:t.sourceContent});return e}function kG(j,A,e,t){let r=[];for(let o of j){let n=o.path[0];switch(E(typeof n=="string","The first element of patch.path is expected to be module's typeSlashName"),o.op){case"add":case"replace":{if(n===ge){if(!Wj.isOn("showImportMap"))break;E(A,"dependenciesModule is expected to be defined");let{importMap:s,dependenciesMap:l}=OB(A);r.push({type:o.op==="add"?"added":"changed",file:s},{type:o.op==="add"?"added":"changed",file:l});break}let a=e.get(n);if(E(a,n,"is expected to be in newModules"),!Jc(a))break;let i=a.sourceContent;r.push({type:o.op==="add"?"added":"changed",file:{id:a.localId,path:n,content:i}});break}case"remove":{let a=t[n];E(a,n,"is expected to be in deletedLocalIdsByTypeSlashNames"),r.push({type:"deleted",file:{id:a,path:n}});break}default:lA(o.op)}}return r}function OB(j){return{importMap:{id:_o,path:_o,content:j.importMapContent},dependenciesMap:{id:Do,path:Do,content:j.dependenciesMapContent}}}var mG={defaultComponent:{insert:"insert-default",drag:"insert-default-drag"},libraryModule:{insert:"insert-library",drag:"insert-library-drag"},externalModuleComponent:{insert:"insert",drag:"insert-drag"}},Uc="default_component_",Fs="external_",Wc="local_",wB="legacy_design_component",LB="legacy_code_component",qB=`${Wc}${LB}`,EG=`${Fs}${LB}`,KB=`${Wc}${wB}`,VB=`${Fs}${wB}`;var fG=new Set(["form","frame","image-frame","stack","repeater"]),$G=j=>j.startsWith(Uc),JB=j=>j===KB||j===VB,BG=j=>fG.has(j);function HB({canvasNode:j,source:A,isDrag:e,engine:t}){let r=gG(j,t);switch(fA("component_instance",{componentType:r.type,source:A}),A){case"insert_menu":{let o=hG(r);fA("insert_menu_add",{type_added:o});break}}if(r.type==="local_module_canvasComponent_component"&&fA("component_canvas_instance",{componentId:j.id}),JB(r.type)&&fA("component_design_instance",{}),X(j)&&ce(j.codeComponentIdentifier)){let o=r.type.startsWith(Uc)?"defaultComponent":A==="team_library"?"libraryModule":"externalModuleComponent",n=mG[o][e?"drag":"insert"];t.stores.modulesStore.trackExternalComponentInsert([j.codeComponentIdentifier],n)}}function gG(j,A){if(X(j)){let r=j.codeComponentIdentifier,o=AA(r);if(!o)return{type:j.codeComponentIdentifier.startsWith(".")?qB:EG,codeComponentIdentifier:r};if(KA(o))return{type:`${Wc}module_${o.type}_component`,codeComponentIdentifier:r};if(ce(o)){let n=A.tree.getNode(o.moduleId);return va(A,r)?{type:`${Uc}${n?.title}`,codeComponentIdentifier:r}:{type:`${Fs}module_${n?.type??"unknown"}_component`,codeComponentIdentifier:r}}}let t=j.replicaInfo?.master&&A.tree.getNode(j.replicaInfo.master)||j;return qj(t)?xo(t)?{type:VB}:{type:KB}:Ti(j)?{type:"repeater"}:zr(j)?{type:"form"}:LA(j)?{type:"stack"}:mA(j)?j.fillType==="image"?{type:"image-frame"}:{type:"frame"}:{type:"unknown"}}function hG({type:j}){return j.startsWith("local_module_")||j===qB?"code_component":JB(j)?"design_component":j.startsWith(Fs)?"package":$G(j)||BG(j)?j:"unknown"}function zc(j,A){let e=j.children;return de(j)?!e||e.length===0?[]:A.getChildrenRects(j.id)??[]:null}function HW(j,A,e){if(!j||!CA(j))return;let t=[];for(let r=0,o=j.children.length+1;r<o;r++){let n=j.children[r];if(!be(n,j))continue;let a=zc(j,e);if(!a||a.length===0)return;let i=a.splice(r,A.length),s=L.merge(...i);t.push(s)}return t}function QB(j,A,e){if(j>=A&&j<=e||j<=A&&j>=e)return 0;let t=Math.abs(A-j),r=Math.abs(e-j);return Math.min(t,r)}function RG(j,A,e){let t=j?"y":"x",r=j?"height":"width",o=A[t],n=0,a=1/0;return e.forEach((i,s)=>{if(a===0)return;let l=i[t],d=l+i[r],p=QB(o,l,d);p<a&&(n=s,a=p)}),n}function IG(j,A,e,t){let r=Math.max(j,e),o=Math.min(A,t);return r<o}function FG(j,A,e){let t=j?"y":"x",r=j?"height":"width",o=e[A];E(o,"Out of bound access to childRects:",A,e);let n=o[t],a=n+o[r],i=new Set([A]);return e.forEach((s,l)=>{if(l===A)return;let d=s[t],p=d+s[r];IG(n,a,d,p)&&i.add(l)}),{startIndex:Math.min(...i),endIndex:Math.max(...i)}}function GG(j,A,e,t,r,o){if(r)return t.startIndex;if(o)return t.endIndex;let n=A?"x":"y",a=A?"width":"height",i=j[n],s=1/0,l=t.startIndex;for(let d=t.startIndex;d<=t.endIndex;d++){let p=e[d];E(p,"Ouf of bound access to childRects:",d,t,e);let k=p[n],g=k+p[a],$=QB(i,k,g);$<s&&(s=$,l=d)}return l}function SG(j,A){let e=[];for(let t=A.startIndex;t<=A.endIndex;t++){let r=j[t];E(r,"Ouf of bound access to childRects:",t,A,j),e.push(r)}return L.merge(...e)}function yG(j,A,e,t){let r=Ke(j)||j.resolveValue("stackDirection")==="horizontal",o=L.merge(...A),n=r?"x":"y",a=r?"y":"x",i=r?"width":"height",s=r?"height":"width",l=e[n],d=e[a],p=o[a],k=p+o[s],g=d<p,$=!g&&d>k,F=RG(r,e,A),I=FG(r,F,A),S=GG(e,r,A,I,g,$),T=A[S];E(T,"Closest rect is not defined:",S);let v=T[n]+T[i]/2,P=g||$?g:l<v,N=P?S:S+1;g&&(N=0),$&&(N=A.length);let Q=T[n],w=Q+T[i],iA=P?Q:w,z=null,pA=P?S-1:S+1;if(pA>=I.startIndex&&pA<=I.endIndex){let lj=A[pA];if(lj){let Mj=lj[n],Oj=Mj+lj[i];z=P?Oj:Mj}}let D=iA;Y(z)&&(D=Math.round((D+z)/2));let J=SG(A,I),H=Math.round(J[a]+J[s]/2),Z={[n]:D,[a]:H},sA={...Z},NA={...Z},kj=t[s],ZA=Math.round(kj/2);return r?(sA.y-=ZA,NA.y+=ZA):(sA.x-=ZA,NA.x+=ZA),{index:N,line:{a:sA,b:NA}}}function UB(j,A,e,t,r){if(E(A.length,"childInsertion only works correctly if there are more than 0 child rects"),Ke(j)||j.stackWrapEnabled)return yG(j,A,t,r);let o=1/0,n=null,a=j.stackDirection==="vertical";A.forEach((d,p)=>{let k=Math.abs(a?t.y-d.y:t.x-d.x);k>o||(o=k,n=p)});let i=0;if(n!==null){let d=A[n];E(d,"Closest child rect is not defined:",n);let p=L.center(d);(a?t.y>p.y:t.x>p.x)&&n++,i=Math.min(Math.max(0,n),A.length)}let s=CG(j),l=vG(j.resolveValue("stackDirection"),j.resolveValue("stackAlignment"),s,e,A,i,r);return{index:bG(j,i),line:l}}function bG(j,A){E(CA(j),"A node must support children to consider an insertion index.");let e=A;for(let t=0;t<j.children.length&&t!==A;t++){let r=j.children[t];r&&(be(r)||e++)}return e}function CG(j){let A=j.resolveValue("stackDirection"),e=j.resolveValue("stackAlignment");if(e==="center")return 0;let t=to(j);if(!t.perSide)return t.top;let r=e==="start";return A==="vertical"?r?t.left:t.right:r?t.top:t.bottom}function vG(j,A,e,t,r,o,n){let a=r[o-1],i=r[o],s=j==="vertical",l={x:t.width/2,y:t.height/2};if(!(!a&&!i)){if(r.length===1){let d=a||i;E(d,"Child rect must be defined"),o===0?s?l.y=d.y-10:l.x=d.x-10:s?l.y=d.y+d.height+10:l.x=d.x+d.width+10}else if(a&&i){let d=Math.abs(s?a.y+a.height-i.y:a.x+a.width-i.x);s?l.y=i.y-d/2:l.x=i.x-d/2}else if(a){let d=r[o-2];E(d,"Child rect must be defined");let p=Math.abs(s?d.y+d.height-a.y:d.x+d.width-a.x);s?l.y=a.y+a.height+p/2:l.x=a.x+a.width+p/2}else if(i){let d=r[o+1];E(d,"Child rect must be defined");let p=Math.abs(s?i.y+i.height-d.y:i.x+i.width-d.x);s?l.y=i.y-p/2:l.x=i.x-p/2}}return l.x=Math.min(Math.max(4,l.x),t.width-4),l.y=Math.min(Math.max(4,l.y),t.height-4),TG(j,A,e,l,t,n)}function TG(j,A,e,t,r,o){let n=j==="vertical",a,i,s=e??0;switch(A){case"center":a={x:n?t.x-o.width/2:t.x,y:n?t.y:t.y-o.height/2},i={x:n?t.x+o.width/2:t.x,y:n?t.y:t.y+o.height/2};break;case"start":a={x:n?s:t.x,y:n?t.y:s},i={x:n?o.width+s:t.x,y:n?t.y:o.height+s};break;case"end":default:a={x:n?r.width-o.width-s:t.x,y:n?t.y:r.height-o.height-s},i={x:n?r.width-s:t.x,y:n?t.y:r.height-s};break}return{a,b:i}}var WB=6;function PG(j,A){for(let e of j)if(A.includes(e))return!0;return!1}function MG(j,A,e,t,r){if(r.length===0||j.stackWrapEnabled||MA(j)||gA(j))return null;let{tree:o,zoom:n}=A,a=o.getParent(j.id);if(a&&LA(a)&&(a.stackDirection!==j.stackDirection||a.stackWrapEnabled))return null;let i=o.convertPointToNode(j,e),s=o.getRect(j),l=j.stackDirection==="vertical",d=l?"x":"y",p=l?"y":"x",k=l?"width":"height",g=l?"height":"width",$=s[k],F=s[g],I=$*n,S=$*n;if(I<40||S<40)return null;let T=i[d],v=10/n,P=L.merge(...r),N=P[d],Q=N+P[k],w=Math.max(v,N/2),iA=Math.max(v,($-Q)/2),z=T<=w,pA=T>=$-iA;if(!z&&!pA)return null;let D=z?0:1,J=t[g],H=4/n,Z=z?H:$-H,sA=F/2,NA=J/2,kj=F/3,ZA=i[p],uj="end";J>F?uj="center":ZA<kj?uj="start":ZA<2*kj&&(uj="center");let lj,Mj;switch(uj){case"start":{lj=0,Mj=J;break}case"end":{Mj=F,lj=Mj-J;break}case"center":default:{lj=sA-NA,Mj=sA+NA;break}}let Oj={[d]:Z,[p]:lj},le={[d]:Z,[p]:Mj},li=o.convertPointToCanvas(j,Oj),ci=o.convertPointToCanvas(j,le);return{insertionIndex:D,insertionLine:{a:li,b:ci},wrap:{wrapAlignment:uj}}}function Xc(j,A,e,t,{allowWrapping:r=!0}={}){if(!CA(j))return{insertionIndex:null,insertionLine:null};let o=zc(j,A.stores.layoutCache);if(!o)return{insertionIndex:null,insertionLine:null};if(LA(j)&&r){let p=MG(j,A,e,t,o);if(p)return p}let n=A.tree,a=n.getRect(j),i=n.convertPointToNode(j,e);if(o.length===0)return{insertionIndex:0,insertionLine:null};let{index:s,line:l}=UB(j,o,a,i,t),d={a:n.convertPointToCanvas(j,l.a),b:n.convertPointToCanvas(j,l.b)};return{insertionIndex:s,insertionLine:d}}var _G={width:10,height:10};function zB(j,A,e,t,r,o=!1){E(e.length,"getStackOrGridInRange(): expects at least a single selected node");let n=j.stores.scopeStore.active;if(e.some(gj))return null;let i=j.tree.getNodesAtPoint(n,A).filter(d=>!(pr(d)&&d.locked||!CA(d)||Of(d)||Cp(j.tree,j.stores.overlayStore.activeOverlays,d))).reverse();if(t){let d=t.id,p=i.find(k=>k.id===d);if(p)return p}let s=null,l=e.map(d=>d.id);for(let d of i){if(!X7(d)||o&&!RA(d))continue;let p=j.tree.getAncestors(d.id);if(p.push(d.id),PG(p,l)||(s||(s=d),!ke(d)))continue;let{insertionLine:g}=Xc(d,j,A,_G);if(!g)continue;if(g.a.x===g.b.x){if(Math.abs(A.x-g.a.x)*j.zoom>WB)continue}else if(g.a.y===g.b.y){if(Math.abs(A.y-g.a.y)*j.zoom>WB)continue}else continue;if(e.every(F=>Gt(j.tree,d,F,n.id,r)))return d}if(ke(s)){let d=s;if(e.every(k=>Gt(j.tree,d,k,n.id,r)))return s}return null}function XB(j,A,{wrapAlignment:e}){let t=Bc.addStack(j,[A]);if(!t)return null;let r=j.tree.getNode(t);return!r||!LA(r)?null:(r.set({stackDirection:A.stackDirection==="horizontal"?"vertical":"horizontal",stackAlignment:e}),r)}function Yc(j,A){let{width:e,height:t}=j.tree.getRect(A);return EA(A)&&zA(A)&&(A.widthType===2&&A.width>0&&(e=A.width),A.heightType===2&&A.height>0&&(t=A.height)),{width:e,height:t}}function DG(j,A,e){let t=Yc(j,A);return{...t,x:e.x-t.width/2,y:e.y-t.height/2}}function NG(j,A){let e=Yc(j,A),t=j.stores.scopeStore.active,r=j.tree.getCommonGroundNode(j.stores.selectionStore.nodes),o,n;if(r){let i=j.tree.convertFrameToCanvas(r);o=L.center(i).x-e.width/2,n=i.y}else if(V(t)||tA(t)){let i=t.getPrimaryVariant(),s=j.tree.convertFrameToCanvas(i);o=L.center(s).x-e.width/2,n=s.y}else{let i=j.stores.canvasStore.getCanvasCenter();o=i.x-e.width/2,n=i.y-e.height/2}let a={x:o,y:n};for(;;){let i={...e,...a},s=j.tree.getNodesInRect(t,i,!0);if(s.length===0)return i;let l=j.tree.getBoundingFrameForNodes(s);a.x=l.x-e.width-100}}function xG(j,A,e,t=!1){let{tree:r}=j,o=r.getPotentialParents(j.stores.scopeStore.active,j.stores.overlayStore.activeOverlays,L.cornerPoints({...e,width:1,height:1}),e,K,A);return t&&(o=o.filter(RA)),o=r.sortVisually(o).reverse(),o.length>0&&o[0]?o[0]:null}var YB={width:1,widthType:1,heightType:2,left:0,right:null};function ZB({engine:j,component:A,canvasPoint:e,source:t,type:r,shouldBecomeFullWidthForVariants:o=new Set,isLayoutSection:n=!1,notDraggedOntoCanvas:a=!1,insertAsGroundNode:i=!1,insertAsOverlayType:s,imageToUpload:l}){HB({canvasNode:A,source:r==="libraryModule"?"team_library":t,isDrag:!0,engine:j});let{selectionStore:d,canvasStore:p,scopeStore:k}=j.stores,g=i?NG(j,A):DG(j,A,e);s===1&&ht(A)&&A.set({floatingPositionEnabled:!0,floatingPlacement:Ui,floatingAlignment:Wi,floatingOffsetX:0,floatingOffsetY:10});let $=ss(j,A),F=zB(j,e,[$],null,K,n);if(a&&n&&!F){let D=p.getCanvasVisibleRectTakingOverlaysIntoAccount(),J=d.ids.length===1&&d.ids[0]?j.tree.getNode(d.ids[0]):null,H=J?j.tree.getGroundNodeFor(J):null;ke(H)&&L.intersects(j.tree.convertFrameToCanvas(H),D)&&(F=H)}let I=F??xG(j,A,e,n),S=d.ids.length===0,T=k.active,v=Ur(T)?T.getPrimaryVariant():null;if(a&&n&&v&&S&&(I=v),s===1&&I&&ht($)&&!RA(I)){E(I,"Parent should exist");let D=I.originalid??I.id,J=As(j.stores,"framer/useShowRelativeOverlay",D,$.draftOrCurrent());if(!J)return;j.tree.move(J.id,D);return}else ht($)&&$.set(Gp);if(i&&(I=null,F=null,!L.containsRect(p.getCanvasVisibleRectTakingOverlaysIntoAccount(),g))){let D=L.center(g),J=p.zoom,H=Math.min(J,1);p.scrollToCenter(D,{animate:!0,zoom:H})}let P=-1,N=null;if(I){xE(j,I,A,g),OE(j,I,A);let D=I.draftOrCurrent();LA(D)&&(F=D)}if(F){let D=Yc(j,A),{insertionIndex:J,wrap:H}=Xc(F,j,e,D);if(H&&(N=H),Y(J)&&(P=J),a&&n){if(P=F.children.length,d.ids.length===1){let Os=d.ids[0],di=Os&&j.tree.getNode(Os);if(di){let ws=new Set([di.id]);for(let Pr of di.ancestors())ws.add(Pr.id);let pi=F.children.findIndex(Pr=>ws.has(Pr.id));pi>=0&&(P=pi+1)}}let Z,sA=F.children[P-1];sA?(Z=j.tree.convertFrameToCanvas(sA),Z.y+=Z.height):Z=j.tree.convertFrameToCanvas(F),Z.height=D.height;let NA=j.tree.convertFrameToCanvas(F),kj=Math.min(Z.x,NA.x),ZA=Math.max(L.maxX(Z),L.maxX(NA));Z.x=kj,Z.width=ZA-kj;let{zoom:uj}=p,lj=p.getCanvasVisibleRectTakingOverlaysIntoAccount(),Mj=lj.width*uj,Oj=lj.height*uj,le=40,li=Math.max(Mj-le*2,100),ci=Math.max(Oj-le*2,100),xs=li/(Z.width||1),Ed=ci/(Z.height||1),fd=Math.min(xs,Ed,.5),$d=L.center(Z);p.scrollToCenter($d,{animate:!0,zoom:fd})}wE(j,F,A,g)}let Q;if(I){let{width:D,height:J}=g;Q={...j.tree.convertCanvasFrameToNode(I,g),width:D,height:J}}else Q=g;let w=$.updateForRect({rect:Q,parentSizeInfo:null,constraintsLocked:!1,shouldGuessPinToBottom:I?ot(j.tree,$,I):!0,shouldGuessPinToRight:I?Uj(j.tree,$,I):!0});I&&LA(I)&&zA($)&&EA($)&&(w=wG($,w)),N$($,w),$.set(w,j.tree);let iA=$.id,z=!1,pA=null;if(I){if(pA=I,sj(I)&&(pA=j.tree.getNode(I.originalid),z=!0,E(pA,"Fail to insert node into variants: the original parent should exist")),N&&!gA(pA)&&LA(pA)){let H=XB(j,pA,N);if(!H)return;pA=H}j.moveNode($.id,pA.id,P),z&&(E(gA(I),"Fail to insert node into variants: the new parent should be a replica node"),iA=hn(j,$,I,pA));let D=j.tree.getGroundNodeFor(pA),J=!!(D.name&&o.has(D.name.toLowerCase()));if(mA($)&&J&&$.set({left:0,width:1,widthType:1},j.tree),X($)&&aj(D)&&RA(D)){let Z={width:$.width,widthType:$.widthType,left:$.left,right:$.right};J&&$.set(YB);let sA=ql($);if(sA){let NA=j.tree.getScopeNodeFor(D);V(NA)&&NA.getTopLevelReplicaVariants().forEach(ZA=>{if(!ZA.name)return;let uj=Kl(ZA.name,sA);if(!uj||uj===sA.defaultVariant)return;let lj={...ZA.replicaInfo.overrides},Mj={...ZA.replicaInfo,overrides:lj},Oj={...lj[$.id]},le=OG(J,o,ZA.name,Z);le&&Object.assign(Oj,le),Oj[VA(sA.key)]={type:"enum",value:uj},lj[$.id]=Oj,ZA.set({replicaInfo:Mj})})}}Ke(I)&&Ar($)&&(J||$.set({gridItemFillCellWidth:!0}),$.set({gridItemFillCellHeight:!0}))}l&&mA(A)&&ym(l,A,j).catch(SA),d.set(iA,{switchToLayers:!0})}function OG(j,A,e,t){let r=A.has(e.toLowerCase());if(j!==r)return r?YB:t}function wG(j,A){let e={...A};return(j.widthType===3||j.widthType===1)&&Y(A.width)&&A.widthType!==j.widthType&&(delete e.width,delete e.widthType),(j.heightType===3||j.heightType===1)&&Y(A.height)&&A.heightType!==j.heightType&&(delete e.height,delete e.heightType),e}function Gs({engine:j,module:A,identifier:e,position:t,centerInParent:r,insertAsGroundNode:o,update:n}){let a={width:Ue(A.metadata.intrinsicWidth)??200,height:Ue(A.metadata.intrinsicHeight)??200},i=new ur({codeComponentIdentifier:e,slotsAreChildNodes:XA.isOn("componentSlotsAreChildNodes"),...a});n&&n(i);let s=t;if(r&&!o){let l=tB(i,j),d=l?L.center(j.tree.convertFrameToCanvas(l)):null,p=j.stores.canvasStore.getCanvasVisibleRectTakingOverlaysIntoAccount();d&&L.containsPoint(p,d)&&(s=d)}return ZB({engine:j,component:i,canvasPoint:s,source:"context_menu",insertAsGroundNode:o}),i}var Ai=kA("unlinking");async function LG(j,A,e){let{codeEditorStore:t,selectionStore:r,treeStore:o}=j.stores;t.closeEditor();let[n]=r.nodes;if(r.nodes.length===1&&X(n)&&n.codeComponentIdentifier===A)return!0;let a=await j.runWithFullyLoadedTreeAsync(()=>{for(let i of o.treeIndex.codeComponentNodeIds){let s=j.tree.getNodeWithTrait(i,X);if(s?.codeComponentIdentifier===A)return s}},{runInBackground:!0,name:`findCodeComponentInstance: ${A}`});return a?(x$(j,a),!0):(vA({type:"add",variant:"info",key:"add-component-instance-to-edit-in-plugin",text:`Add this Component to Canvas to edit in ${e.name}`}),!1)}async function A0(j,A,e){return await LG(j,A,e)?(j.stores.pluginStore.openPlugin(e,j,{mode:"canvas"}),!0):!1}function j0(j,A){let e=j.componentForIdentifier(A);if(e)return e;let t=AA(A);return!KA(t)||!cj(t)?null:j.componentForIdentifier(Od(t))}function qG(j,A,e){let t=KA(e)?e.localId:e?.moduleId,r=j.get(t);if(Je(r))return r.pluginId;if(!vt(r))return;if(!oA(r.save.pluginId))return r.save.pluginId;let o=A.getPersistedModuleByLocalId(r.id);if(!o)return;let n=o.metadata.pluginId;if(_(n))return n}function e0(j,A){let e=qG(j.tree,j.stores.modulesStore,A);if(!oA(e))return j.stores.pluginStore.manifestById.get(e)}function uz(j){return`Edit in ${j.name}`}var KG=0;async function Ss(j,A,e=KG){if(e===0){let r=AA(A),o=e0(j,r);if(o&&await A0(j,A,o))return}let t=j0(K,A);t&&j.stores.codeEditorStore.editFile(t.file)}async function t0(j,{identifier:A,info:e,instance:t,enterIsolation:r,codeComponentIsolationMode:o}){let n=e.module.baseURL+e.module.files.source,i=await(await fetch(n)).text(),[s,l]=await Promise.all([_$(i),j.stores.modulesStore.getModuleDependencies(A)]);if(s.ok){let $=new Map;for(let I of s.value.relative){let S=me(I.specifier,`${e.module.type}/`);if(!S){Ai.warn("Failed to normalize relative import",I.specifier);continue}let T=$.get(S)??[];T.push(I),$.set(S,T)}let F;for(let I of l.imports){if(I.type!=="local")continue;let S=`${I.moduleType}/${I.moduleName}`,T=$.get(S);if(!T){Ai.warn("Unable to get source location of import",S,"when unlinking");continue}for(let v of T){F||(F=i.split(`
`));let P=v.specifierLine;F[P]=F[P].replace(JSON.stringify(v.specifier),JSON.stringify(I.importURL))}}F&&(i=F.join(`
`))}let d=j.stores.modulesStore.forType("codeFile"),p=d.getUniqueName(e.module.name),k=await d.create({name:p,source:i,metadata:{pluginId:e.module.metadata.pluginId}}),g=Nr(A,k).value;return t&&j.processWhenReady(()=>{let $=j.tree.get(t.originalid??t.id);$&&$.set({codeComponentIdentifier:g})}),r&&(j.stores.chromeStore.contentPanelTab="Assets",Ss(j,g,o)),g}var r0={canvasComponent:AB,codeFile:t0};function VG(j){return _(j)?j in r0:!1}async function Ad(j,{identifier:A,moduleType:e,instance:t,enterIsolation:r=!0,codeComponentIsolationMode:o,renamedIds:n=new Map,isAutoDetach:a=!1}){if(!VG(e))throw Error(`Cannot import external module of type ${e}`);let[i]=await j.stores.modulesStore.preloadExternalModules([A]);E(i,"external module must exist on preload");let s={identifier:A,info:i,instance:t,enterIsolation:r,codeComponentIsolationMode:o,renamedIds:n,isAutoDetach:a},l=r0[e],d=await l(j,s);if(!oA(d))return!_(d)&&tA(d)?{...i,codeComponentIdentifier:d.instanceIdentifier,node:d}:{...i,codeComponentIdentifier:d,node:void 0}}var Zc=new Set;async function JG(j,A){let{instance:e,withUnlinkModal:t,...r}=A,o=va(j,A.identifier),n=j.stores.insertSidebarStore.getEditBehavior(A.identifier.moduleId);if(t&&n!=="autoUnlink"&&(!o||Wj.isOn("openPrimaryForBuiltInModules"))){j.stores.modalStore.set({type:"UnlinkComponent",source:"edit_action",...r,nodeId:e?.id});return}if(!Zc.has(A.identifier)){Zc.add(A.identifier),j.process(()=>{j.beginUndoGroup()});try{return(await Ad(j,{instance:e,enterIsolation:n!=="autoDetach",...r}))?.codeComponentIdentifier}catch(a){Ai.reportError(a),vA({type:"add",variant:"error",text:"Failed to unlink component",key:"external-component-unlink-error",icon:"error"})}finally{j.processWhenReady(()=>{j.endUndoGroup()}),Zc.delete(A.identifier)}}}async function zz(j,A){let{instance:e,moduleType:t,enterIsolation:r,codeComponentIsolationMode:o}=A;if(!X(e))return;let n=await JG(j,{...A,enterIsolation:!1});if(!n)return;await ms(K,[n],j.stores.modulesStore);let a=K.componentForIdentifier(n);if(!a)return;let i=Jf(a);i&&j.processWhenReady(()=>{if(j.tree.getNodes(Array.from(j.stores.treeStore.treeIndex.codeComponentNodeIds)).forEach(l=>{if(!i||i.id===l.id||!X(l)||l.codeComponentIdentifier!==e.codeComponentIdentifier||gA(l)||!ls(l,{allowLockedNodes:!0}))return;let d=j.cloneNode(i,!1,!1);Vf(j,l,d).catch(SA)}),!!r)if(t==="canvasComponent"){let l=ea(n);l&&j.stores.scopeStore.select(l,{keepHistory:!1})}else t==="codeFile"&&Ss(j,n,o)})}var HG=kA("clipboard:modules");async function lX(j,A,e){if(!A||!Kk(A))return!1;let t="insert-external-component";try{await UG({engine:j,moduleURL:A,position:e,centerInParent:!0,toastKey:t}),vA({type:"remove",key:t})}catch(r){console.error("Failed to insert external component",r),vA({type:"add",variant:"error",key:t,text:"Failed to insert external component",icon:"error"})}return!0}async function QG(j,A){let e=new URL(A),t=e.hash.substring(1).split(","),r=t[0]||"default",o=t.some((d,p)=>p>0&&d==="unlink"),{module:n}=await j.stores.modulesStore.lookUpModule({url:e.href}),a=n.id,i=j.stores.modulesStore.getPersistedModuleByGlobalId(a);E(n.files.module,"Module file must be defined");let s=ee(a,n.saveId,n.files.module,r),l=i?ki(i.localId,r):s;return{module:n,moduleIdentifier:l,externalIdentifier:s,insertUnlinked:o}}async function UG({engine:j,moduleURL:A,position:e,centerInParent:t,insertAsGroundNode:r,toastKey:o,update:n}){let{module:a,moduleIdentifier:i,externalIdentifier:s,insertUnlinked:l}=await QG(j,A);if(a.type==="screen")if(KA(i)){let d=ea(i.value);if(!d)return;let p=j.tree.getNode(d);if(!V(p))return;await j.loadScopesThenProcess([p],([k])=>{k&&eB(j,k,k.getPrimaryVariant())})}else o&&vA({type:"add",variant:"progress",key:o,text:"Inserting Web Page",icon:"reconnecting",duration:1/0,showCloseButton:"never"}),await jB(j,s);else if(l){o&&vA({type:"add",variant:"progress",key:o,text:"Inserting external component",icon:"reconnecting",duration:1/0,showCloseButton:"never"});let d=await Ad(j,{identifier:s,moduleType:a.type,enterIsolation:!1});await j.processWhenReadyAsync(()=>{d&&Gs({engine:j,module:a,identifier:d.codeComponentIdentifier,position:e,centerInParent:t,insertAsGroundNode:r,update:n})})}else{if(o&&vA({type:"add",variant:"progress",key:o,text:"Inserting external component",icon:"reconnecting",duration:1/0,showCloseButton:"never"}),!ce(i)){await j.processWhenReadyAsync(()=>{Gs({engine:j,module:a,identifier:i.value,position:e,centerInParent:t,insertAsGroundNode:r,update:n})});return}await j.stores.modulesStore.addExternalModulesToProject([i],{onTreeUpdate:()=>{if(Gs({engine:j,module:a,identifier:i.value,position:e,centerInParent:t,insertAsGroundNode:r,update:n}),a.type!=="vector")return;let d=j.tree.getNodeWithTrait(a.id,Je)?.annotation("framerVector");aa(d)&&j.stores.modulesStore.addOrUpdateVectorSetAndVectors({moduleId:d.set.moduleId,saveId:""}).catch(SA)}}).catch(HG.reportError),j.stores.modulesStore.trackExternalComponentInsert([i.value],"paste-url")}return a}function o0(j,A){if(j.stores.projectStore.projectLicenseType===um())return j.stores.modalStore.set({type:"UpsellEnterprise",source:"upsell",description:"Sign up for an Enterprise plan to increase your file upload limit to 150MB and unlock other powerful features that help scale your site.",upsell:"file-limit-enterprise-upsell",upsellFeatures:["Advanced Permissions","Custom Limits","Custom Hosting","Custom Proxy Support","Enterprise Security","Dedicated Support"]});let e=j.stores.projectStore.resourceLimits?.fileUploadLimitInMB;E(typeof e=="number","fileUploadLimitInMB is not a number");let t=e.toLocaleString()+"MB",r=(A/vm).toLocaleString(void 0,{minimumFractionDigits:0,maximumFractionDigits:1})+"MB";return j.stores.modalStore.set({source:"upsell",type:"UpsellFeature",upsellFeature:"fileUploadLimitInMB",title:"File Upload Limit",description:`Your current plan limits file uploads to ${t}, and you\u2019re trying to upload a file that\u2019s ${r}. Upgrade your site to increase the limit and upload your file.`})}var n0=class{constructor(A,{concurrency:e=5,silent:t=!1}={}){this.engine=A;R(this,"uploads",new Map);R(this,"completed",0);R(this,"failed",0);R(this,"generating",!1);R(this,"resolveStatusUpdate");R(this,"limiter");R(this,"silent");this.limiter=new yo(e),this.silent=t}add(A){return this.createTask(A,e=>e)()}createTask(A,e){let t=this.uploads.get(A);t||(t={task:async()=>{try{return typeof A=="string"?A.startsWith("data:")?await this.uploadFile(await Sm(A,"imported")):await fn.uploadAssetByURL(A,{silent:this.silent,refreshAssetService:!1}):await this.uploadFile(A)}catch(n){throw this.failed++,n}finally{this.completed++,this.resolveStatusUpdate?.()}}},this.uploads.set(A,t));let r=t;return async()=>(r.resultPromise||(r.resultPromise=this.limiter.run(r.task),this.resolveStatusUpdate?.()),e(await r.resultPromise))}async uploadFile(A){let e=this.engine.stores.projectStore.resourceLimits?.fileUploadLimitInMB??void 0,t={silent:this.silent,maxFileSize:e,onExceedsCustomMaxSize:o=>o0(this.engine,o),refreshAssetService:!1},r;if(A.type.startsWith("image/")?r=await fn.uploadImage(A,t):A.type.startsWith("video/")?r=await fn.uploadVideo(A,t):r=await fn.uploadFile(A,t),!r)throw Error("Failed to upload file");return r}get active(){return[...this.uploads.values()].map(({resultPromise:A})=>A).filter(te)}get status(){let{active:A,completed:e,failed:t}=this;return{started:A.length,completed:e,failed:t}}async*statusUpdates(){if(this.generating)throw Error("`statusUpdates` is in use by another call");for(this.generating=!0,yield this.status;this.completed<this.active.length;)await new Promise(A=>{this.resolveStatusUpdate=()=>{A(),this.resolveStatusUpdate=void 0}}),yield this.status;await this.engine.stores.assetStore.assetService?.refresh().catch(SA),this.generating=!1}async results(){let A=await Promise.allSettled(this.active).then(e=>e.filter(n7).map(t=>t.value));return await this.engine.stores.assetStore.assetService?.refresh().catch(SA),A}};var bX=({naturalWidth:j,naturalHeight:A})=>({nonZeroNaturalWidth:j===0?300:j,nonZeroNaturalHeight:A===0?150:A});var XG={cm:96/2.54,mm:96/2.54/10,Q:96/2.54/40,in:96,pc:96/6,pt:96/72,px:1,em:16,ex:8,ch:8,rem:16};function ys(j){if(!j)return null;let A=/(-?[\d.]+)([a-z%]*)/u.exec(j);if(!A)return null;let[e,t,r]=A;if(t===void 0||r?.startsWith("%"))return null;let o=Math.round(parseFloat(t)*(r&&XG[r]||1));return o<=0?0:o}function PX(j){let A=YG(j);if(!A)throw Error("Invalid SVG");let e=ys(A.getAttribute("width")),t=ys(A.getAttribute("height"));if(e!==null&&t!==null)return{width:e,height:t};let r=A.getAttribute("viewBox");if(r){let o=r.split(" "),n=ys(o[2]),a=ys(o[3]);if(n!==null&&a!==null){let i=a!==0?n/a:2;return e!==null&&t===null?{width:e,height:e/i}:t!==null&&e===null?{width:t*i,height:t}:{width:n,height:a}}}return{width:e??300,height:t??150}}function YG(j){let A=zt(j,"image/svg+xml"),e=A.rootElement||A.childNodes[0];if(!(!e||e.nodeName.toUpperCase()!=="SVG"))return e}var ZG=kA("wantsNativeTextActions");function i0(j=document.activeElement){if(!(j instanceof HTMLElement))return!1;if(j.classList.contains("wantsNativeTextAction")||j instanceof HTMLIFrameElement)return!0;if(j instanceof HTMLInputElement)switch(j.type){case"date":case"datetime-local":case"email":case"month":case"number":case"password":case"search":case"tel":case"text":case"time":case"url":case"week":return!0;case"checkbox":case"color":case"file":case"image":case"radio":case"range":case"reset":case"submit":return!1;default:return ZG.reportErrorOncePerMinute("Unhandled input type: "+j.type),!1}return j instanceof HTMLTextAreaElement||XA.isOn("rightClickOnLinks")&&(j instanceof HTMLAnchorElement||j.closest("a"))?!0:j.isContentEditable}var Ot=yj($i());var u0=yj(Or());function jd(j){return j.wantsActions?j.wantsActions():!0}function ed(j,A,e){return j.wantsAction?j.wantsAction(A,e):!0}function s0(j,A){return j.optionsForAction?j.optionsForAction(A):void 0}var l0;(t=>{function j(r){return new e(r)}t.chain=j;function A(r,o){return r&&r instanceof e?r.actionToTargetMap[o]:r}t.functionTarget=A;class e{constructor(o){R(this,"actionToTargetMap",{});R(this,"wantedActions",[]);this.then(o)}then(o){this.wantedActions=this.wantedActions.concat(o.wantedActions);let n=this.actionToTargetMap,a=o.wantedActions;for(let i of a)n[i]=n[i]||o;return this}wantsAction(o,n){let a=this.actionToTargetMap[o];return!a||!jd(a)?!1:ed(a,o,n)}optionsForAction(o){let n=this.actionToTargetMap[o];if(n)return s0(n,o)}}})(l0||={});var vr=class extends Event{constructor(){super(...arguments);R(this,"actionIdentifier");R(this,"actionArgument")}};R(vr,"eventType","vekter-action-dispatch-event");var Tr=class extends Event{constructor(){super(...arguments);R(this,"invalidatedActions");R(this,"validatedActionStates");R(this,"validatedActionOptions")}};R(Tr,"eventType","vekter-action-validation-event");function LX({target:j,engine:A,children:e,style:t,global:r}){let o=(0,Ot.useRef)(null),n=(0,Ot.useCallback)(s=>{let l=s.actionIdentifier;if(!l)return;let d=l0.functionTarget(j,l);if(!d||!d.wantedActions.includes(l)||!jd(d))return;let p=d[l];if(!o7(p))return;let k=ed(d,l,s);if(!k||(s.preventDefault(),s.stopPropagation(),k!==!0))return;A.setEditReason(l);let g=p.bind(d);A.wrapHandler(g)(s.actionArgument)},[A,j]),a=(0,Ot.useCallback)(s=>{let{invalidatedActions:l,validatedActionStates:d,validatedActionOptions:p}=s;if(!(!l||!d||!p)&&j){for(let k of j.wantedActions)if(l.has(k)){l.delete(k);let g=jd(j)?ed(j,k,s):!1;if(d[k]=g,g===!0||g===!1){let $=s0(j,k);$&&(p[k]=$)}}l.size===0&&(s.preventDefault(),s.stopPropagation())}},[j]);(0,Ot.useEffect)(()=>{if(!o.current)return;let s=(r?document.documentElement:null)||o.current;return s.addEventListener(vr.eventType,n),s.addEventListener(Tr.eventType,a),()=>{s.removeEventListener(vr.eventType,n),s.removeEventListener(Tr.eventType,a)}},[r,n,a]);let i=(0,Ot.useCallback)(s=>{!i0(s.target)&&!$j.isDebugBuild&&s.preventDefault()},[]);return(0,u0.jsx)("div",{ref:o,onContextMenu:i,style:t,children:e})}function c0(j,A){let e=document.activeElement;if(!e)throw Error("No active element for action dispatch");let t=new vr(vr.eventType,{bubbles:!0});return t.actionIdentifier=j,t.actionArgument=A,e.dispatchEvent(t)}function AS(j){let A=document.activeElement;if(!A)throw Error("No active element for action validation");let e=new Set;for(let n of j)e.add(n);let t={},r={},o=new Tr(Tr.eventType,{bubbles:!0});return o.invalidatedActions=e,o.validatedActionStates=t,o.validatedActionOptions=r,A.dispatchEvent(o),{states:t,options:r}}var d0=[],p0=[];function qX(j){d0.push(j)}function KX(j){p0.push(j)}function k0(j){let A=j==="*"?Object.keys(bs):[j];d0.forEach(r=>r());let{states:e,options:t}=AS(A);Object.assign(bs,e),Object.assign(a0,t);for(let r of A)bs[r]=e[r]||(r==="undo"||r==="redo"||r==="delete"?"native":!1);return p0.forEach(r=>r()),{states:bs,options:a0}}var bs={},a0={};function m0(j,A){let e=j.itemVariables.length===1&&j.itemVariables[0]?.type==="image"?j.itemVariables[0]:void 0,t=B`item`,r={[gr]:B`typeof ${t}?.[${gr}] === "string" ? ${t}[${gr}] : undefined`};for(let n of j.itemVariables){let a=Zi(n.name);a?r[n.id]=B`${t}?.[${a}] ?? ${t}?.[${n.id}]`:r[n.id]=B`${t}?.[${n.id}]`}let o=A.bindings.create("arrayFromHumanReadable"+j.id);return A.declarations.file.create(B.joinLines(B`const ${o} = (value) => {${B.joinLines(B`if (!Array.isArray(value)) return`,B`return value.map(${t} => {${B.joinLines(e?B`if (typeof ${t} === "string") return { [${e.id}]: ${t} }`:void 0,B`return ${r}`)}})`)}}`)),o}function jS(j){return[j[1],j[0]]}var eS=new Map(Object.entries(PA).map(jS));function E0(j,A){let e=A.addImport("framer",{exportSpecifier:"ControlType"}),t=eS.get(j),r=new q(t);return B`${e}.${r}`}var tS={boolean:"boolean",number:"number",string:"string",richtext:"string",fusednumber:"any",enum:"string",segmentedenum:"string",color:"string",image:"string",responsiveimage:"{src: string; srcSet?: string; alt?: string}",file:"string",componentinstance:"any",slot:"any",array:"any[]",eventhandler:"any",transition:"Record<string, any>",link:"string",linkrelvalues:"string[] | undefined",pagescope:"string",date:"string",object:"Record<string, any>",font:"Record<string, any> | undefined",scrollsectionref:"React.MutableRefObject<HTMLElement>",customcursor:"string",border:"Record<string, any>",cursor:"string",boxshadow:"string",gap:"string",padding:"string",borderradius:"string",collectionreference:"string | undefined",multicollectionreference:"string[] | undefined",trackingid:"string | undefined",vectorsetitem:"React.ComponentType<any> | undefined"};function rS(j){return j?new q(tS[j]):B`any`}var f0="variant";function oS(j){return!oA(j?.defaultValue)}function nS(j,A){if(!tA(j))return{};E(j.isLoaded(),"Node must be loaded to generate controls");let e=j.getTopLevelVariants();if(e?.length<2)return{};let t=[],r=[];for(let o of e){let n=o.name??rt(o);t.push(o.id),r.push(n)}return{[f0]:{type:E0("enum",A),title:"Variant",options:t,optionTitles:r}}}function iS(j,A,e,t,r){if(j.type==="responsiveimage"&&o6(j)&&r6(j.__vekterDefault)){let{assetReference:o,alt:n}=j.__vekterDefault,a=jl(r?.width,r?.height),i=e.assets.resolveResponsiveImage(o,a,j.__vekterDefault);return i&&_(n)&&(i.alt=n),i}else if(t6(j))switch(j.type){case"responsiveimage":{let o=jl(r?.width,r?.height),n=e.assets.resolveResponsiveImage(j.__defaultAssetReference,o);return n||void 0}case"file":{let o=e.assets.resolve(j.__defaultAssetReference);return o?o.src:void 0}}else{if(A?.type==="array")return A.initialValue?A.initialValue.map(o=>{let n={};if(!o||o.type!=="object"||!Lj(o.value))return n;for(let a in o.value){let i=o.value[a];if(!i||i.type!=="image"||!_(i.value))continue;let s=e.assets.resolveResponsiveImage(i.value,void 0,i);s&&(s.alt=i.alt??"",n[a]=s)}return n}):[];if(oS(j)){let o=j.defaultValue;if(j.type==="vectorsetitem")return E(wp(o),"Vector set item must be a module export identifier"),e.imports.addModuleImport(o.identifier);if(j.type==="richtext"&&_(o))return Tm(o,{collectors:e,useFramerMotion:t==="SmartComponent"});if(j.type==="boxshadow"&&Yk(o))return Zk(o,"emptyStringWhenEmpty",n=>He(n)?k6(n):Ii.toFormatString(n));if(tt(o))return He(o)?k6(o):o}}}function Cs(j,A){return B`${j}?: ${A};`}var $0=["id","width","height"],aS=Object.fromEntries($0.map(j=>{let A=new q(j);return[A,A]}));function sS(j,A){let e=new vj(j);return vj.addSpreadAtEnd(e,A),e}var B0=[{name:_A.style,type:B`Record<string, unknown>`},{name:_A.className,type:B`string`},{name:_A.layoutId,type:B`string | number`}];function lS(j,{declarations:A}){if(!tA(j)&&!V(j)&&!ij(j)&&!re(j))return[];E(j.isLoaded(),"Node must be loaded to generate default values and types");let e=B0.map(({name:a,type:i})=>({key:OA(a),type:Cs(a,i)})),t=Zt(j)?j.getTopLevelVariants():[],r=OA(_A.variant);if(t.length<2)return e.concat({key:r});E(Zt(j),"A scope with more than 1 variants must have replica variants.");let o=new vj;for(let a of t)o[a.name??rt(a)]=a.id;let n=A.file.dedupe("humanReadableVariantMap",o);return e.concat([{key:r,type:Cs(_A.variant,B`keyof typeof ${n}`),value:B`${n}[props.${_A.variant}] ?? props.${_A.variant} ?? ${j.baseVariantId}`}])}function td(j,A,e){let t=B`props.${new q(j)}`;return A&&(t=B`${A} ?? ${t}`),e&&(t=B`${t} ?? ${e}`),t}function cS(j,{treeStore:A}){if(!V(j)||!ve(A.tree,j))return;let t=AA(j.dataIdentifier);if(!cj(t))return;let r=j.getVariableDefinitions(A.tree,K,K.activeBundleHash);if(!r||r.length===0)return;let o=new Map;for(let n of r){let a=Ea(n.id,j.id,!0);o.set(OA(a),n)}return o}var dS=[...Jk,f0,...$0,...B0.map(({name:j})=>j.toString()),"name"];function pS(j,A,e,t,r,o){let n=new Set(dS),a=B`props`,i=Object.entries(j).map(([S,{control:T,variable:v}])=>{if(!T)return{key:S};let P=Hk(Zi(T.title)??S,n),N=new q(P),Q=iS(T,v,t,r,o),w=Cs(N,rS(T.type)),iA;if(T.type==="enum"&&T.options&&T.optionTitles&&N){let z=new vj;T.options.forEach((D,J)=>{if(!_(D)||!T.optionTitles)return;let H=T.optionTitles[J];_(H)&&(z[H]=D)});let pA=t.declarations.file.dedupe("humanReadableEnumMap",z);w=Cs(N,B`keyof typeof ${pA}`),iA=td(S,N,Q),iA=B`${pA}[${N}] ?? ${iA}`}else if(v?.type==="array"){let z=m0(v,t),pA=q.fn(z,N);iA=td(S,pA,Q)}else iA=td(S,N,Q);return{key:S,name:P,type:w,value:iA}}),s="",l=[],d=new vj,p=cS(A,e),k={},g={...aS};for(let{key:S,type:T,value:v,name:P}of[...lS(A,t),...i]){let N=p?.get(S),Q=new q(S);if(N){let w=B`${Q} = ${_A.getFromCurrentRouteData}(${N.id})`;if(W7(N.type)){let iA=Ft(N.type);tt(iA)&&(w=B`${w} ?? ${iA}`)}l.push(w)}else l.push(Q);T&&(s+=T),v&&(d[S]=v),P&&(k[S]=P,g[P]=new q(P))}r==="DesignPage"&&l.push(_A.style),vj.addSpreadAtStart(d,a);let $=t.declarations.file.dedupe("getProps",B`(${sS(g,a)}) => { return ${d} }`),F=l.join(", "),I=F.length>0?new q(`{ ${F}, ...${_A.restProps} }`):_A.restProps;return{variableMap:$e(k)?void 0:k,types:new q(s),props:B`const ${I} = ${q.fn($,a)}`}}function kS(j,A,e=!1){let t=[],r=g0(j),o=new q.Set(A.variables);for(let n of r){if(n.type==="divider")continue;let a=new q(n.id);!e&&!A.variables.has(a)||(t.push({id:n.id,definition:n}),o.delete(a))}for(let n of o)t.push({id:String(n)});return t}function uS(j,A){let{hidden:e,...t}=j;if(!A)return t;let{description:r,...o}=t;return o}function mS(j,A,{modulesStore:e,treeStore:t},{imports:r,variables:o},n,a){let{id:i,type:s}=j;switch(s){case"controlReference":{let l=AA(qp(t.tree,j.entityIdentifier));if(!l||!j.entityIdentifier||!cj(l))return;let d=r.addModuleImport(l,{composeWithImports:[r.addImport("framer",{exportSpecifier:"getPropertyControls"})]});if(!d)return;let p=new vj({hidden:B`undefined`,description:B`undefined`});return vj.addSpreadAtStart(p,B`${d}[${j.controlKey}]`),_(A.title)&&(p.title=A.title),_(A.description)&&(p.description=A.description),A.type==="responsiveimage"&&o6(A)&&r6(A.__vekterDefault)&&(p[a7]=q.fromValue(A.__vekterDefault)),t6(A)?p[i7]=q.fromValue(A.__defaultAssetReference):oA(j.initialValue)||(p.defaultValue=q.fromValue(j.initialValue)),B`${d}?.[${j.controlKey}] && ${p}`}case"nodePropertyControlReference":case"array":case"vectorsetitem":case"boolean":case"color":case"date":case"enum":case"eventhandler":case"file":case"image":case"link":case"linkrelvalues":case"number":case"richtext":case"scrollsectionref":case"customcursor":case"cursor":case"transition":case"boxshadow":case"string":case"border":case"borderradius":case"gap":case"padding":case"collectionreference":case"multicollectionreference":case"trackingid":case"slug":{let l={...uS(A,n),type:E0(A.type,r)};if(a==="vector"&&o){let d=new q(i);l.hidden=!o.variables.has(d)}return l}default:lA(s)}}function g0(j){return Ye(j)?j.variables:[]}function ES(j,A,e,t,r=g0(j)){let o=nS(j,e.imports),n=qi(j),a=[...r];if(tj(j)){let i=ek(j);a.push(i);let s=tk(j);a.push(s)}for(let i of a){if(i.type==="divider")continue;let s=S6(A.treeStore.tree,i);if(Cj(s))continue;E(s.type!=="image","Image variables should become responsive images");let l=mS(i,s,A,e,n,t);oA(l)||(o[i.id]=l)}if(!$e(o))return new vj(o,1)}function yY(j,A,e,t,r,o){let n={},a=[];for(let{id:i,definition:s}of fS(j,e.variables)){let l=s?S6(A.treeStore.tree,s):void 0;n[i]={control:l,variable:s},s&&a.push(s)}return{propertyControls:ES(j,A,e,r,a),...pS(n,j,A,e,t,o)}}function fS(j,A){return kS(j,A,re(j))}var ei=yj(s6());function h0(){return document.body.dataset.framerTheme==="dark"}var R0=Yj()?["Control","Option","Shift","CommandOrControl","Command"]:["CommandOrControl","Command","Control","Alt","Shift"];function rd(j){return j?j.split("+").sort((A,e)=>{let t=R0.indexOf(A),r=R0.indexOf(e);return t!==-1&&r!==-1?t-r:t!==-1?-1:r!==-1?1:0}).map(A=>{switch(A){case"Backspace":case"Delete":return Yj()?"\u232B":"Del";case"Command":return"\u2318";case"CommandOrControl":return Yj()?"\u2318":"Ctrl";case"Control":return Yj()?"\u2303":"Ctrl";case"Down":return"\u2193";case"Enter":case"Return":return Yj()?"\u21A9":"Enter";case"Left":return"\u2190";case"-":return"\u2013";case"Option":return Yj()?"\u2325":"Alt";case"Plus":return Yj()?"+":"=";case"Right":return"\u2192";case"Shift":return Yj()?"\u21E7":"Shift";case"Up":return"\u2191";case"Escape":return"ESC"}return A}):[]}function od(j,A){let e=[];return j.forEach(t=>{let{accelerator:r,acceleratorWindows:o,checked:n,mixed:a,enabled:i,ellipsis:s,role:l,type:d="normal",visible:p,requiresUserInteraction:k,acceleratorLabel:g,acceleratorLabelWindows:$,badge:F,icon:I}=t;if(d==="separator")e.push({type:"separator",visible:p});else if(d==="normal"){let S;i!==void 0&&(S=!i);let T=!Yj()&&o!==void 0?o:r,v=!Yj()&&$!==void 0?$:g,P=v?rd(v):T?rd(T):void 0,N=t.label;N&&s&&(N+="\u2026");let Q={accelerator:T,acceleratorLabelTokens:P,tokenDelimiter:Yj()?void 0:"+",checked:n||a,disabled:S,label:N||"",description:t.description,action:l,type:d,visible:p,requiresUserInteraction:k,badge:F,icon:I};Q.submenu=t.submenu&&od(t.submenu,A),A&&A(Q),Q.visible===void 0&&(Q.visible=!0),e.push(Q)}else throw Error(`Unhandled type: ${d}`)}),e}var vs={importFigma:"CommandOrControl+Shift+I",newProject:"Option+CommandOrControl+N",publishSite:"CommandOrControl+Shift+P",openPublishedSite:"CommandOrControl+Shift+O",uploadImage:"Option+CommandOrControl+I",quickActions:"CommandOrControl+K",toggleLocalization:"CommandOrControl+Shift+L",toggleContentManagement:"Option+C",toggleVersionHistory:"Shift+CommandOrControl+H",generateWebPage:"W",undo:"CommandOrControl+Z",redo:"CommandOrControl+Shift+Z",goBack:"CommandOrControl+[",goForward:"CommandOrControl+]",cut:"CommandOrControl+X",copy:"CommandOrControl+C",copyFill:"CommandOrControl+Shift+C",paste:"CommandOrControl+V",delete:"Delete",selectMostRecentPage:"Option+Escape",selectAll:"CommandOrControl+A",selectGroundNode:"CommandOrControl+Escape",selectParent:"Escape",copyStyle:"CommandOrControl+Option+C",pasteStyle:"CommandOrControl+Option+V",pasteInPlace:"CommandOrControl+Shift+V",duplicate:"CommandOrControl+D",toggleLayerLock:"CommandOrControl+L",toggleLayerVisible:"CommandOrControl+;",rename:"CommandOrControl+R",selectSiblings:"CommandOrControl+Shift+A",cycleSelection:"Tab",decycleSelection:"Shift+Tab",fakeSelectChildren:"Enter",zoomIn:"CommandOrControl+Plus",zoomOut:"CommandOrControl+-",resetZoom:"CommandOrControl+0",zoomToFitAll:"CommandOrControl+1",zoomToFitSelection:"CommandOrControl+2",openPanelSearch:"CommandOrControl+F",toggleInterface:"CommandOrControl+.",toggleRulers:"Control+R",toggleGrids:"Control+G",toggleAppearance:"Control+Command+N",showPages:"Option+1",showLayers:"Option+2",showAssets:"Option+3",collapseLayers:"Option+L",startLinkTool:"L",sampleColor:"Control+C",toggleInsert:"I",toggleLibraryModal:"CommandOrControl+/",toolCreateStack:"S",toolCreateFrame:"F",toolCreateRounded:"U",toolCreateImage:"Shift+I",toolCreateVideo:"Shift+V",toolCreateText:"T",toolComment:"C",toolChat:"/",toolZoom:"Z",toolPath:"P",toolScale:"K",toolCreateRectangleShape:"R",toolCreateOvalShape:"O",toolCreateRows:"Shift+R",toolCreateColumns:"Shift+C",toolCreateGrid:"Shift+G",addEnclosingFrame:"CommandOrControl+Return",addEnclosingStack:"CommandOrControl+Option+Return",autoSizeLayout:"Shift+A",removeFramePreservingChildren:"CommandOrControl+Delete",sizeToFitContent:"Control+Option+R",moveForward:"CommandOrControl+Option+Up",moveBackward:"CommandOrControl+Option+Down",moveToFront:"]",moveToBack:"[",alignLeft:"Option+A",alignCenter:"Option+H",alignRight:"Option+D",alignTop:"Option+W",alignMiddle:"Option+V",alignBottom:"Option+S",distributeHorizontal:"Control+Option+H",distributeVertical:"Control+Option+V",unite:"Option+Shift+U",subtract:"Option+Shift+S",intersect:"Option+Shift+I",exclude:"Option+Shift+E",join:"Option+Shift+J",saveCodeFile:"CommandOrControl+S",makeBold:"CommandOrControl+B",makeItalic:"CommandOrControl+I",makeUnderlined:"CommandOrControl+U",chooseFontFamily:"CommandOrControl+T",group:"CommandOrControl+G",ungroup:"CommandOrControl+Shift+G",makeComponent:"CommandOrControl+Option+K",makeCodeComponent:"CommandOrControl+Shift+K",showPreview:"CommandOrControl+P",openFullScreen:"CommandOrControl+Shift+F",toggleHighlightsInLivePreview:"CommandOrControl+Shift+H",reload:"CommandOrControl+R",toggleConsole:"CommandOrControl+I",handleResponsive:"Z",togglePreviewInterface:"CommandOrControl+Shift+F",previewNextBreakpoint:"CommandOrControl+.",previewPreviousBreakpoint:"CommandOrControl+,",runRecentPlugin:"CommandOrControl+Option+P",openDevelopmentPlugin:"CommandOrControl+Option+L",openSiteSettings:"Shift+,",previousCollectionItem:"CommandOrControl+Up",nextCollectionItem:"CommandOrControl+Down",newCollectionItem:"N",pasteCollection:"CommandOrControl+V"},nd={sampleColor:"",selectGroundNode:"",openFullScreen:"Control+Alt+F",resetZoom:"Shift+0",zoomToFitAll:"Shift+1",zoomToFitSelection:"Shift+2",toggleInterface:"Alt+.",toggleRulers:"Control+Shift+R",toggleGrids:"Alt+G",toggleAppearance:"Alt+N",distributeHorizontal:"Alt+Shift+H",distributeVertical:"Alt+Shift+V"},NY=j=>la?vs[j]:nd[j]??vs[j];var $S=(0,ei.List)();async function BS(j){return{indexPath:(await new Promise(e=>{let{location:t={x:0,y:0},within:r,className:o}=j,n=od(j.items,a=>{if("action"in a&&a.action){let{states:i,options:s}=k0(a.action),l=i[a.action],{label:d,checked:p,visible:k}=s[a.action]??{};if(_(d)&&(a.label=d),a.checked===void 0&&pt(p)&&(a.checked=p),a.visible===void 0&&pt(k)&&(a.visible=k),a.submenu)return;a.disabled===void 0&&pt(l)&&(a.disabled=!l)}});Pm.show(n,{location:t,within:r,className:o,isDarkMode:h0(),maxItemsPerMenu:24,expandRight:j.expandRight,onSelection:a=>{let i=gS(n,a.path);i?.type==="normal"&&i.requiresUserInteraction&&e(a)},enableTranslate:!0}).then(e)}))?.path??[]}}function gS(j,A){let e;for(let t of A){if(!j||(e=j[t],!e))return;j=e.type==="normal"&&e.submenu||[]}return e}var ji=class ji extends s7("Menu"){constructor(){super();R(this,"_items");R(this,"handlePopupResponse",Hu((e,t)=>{if(!e||e.length===0){t&&t();return}let r=this._items,o,n;for(let a of e){if(o=r.get(a),!o)throw Error("Could not find expected menu item");o.editReason!==void 0&&(n=o.editReason),r=o.submenu?._items??$S}n?il()?.setEditReason(n):n!==!1&&il()?.setEditReason(o?.role??xp(o?.label)),o!==void 0&&o.click!==void 0?o.click():o?.role!==void 0&&c0(o.role,{fromContextMenu:!0})}));this._items=(0,ei.List)()}static buildFromTemplate(e){let t=new ji;for(let r of e)t.append(new ad(ji.getItemTemplateWithShortcut(r)));return t}get items(){return this._items.toArray()}append(e){this._items=this._items.push(e)}insert(e,t){this._items=this._items.insert(e,t)}popup(e,t){return new Promise(r=>{let o=JSON.parse(JSON.stringify(this._items.toJS()));BS({items:o,location:e,within:t?.within,className:t?.className,expandRight:t?.expandRight}).then(n=>this.handlePopupResponse(n.indexPath,t?.onCancel)).catch(SA).finally(r)})}};R(ji,"getItemTemplateWithShortcut",e=>{let{role:t}=e;if(!t)return e;let r={...e};return!la&&!e.acceleratorWindows&&(r.acceleratorWindows=nd[t]),e.accelerator||(r.accelerator=vs[t]),r});var id=ji,hS={enabled:void 0,visible:void 0,label:void 0,description:void 0,click:void 0,type:"normal",accelerator:void 0,acceleratorWindows:void 0,acceleratorLabel:void 0,acceleratorLabelWindows:void 0,submenu:void 0,checked:void 0,mixed:void 0,role:void 0,requiresUserInteraction:void 0,alternate:void 0,badge:void 0,icon:void 0,editReason:void 0},ad=class extends(0,ei.Record)(hS){constructor(e){e.label&&e.ellipsis&&(e.label=`${e.label}\u2026`),e.submenu!==void 0&&!("__class"in e.submenu&&e.submenu.__class==="Menu")&&(e.submenu=id.buildFromTemplate(e.submenu));super(e);R(this,"enabled");R(this,"visible");R(this,"label");R(this,"ellipsis");R(this,"checked");R(this,"mixed");R(this,"click");R(this,"role");R(this,"requiresUserInteraction");R(this,"alternate");R(this,"editReason");R(this,"submenu")}toJS(){let e=super.toJS();return e.submenu!==void 0&&(e.submenu=e.submenu._items.toJS()),e}};function zY(j){return{...j,enabled:j.enabled(),click:()=>{j.enabled()&&j.click()}}}function XY(j){return Array.isArray(j)}var RS=512,wt,sd,ld,ti=class{constructor(A){this.assetMap=A;xA(this,wt);R(this,"keys",new Set)}addAsset(A){this.keys.add(A)}resolve(A){if(!Mo(this,wt,sd).call(this,A))return;let e=Mo(this,wt,ld).call(this,A);if(e!==null)return e&&(A=e.identifier),{src:Xd(A)}}resolveResponsiveImage(A,e,t){if(!Mo(this,wt,sd).call(this,A))return;let r=Mo(this,wt,ld).call(this,A);if(r===null)return;let o;r&&(A=r.identifier,o=r.preferredSize);let n=this.assetMap.assetForKey(A),a=n?.properties?.image,i=Zd(a?.width,a?.height),l={src:n?A7(n,o,e,i).url:zd(A),positionX:void 0,positionY:void 0,srcSet:this.generateSrcSet(n,i,o),pixelWidth:n?.properties?.image?.width,pixelHeight:n?.properties?.image?.height};return t&&_(t.positionX)&&_(t.positionY)&&(l.positionX=t.positionX,l.positionY=t.positionY),l}generateSrcSet(A,e,t){if(!A)return;let r;if((!t||t==="auto"||t==="lossless")&&e?.length&&A.properties?.image){r="";for(let{maxSideSize:n,width:a}of e)a<RS||(r+=`${Ys(A,n,t)} ${a}w,`);r+=`${Ys(A,void 0,t)} ${A.properties.image.width}w`}return r}};wt=new WeakSet,sd=function(A){return!(qe(A)||A.startsWith("https:"))},ld=function(A){let e=Yd(A);return e&&(A=e.identifier),A===""?null:(this.addAsset(A),e)};function cd(j,A){let e=[],t=u7(j,o=>{let n=A.create(o);return e.push(o),"${"+n+"}"});return{templatedUrl:new q("`"+t+"`"),usedVariables:e}}function Ts(j,A,e,t=void 0){if(WA(j.value))return Ut(!I7(j.value),"Computed values should not be possible in fetch fallback"),A.create(j.value);switch(j.type){case"color":return j.value?B`${j.value}`:B`undefined`;case"string":return B`${j.value}`;case"boolean":return new q(j.value);case"number":return new q(j.value);case"image":{if(j.value===void 0)return B`undefined`;let r=e.resolveResponsiveImage(j.value,void 0,void 0);return r?B`${r.src}`:B`undefined`}case"link":{if(!j.value||!t)return B`undefined`;let r=t.create(j.value);return r?new q(OA(r)):B`undefined`}default:Bi(j)}}function Ps(j,A,e,t=void 0){let{templatedUrl:r}=cd(j,A),o=yi(j);return new vj({url:r,resultKeyPath:j.resultKeyPath,fallbackValue:Ts(o.controlProp,A,e,t),errorFallbackValue:o.errorControlProp?Ts(o.errorControlProp,A,e,t):void 0,resultOutputType:o.controlProp.type,cacheDuration:j.cacheDuration,credentials:j.credentials})}var ri=class{constructor(A,e,t,r,o){this.bindings=A;this.variables=e;this.preload=t;this.assets=r;this.links=o;R(this,"fetchesByNode",new Map);R(this,"resultBindingsByNode",new Map)}createFetchBinding(A,e){let t=yi(e);if(!k7(t))return Ts(t.controlProp,this.variables,this.assets,this.links);let r=A.originalid??A.id,o=this.resultBindingsByNode.get(r)??this.bindings.create("fetchResult");this.resultBindingsByNode.set(r,o),this.preload.addFetch(A,t);let n=this.fetchesByNode.get(A.id)??[];return n.push(Ps(t,this.variables,this.assets,this.links)),this.fetchesByNode.set(A.id,n),B`${o}[${n.length-1}]`}getResultBinding(A){return this.resultBindingsByNode.get(A.originalid??A.id)}getFetchesForNode(A){return this.fetchesByNode.get(A.id)}};var dd=class{constructor(A,e,t,r){this.moduleType=A;this.modulesStore=e;this.submoduleName=t;this.sourceCode=r;R(this,"submoduleFilename");R(this,"submoduleImport");R(this,"bindings",new lr);R(this,"imports");R(this,"declarations",new kr(this.bindings));this.submoduleFilename=ba(this.submoduleName),this.submoduleImport=Ca(this.submoduleFilename),this.imports=new cr(this.moduleType,this.modulesStore,this.bindings)}get estimatedSize(){return this.declarations.declarationsByteSize}serialize(){let A=Rj.linesFrom(this.imports.statements),e=this.declarations.list();return Rj.sections(A,this.sourceCode,...e)}},Ms=class{constructor(A,e,t){this.moduleType=A;this.modulesStore=e;this.componentSourceNodeId=t;R(this,"submodules",new Set)}create(A){let e=bm(this.componentSourceNodeId,this.submodules.size),t=new dd(this.moduleType,this.modulesStore,e,A);return this.submodules.add(t),t}delete(A){this.submodules.delete(A)}serialize(){let A=new Map;for(let e of this.submodules){let t=e.serialize();A.set(e.submoduleName,t)}return A}};function I0(j){return`${j}ToDisplayName`}var F0="enumToDisplayNameFunctions";function G0(j){if(j?.type!=="enum"||!j.optionTitles)return B`(value) => value`;let A=j.optionTitles;return new q(Rj.lines(B`(value, _locale) => {`,B`switch (value) {`,...j.options.map((e,t)=>{let r=A[t];return B`case ${e}: return ${oA(r)?B`undefined`:r};`}),B`default: return "";`,B`}`,B`}`))}function S0(j){let{locale:A,grouping:e,notation:t,compactDisplay:r,style:o,currency:n,currencyDisplay:a,unit:i,unitDisplay:s,minimumFractionDigits:l,maximumFractionDigits:d,minimumIntegerDigits:p}=j,k={locale:A,notation:t,style:o};switch(pt(e)&&(k.useGrouping=e),Y(l)&&(k.minimumFractionDigits=l),Y(d)&&(k.maximumFractionDigits=d),Y(p)&&(k.minimumIntegerDigits=p),t==="compact"&&(k.compactDisplay=r),o){case"currency":k.currency=n,k.currencyDisplay=a;break;case"unit":k.unit=i,k.unitDisplay=s;break}return new vj(k)}var y0=B`(value, options = {}, activeLocale) => {
    const fallbackLocale = "en-US";
    const locale = options.locale || activeLocale || fallbackLocale;
    const {
        useGrouping,
        notation,
        compactDisplay,
        style,
        currency,
        currencyDisplay,
        unit,
        unitDisplay,
        minimumFractionDigits,
        maximumFractionDigits,
        minimumIntegerDigits,
    } = options;
    const formatOptions = {useGrouping, notation, compactDisplay, style, currency, currencyDisplay, unit, unitDisplay, minimumFractionDigits, maximumFractionDigits, minimumIntegerDigits};
    const number = Number(value);
    try {
        return number.toLocaleString(locale, formatOptions);
    } catch {
        try {
            return number.toLocaleString(fallbackLocale, formatOptions);
        } catch {
            return number.toLocaleString();
        }
    }
};
`;function b0(j,A){if(A.length===0)return null;E(j);let e=new Set;for(let r of A){let o=j.create(r);e.add(OA(o))}let t=`{${Array.from(e).join(", ")}}`;return new q(t)}function C0(j,A,e,t){let r=j.name;switch(r){case"contains":case"endsWith":case"equals":case"startsWith":case"greaterThan":case"lessThan":case"isBefore":case"isAfter":case"isIncludedIn":return cA(j.value)?(E(e),[e.create(j.value)]):[oA(j.value)?B`undefined`:j.value];case"prefix":case"suffix":{if(cA(j.value))return E(e),[e.create(j.value)];let n=oA(j.value)?B`undefined`:j.value;return j.valueLocalized?(E(t,"LocalizedValueCollector is required"),[t.add(n,j.valueLocalized,a=>j.valueLocalized?.[a]?.value)]):[n]}case"toDateString":return[A.getActiveLocaleCode()];case"extractDateSegment":return[j.segment];case"numberToString":return[S0(j),A.getActiveLocaleCode()];case"offsetAndLimitArray":return[j.startOffset,Y(j.limit)?j.limit:B`undefined`];case"isBetweenDates":{let n=[];return cA(j.start)?(E(e),n.push(e.create(j.start))):n.push(oA(j.start)?B`undefined`:j.start),cA(j.end)?(E(e),n.push(e.create(j.end))):n.push(oA(j.end)?B`undefined`:j.end),n}case"convertFromEnum":case"convertFromString":{let a=function(l){Vj(l)&&Qe(l,d=>a(d)),cA(l)&&n.push(l)};var o=a;let n=[];a(j.default);for(let l of j.cases)a(l.to);let i=b0(e,n),s=e?.getLocale()??B`undefined`;return i?[s,i]:[s]}case"convertFromBoolean":{let a=function(d){Vj(d)&&Qe(d,p=>a(p)),cA(d)&&n.push(d)};var o=a;let n=[];a(j.truthy),a(j.falsy);let i=e?.getLocale()??B`undefined`,s=b0(e,n);return s?[i,s]:[i]}case"enumToDisplayName":return A.variables?[A.variables.getLocale()]:[];case"toString":case"toBoolean":case"toNumber":case"isSet":case"negate":case"reverseArray":case"toResponsiveImage":case"toImageSrc":case"jsonStringify":case"htmlEscape":case"htmlUnescape":case"addImageAlt":case"toZIndex":case"toAxisOverflow":case"numberToPixelString":case"radiusForCorner":case"arrayToArray":case"arrayLength":case"isEven":case"isOdd":case"getGridColumnCSSValue":case"getGridRowCSSValue":case"getNumericColumnGap":return[];default:lA(r,"All value transforms should define their arguments")}}var v0=B`(image, alt) => {
    if (!image || typeof image !== "object") {
        return;
    };
    return { ...image, alt };
};
`;var T0=B`(value) => {
    return Array.isArray(value) ? value.length : 0
}
`;function P0(j){let A=B`item`,e={[gr]:B`${A}?.[${gr}]`};for(let t in j.mapping){let r=j.mapping[t];if(E(te(r)),$7(r.value)){e[t]=B`${A}?.[${r.value.id}]`;continue}r.value}return B`(value) => {
      if (!Array.isArray(value)) return
      return value.map((${A}) => (${e}))
    }`}var M0=B`(a, b) => {
    if (typeof a === "string" && typeof b === "string") {
        return a.toLowerCase().includes(b.toLowerCase());
    }

    if (Array.isArray(a) && typeof b === "string") {
        return a.includes(b);
    }

    return false;
};
`;function IS(j){let A=Ft(j.outputType);return OA(B`return ${tt(A)?A:B`undefined`};`)}function _0(j,A,e,t,r,o,n){if(e==="link")return!n||!Vj(j)&&!cA(j)?void 0:n.create(j);if(!Vj(j))return cA(j)?r.create(j):Yp(e,j,t)?o&&A&&e==="string"?o.add(j,A,a=>A?.[a]?.value):j:Zp(e,t)}function FS(j,A,e,t,r){if(!Xp(j.outputType))return IS(j);let o=_0(j.truthy,j.truthyLocalized,j.outputType,A,e,t,r),n=_0(j.falsy,j.falsyLocalized,j.outputType,A,e,t,r);return Rj.lines(B`if (value) {`,B`return ${o===void 0?B`undefined`:o};`,B`} else {`,B`return ${n===void 0?B`undefined`:n};`,B`}`)}function D0(j,A,e,t,r){E(e),E(t),E(r);let o=new Set;function n(i){if(Vj(i)&&Qe(i,s=>n(s)),cA(i)){E(e);let s=e.create(i);o.add(OA(s))}}n(j.truthy),n(j.falsy);let a=[B`value`,_A.activeLocale];if(o.size>0){let i=`{${Array.from(o).join(", ")}}`;a.push(new q(i))}return new q(Rj.lines(B`(${new q(a.map(OA).join(", "))}) => {`,new q(FS(j,A,e,t,r)),B`}`))}function Co(j,A,e,t,r,o,n){if(e==="link")return!n||!Vj(j)&&!cA(j)?void 0:n.create(j);if(!Vj(j))return cA(j)?r.create(j):Wp(e,j,t)?o&&e==="string"&&_(j)&&A?o.add(j,A,a=>A?.[a]?.value):j:zp(e,t)}function N0(j){let A=Ft(j.outputType);return OA(B`return ${tt(A)?A:B`undefined`};`)}function GS(j,A,e,t,r,o){if(A?.type!=="enum"||!Qp(j.outputType))return N0(j);let n=new Set,a=Co(j.default,j.defaultLocalized,j.outputType,e,t,r,o);return Rj.lines(B`switch (value) {`,...j.cases.filter(i=>n.has(i.from)||!A.options.includes(i.from)?!1:(n.add(i.from),!0)).map(i=>{let s=Co(i.to,i.toLocalized,j.outputType,e,t,r,o);return B`case ${i.from}: return ${s===void 0?B`undefined`:s};`}),B`default: return ${a===void 0?B`undefined`:a};`,B`}`)}function x0(j,A,e,t,r,o){E(t),E(r),E(o);let n=new Set;function a(s){if(Vj(s)&&Qe(s,l=>a(l)),cA(s)){E(t);let l=t.create(s);n.add(OA(l))}}j.cases.forEach(s=>{a(s.to)}),a(j.default);let i=[B`value`,_A.activeLocale];if(n.size>0){let s=`{${Array.from(n).join(", ")}}`;i.push(new q(s))}return new q(Rj.lines(B`(${new q(i.map(OA).join(", "))}) => {`,new q(GS(j,A,e,t,r,o)),B`}`))}function SS(j){let A=Ft(j.outputType);return OA(B`return ${tt(A)?A:B`undefined`};`)}function yS(j,A,e,t,r){if(!Up(j.outputType))return SS(j);let o=new Set,n=Co(j.default,j.defaultLocalized,j.outputType,A,e,t,r);return Rj.lines(B`switch (typeof value === "string" ? value.toLowerCase() : value) {`,...j.cases.filter(a=>{let i=a.from.toLowerCase();return o.has(i)?!1:(o.add(i),!0)}).map(a=>{let i=Co(a.to,a.toLocalized,j.outputType,A,e,t,r);return B`case ${a.from.toLowerCase()}: return ${i===void 0?B`undefined`:i};`}),B`default: return ${n===void 0?B`undefined`:n};`,B`}`)}function O0(j,A,e,t,r){E(e),E(t),E(r);let o=new Set;function n(i){if(Vj(i)&&Qe(i,s=>n(s)),cA(i)){E(e);let s=e.create(i);o.add(OA(s))}}j.cases.forEach(i=>{n(i.to)}),n(j.default);let a=[B`value`,_A.activeLocale];if(o.size>0){let i=`{${Array.from(o).join(", ")}}`;a.push(new q(i))}return new q(Rj.lines(B`(${new q(a.map(OA).join(", "))}) => {`,new q(yS(j,A,e,t,r)),B`}`))}var w0=B`(a, b) => {
    return typeof a === "string" && typeof b === "string" && a.toLowerCase().endsWith(b.toLowerCase());
};
`;var L0=B`(a, b) => {
    return (typeof a === "string" && typeof b === "string") ? a.toLowerCase() === b.toLowerCase() : a === b;
};
`;var q0=B`(value, segment = "year") => {
    if (typeof value !== "string") return;
    const date = new Date(value);
    if (isNaN(date.getTime())) return;
    if (segment === "year") return date.getUTCFullYear();
    if (segment === "month") return date.getUTCMonth() + 1;
    if (segment === "day") return date.getUTCDate();
    if (segment === "hour24") return date.getUTCHours();
    if (segment === "hour12") {
        const hour = date.getUTCHours();
        return hour === 0 ? 12 : hour > 12 ? hour - 12 : hour;
    }
    if (segment === "minute") return date.getUTCMinutes();
};
`;var pd=B`spanCount`,_s=B`optionalColumnCount`,K0=B`(columnSpan, ${_s}) => {
    if (columnSpan === "all") return "-1 / 1";
    const ${pd} = Number.isFinite(columnSpan) && columnSpan > 0 ? columnSpan : 1;
    if (Number.isFinite(${_s}) && ${pd} > ${_s}) {
        return ${ar`span ${_s}`};
    }
    return ${ar`span ${pd}`};
};
`;var V0=B`spanCount`,J0=B`(rowSpan) => {
    const ${V0} = Number.isFinite(rowSpan) && rowSpan > 0 ? rowSpan : 1;
    return ${ar`span ${V0}`}
};
`;var H0=B`(gap) => {
    if (Number.isFinite(gap) && gap >= 0) return gap;
    if (typeof gap !== "string") return 0;
    const firstSegment = gap.split(" ")[0];
    const parsedGap = parseFloat(firstSegment);
    return Number.isFinite(parsedGap) && parsedGap >= 0 ? parsedGap : 0;
};
`;var Q0=B`(a, b) => {
    return (typeof a === "number" && typeof b === "number") ? a > b : false;
};
`;var U0=B`(value) => {
    if (typeof value !== "string") return "";
    return value.replaceAll("&", "&amp;").replaceAll("<", "&lt;").replaceAll(">", "&gt;").replaceAll('"', "&quot;").replaceAll("'", "&#39;");
};
`;var W0=B`(value) => {
    if (typeof value !== "string") return "";
    const entities = /&(?:[gl]t|quot|#39|amp|#6[02]|#34|apos|#38);/gu;
    const replacers = { "&lt;": "<", "&gt;": ">", "&quot;": '"', "&#39;": "'", "&amp;": "&", "&#60;": "<", "&#62;": ">", "&#34;": '"', "&apos;": "'", "&#38;": "&" };
    return value.replace(entities, match => replacers[match]);
};
`;var z0=B`(dateString, minDateString) => {
    if (typeof dateString !== "string" || typeof minDateString !== "string") return false;

    const date = new Date(dateString);
    if (isNaN(date.getTime())) return false;

    const minDate = new Date(minDateString);
    if (isNaN(minDate.getTime())) return false;

    return date >= minDate;
};
`;var X0=B`(dateString, maxDateString) => {
    if (typeof dateString !== "string" || typeof maxDateString !== "string") return false;

    const date = new Date(dateString);
    if (isNaN(date.getTime())) return false;

    const maxDate = new Date(maxDateString);
    if (isNaN(maxDate.getTime())) return false;

    return date <= maxDate;
};
`;var Y0=B`(value, start, end) => {
    if (typeof value !== "string" || typeof start !== "string" || typeof end !== "string") return false;

    const date = new Date(value);
    if (isNaN(date.getTime())) return false;

    const startDate = new Date(start);
    if (isNaN(startDate.getTime())) return false;

    const endDate = new Date(end);
    if (isNaN(endDate.getTime())) return false;

    return date >= startDate && date <= endDate;
};
`;var Z0=B`(value) => {
    return typeof value === "number" && value % 2 === 0;
};
`;var Ag=B`(a, b) => {
    return b.includes(a);
};
`;var jg=B`(value) => {
    return typeof value === "number" && value % 2 === 1;
};
`;var eg=B`(value) => {
    if (Array.isArray(value)) return value.length > 0;
    return value !== undefined && value !== null && value !== "";
};
`;var tg=B`(value) => {
    const result = JSON.stringify(value)
    if (typeof result === 'string') return result.replace(/<\\/(script|style)/gi, '<\\\\/$1')
    return result
};
`;var rg=B`(a, b) => {
    return (typeof a === "number" && typeof b === "number") ? a < b : false;
};
`;var og=B`(value) => {
    return !value;
};
`;var ng=B`(value) => {
    if (typeof value !== "number") return value;
    if (!Number.isFinite(value)) return undefined;
    return Math.max(0, value) + "px";
};
`;var ig=B`(value, offset, limit) => {
    if (!Array.isArray(value)) return []
    const end = typeof limit === "number" ? offset + limit : undefined
    return value.slice(offset, end);
};
`;var ag=B`(value, prefix) => {
    if (typeof value === "string" && typeof prefix === "string") {
        return prefix + value;
    } else if (typeof value === "string") {
        return value;
    } else if (typeof prefix === "string") {
        return prefix;
    }
    return "";
};
`;var sg=B`(value, cornerIndex) => {
    if (typeof value === "number" && Number.isFinite(value)) return Math.max(0, value) + "px";
    if (typeof value !== "string" || typeof cornerIndex !== "number") return undefined;
    const segments = value.split(" ");
    return segments[cornerIndex] || segments[cornerIndex - 2] || segments[0];
};
`;var lg=B`(value) => {
    return Array.isArray(value) ? Array.from(value).reverse() : [];
}
`;var cg=B`(a, b) => {
    return typeof a === "string" && typeof b === "string" && a.toLowerCase().startsWith(b.toLowerCase());
};
`;var dg=B`(value, suffix) => {
    if (typeof value === "string" && typeof suffix === "string") {
        return value + suffix;
    } else if (typeof value === "string") {
        return value;
    } else if (typeof suffix === "string") {
        return suffix;
    }
    return "";
};
`;var pg=B`(value, overflow) => {${B.joinLines(B`if (overflow === "visible" || value === "visible") return undefined`,B`return value`)}};`;var kg=B`(value) => {
    return Boolean(value);
};
`;var ug=B`value`,mg=B`activeLocale`;function Eg(j,A){let e=A.dedupe("sharedDateFormatter",new q(Rj.lines(B`(value, formatOptions, locale) => {`,B`  if (typeof value !== "string") return "";`,B`  const date = new Date(value);`,B`  if (isNaN(date.getTime())) return "";`,B`  const fallbackLocale = "en-US";`,B`  try {`,B`      return date.toLocaleString(locale || fallbackLocale, formatOptions);`,B`  } catch {`,B`      return date.toLocaleString(fallbackLocale, formatOptions);`,B`  }`,B`};`))),t=jk(j.display,j.format,j.dateStyle),r={...Ak[t].options,timeZone:"UTC"},o=A.dedupe("dateOptions",new q(OA(r)));return new q(Rj.lines(B`(${ug}, ${mg}) => {`,B`return ${q.fn(e,ug,o,j.locale||mg)};`,B`};`))}var fg=B`(value) => {
    if (typeof value === "object" && value !== null && typeof value.src === "string") {
        return value.src;
    };
    return typeof value === "string" ? value : undefined;
};
`;var $g=B`(value) => {
    if (typeof value === "number" && Number.isFinite(value)) return value;
    if (typeof value !== "string") return 0;
    const parsedNumber = parseFloat(value);
    return (typeof parsedNumber === "number" && Number.isFinite(parsedNumber)) ? parsedNumber : 0;
};
`;var Bg=B`(value) => {
    if (typeof value === "object" && value !== null && typeof value.src === "string") {
        return value;
    };
    return typeof value === "string" ? {src: value} : undefined;
};
`;var gg=B`(value) => {
    return typeof value === "string" ? value : String(value);
};
`;var hg=B`(value) => {${B.joinLines(B`if (value < -1) return -1`,B`if (value > 11) return 11`,B`return value`)}};`;function Rg(j){switch(j){case"isAfter":return z0;case"isBefore":return X0;case"isBetweenDates":return Y0;case"contains":return M0;case"endsWith":return w0;case"equals":return L0;case"isSet":return eg;case"greaterThan":return Q0;case"lessThan":return rg;case"negate":return og;case"numberToString":return y0;case"startsWith":return cg;case"toString":return gg;case"toNumber":return $g;case"toBoolean":return kg;case"extractDateSegment":return q0;case"reverseArray":return lg;case"offsetAndLimitArray":return ig;case"arrayLength":return T0;case"prefix":return ag;case"suffix":return dg;case"toResponsiveImage":return Bg;case"toImageSrc":return fg;case"jsonStringify":return tg;case"htmlEscape":return U0;case"htmlUnescape":return W0;case"addImageAlt":return v0;case"toZIndex":return hg;case"toAxisOverflow":return pg;case"numberToPixelString":return ng;case"radiusForCorner":return sg;case"isIncludedIn":return Ag;case"isEven":return Z0;case"isOdd":return jg;case"getGridColumnCSSValue":return K0;case"getGridRowCSSValue":return J0;case"getNumericColumnGap":return H0;default:lA(j,"All constant transform names should be implemented")}}function Ig(j,A,e,t,r,o,n){switch(j.name){case"enumToDisplayName":return G0(A);case"convertFromEnum":return x0(j,A,e,t,r,o);case"convertFromString":return O0(j,e,t,r,o);case"convertFromBoolean":return D0(j,e,t,r,o);case"arrayToArray":return P0(j);case"toDateString":return Eg(j,n);default:lA(j,"All dynamic transform names should be implemented")}}var Ae=Dd(),CS={name:"toString"},vS={name:"toNumber"},TS={name:"toBoolean"},PS={name:"toResponsiveImage"},MS={name:"toImageSrc"},_S={name:"toZIndex"},DS={name:"numberToPixelString"},NS={name:"radiusForCorner"},xS={name:"toAxisOverflow"},OS={name:"jsonStringify"},wS={name:"htmlEscape"},LS={name:"htmlUnescape"},qS={name:"addImageAlt"},KS={name:"getGridColumnCSSValue"},VS={name:"getGridRowCSSValue"},JS={name:"getNumericColumnGap"};function HS(j){return g7(j.name)}var Lt=class{constructor(A,e,t,r,o,n,a,i,s){this.fileDeclarations=A;this.componentDeclarations=e;this.imports=t;this.variables=r;this.localizedValues=o;this.links=n;this.fetches=a;this.modulesStore=i;this.type=s}wrapInTransformFunction(A,e,t,r,o){if(B7(e.name)){let n=this.fileDeclarations.dedupe(e.name,Rg(e.name));return q.fn(n,A,...t)}if(HS(e)){if(e.name==="enumToDisplayName"&&r&&r.type==="enum"){let a=this.getImportedEnumToDisplayNameIfPossible(A,r);if(a)return a}let n=Ig(e,r,o,this.variables,this.localizedValues,this.links,this.fileDeclarations);return q.fn(new q(this.fileDeclarations.dedupe(e.name,n)),A,...t)}lA(e.name,"All value transforms should be handled in wrapInTransformFunction")}getImportedEnumToDisplayNameIfPossible(A,e){let t=this.imports,r=this.modulesStore;if(!t||!r)return;let o=Tp(e);if(!o)return;let{dataIdentifier:n,enumFieldKey:a}=o;if(n===Pp)return this.variables?.getLocaleName()??B`undefined`;let i=K.dataForIdentifier(n);if(!i||!i.annotations)return;let s="framerEnumToDisplayNameUtils",l=i.annotations?.[s];if(!_(l))return;let d=Number.parseInt(l,10);if(!Y(d))return;let p=AA(n);if(!cj(p))return;let{importSpecifier:k}=Qk(p,this.type,r);if(!k)return;let g=this.variables?.getLocale()??B`undefined`;switch(d){case 1:{let $=I0(a),F=t.addImport(k,{exportSpecifier:$});return q.optionalFn(F,A,g)}case 2:{let $=F0,F=t.addImport(k,{exportSpecifier:$});return q.optionalFn(B`${F}[${a}]`,A,g)}default:throw new Error(`Enum to display name utils, unsupported version: ${d}`)}}wrapInValueTransform(A,e,t,r){return this.wrapInTransformFunction(A,e,C0(e,this,this.variables,this.localizedValues),t,r)}makeTypeSafe(A,e){switch(e){case"string":case"color":return this.wrapInTransformFunction(A,CS,Ae);case"number":return this.wrapInTransformFunction(A,vS,Ae);case"boolean":return this.wrapInTransformFunction(A,TS,Ae);case"array":case"enum":case"link":case"gap":case"padding":case"borderradius":case"image":return A;default:return A}}getActiveLocaleCode(){if(!this.componentDeclarations||!this.imports)return B`undefined`;let A=this.imports.addImport("framer",{exportSpecifier:"useLocaleCode"});return this.componentDeclarations.dedupe("activeLocaleCode",q.fn(A))}createComputedValue(A,e,t){E(this.variables);let r=n6(A)?e.cache.getVariableControlByReference(A.startValue):void 0,o=n6(A)?this.variables.create(A.startValue):this.fetches.createFetchBinding(e,A.startValue),n;A.transforms.forEach(i=>{h7(i.name)&&(o=this.wrapInValueTransform(o,i,r,t),n=i)});let a=n?R7(n.name):null;return!a||a.length>1||a[0]!==A.outputType?this.makeTypeSafe(o,A.outputType):o}wrapInToResponsiveImage(A){return this.wrapInTransformFunction(A,PS,Ae)}wrapInToImageSrc(A){return this.wrapInTransformFunction(A,MS,Ae)}wrapInToZIndex(A){return this.wrapInTransformFunction(A,_S,Ae)}wrapInNumberToPixelString(A){return this.wrapInTransformFunction(A,DS,Ae)}wrapInRadiusForCorner(A,e){return this.wrapInTransformFunction(A,NS,[e])}wrapInToAxisOverflow(A,e){return this.wrapInTransformFunction(A,xS,[e])}wrapInAddImageAlt(A,e){return this.wrapInTransformFunction(A,qS,[e])}wrapInClampRGB(A){return E(this.imports,"ValueTransformCollector: Must have imports to wrap in clampColor."),q.fn(this.imports.addImport("framer",{exportSpecifier:"clampRGB"}),A)}wrapInGetGridColumnCSSValue(A,e){return this.wrapInTransformFunction(A,KS,e?[e]:Ae)}wrapInGetGridRowCSSValue(A){return this.wrapInTransformFunction(A,VS,Ae)}wrapInGetNumericColumnGap(A){return this.wrapInTransformFunction(A,JS,Ae)}wrapInTemplateFilters(A,e){return this.makeTypeSafe(Pu(A,e,{json:t=>this.wrapInTransformFunction(t,OS,Ae),escape:t=>this.wrapInTransformFunction(t,wS,Ae),raw:t=>this.wrapInTransformFunction(t,LS,Ae)}),"string")}};function QS(j){return V(j)||tj(j)||tA(j)||Lr(j)||ij(j)}function Gg(j,A){return B`(key, locale){${B.joinLines(B`while (locale) {${B.joinLines(B`const values = ${j}[locale.id]`,B`if (values) {${B.joinLines(B`const value = ${A?B`values.read()[key]`:B`values[key]`}`,B`if (value) return value`)}}`,B`locale = locale.fallback`)}}`)}}`}var ni,Ds=class{constructor(A,e,t){this.entryNode=A;this.variables=e;this.treeStore=t;R(this,"cache",{});R(this,"valueCounter",0);xA(this,ni,!1)}freeze(){hA(this,ni,!0)}add(A,e,t){E(!eA(this,ni),"Cannot add values to a frozen LocalizedValuesCollector.");let r={};if(!e||!QS(this.entryNode))return A;let o;this.variables&&(o=new pn(this.entryNode));let n=this.treeStore.tree.root.locales??[];for(let d of n){if(!(d.id in e))continue;let p=this.createLocalizedValue(d.id,o,t);qe(p)||(r[d.id]=p)}if($e(r))return A;this.variables&&o&&this.variables.merge(o);let a=OA({defaultValue:A,localizedValues:r}),i=this.cache[a];if(i)return i;let s=`v${this.valueCounter++}`,l=q.fn(this.getLocalizedValueBinding,s,_A.activeLocale);if(o&&o.variables.size>0){let d=B.listFrom(o.variables);for(let p in r){let k=r[p];E(!qe(k),"Localized should not be null or undefined"),r[p]=B`({ ${d} }) => ${k}`}l=B`${l}?.({ ${d} })`}for(let d in r){let p=r[d];E(!qe(p),"Localized should not be null or undefined"),this.recordLocalizedValue(d,s,p)}return oA(A)||(l=B`${l} ?? ${A}`),this.cache[a]=l}};ni=new WeakMap;var qt,Fg=class extends Ds{constructor(e,t,r,o,n,a,i,s){super(e,t,r);this.imports=o;this.declarations=n;this.fetches=a;this.modulesStore=i;this.moduleType=s;R(this,"submoduleByLocaleId",new Map);R(this,"identifier",`../${Oe("localization",this.entryNode.id)}`);R(this,"submodules");R(this,"bindings",new lr);xA(this,qt);this.submodules=new Ms(this.moduleType,this.modulesStore,this.entryNode.id)}get getLocalizedValueBinding(){return this.imports.addImport(this.identifier,{exportSpecifier:"default",importBinding:"getLocalizedValue"})}canPreloadWithSuspense(){return!tA(this.entryNode)}preloadWithSuspense(){eA(this,qt)||(hA(this,qt,this.bindings.create("usePreloadLocalizedValues")),this.declarations.component.create(q.fn(this.imports.addImport(this.identifier,{exportSpecifier:OA(eA(this,qt))}),_A.activeLocale)))}createLocalizedValue(e,t,r){let o=this.submoduleByLocaleId.get(e)??this.submodules.create(),n=new ao(this.entryNode,o.imports,o.bindings,t,this.treeStore,this.modulesStore),a=r(e,{links:n,variables:t,imports:o.imports,declarations:o.declarations,valueTransforms:new Lt(o.declarations,void 0,o.imports,t,this,n,this.fetches,this.modulesStore,this.moduleType)});if(qe(a)){o&&!this.submoduleByLocaleId.has(e)&&this.submodules.delete(o);return}return this.submoduleByLocaleId.set(e,o),this.canPreloadWithSuspense()&&this.preloadWithSuspense(),a}recordLocalizedValue(e,t,r){let o=this.submoduleByLocaleId.get(e);E(o,"Localization submodule must exist"),o.declarations.create(B`export const ${new q(t)} = ${r}`)}maybeGetUsePreloadDeclarations(e){if(!this.canPreloadWithSuspense()||!eA(this,qt))return[];let t=this.bindings.create("preload"),r=eA(this,qt);return[B`function ${t}(locale) {${B.joinLines(B`const promises = []`,B`while (locale) {${B.joinLines(B`const values = ${e}[locale.id]`,B`if (values) {${B.joinLines(B`const promise = values.preload()`,B`if (promise) promises.push(promise)`)}}`,B`locale = locale.fallback`)}}`,B`if (promises.length > 0) return Promise.all(promises)`)}}`,B`export function ${r}(locale) {${B.joinLines(B`const preloadPromise = ${t}(locale)`,B`if (preloadPromise) throw preloadPromise`)}}`]}values(e){let t={};for(let[r,o]of this.submoduleByLocaleId)if(this.canPreloadWithSuspense()){let n=e.addImport("framer",{exportSpecifier:"LazyValue"});t[r]=q.fn(B`new ${n}`,B`() => import(${o.submoduleImport})`)}else t[r]=e.addImport(o.submoduleImport,{exportSpecifier:"*",importBinding:"localizedValues"});return t}module(e){if(this.freeze(),(this.treeStore.tree.root.locales??[]).length===0||this.submoduleByLocaleId.size===0)return;let r=new cr(this.moduleType,this.modulesStore,this.bindings),o=new kr(this.bindings),n=o.dedupe("valuesByLocaleId",this.values(r));return{type:"localization",revision:e,source:B.joinSections(B.joinLines(...r.statements),...o.list(),B`export default function getLocalizedValue${Gg(n,this.canPreloadWithSuspense())}`,...this.maybeGetUsePreloadDeclarations(n)),artifacts:{submodules:this.submodules.serialize()}}}};qt=new WeakMap;var ii,oi=class extends Ds{constructor(e,t,r,o,n,a,i,s,l){super(e,t,r);this.imports=o;this.bindings=n;this.declarations=a;this.fetches=i;this.modulesStore=s;this.moduleType=l;R(this,"valuesByLocaleId",{});xA(this,ii)}get getLocalizedValueBinding(){return eA(this,ii)||hA(this,ii,this.bindings.create("getLocalizedValue")),eA(this,ii)}recordLocalizedValue(e,t,r){let o=this.valuesByLocaleId[e]??{};o[t]=r,this.valuesByLocaleId[e]=o}createLocalizedValue(e,t,r){let o=new ao(this.entryNode,this.imports,this.bindings,t,this.treeStore,this.modulesStore);return r(e,{links:o,variables:t,imports:this.imports,declarations:this.declarations,valueTransforms:new Lt(this.declarations,void 0,this.imports,t,this,o,this.fetches,this.modulesStore,this.moduleType)})}list(){if(this.freeze(),(this.treeStore.tree.root.locales??[]).length===0)return[];let t=this.bindings.create("valuesByLocaleId");return[B`const ${t} = ${this.valuesByLocaleId}`,B`function ${this.getLocalizedValueBinding} ${Gg(t,!1)}`]}};ii=new WeakMap;var si,ai=class{constructor(A,e,t,r,o,n,a){this.entryNode=A;this.treeStore=e;this.variables=t;this.declarations=r;this.bindings=o;this.imports=n;this.assets=a;xA(this,si,new Map);R(this,"preloadDependencyTree",new Map)}command(A){let e=eA(this,si).get(A);if(e)return e;let t=this.bindings.create("pre"+A);return eA(this,si).set(A,t),t}addQuery(A,e,t){if(!tA(this.entryNode))return;let{destructured:r,dependencies:o}=this.getVariableDependencies(t),n=B`(${yg(this.command("query"),r)}) => ${q.fn(this.command("query"),e)}`;this.addStatement("query",A,o,q.fn(this.declarations.dedupe("query",n),this.command("query"),r))}addFetch(A,e){if(!tA(this.entryNode))return;let{usedVariables:t}=cd(e,this.variables);cA(e.controlProp.value)&&t.push(e.controlProp.value);let{destructured:r,dependencies:o}=this.getVariableDependencies(t),n=B`(${yg(this.command("fetch"),r)}) => ${q.fn(this.command("fetch"),Ps(e,this.variables,this.assets,void 0))}`;this.addStatement("fetch",A,o,q.fn(this.declarations.dedupe("query",n),this.command("fetch"),r))}createPromiseList({fetches:A,children:e},t=!1){let r=[];if(t)for(let o of A)r.push(o);for(let[,o]of e){for(let a of o.fetches)r.push(a);if(!o.value)continue;let n=o.value;if(o.children.size===0){r.push(n);continue}r.push(B`${n}.then(async collection => {await Promise.all(collection.flatMap((${XS(o.usedVariables)}) => (${this.createPromiseList(o)})))})`)}return B`[${B.listFrom(r)}]`}getHook(){if(!tA(this.entryNode))return{variants:new Set,hook:void 0};let A={},e=[],t=new Set;for(let[k,g]of this.preloadDependencyTree){if(g.children.size===0&&g.fetches.size===0||!g.variantHasAnyFetches)continue;t.add(k);let $=g.usedVariables.map(F=>this.variables.create(F));e.push(...$),A[k]=this.declarations.dedupe("preload",B`async (${this.command("query")}, ${this.command("fetch")}, ${kd($)??B`props`}) => await Promise.all(${this.createPromiseList(g,!0)})`)}if(!t.size)return{variants:new Set,hook:void 0};let r=this.declarations.dedupe("preloadStatements",A),o=this.imports.addImport("react",{exportSpecifier:"*",importBinding:"React"}),n=this.imports.addImport("framer",{exportSpecifier:"usePreloadQuery"}),a=this.imports.addImport("framer",{exportSpecifier:"usePrefetch"}),i=B`variant`,s=B`gestures`,l=B`clearLoadingVariant`,d=B`setGestureState`,p=this.declarations.dedupe("useLoadingVariant",B`(${i}, ${s}, ${l}, ${d}, props?: Record<string, unknown>) => {${B.joinLines(B`const prequery = ${q.fn(n)}`,B`const prefetch = ${q.fn(a)}`,B`${o}.useEffect(() => {${B.joinLines(B`const promise = ${r}[${i}]`,B`if (!promise || !${s}?.[${i}]?.loading) return`,B`promise(prequery, prefetch, props)`,B`.then(() => ${q.fn(l)})`,B`.catch(() => ${q.fn(d,{isError:!0})})`)}}, [${i}])`)}}`);return{variants:t,hook:k=>q.fn(p,_A.baseVariant,k,_A.clearLoadingGesture,_A.setGestureState,kd(e))}}addStatement(A,e,t,r){let o=this.treeStore.treeIndex.getGroundNodeIdFor(e.id),n=this.treeStore.tree.get(o);if(!n||!MA(n)||Fa(n.gesture))return;let a=Sg(this.preloadDependencyTree,n.id);A==="fetch"&&(a.variantHasAnyFetches=!0);let i=t.get(this.entryNode.id);i&&a.usedVariables.push(...i);let s=a;for(let l of US(e,t,A==="fetch")){let d=Sg(s.children,l);if(l===e.id){A==="query"&&(d.value=r),A==="fetch"&&d.fetches.add(r);for(let[k,g]of t){let $=d.dependencies.get(k)??[];$.push(...g),d.dependencies.set(k,$)}}let p=t.get(l);p&&d.usedVariables.push(...p),s.children.set(l,d),s=d}this.preloadDependencyTree.set(n.id,a)}getVariableDependencies(A){let e=[],t=new Map;for(let r of A)e.push(this.variables.create(r)),WS(t,r.providerId??this.entryNode.id,r);return{destructured:kd(e),dependencies:t}}};si=new WeakMap;function US(j,A,e){if(j.cache.ancestorRepeaterIds){if(e){let t=[...j.cache.ancestorRepeaterIds,j.id];for(let r=j.cache.ancestorRepeaterIds.length-1;r>=0;r--){let o=j.cache.ancestorRepeaterIds[r];if(o&&A.has(o))break;t.splice(r,1)}return t}return[...j.cache.ancestorRepeaterIds,j.id]}return[j.id]}function WS(j,A,e){let t=j.get(A)??[];t.push(e),j.set(A,t)}function zS(j){return{id:j,value:void 0,dependencies:new Map,usedVariables:[],children:new Map,fetches:new q.Set,variantHasAnyFetches:!1}}function Sg(j,A){return j.get(A)??zS(A)}function yg(...j){let A=[];for(let e of j)e&&A.push(OA(e));return new q(A.join(", "))}function kd(j){if(j.length!==0)return j.reduce((A,e)=>(A[OA(e)]=e,A),{})}function XS(j){return j.length===0?B``:j.reduce((A,e)=>(A[e.id]=Ea(e.id,e.providerId,!1),A),new vj)}function ud(j,A){if(j===void 0)return"";let e=`<${A}>${j}</${A}>`,r=zt(e).querySelector(A);return r instanceof HTMLElement?r.innerHTML:""}function bg(j,A){let e={headStart:"",headEnd:"",bodyEnd:"",bodyStart:""};for(let t of jm){let r=[],o=j[t];if(o&&r.push(o),A)for(let n in A){let a=A[n]?.[t];a?.html&&!a.disabled&&r.push(`<!-- Plugin: ${n} --> ${a.html}`)}e[t]=r.map(n=>YS(n,t)).join(`
`)}return e}function YS(j,A){if(A==="headStart"||A==="headEnd")return ud(j,"head");if(A==="bodyStart"||A==="bodyEnd")return ud(j,"body");Bi(A)}var md=j=>j;function QtA(j){return j.filter(te)}var Ns=B`params`,Cg={type:"siteMetadata",localIdName:"siteMetadata",localId:Oe("siteMetadata","siteMetadata")};function IrA(j){return{type:"webPageMetadata",localIdName:j,localId:Oe("webPageMetadata",j)}}var FrA=md(async(j,A)=>{let{assetMap:e,treeStore:t,modulesStore:r}=A,o=new ti(e),n=new lr,a=new cr("siteMetadata",r,n),i=new pn(j),s=new kr(n),l=new ao(j,a,n,void 0,t,r),d=new ai(j,t,i,s,n,a,o),p=new ri(n,i,d,o,l),k=new oi(j,i,t,a,n,s,p,r,"siteMetadata"),g=new Lt(s,void 0,a,i,k,void 0,p,r,"siteMetadata"),$=Tg(j,o,g,i,k,void 0,void 0);return[{type:"siteMetadata",revision:void 0,source:Pg($,a,s,k,g,i,null),artifacts:{assets:o.keys}}]}),GrA=md(async(j,A,e)=>{let{treeStore:t,modulesStore:r,assetMap:o}=A,{serializationId:n}=e,a=new ti(o),i=new lr,s=new cr("webPageMetadata",r,i),l=new pn(j),d=new kr(i),p=new ao(j,s,i,void 0,t,r),k=new ai(j,t,l,d,i,s,a),g=new ri(i,l,k,a,p),$=new oi(j,l,t,s,i,d,g,r,"webPageMetadata"),F=new Lt(d,void 0,s,l,$,void 0,g,r,"webPageMetadata"),I=j.dataIdentifier?K.dataForIdentifier(j.dataIdentifier):null,S=Tg(j,a,F,l,$,ZS(t.tree,j,s),Ay(s));S.viewport=await jy(j);let T=Object.entries(j.getBreakpointValues()).map(([P,N])=>({hash:lp(P),mediaQuery:Tu(N)}));S.breakpoints=T;let v=Wk(j);return S.elements=v,S.serializationId=n,[{type:"webPageMetadata",source:Pg(S,s,d,$,F,l,I),artifacts:{assets:a.keys},revision:j.moduleSourceRevision}]}),vg=/^[a-z_$][\w$]*$/i;function SrA(j){let A=new q.Set;function e(t){let r=ol(),o=t.matchAll(r);for(let[,n]of o)n&&vg.test(n)&&A.add(new q(n))}for(let t in j.webMetadata){let r=t,o=j.webMetadata[r];switch(r){case"title":case"description":case"socialImage":_(o)&&e(o),cA(o)&&A.add(new q(o.id));break;case"favicon":case"faviconDark":case"appleTouchIcon":case"googleAnalyticsTrackingId":case"reducedMotion":case"language":case"languageTitle":case"noIndex":case"noIndexSite":case"canonicalURL":case"customCanonicalURL":case"optOutOfHTMLPlugin":case"automaticLocale":case"preserveQueryParams":case"enableFormsUTMTracking":case"editorBarDisabled":break;default:}}for(let t in j.customHTML){let r=t,o=j.customHTML[r];switch(r){case"headStart":case"headEnd":case"bodyStart":case"bodyEnd":_(o)&&e(o);break;default:}}if(j.titleLocalized)for(let t of Object.values(j.titleLocalized))_(t.value)&&e(t.value);if(j.descriptionLocalized)for(let t of Object.values(j.descriptionLocalized))_(t.value)&&e(t.value);return A}function Tg(j,A,e,t,r,o,n){let a={},i=r.add(Kt(j,j.webMetadata?.title,e,t)??o,j.titleLocalized,(p,k)=>(E(k.variables),Kt(j,j.titleLocalized?.[p]?.value,k.valueTransforms,k.variables)));oA(i)||(a.title=i);let s=r.add(Kt(j,j.webMetadata?.description,e,t)??n,j.descriptionLocalized,(p,k)=>(E(k.variables),Kt(j,j.descriptionLocalized?.[p]?.value,k.valueTransforms,k.variables)));if(oA(s)||(a.description=s),j.webMetadata?.favicon){let p=A.resolve(j.webMetadata.favicon);E(p,"Favicon is not a valid asset reference"),a.favicon=p.src}let l=j.webMetadata?.socialImage;if(cA(l)){let p=Jj(l.id,j.id),k=t.create(p);a.socialImage=e.wrapInToImageSrc(k)}else if(l){let p=A.resolve(l);E(p,"Social image is not a valid asset reference"),a.socialImage=p.src}j.webMetadata?.noIndex===!0?a.robots="noindex":a.robots="max-image-preview:large",j.webMetadata?.noIndexSite!==void 0&&(a.framerSearch={index:!j.webMetadata?.noIndexSite});let d=bg(j.customHTML??{},Lr(j)?j.pluginCustomHTML:void 0);if(d.headStart){let p=Kt(j,d.headStart,e,t,"escape");p&&(a.customHTMLHeadStart=p)}if(d.headEnd){let p=Kt(j,d.headEnd,e,t,"escape");p&&(a.customHTMLHeadEnd=p)}if(d.bodyStart){let p=Kt(j,d.bodyStart,e,t,"escape");p&&(a.customHTMLBodyStart=p)}if(d.bodyEnd){let p=Kt(j,d.bodyEnd,e,t,"escape");p&&(a.customHTMLBodyEnd=p)}return a}function Pg(j,A,e,t,r,o,n){let a=[];for(let s of o.variables){let l=B`${Ns}?.${s}`,d=n?.properties[String(s)];if(d&&d.type==="enum"){let k=r.wrapInValueTransform(l,{name:"enumToDisplayName"},d);l=B`${l} !== undefined ? ${k} : undefined`}let p=B`const ${s} = ${l}`;a.push(p)}let i=B.joinLines(B`export default function metadata(${Ns}, ${_A.activeLocale}) {`,...a,B`return ${j}`,B`}`);return B.joinSections(B.linesFrom(A.statements),...t.list(),...e.list(),i,B`export const metadataVersion = 1`)}function Kt(j,A,e,t,r){if(qe(A))return;let o=ol();return ar.replaceAll(A,o,(n,a)=>{let[i,s]=Mu(a,r);if(!vg.test(i))return n;let l=Jj(i,j.id),d=t.create(l),p=d;return p=e.wrapInTemplateFilters(p,s),B`${d} !== undefined ? ${p} : ${n}`})}function yrA(j,A,e){let t=e?.title,r=Mg(j,A);return t||r}function ZS(j,A,e){let t=e.addImport(`../${Cg.localId}`,{exportSpecifier:"default",importBinding:"siteMetadata"}),r=B`${t}(${Ns}, ${_A.activeLocale}).title`,o=Mg(j,A);return B`${r} || ${o}`}function Ay(j){let A=j.addImport(`../${Cg.localId}`,{exportSpecifier:"default",importBinding:"siteMetadata"});return B`${A}(${Ns}, ${_A.activeLocale}).description`}function Mg(j,A){if(Kj(A)){let r=K.dataForIdentifier(A.dataIdentifier);if(r?.name)return r.name+" Detail"}let e=Xk(j,A);return go(e??"/")}async function jy(j){if(V(j)){let A=j.isLoaded()?j:await j.load();return A?A.getReplicaVariants().length>0?"width=device-width":`width=${A.getPrimaryVariant().width}`:"width=device-width"}return"width=device-width"}function _rA(j){Ut(G6(j),"Array gallery control must be Array of Object controls");let A=j.control,e;for(let t in A.controls){Ut(!e,"Multiple item properties found in gallery control");let r=A.controls[t];Ut(r?.type==="responsiveimage"),e=[t,r]}return Ut(e,"Gallery control must have at least one item property"),e}function DrA(j,A){if(!$6(A)||!A.value)return;let e=A.value[j];if(e?.type==="image")return e}function NrA(j){return j?j.filter(A=>!ey(A)):[]}function ey(j){if(!$6(j)||!j.value)return!1;let A=Object.values(j.value);if(A.length!==1)return!1;let e=A[0];return Dp(e)?oA(e.value):!1}function _g(j){if(!G6(j))return!1;let A=Object.values(j.control.controls);return A.length!==1?!1:A[0]?.type==="responsiveimage"}function qrA(j){return`${j??"Field"} is required`}function KrA(j,A){return`Exceeded max length by ${Mk(j-A,"character","characters")}`}function VrA(j){return`Must have at least ${j.minCount} ${Dg(j)}`}function JrA(j){return`Must have at most ${j.maxCount} ${Dg(j)}`}var HrA="Slug value is already taken and must be unique";function Dg(j){return _g(j)?"images":"items"}export{Jm as a,Tl as b,Xm as c,rE as d,Wy as e,ah as f,gn as g,lh as h,eb as i,Pe as j,gv as k,hn as l,Ml as m,hv as n,nE as o,iE as p,Kv as q,Rn as r,Vv as s,Mh as t,Jv as u,Hv as v,Qv as w,Uv as x,Wv as y,rT as z,oT as A,Me as B,nT as C,iT as D,aT as E,sT as F,lT as G,cT as H,xh as I,dT as J,dE as K,Ol as L,hr as M,IT as N,FT as O,wh as P,wa as Q,kE as R,NT as S,wl as T,xT as U,OT as V,wT as W,Ll as X,LT as Y,La as Z,zT as _,XT as $,YT as aa,co as ba,uE as ca,nP as da,Kb as ea,Lm as fa,mE as ga,EE as ha,$E as ia,qm as ja,iC as ka,bl as la,Sl as ma,$n as na,jC as oa,eC as pa,yl as qa,Na as ra,tC as sa,Km as ta,Cl as ua,ph as va,Bn as wa,pC as xa,Ym as ya,KC as za,jE as Aa,VC as Ba,JC as Ca,HC as Da,QC as Ea,UC as Fa,WC as Ga,ZC as Ha,gE as Ia,Va as Ja,xP as Ka,U as La,Ja as Ma,RE as Na,Pj as Oa,N_ as Pa,x_ as Qa,O_ as Ra,w_ as Sa,yE as Ta,bE as Ua,CE as Va,iR as Wa,ME as Xa,Hl as Ya,kD as Za,Ha as _a,PD as $a,Qa as ab,MD as bb,xE as cb,OE as db,wE as eb,Ua as fb,VE as gb,za as hb,Xa as ib,po as jb,QE as kb,zE as lb,XE as mb,Za as nb,jf as ob,ef as pb,fx as qb,Gx as rb,tf as sb,Lx as tb,rf as ub,As as vb,vn as wb,af as xb,sf as yb,HO as zb,cf as Ab,js as Bb,es as Cb,Tn as Db,uf as Eb,jv as Fb,ev as Gb,tE as Hb,bh as Ib,xa as Jb,OR as Kb,Z8 as Lb,A1 as Mb,j1 as Nb,e1 as Ob,Bf as Pb,Bo as Qb,rs as Rb,it as Sb,go as Tb,U1 as Ub,pw as Vb,kw as Wb,uw as Xb,mw as Yb,AI as Zb,jI as _b,eI as $b,tI as ac,Ew as bc,fw as cc,$w as dc,Bw as ec,gw as fc,Ff as gc,oI as hc,hw as ic,Rw as jc,Iw as kc,Fw as lc,Gw as mc,Sw as nc,Oa as oc,yf as pc,Mn as qc,Cf as rc,vf as sc,Pf as tc,Mf as uc,g4 as vc,h4 as wc,xf as xc,G4 as yc,wf as zc,Kf as Ac,L4 as Bc,q4 as Cc,K4 as Dc,V4 as Ec,J4 as Fc,ls as Gc,Vf as Hc,sI as Ic,Jf as Jc,Qf as Kc,OL as Lc,wL as Mc,Uf as Nc,LL as Oc,Wf as Pc,Xf as Qc,$q as Rc,pc as Sc,BI as Tc,Bq as Uc,gq as Vc,hq as Wc,Dn as Xc,Yf as Yc,Nn as Zc,dc as _c,Rq as $c,Iq as ad,Fq as bd,Gq as cd,hI as dd,Sq as ed,yq as fd,A$ as gd,j$ as hd,Wq as id,zq as jd,e$ as kd,t$ as ld,o$ as md,n$ as nd,Bc as od,E$ as pd,YI as qd,zc as rd,HW as sd,PG as td,Xc as ud,zB as vd,XB as wd,ti as xd,ri as yd,Ms as zd,I0 as Ad,F0 as Bd,v0 as Cd,Lt as Dd,Fg as Ed,ai as Fd,bg as Gd,md as Hd,QtA as Id,Cg as Jd,IrA as Kd,FrA as Ld,GrA as Md,SrA as Nd,yrA as Od,Mg as Pd,jy as Qd,_rA as Rd,DrA as Sd,NrA as Td,ey as Ud,_g as Vd,qrA as Wd,KrA as Xd,VrA as Yd,JrA as Zd,HrA as _d,j0 as $d,ps as ae,lJ as be,cJ as ce,Sr as de,cH as ee,ms as fe,w$ as ge,Es as he,IF as ie,V$ as je,J$ as ke,H$ as le,j5 as me,G5 as ne,U$ as oe,W$ as pe,z$ as qe,S5 as re,y5 as se,b5 as te,TF as ue,C5 as ve,Ro as we,v5 as xe,T5 as ye,Q$ as ze,B$ as Ae,lF as Be,ks as Ce,gc as De,hc as Ee,O5 as Fe,w5 as Ge,L5 as He,q5 as Ie,K5 as Je,V5 as Ke,MF as Le,J5 as Me,X$ as Ne,yc as Oe,eB as Pe,tB as Qe,Nt as Re,tQ as Se,Fo as Te,rQ as Ue,nB as Ve,Kn as We,fQ as Xe,JF as Ye,$Q as Ze,HF as _e,QF as $e,Cc as af,iB as bf,BQ as cf,gQ as df,_J as ef,S$ as ff,y$ as gf,DJ as hf,zF as if,XF as jf,vQ as kf,b$ as lf,wJ as mf,On as nf,xc as of,Oc as pf,wc as qf,jH as rf,eH as sf,_$ as tf,wU as uf,SB as vf,yB as wf,LU as xf,qU as yf,KU as zf,DB as Af,xB as Bf,gG as Cf,hG as Df,N$ as Ef,Yc as Ff,xG as Gf,ZB as Hf,wG as If,x$ as Jf,A0 as Kf,qG as Lf,e0 as Mf,uz as Nf,VG as Of,Ad as Pf,JG as Qf,zz as Rf,lX as Sf,QG as Tf,UG as Uf,n0 as Vf,bX as Wf,i0 as Xf,l0 as Yf,LX as Zf,c0 as _f,qX as $f,KX as ag,k0 as bg,E0 as cg,dS as dg,ES as eg,yY as fg,PX as gg,YG as hg,vs as ig,nd as jg,NY as kg,rd as lg,od as mg,id as ng,zY as og,XY as pg};
//# sourceMappingURL=https://app.framerstatic.com/chunk-LFHNV3Y3.mjs.map
